"use strict";(globalThis.webpackChunkixl_webpack=globalThis.webpackChunkixl_webpack||[]).push([["commons-ixl_utils_ixlModal_IxlModal_jsx"],{913585:(t,e,o)=>{o.d(e,{Z:()=>b}),o(868535),o(963452),o(427142);var s=o(406042),i=o(642980),n=o(745247),l=o.n(n),r=o(103024),a=o.n(r),d=o(380742),h=(o(574995),o(547397));const p={open:l().bool,closeCallback:l().func,focusCallback:l().func,blurCallback:l().func,mouseLeaveCallback:l().func,showCloseButton:l().bool,closeButtonStyle:l().object,modalContentStyle:l().object,modalStyle:l().object,extraClassName:l().string,extraClassNameUnderlay:l().string,minMargin:l().number,zIndex:l().number,maskClosable:l().bool,hideMask:l().bool,closeButtonAriaLabelOverride:l().string,ariaLabelledBy:l().string,ariaDescribedBy:l().string,alignmentMode:l().string,targetNodeInfo:l().shape({domNode:l().any,offset:l().number.isRequired,preferredDirections:l().arrayOf(l().oneOf(["above","below","left","right"])).isRequired,onRenderCallback:l().func,crossAxisAlignToEdge:l().bool}),onKeyDown:l().func,dataCy:l().string,children:l().node.isRequired},c={open:!1,showCloseButton:!0,closeButtonStyle:{},modalContentStyle:{},modalStyle:{},extraClassName:"",extraClassNameUnderlay:"",minMargin:10,zIndex:1e3,maskClosable:!1,hideMask:!1,closeButtonAriaLabelOverride:"",ariaLabelledBy:"",ariaDescribedBy:"",alignmentMode:"center",targetNodeInfo:null,closeCallback:h.Z,focusCallback:h.Z,blurCallback:h.Z,mouseLeaveCallback:h.Z,onKeyDown:h.Z,dataCy:null};class m extends s.Component{constructor(t){super(t),this._onResize=this._onResize.bind(this),this._onEscape=this._onEscape.bind(this),this._onFocusPopover=this._onFocusPopover.bind(this),this._onBlurPopover=this._onBlurPopover.bind(this),this._onMouseLeavePopover=this._onMouseLeavePopover.bind(this),this._onMaskClose=this._onMaskClose.bind(this),this.forceResizePopover=this.forceResizePopover.bind(this),this._centerPopover=this._centerPopover.bind(this),this._setupTabs=this._setupTabs.bind(this),this._removeTabs=this._removeTabs.bind(this),this._controlTab=this._controlTab.bind(this),this._setModalRef=this._setModalRef.bind(this),this._setModalContentRef=this._setModalContentRef.bind(this),this._setUnderlayRef=this._setUnderlayRef.bind(this),this._setModalArrowRef=this._setModalArrowRef.bind(this)}componentDidMount(){window.addEventListener("resize",this._onResize),document.addEventListener("keydown",this._onEscape),this._setupTabs(),this._onResize()}componentWillUpdate(){this._removeTabs()}componentDidUpdate(){this._setupTabs(),this._onResize()}componentWillUnmount(){this._removeTabs(),window.removeEventListener("resize",this._onResize),document.removeEventListener("keydown",this._onEscape),document.body.classList.remove("prevent-ios-body-scroll")}_setupTabs(){let t=Array.prototype.slice.call(i.findDOMNode(this).querySelectorAll(["a","input:not([type=hidden]):enabled","select","textarea","button:not([disabled])",".practice-audio-button:not([tabindex='-1'])"].join(",")));t=t.filter((t=>t.offsetHeight>0));const e=t.filter((t=>0===t.tabIndex)),o=t.filter((t=>t.tabIndex>0));o.sort(((t,e)=>t.tabIndex>e.tabIndex)),this._tabOrder=e.concat(o);const s=this;this._tabOrder.forEach((t=>{t.addEventListener("keydown",s._controlTab)}))}_removeTabs(){const t=this;this._tabOrder.forEach((e=>{e.removeEventListener("keydown",t._controlTab)}))}_controlTab(t){if("Tab"===t.key){t.preventDefault();let e=this._tabOrder.indexOf(t.target);t.shiftKey?e--:e++,e<0&&(e=this._tabOrder.length-1),e>=this._tabOrder.length&&(e=0),this._tabOrder[e].focus()}}forceResizePopover(){this._positionPopover()}_positionPopover(){const t=this.props;"target-node"===t.alignmentMode&&t.targetNodeInfo&&t.targetNodeInfo.domNode?this._alignPopoverToTargetNode():this._centerPopover()}_alignPopoverToTargetNode(){const{preferredDirections:t,onRenderCallback:e}=this.props.targetNodeInfo,o={left:this._alignPopoverToTargetNodeLeft,right:this._alignPopoverToTargetNodeRight,above:this._alignPopoverToTargetNodeAbove,below:this._alignPopoverToTargetNodeBelow};let s=!1;for(let i=0;i<t.length&&!s;i++){const n=t[i];s=o[n].call(this),s&&e&&e(n)}s||(o[t[0]].call(this,!0),e&&e(t[0]))}_alignPopoverToTargetNodeBelow(t){const{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,n=i.getBoundingClientRect(),l=this.modal.style.left?parseInt(this.modal.style.left):0,r=this.modal.style.top?parseInt(this.modal.style.top):0,a=e.getBoundingClientRect();if(a.bottom+n.height<=window.innerHeight&&this._modalFitsInCrossAxisDirection(n,a,!0,s,o)||t){const t=this._getCrossAxisAlignmentPoint(a,!0,s),e=n.left+n.width*o;i.style.left=`${l+Math.round(t-e)}px`;const d=a.bottom,h=n.top;i.style.top=`${r+Math.round(d-h)}px`;const p=this.modalArrow.style;return p.borderLeft="10px solid transparent",p.borderRight="10px solid transparent",p.borderTop="",p.borderBottom="5px solid #FFFFFF",p.top="-5px",p.bottom="",p.left=`calc(${100*o}% - 10px)`,p.right="",!0}}_alignPopoverToTargetNodeAbove(t){const{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,n=i.getBoundingClientRect(),l=this.modal.style.left?parseInt(this.modal.style.left):0,r=this.modal.style.top?parseInt(this.modal.style.top):0,a=e.getBoundingClientRect();if(a.top-n.height>=0&&this._modalFitsInCrossAxisDirection(n,a,!0,s,o)||t){const t=this._getCrossAxisAlignmentPoint(a,!0,s),e=n.left+n.width*o;i.style.left=`${l+Math.round(t-e)}px`;const d=a.top,h=n.bottom;i.style.top=`${r+Math.round(d-h)}px`;const p=this.modalArrow.style;return p.borderLeft="10px solid transparent",p.borderRight="10px solid transparent",p.borderTop="5px solid #FFFFFF",p.borderBottom="",p.top="",p.bottom="-5px",p.left=`calc(${100*o}% - 10px)`,p.right="",!0}}_alignPopoverToTargetNodeLeft(t){const{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,n=i.getBoundingClientRect(),l=this.modal.style.left?parseInt(this.modal.style.left):0,r=this.modal.style.top?parseInt(this.modal.style.top):0,a=e.getBoundingClientRect();if(a.left-n.width>=0&&this._modalFitsInCrossAxisDirection(n,a,!1,s,o)||t){const t=a.left,e=n.right;i.style.left=`${l+Math.round(t-e)}px`;const d=this._getCrossAxisAlignmentPoint(a,!1,s),h=n.top+n.height*o;i.style.top=`${r+Math.round(d-h)}px`;const p=this.modalArrow.style;return p.borderLeft="5px solid #FFFFFF",p.borderRight="",p.borderTop="10px solid transparent",p.borderBottom="10px solid transparent",p.top=`calc(${100*o}% - 10px)`,p.bottom="",p.left="",p.right="-5px",!0}}_alignPopoverToTargetNodeRight(t){const{domNode:e,offset:o,crossAxisAlignToEdge:s}=this.props.targetNodeInfo,i=this.modal,n=i.getBoundingClientRect(),l=this.modal.style.left?parseInt(this.modal.style.left):0,r=this.modal.style.top?parseInt(this.modal.style.top):0,a=e.getBoundingClientRect();if(a.right+n.width<=window.innerWidth&&this._modalFitsInCrossAxisDirection(n,a,!1,s,o)||t){const t=a.right,e=n.left;i.style.left=`${l+Math.round(t-e)}px`;const d=this._getCrossAxisAlignmentPoint(a,!1,s),h=n.top+n.height*o;i.style.top=`${r+Math.round(d-h)}px`;const p=this.modalArrow.style;return p.borderLeft="",p.borderRight="5px solid #FFFFFF",p.borderTop="10px solid transparent",p.borderBottom="10px solid transparent",p.top=`calc(${100*o}% - 10px)`,p.bottom="",p.left="-5px",p.right="",!0}}_modalFitsInCrossAxisDirection(t,e,o,s,i){const n=o?window.innerWidth:window.innerHeight,l=o?t.width:t.height,r=this._getCrossAxisAlignmentPoint(e,o,s);return r+l*(1-i)<=n&&r-l*i>=0}_getCrossAxisAlignmentPoint(t,e,o){return e?t.left+(o?0:t.width/2):t.top+(o?0:t.height/2)}_centerPopover(){const t=document.documentElement.clientHeight,e=document.documentElement.clientWidth;this._lastHeight||(this._lastHeight=t),this._lastWidth||(this._lastWidth=e),/(android)/i.test(navigator.userAgent)&&(this._lastWidth===e&&3*this._lastHeight/4>t?this._androidKeyboardShown=!0:this._lastWidth===e&&4*this._lastHeight/3<t&&(this._androidKeyboardShown=!1)),this.modalContent.style.removeProperty("height"),this.modal.style.removeProperty("right"),this.modal.style.removeProperty("left"),this.modalContent.style.removeProperty("width");const o=this.modalContent.getBoundingClientRect(),s=this.underlay.getBoundingClientRect(),i=o.height,n=o.width,l=t-i,r=this.props.minMargin+(s.width-n)/2;l>2*r?(this.modal.style.top=l/2+"px",this.modal.style.removeProperty("bottom")):this._androidKeyboardShown?this.modal.style.top=`${r}px`:(this.modal.style.top=`${r}px`,this.modal.style.bottom=`${r}px`,this.modalContent.style.height=t-2*r+"px");const a=e-n;a>2*r?(this.modal.style.left=a/2+"px",this.modal.style.removeProperty("right")):(this.modal.style.left=`${r}px`,this.modal.style.right=`${r}px`,this.modalContent.style.width=e-2*r+"px"),this._lastHeight=t,this._lastWidth=e}_setModalRef(t){this.modal=t}_setModalContentRef(t){this.modalContent=t}_setUnderlayRef(t){this.underlay=t}_setModalArrowRef(t){this.modalArrow=t}_onResize(){this.props.open&&this._positionPopover()}_onEscape(t){this.props.open&&"Escape"===t.key&&this.props.showCloseButton&&this.props.closeCallback()}_onFocusPopover(){this.props.focusCallback&&this.props.focusCallback()}_onBlurPopover(){this.props.blurCallback&&this.props.blurCallback()}_onMouseLeavePopover(){this.props.mouseLeaveCallback&&this.props.mouseLeaveCallback()}_onMaskClose(t){this.props.maskClosable&&t.currentTarget===t.target&&this.props.closeCallback()}render(){let t=null;this.props.showCloseButton&&(t=s.createElement(d.xR,null,(t=>{let{getI18nMessage:e}=t;return s.createElement("button",{className:"modal-close","data-cy":"ixl-modal-close",style:this.props.closeButtonStyle,onClick:this.props.closeCallback,"aria-label":this.props.closeButtonAriaLabelOverride||e("ixl_modal.close")})})));const e={display:this.props.open?"block":"none",zIndex:this.props.zIndex},o=a()(["ixl-modal-outer-container",this.props.extraClassName,this.props.alignmentMode],{hidden:this.props.hideMask}),i={zIndex:this.props.zIndex},n=a()(["ixl-modal-mask"],{hidden:this.props.hideMask}),l={zIndex:this.props.zIndex+1};Object.assign(l,this.props.modalStyle);const r=a()({"ixl-modal":!0});return s.createElement("div",{className:o,onKeyDown:this.props.onKeyDown,style:e},s.createElement("div",{className:n,style:i,onClick:this._onMaskClose}),s.createElement("div",{className:r,style:l,role:"dialog","aria-labelledby":this.props.ariaLabelledBy,"aria-describedby":this.props.ariaDescribedBy,onFocus:this._onFocusPopover,onBlur:this._onBlurPopover,onMouseLeave:this._onMouseLeavePopover,tabIndex:-1,ref:this._setModalRef,"data-state":this.props.open?"open":"closed","data-cy":this.props.dataCy},s.createElement("div",{className:"ixl-modal-arrow",ref:this._setModalArrowRef}),s.createElement("div",{className:"ixl-modal-container","data-cy":"ixl-modal-container"},s.createElement("div",{className:"ixl-modal-inside"},s.createElement("div",{className:"ixl-modal-content",style:this.props.modalContentStyle,ref:this._setModalContentRef},this.props.children)),t),s.createElement("div",{className:this.props.extraClassNameUnderlay?this.props.extraClassNameUnderlay:"ixl-modal-underlay",ref:this._setUnderlayRef})))}}m.propTypes=p,m.defaultProps=c;const b=m}}]);