"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[129927],{516838:(e,t,n)=>{n.d(t,{eN:()=>i,o1:()=>a,Pi:()=>o,cL:()=>s,FB:()=>r,JG:()=>d,ao:()=>l});const i="shell",a={showToast:"showToast",removeToast:"removeToast",showBanner:"showBanner",removeBanner:"removeBanner",updateProfilePicture:"updateProfilePicture",updateDisplayName:"updateDisplayName",openPhonelinkDialog:"openPhonelinkDialog"},o={showToast:e=>({actor:i,action:a.showToast,data:e}),removeToast:e=>({actor:i,action:a.removeToast,data:e}),showBanner:e=>({actor:i,action:a.showBanner,data:e}),removeBanner:e=>({actor:i,action:a.removeBanner,data:e}),updateProfilePicture:()=>({actor:i,action:a.updateProfilePicture}),updateDisplayName:()=>({actor:i,action:a.updateDisplayName}),openPhonelinkDialog:()=>({actor:i,action:a.openPhonelinkDialog})},s=e=>"object"==typeof e&&null!==e&&"title"in e&&"intent"in e&&"source"in e&&"dismissOnAction"in e,r=e=>"object"==typeof e&&null!==e&&"id"in e&&"source"in e&&"intentLevel"in e&&"text"in e&&(!("isContextualBanner"in e)||!0===e.isContextualBanner&&"targetEntityType"in e),d=e=>"object"==typeof e&&null!==e&&"id"in e,l=e=>"object"==typeof e&&null!==e&&"id"in e&&"source"in e},455051:(e,t,n)=>{var i,a,o,s,r;n.d(t,{IO:()=>i,Wx:()=>a,$b:()=>o,BV:()=>s,fP:()=>r,lV:()=>d,p$:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={})),function(e){e[e.Skype=0]="Skype",e[e.AAD=1]="AAD",e[e.CAE=2]="CAE"}(a||(a={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(o||(o={})),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(s||(s={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.AAD_V2_TFL="https://mtsvc.fl.teams.microsoft.com/teams.mt.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation",e.FORMS_AUTH_URL="MicrosoftForms.ReadWrite",e.SEARCH_SERVICE_AUTH_RESOURCE="https://searchsvc.fl.teams.microsoft.com/teams.search.readwrite",e.SUBSTRATE_TOKEN_URL="https://substrate.office.com/M365.Access",e.UNIFIED_STORAGE_QUOTA="https://graph.microsoft.com/Files.ReadWrite",e.MY_MS_PERSONAL_CONTENT_V2="https://my.microsoftpersonalcontent.com/v2/.default",e.HOME_MS_PERSONAL_CONTENT_V2="https://home.microsoftpersonalcontent.com/v2/.default",e.GRAPH_API_BASE_URL_DEFAULT="https://graph.microsoft.com/.default",e.AAD_MT_TFL="service::api.fl.teams.microsoft.com::MBI_SSL"}(r||(r={}));const d="9188040d-6c67-4c5b-b112-36a304b66dad";var l;!function(e){e.DEFAULT="DEFAULT",e.MEETING="MEETING",e.SKYPEMIGRATION="SKYPEMIGRATION"}(l||(l={}))},903502:(e,t,n)=>{var i,a;n.d(t,{I:()=>i,V:()=>a}),function(e){e.Compose="Compose",e.MessagePane="MessagePane",e.DeeplinkedMessage="DeeplinkedMessage",e.DoNotMove="DoNotMove",e.PeoplePickerInput="people-picker-input"}(i||(i={})),function(e){e.LeftRailSelectedItem="LeftRailSelectedItem",e.DoNotMove="DoNotMove"}(a||(a={}))},663896:(e,t,n)=>{var i;n.d(t,{k:()=>i,w:()=>d}),function(e){e.Configurations="Configurations",e.HorizontalBar="HorizontalBar",e.Main="Main",e.Modal="Modal",e.Monitor="Monitor",e.Rail="Rail",e.OverlayThinHorizontalBar="OverlayThinHorizontalBar",e.PartialOverlay="PartialOverlay",e.ThinHorizontalBar="ThinHorizontalBar",e.TitleBar="TitleBar",e.VerticalBar="VerticalBar",e.PreCache="PreCache"}(i||(i={}));const{OverlayThinHorizontalBar:a,ThinHorizontalBar:o,TitleBar:s,VerticalBar:r,...d}=i},240892:(e,t,n)=>{var i;n.d(t,{Q:()=>i}),function(e){e.CallHistoryContainerError="CallHistoryContainerError",e.CallsAppSwitchError="CallsAppSwitchError",e.CommandGetAppViewEntitiesFailure="CommandGetAppViewEntitiesFailure",e.ChannelDashboardHeader="ChannelDashboardHeader",e.ChannelDashboardView="ChannelDashboardView",e.ChannelHeader="ChannelHeader",e.ChannelHeaderBoundaryError="ChannelHeaderBoundaryError",e.CommunitiesHeader="CommunitiesHeader",e.ChannelHeaderTitle="ChannelHeaderTitle",e.ChannelHeaderTitleBoundaryError="ChannelHeaderTitleBoundaryError",e.ChannelListContainerError="ChannelListContainerError",e.CommunitiesHeaderTitleBoundaryError="CommunitiesHeaderTitleBoundaryError",e.CommunitiesHeaderBoundaryError="CommunitiesHeaderBoundaryError",e.CommunitiesPaneBoundaryError="CommunitiesPaneBoundaryError",e.CommunitiesDataError="CommunitiesDataError",e.CreateWindowError="CreateWindowError",e.CreateUserContextError="CreateUserContextError",e.DeeplinkIntentParseFailure="DeeplinkIntentParseFailure",e.DeeplinkExecutionTerminated="DeeplinkExecutionTerminated",e.DeeplinkLaunchCrossCloud="DeeplinkLaunchCrossCloud",e.DeeplinkLaunchCrossCloudError="DeeplinkLaunchCrossCloudError",e.DelegatedCommandError="DelegatedCommandError",e.DestroyedClientCommandError="DestroyedClientCommandError",e.EmptyWindowError="EmptyWindowError",e.EntityCommandResolverError="EntityCommandResolverError",e.ErrorAppError="ErrorAppError",e.ErrorBoundaryError="ErrorBoundaryError",e.EventError="EventError",e.ExtensionAlreadyRenderedInWindow="ExtensionAlreadyRenderedInWindow",e.GetCommandScenarioNameHookFailed="GetCommandScenarioNameHookFailed",e.GuardiansError="GuardiansError",e.GridViewBoundaryError="GridViewBoundaryError",e.SingleTeamViewLeftRail="SingleTeamViewLeftRail",e.MessagePaneBoundaryError="MessagePaneBoundaryError",e.DiscoverSurfaceBoundaryError="DiscoverSurfaceBoundaryError",e.DiscoverSurfaceErrorScreenRendered="DiscoverSurfaceErrorScreenRendered",e.EntityCommandMutateError="EntityCommandMutateError",e.NetworkOffline="NetworkOffline",e.OnBeforeIntentAuthenticatedReturnedUndefined="OnBeforeIntentAuthenticatedReturnedUndefined",e.OnBeforeIntentAuthenticatedRejected="OnBeforeIntentAuthenticatedRejected",e.OnAfterIntentAuthenticatedReturnedUndefined="OnAfterIntentAuthenticatedReturnedUndefined",e.OnAfterIntentAuthenticatedRejected="OnAfterIntentAuthenticatedRejected",e.OnBeforeCommandHandledRejected="OnBeforeCommandHandledRejected",e.PlatformErrorBoundaryError="PlatformErrorBoundaryError",e.RenderingError="RenderingError",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.ThreadListErrorBoundaryError="ThreadListErrorBoundaryError",e.TimeoutRunningApp="TimeoutRunningApp",e.TimeoutRunningCore="TimeoutRunningCore",e.UnknownCommandError="UnknownCommandError",e.UserContextMismatch="UserContextMismatch",e.WindowCacheFailedToUpdate="WindowCacheFailedToUpdate",e.WindowCloseRunningApp="WindowCloseRunningApp",e.WindowCloseRunningCore="WindowCloseRunningCore",e.WindowNotFound="WindowNotFound"}(i||(i={}))},892256:(e,t,n)=>{var i;n.d(t,{T:()=>i}),function(e){e.UnableToCreateChat="UnableToCreateChat",e.UnableToCreateGuardianChatTFL="UnableToCreateGuardianChatTFL",e.UnableToCreateThrottledUserChatTFL="UnableToCreateThrottledUserChatTFL",e.UnableToAddParticipant="UnableToAddParticipant",e.UnableToAddParticipantGuardianChatTFL="UnableToAddParticipantGuardianChatTFL",e.UnableToRemoveParticipant="UnableToRemoveParticipant",e.UnableToRemoveParticipantGuardianChatTFL="UnableToRemoveParticipantGuardianChatTFL",e.UnableToLeaveChat="UnableToLeaveChat",e.UnableToLeaveGuardianChatTFL="UnableToLeaveGuardianChatTFL",e.UnableToDeleteChat="UnableToDeleteChat",e.UnableToViewChat="UnableToViewChat",e.UnableToNavigateToGroupCopilotChat="UnableToNavigateToGroupCopilotChat"}(i||(i={}))},370054:(e,t,n)=>{var i,a,o,s,r,d,l,c,m,u,g;n.d(t,{PW:()=>a,Vd:()=>s,$D:()=>l,$i:()=>c,qF:()=>m,ZS:()=>u,Wu:()=>g,Xr:()=>p,XJ:()=>h}),function(e){e.VideoEffectsButton="video-effects-button",e.AvatarButton="effects-and-avatars-button"}(i||(i={})),function(e){e.Voicemail="voicemail",e.MissedCalls="missed-calls"}(a||(a={})),function(e){e.Chat="Chat",e.Meeting="Meeting"}(o||(o={})),function(e){e.Invite="Invite",e.Claim="Claim",e.FileShare="FileShare",e.Community="Community",e.PlatformExtension="PlatformExtension",e.PlatformStage="PlatformStage",e.SkypeInvites="SkypeInvites"}(s||(s={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(r||(r={})),function(e){e.Outlook="Outlook",e.Google="Google"}(d||(d={})),function(e){e.template="template",e.group="group",e.team="team"}(l||(l={})),function(e){e.WIFI="WIFI",e.PERIPHERAL="PERIPHERAL",e.HOTDESK="HOTDESK",e.ROOM="ROOM",e.E911="E911"}(c||(c={})),function(e){e[e.teamsAndChannels=0]="teamsAndChannels",e[e.teamGallery=1]="teamGallery"}(m||(m={})),function(e){e[e.Whiteboard=0]="Whiteboard",e[e.Document=1]="Document",e[e.Video=2]="Video"}(u||(u={})),function(e){e.TeamDeleted="TeamDeleted",e.NoAccessToTeam="NoAccessToTeam",e.TeamNotFound="TeamNotFound",e.ChannelDeleted="ChannelDeleted",e.NoAccessToChannel="NoAccessToChannel",e.ChannelNotFound="ChannelNotFound",e.SomethingWentWrong="SomethingWentWrong"}(g||(g={}));const p={sideload:"sideload",staging:"staging",tenant:"tenant"};var h;!function(e){e[e.AppDetailsDialog=1]="AppDetailsDialog",e[e.AppBarContextMenu=2]="AppBarContextMenu",e[e.AppHeaderContextMenu=3]="AppHeaderContextMenu"}(h||(h={}))},312726:(e,t,n)=>{var i,a;n.d(t,{h:()=>i,F:()=>a}),function(e){e.OpenOnMainRenderer="main"}(i||(i={})),function(e){e.DeepLink="deepLink",e.ImmersiveReader="immersiveReader",e.MeetingNotes="meetingNotes",e.Transcript="Transcript",e.JoinBroadcastAsAttendee="joinBroadcastAsAttendee"}(a||(a={}))},489294:(e,t,n)=>{n.d(t,{x:()=>s,r:()=>r});var i=n(199448),a=n(850434);let o;const s=e=>async t=>{if(!o)return e(t);return e(t).then((e=>(o?.processResponse(e),e))).catch((e=>{throw o?.processError(e),e}))};function r(e,t){if(o){throw(0,i.$5)(a.Ir.Tasks,a.O4.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}o={processResponse:e,processError:t};return()=>{o=void 0}}},21534:(e,t,n)=>{n.d(t,{tg:()=>M,s_:()=>P});var i,a=n(754255),o=n(700188),s=n(953730),r=n(403097);!function(e){e.HEALTHY="healthy",e.UNHEALTHY="unhealthy",e.UNKNOWN="unknown"}(i||(i={}));var d=n(762322),l=n(817542),c=n(634664),m=n(657120),u=n(845097),g=n(199448),p=n(480354);const h={headers:{sharePoint:{SPRequestGuid:"SPRequestGuid",SPClientServiceRequestDuration:"SPClientServiceRequestDuration",SPRequestDuration:"SPRequestDuration"}}},f="cache",y="cache-control",C="x-cache",v="electron";var I;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(I||(I={}));let D="";async function T(e){const{status:t,responseHeaders:n,requestHeaders:i,performance:a}=e,o=await async function(e){try{return await e}catch(e){return}}(a);return Object.assign(e,{requestHeaders:(s=i,A(["clientRequestId","x-ms-request-id","x-ms-client-caller","x-ms-request-priority"],s)),responseHeaders:w(t,n),performance:F(o)});var s}const M=(e,t,n,s="")=>{const r=(t.get(a.w.Telemetry).httpnsDisabledServices??[]).map((e=>e.toLowerCase()));return async t=>{const{serviceName:a,apiName:h,result:f,innerError:y,operationLogs:C}=t;if(y&&(0,g.WZ)(y))return;t.operationLogs=await function(e){const t=e.map((async e=>{const{type:t,duration:n,result:i,request:a}=e;return{type:t,duration:n,result:i,request:a&&await T(a)}}));return Promise.all(t)}(C);const v=a.toLowerCase(),I=r.some((e=>e===v));D=s;const M=t.correlationId||(0,u.v4)(),A=U(a,h),b=(0,p.first)(t.operationLogs.map((e=>e.request?.responseHeaders?.serverRequestId)).filter(Boolean)),w=`Data call ${A} is completed with ${f}. CorrelationId: ${M}. ServerRequestId: ${b}.`;n.log(w),I||t.operationLogs.forEach((t=>{if(t.request){const{name:n,method:i}=t.request;E(e,N(a,n||h,i),"EM",t,M)}})),function(e,t,n){const{serviceName:a,apiName:s,createdTime:r,duration:u,parameters:g,result:p,statusCode:h,innerError:f,operationLogs:y}=e,C=function(e,t){const n=(0,m.AR)().getEndpointHealth(e,t);return void 0===n?i.UNKNOWN:n?i.HEALTHY:i.UNHEALTHY}(a,s);y.forEach((e=>{if(e.request){const{method:t}=e.request;!function(e,t,n,i,a,s,r){const d=t.request;if(d){const{duration:m,result:u}=t,{method:g,hostname:p,performance:h,responseHeaders:f,requestHeaders:y,dateTime:C,authPerformanceLogs:v}=d,I={apiName:i,serviceName:a,duration:m,result:S(u),correlationId:n,method:g,hostname:p,responseHeaders:(0,c.hR)(f),requestHeaders:(0,c.hR)(y),healthState:s,timestamp:C.toISOString(),hasInnerError:!!r};h&&(h.duration&&(I.perf_duration=h.duration.toString()),I.perf_details=(0,c.hR)({...h,...v})),(0,l.wW)(o.Q.Endpoint,e,I,void 0,void 0,void 0,D)}}(N(a,s,t),e,n,s,a,C,f)}}));const v=p===d.B.RequireStatusFailed?`${p}-${h}`:p,I={apiName:s,serviceName:a,duration:u,result:v,innerError:(0,c.hR)(f),correlationId:n,userAgent:t.navigator.userAgent,timestamp:r,operationLogs:(0,c.hR)(y),parameters:(0,c.hR)(g),ECT:t.navigator?.connection?.effectiveType,healthState:C},T=U(a,s);(0,l.wW)(o.Q.Endpoint,T,I,void 0,void 0,void 0,D)}(t,e,M)}};function S(e){let t;return e instanceof Error&&(t=e.innerException?`${e.reason} / ${(0,c.hR)(e.innerException)}`:e.reason),t||e||""}function A(e,t){const n={};return t&&e.forEach((e=>{t[e]&&(n[e]=t[e])})),n}function b(e=""){if(!e)return e;let t=0;return e.split(",").forEach((e=>{const n=e.split("/");t+=+n[0]+ +n[1]})),`${t}`}function w(e,t){return t?{contentLength:t["content-length"]||"-1",serverRequestId:t.contextid||t["x-serverrequestid"]||t["request-id"]||R(t),[f]:B(e,t),requestId:t["x-ms-request-id"],invalidToken:t["x-invalid-token"],afdCorrelationId:t["x-msedge-ref"],serverLatency:t["x-end2endlatencyms"],serviceOrigin:t["x-servicering"],cafeLatency:b(t["x-cafeproxylatency"]),requestPriority:t["x-ms-request-priority"]}:{}}const P=(e,t,n,i,a,o,r)=>{const d=r||s.nW[i?.status]||"",l=function(e){const t={};if(e)for(const n of Object.keys(e.headers)){t[n.toLowerCase()]=e.headers[n]}return t}(i),{serviceName:c,apiName:m,method:u,authPerformanceLogs:g}=n;E(o,N(c,m,u),"SEND",{type:s.ew.Initial,duration:e,result:d,request:{name:m||"undefined",dateTime:t,method:n.method,hostname:i&&new URL(i.url).hostname,status:i?.status,requestHeaders:n.headers||{},responseHeaders:l,performance:a,authPerformanceLogs:g}},n.correlationId)};const E=({navigator:e},t,n,i,a)=>{const d=i.request;if(d){const{dateTime:m,method:u,hostname:g,status:p,requestHeaders:h,responseHeaders:y,performance:C,authPerformanceLogs:I}=d,T={ECT:e?.connection?.effectiveType,hostname:g,transport:n,requestCreatedTime:m.toISOString(),networkState:e.onLine?r.Kv.ONLINE:r.Kv.OFFLINE,method:u,resultCode:p,requestResult:S(i.result),contentLength:y["content-length"]||-1,serverRequestId:y.contextid||y["x-serverrequestid"]||y["request-id"]||R(y),correlationId:a,duration:i.duration,authPerformanceLogs:(0,c.hR)(I)};!function(e,t,n,i,a){const o=i&&i.clientRequestId,r=n["x-ms-request-id"]||i["x-ms-request-id"];e.requestId=r,o&&(e.clientRequestId=o);n["x-invalid-token"]&&(e.invalidToken=n["x-invalid-token"]);t!==s.nW.OK&&(e.afdCorrelationId=n["x-msedge-ref"]);e.hasClaims=!!a&&!!a.hasClaims}(T,p,y,h,I),T[f]=B(p,y),function(e,t,n){if(n){const i=n.domainLookupEnd-n.domainLookupStart,a=n.connectEnd-n.connectStart,o=n.redirectEnd-n.redirectStart;if(i>0&&(e.dns=i),a>0&&(e.tcp=a),o>0&&(e.redirect=o),e.size=n.transferSize,e.payload=n.encodedBodySize,e.start=n.startTime,e.reqStart=n.requestStart,e.respStart=n.responseStart,n.duration){const i=n.duration;(-1===t.userAgent.toLowerCase().indexOf(v)||e.duration&&i>e.duration)&&(e.duration=i)}}}(T,e,C),(0,l.wW)(o.Q.Http,t,T,void 0,void 0,void 0,D)}};function R(e){let t=e[h.headers.sharePoint.SPRequestGuid.toLowerCase()]||"";return"[object String]"===Object.prototype.toString.call(t)&&t.length>0&&(t=[`${h.headers.sharePoint.SPRequestGuid}=${t}`,`${h.headers.sharePoint.SPClientServiceRequestDuration}=${e[h.headers.sharePoint.SPClientServiceRequestDuration.toLowerCase()]||""}`,`${h.headers.sharePoint.SPRequestDuration}=${e[h.headers.sharePoint.SPRequestDuration.toLowerCase()]||""}`].join(";")),t}function F(e){if(e){const{duration:t,domainLookupStart:n,domainLookupEnd:i,connectStart:a,connectEnd:o,redirectStart:s,redirectEnd:r,transferSize:d,encodedBodySize:l,startTime:c,requestStart:m,responseStart:u}=e;return{duration:t,dns:i-n,tcpHandshakeTime:o-a,redirectTime:r-s,transferSize:d,encodedBodySize:l,startTime:c,requestStart:m,responseStart:u}}return{}}function B(e,t){let n=I.None;if(t.hasOwnProperty(y)){const i=t[y];e===s.nW.NOT_MODIFIED?n=I.Browser:i.includes("no-store")||i.includes("no-cache")||(n=I.Browser,i.includes("public")&&(n+=", ".concat(I.Shared)))}else t.hasOwnProperty("expires")&&(n=I.Browser);if(t.hasOwnProperty(C)){t[C].toLowerCase().includes("hit")&&(n===I.None?n=I.CDN:n+=", ".concat(I.CDN))}return n}function N(e,t,n){return`${e}_${t||"undefined"}_${n}`}function U(e,t){return`${t}_${e}`}},720639:(e,t,n)=>{n.d(t,{g:()=>r});var i=n(953730),a=n(199448),o=n(850434),s=n(867564);function r(e){return async t=>{try{return await e(t)}catch(e){if(e instanceof TypeError&&e.message?.toLowerCase()===s.p7){const n=t.headers&&t.headers.cache;if(n&&-1!==n.indexOf("only-if-cached"))return{status:i.nW.GATEWAY_TIMEOUT};e=(0,a.$5)(o.Ir.RejectHttpError,o.O4.RemoteOperationFailed,"rejectHttpError",void 0,e.message)}throw e}}}},867564:(e,t,n)=>{n.d(t,{cS:()=>i,p7:()=>a,Us:()=>o});const i=3e4,a="failed to fetch",o="Request Timed Out"},647561:(e,t,n)=>{function i(e,t){return({url:n,...i})=>e({...i,url:new URL(n,t).href})}n.d(t,{V:()=>i})},378193:(e,t,n)=>{n.d(t,{b:()=>r});var i=n(823013),a=n.n(i),o=n(780952),s=n(867564);const r=({url:e,method:t,body:n,headers:i,credentials:r,timeout:d=s.cS,skipHeaders:l=!1})=>{const c=new AbortController;return(0,o.a)(a()(e,{method:t,headers:l?{}:i&&new Headers(i),body:n,credentials:r,signal:c.signal}),d,s.Us,c).then((e=>{const t={};return e.headers.forEach(((e,n)=>t[n]=e)),{status:e.status,headers:t,body:e,url:e.url}}))}},291678:(e,t,n)=>{n.d(t,{t:()=>r});var i=n(489294),a=n(21534);var o=n(378193),s=n(720639);const r=(0,i.x)(function(e){return async t=>{let i,o;const s=performance.now(),r=new Date;try{return o=await e(t),o}catch(e){throw i=e.code||e.message,o=e.serverResponse,e}finally{!function(e,t,i,o,s){const r=n.g;(0,a.s_)(o,t,i,e,e&&function(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType)return t[t.length-1];return}(e.url),r,s)}(o,r,t,performance.now()-s,i)}}}((0,s.g)(o.b)))},621803:(e,t,n)=>{n.d(t,{Es:()=>l,Bh:()=>c,r8:()=>m,LT:()=>u,Ok:()=>g,B6:()=>p});var i=n(324532),a=n(577253),o=n(913937),s=n(88519),r=n(961286),d=n(473107);const l=(e,t)=>!("-1"===e.id||e.id===e.clientMessageId)&&t?new Date(Date.now()).toISOString():e.version,c=(e,t,n,o,s)=>{if(t.from&&t.imDisplayName&&(n||t.attached))return t;const{fragment:r,fragmentTypeName:d,fragmentName:c}=u(s);try{const s=e.readFragment(n?{id:`${d}:${t.clientMessageId}`,fragment:r,fragmentName:c}:{id:`${(0,i.or)(t)}`,fragment:a.s,fragmentName:"replyMessage"});if(!s)return o&&o.warn(`getDataToWrite::No existing entry found in cache for ${n?"post":"reply"} with clientMessageId ${t.clientMessageId}. Returning given data.`),t;const m=n?void 0:s.attached;return{...t,...!n&&{attached:m},from:s.from,imDisplayName:s.imDisplayName,version:l(t,!0)}}catch(e){return o&&o.warn(`getDataToWrite::Failed to read ${n?"post":"reply"} fragment to replace existing lie for msg with clientMessageId ${t.clientMessageId}. Returning given data.`),t}};function m(e,t,n){const o=c(e,t,!1,n);try{const n=o.attached;e.writeFragment({id:`${(0,i.or)(t)}`,fragment:a.s,fragmentName:"replyMessage",data:{...o,...n&&{attached:n}}})}catch(e){n&&n.error(`updateExistingReply::Failed writing replyChainMessage fragment to cache for clientMessageId ${t.clientMessageId}`)}}const u=e=>{switch(e){case"Announcement":return{fragmentName:"announcementPostMessage",fragmentTypeName:"AnnouncementPostMessage",fragment:o.D};case"Guardians":return{fragmentName:"DataFragmentsCommonGuardiansPostMessageFragment",fragmentTypeName:"GuardiansPostMessage",fragment:r.m};default:return{fragmentName:"standardPostMessage",fragmentTypeName:"StandardPostMessage",fragment:s.T}}},g=(e,t,n,o="Standard")=>t!==n?{id:(0,i.or)({__typename:e,id:n}),fragmentName:"replyMessage",fragment:a.s}:{id:`${e}:${n}`,...u(o)},p=(e,t)=>{let n;if(!t||t.deleteTime)return;if(e.from!==t.from)return;return h(e,t)?n="bottom":t.attached&&(n="top"),n},h=(e,t)=>{if(e.messageType&&f(e.messageType)||t.messageType&&f(t.messageType))return!1;const n=t.originalArrivalTime&&new Date(t.originalArrivalTime),i=e.originalArrivalTime&&new Date(e.originalArrivalTime);return!(!i||!n)&&i.getTime()-n.getTime()<=5*d.Kv},f=e=>!!e&&(/^(Event|Control|ThreadActivity)/.test(e)||"RichText/Media_CallRecording"===e||"RichText/Media_LocalRecording"===e)},913937:(e,t,n)=>{n.d(t,{D:()=>f});var i=n(67309),a=n(568513),o=n(406909),s=n(954312),r=n(411234),d=n(46229),l=n(373558),c=n(952809),m=n(120157),u=n(509094),g=n(85284),p=n(96562),h=n(20404);const f={kind:"Document",get definitions(){const e=(0,i.G)("fragment announcementPostMessage on AnnouncementPostMessage {id,clientMessageId,content,version,originalArrivalTime,deleteTime,isDeletedByAdmin,editTime,files {...files},from,imDisplayName,messageType,importance,mentions {...mentions},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},subject,isPinned,status,announcement {title,originalImageUrl,croppedImageUrl,colorTheme,croppedImageHeight,croppedImageWidth,croppedImageAltText,isTeamsIllustration},cards {...card},atpSharepointData {...DataFragmentsCommonAtpSharepointDataFragment},translation {...translation},dlpContext {...dlpContext},isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,isCrossPost,crossPostId,crossPostStatus,crossPostFailedChannels,postType,deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},messageRenderType,replyPermission,canUserReply,meeting {...meeting},translationStatus,softDeleteReason,sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,isUserFollowing,userHasSaved,forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.S.definitions,...o.M.definitions,...s.r.definitions,...r.Z.definitions,...d.$.definitions,...l.p.definitions,...c.n.definitions,...m.K.definitions,...u.g.definitions,...g.a.definitions,...p.C.definitions,...h.h.definitions]}}},76719:(e,t,n)=>{n.d(t,{x:()=>g});var i=n(67309),a=n(410703),o=n(88519),s=n(913937),r=n(911678),d=n(46493),l=n(214898),c=n(961286),m=n(577253),u=n(936213);const g={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataClientChannelReplyChainSummaryWithUserDetailsFragment on ReplyChainSummary {id,replyChainId,channelId,consumptionHorizon {...consumptionHorizonFields},consumptionHorizonBookmark {...consumptionHorizonFields},postType,postMessage {...standardPostMessage,...announcementPostMessage,...emailPostMessage,...meetingPostMessage,...connectorPostMessage,...DataFragmentsCommonGuardiansPostMessageFragment},previewMessageSet {...replyMessage,...meetingReplyMessage},mostRecentOverflowMessage {... on ReplyChainMessage {id,originalArrivalTime,from},... on MeetingReplyMessage {id,originalArrivalTime,from}},totalReplies,forceShowResponseSurface,totalUsers,recentUsers {id,displayName},recentUserDisplayNameHints,creationTime,updatedTime,hasMention,hasChannelMention,hasImportance,hasFiles,hasCurrentUserMention,hasUnreadPostMessage,hasUnreadReplyMessage,isCurrentUserParticipant}");return delete this.definitions,this.definitions=[...e.definitions,...a.U.definitions,...o.T.definitions,...s.D.definitions,...r.s.definitions,...d.h.definitions,...l.T.definitions,...c.m.definitions,...m.s.definitions,...u.$.definitions]}}},911678:(e,t,n)=>{n.d(t,{s:()=>y});var i=n(67309),a=n(568513),o=n(406909),s=n(954312),r=n(411234),d=n(46229);const l={kind:"Document",get definitions(){const e=(0,i.G)("fragment emailUser on EmailUser {name,smtp}");return delete this.definitions,this.definitions=e.definitions}},c={kind:"Document",get definitions(){const e=(0,i.G)("fragment emailDetails on EmailDetails {from {...emailUser},sender {...emailUser},to {...emailUser},cc {...emailUser},emailLink,totalRecipients}");return delete this.definitions,this.definitions=[...e.definitions,...l.definitions]}};var m=n(373558),u=n(952809),g=n(120157),p=n(509094),h=n(96562),f=n(20404);const y={kind:"Document",get definitions(){const e=(0,i.G)("fragment emailPostMessage on EmailPostMessage {id,clientMessageId,content,version,originalArrivalTime,deleteTime,isDeletedByAdmin,editTime,files {...files},from,imDisplayName,messageType,importance,mentions {...mentions},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},subject,isPinned,emailDetails {...emailDetails},status,cards {...card},atpSharepointData {...DataFragmentsCommonAtpSharepointDataFragment},translation {...translation},dlpContext {...dlpContext},isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,isCrossPost,crossPostId,crossPostStatus,crossPostFailedChannels,postType,deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},hardDeleteReason,hardDeleteTime,messageRenderType,replyPermission,canUserReply,translationStatus,softDeleteReason,sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,isUserFollowing,userHasSaved,forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.S.definitions,...o.M.definitions,...s.r.definitions,...r.Z.definitions,...d.$.definitions,...c.definitions,...m.p.definitions,...u.n.definitions,...g.K.definitions,...p.g.definitions,...h.C.definitions,...f.h.definitions]}}},85284:(e,t,n)=>{n.d(t,{a:()=>o});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment scheduledMeetingInfo on ScheduledMeetingInfo {startTime,endTime,exchangeId,iCalUID,isCancelled,eventType,eventRecurrenceRange {startDate,endDate},eventRecurrencePattern {patternType,daily {interval},weekly {daysOfTheWeek,interval},monthly {dayOfMonth,interval},relativeMonthly {dayOfTheWeekIndex,dayOfTheWeek,interval},yearly {month,dayOfTheMonth},relativeYearly {month,dayOfTheWeekIndex,dayOfTheWeek}}}");return delete this.definitions,this.definitions=e.definitions}},o={kind:"Document",get definitions(){const e=(0,i.G)("fragment meeting on Meeting {itemId,meetingTitle,meetingActionType,tenantId,organizerId,meetingJoinUrl,location,scheduledMeetingInfo {...scheduledMeetingInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...a.definitions]}}},46493:(e,t,n)=>{n.d(t,{h:()=>y});var i=n(67309),a=n(406909),o=n(954312),s=n(411234),r=n(46229),d=n(568513),l=n(85284),c=n(373558),m=n(952809),u=n(120157),g=n(509094),p=n(96562),h=n(203820),f=n(20404);const y={kind:"Document",get definitions(){const e=(0,i.G)("fragment meetingPostMessage on MeetingPostMessage {id,clientMessageId,content,version,originalArrivalTime,deleteTime,editTime,isDeletedByAdmin,from,imDisplayName,messageType,importance,mentions {...mentions},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},files {...files},subject,isPinned,status,meeting {...meeting},cards {...card},atpSharepointData {...DataFragmentsCommonAtpSharepointDataFragment},translation {...translation},dlpContext {...dlpContext},isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,isCrossPost,crossPostId,crossPostStatus,crossPostFailedChannels,postType,deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},replyPermission,canUserReply,translationStatus,softDeleteReason,sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,isUserFollowing,suggestedActions {...DataFragmentsCommonMessageSuggestedActionsFragment},userHasSaved,forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.M.definitions,...o.r.definitions,...s.Z.definitions,...r.$.definitions,...d.S.definitions,...l.a.definitions,...c.p.definitions,...m.n.definitions,...u.K.definitions,...g.g.definitions,...p.C.definitions,...h.m.definitions,...f.h.definitions]}}},936213:(e,t,n)=>{n.d(t,{$:()=>f});var i=n(67309),a=n(954312),o=n(411234),s=n(46229),r=n(406909),d=n(373558),l=n(952809),c=n(568513),m=n(85284),u=n(120157),g=n(509094),p=n(96562),h=n(203820);const f={kind:"Document",get definitions(){const e=(0,i.G)("fragment meetingReplyMessage on MeetingReplyMessage {id,clientMessageId,content,version,originalArrivalTime,deleteTime,isDeletedByAdmin,editTime,from,imDisplayName,messageType,isImportant,importance,callId,diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},mentions {...mentions},cards {...card},atpSharepointData {...DataFragmentsCommonAtpSharepointDataFragment},files {...files},isPinned,status,messageRenderType,replyPermission,canUserReply,meeting {...meeting},translation {...translation},dlpContext {...dlpContext},isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,attached,deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},translationStatus,softDeleteReason,sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,suggestedActions {...DataFragmentsCommonMessageSuggestedActionsFragment},userHasSaved}");return delete this.definitions,this.definitions=[...e.definitions,...a.r.definitions,...o.Z.definitions,...s.$.definitions,...r.M.definitions,...d.p.definitions,...l.n.definitions,...c.S.definitions,...m.a.definitions,...u.K.definitions,...g.g.definitions,...p.C.definitions,...h.m.definitions]}}},577253:(e,t,n)=>{n.d(t,{s:()=>f});var i=n(67309),a=n(568513),o=n(954312),s=n(411234),r=n(46229),d=n(406909),l=n(373558),c=n(952809),m=n(509094),u=n(120157),g=n(756806),p=n(96562),h=n(203820);const f={kind:"Document",get definitions(){const e=(0,i.G)("fragment replyMessage on ReplyChainMessage {id,clientMessageId,content,version,originalArrivalTime,deleteTime,isDeletedByAdmin,editTime,files {...files,...files},from,imDisplayName,messageType,isImportant,importance,diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},mentions {...mentions},cards {...card},atpSharepointData {...DataFragmentsCommonAtpSharepointDataFragment},files {...files},isPinned,status,messageRenderType,isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,attached,urlPreview {url,title,description,previewEnabled,thumbnail,thumbnailMeta {width,height}},deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},dlpContext {...dlpContext},translation {...translation},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},replyPermission,canUserReply,messageRenderType,translationStatus,softDeleteReason,sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},feedbackLoopEnabled,sensitivity {title,description},poweredByAI,citations {...DataFragmentsCommonMessageCitationFragment},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,suggestedActions {...DataFragmentsCommonMessageSuggestedActionsFragment},userHasSaved}");return delete this.definitions,this.definitions=[...e.definitions,...a.S.definitions,...o.r.definitions,...s.Z.definitions,...r.$.definitions,...d.M.definitions,...l.p.definitions,...c.n.definitions,...m.g.definitions,...u.K.definitions,...g.B.definitions,...p.C.definitions,...h.m.definitions]}}},88519:(e,t,n)=>{n.d(t,{T:()=>y});var i=n(67309),a=n(568513),o=n(406909),s=n(954312),r=n(411234),d=n(46229),l=n(373558),c=n(952809),m=n(509094),u=n(120157),g=n(756806),p=n(96562),h=n(20404),f=n(203820);const y={kind:"Document",get definitions(){const e=(0,i.G)("fragment standardPostMessage on StandardPostMessage {id,clientMessageId,content,version,originalArrivalTime,editTime,deleteTime,isDeletedByAdmin,files {...files},from,imDisplayName,messageType,importance,mentions {...mentions},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},subject,isPinned,status,cards {...card},atpSharepointData {...DataFragmentsCommonAtpSharepointDataFragment},isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,isCrossPost,crossPostId,crossPostStatus,crossPostFailedChannels,postType,urlPreview {url,title,description,previewEnabled,thumbnail,thumbnailMeta {width,height}},deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},dlpContext {...dlpContext},translation {...translation},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},messageRenderType,replyPermission,canUserReply,translationStatus,softDeleteReason,sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},sendPipelineStatus,isUserFollowing,feedbackLoopEnabled,sensitivity {title,description},poweredByAI,citations {...DataFragmentsCommonMessageCitationFragment},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}},suggestedActions {...DataFragmentsCommonMessageSuggestedActionsFragment},userHasSaved}");return delete this.definitions,this.definitions=[...e.definitions,...a.S.definitions,...o.M.definitions,...s.r.definitions,...r.Z.definitions,...d.$.definitions,...l.p.definitions,...c.n.definitions,...m.g.definitions,...u.K.definitions,...g.B.definitions,...p.C.definitions,...h.h.definitions,...f.m.definitions]}}},773477:(e,t,n)=>{n.d(t,{k:()=>o});var i=n(283906),a=n(745549);const o=(e,t,n,o,s,r=!1,d=!1,l,c)=>{n?((0,i.t4)(e,t,n,o,s,r,c),(0,a.HA)(e,t,n,o,r,c)):(0,i.xE)(e,t,o,s,r,d,l,c)}},745549:(e,t,n)=>{n.d(t,{yw:()=>D,UT:()=>I,HA:()=>y});var i=n(640829),a=n(67309),o=n(410703),s=n(88519),r=n(913937),d=n(911678),l=n(46493),c=n(577253),m=n(936213),u=n(214898),g=n(961286);const p={kind:"Document",get definitions(){const e=(0,a.G)("fragment replyChainMessageNodeLie on ReplyChainMessageNode {id,postType,message {...standardPostMessage,...announcementPostMessage,...emailPostMessage,...meetingPostMessage,...replyMessage,...meetingReplyMessage,...connectorPostMessage,...DataFragmentsCommonGuardiansPostMessageFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...s.T.definitions,...r.D.definitions,...d.s.definitions,...l.h.definitions,...c.s.definitions,...m.$.definitions,...u.T.definitions,...g.m.definitions]}},h={kind:"Document",get definitions(){const e=(0,a.G)("query replyChainMessagesList($channelId:ID!,$replyChainId:ID!,$queryInput:ReplyChainQueryInput,$first:Int,$after:String,$last:Int,$before:String) {replyChainMessages(channelId:$channelId,replychainId:$replyChainId,queryInput:$queryInput,first:$first,after:$after,last:$last,before:$before) {consumptionHorizon {...consumptionHorizonFields},pageInfo {startCursor,endCursor,hasNextPage,hasPreviousPage},edges {node {id,...replyChainMessageNodeLie}},parentMessage {id,postType,from,replyPermission,canUserReply},metadata {dataSource,channelRosterSizeExceeded},deeplinkedMessageState,isCurrentUserParticipant}}");return delete this.definitions,this.definitions=[...e.definitions,...o.U.definitions,...p.definitions]}};var f=n(621803);function y(e,t,n,i,a,o){const s=a?(0,f.Bh)(e,i,!1,o):i,r=v(e,t,n,o);if(!r)return void(o&&o.warn(`updateReplyChainMessagesWithReply::Failed getting replyChainMessage data for channel ${t} replyChainId ${n}`));let d=s.attached;if(!a){const e=r?.replyChainMessages?.edges?.[0]?.node;d=!e?.postType?(0,f.B6)(s,e?.message):void 0}const l=M(a?i.id:i.clientMessageId||"",n),c={id:l,postType:null,message:{...s,...d&&{attached:d}}};if(a){const e=T(l,r);if(-1===e)return void(o&&o.warn("updateReplyChainMessagesWithReply::replaceExisting::Could not find matching message to replace"));r.replyChainMessages.edges[e]={__typename:"ReplyChainMessagesEdge",node:{__typename:"ReplyChainMessageNode",...c}}}else r.replyChainMessages.edges.unshift({__typename:"ReplyChainMessagesEdge",node:{__typename:"ReplyChainMessageNode",...c}});C(e,t,n,r,o)}const C=(e,t,n,i,a)=>{try{e.writeQuery({query:h,variables:{channelId:t,replyChainId:n},data:i})}catch(e){return void(a&&a.error(`writeReplyChainMessageData::Failed writing replyChainMessageList query to cache for channel ${t} replyChainId ${n}`))}},v=(e,t,n,a)=>{try{const a=e.readQuery({query:h,variables:{channelId:t,replyChainId:n}});return(0,i.m)(a)}catch(e){return a&&a.error(`getReplyChainSummariesData::Failed to read replyChainSummariesQuery for channel ${t} replyChainId ${n}`),null}},I=(e,t,n,i,a)=>{let o=null;try{o=e.readFragment({id:`ReplyChainMessage:${i.id}`,fragment:c.s,fragmentName:"replyMessage"})}catch(e){a&&a.error(`removeLieFromReplyChainMessages::Failed to read cache fragment for replyMessage id ${i.id} for channelId ${t} and replyChainId ${n}`)}const s=v(e,t,n,a);if(!s)return void(a&&a.warn(`removeLieFromReplyChainMessages::Failed to read from replyChainMessages cache for channel ${t}.`));const r=T(M(i.clientMessageId||"",n),s);-1!==r?(o?s.replyChainMessages.edges[r]={__typename:"ReplyChainMessagesEdge",node:{__typename:"ReplyChainMessageNode",id:M(o?.id||"",n),postType:null,message:{...o,__typename:"ReplyChainMessage"}}}:s.replyChainMessages.edges[r].node.message.id=i.id,C(e,t,n,s,a)):a&&a.warn(`removeLieFromReplyChainMessages::Message with id ${i.clientMessageId||""} not found in cache for channel ${t}`)},D=(e,t,n,i,a)=>{const o=v(e,t,n,a);if(!o)return void a.warn(`deleteFailedReplyLieFromReplyChainMessages::Failed to read from replyChainMessages cache for channel ${t}.`);const s=M(i||"",n);-1!==T(s,o)?(o.replyChainMessages.edges=o.replyChainMessages.edges.filter((e=>e.node.id!==s)),C(e,t,n,o,a)):a.warn(`deleteFailedReplyLieFromReplyChainMessages::Message with id ${i||""} not found in cache for channel ${t}`)},T=(e,t)=>t.replyChainMessages.edges.findIndex((t=>t.node.id===e)),M=(e,t)=>`${t}_${e}`},283906:(e,t,n)=>{n.d(t,{ue:()=>A,qZ:()=>S,xE:()=>M,t4:()=>T});var i=n(324532),a=n(640829),o=n(301587),s=n(577253),r=n(76719),d=n(67309),l=n(410703);const c={kind:"Document",get definitions(){const e=(0,d.G)("fragment standardPostLie on StandardPostMessage {id,clientMessageId,originalArrivalTime,from,version}");return delete this.definitions,this.definitions=e.definitions}},m={kind:"Document",get definitions(){const e=(0,d.G)("fragment meetingPostLie on MeetingPostMessage {id,clientMessageId,originalArrivalTime,from,version}");return delete this.definitions,this.definitions=e.definitions}},u={kind:"Document",get definitions(){const e=(0,d.G)("fragment emailPostMessageLie on EmailPostMessage {id,clientMessageId,originalArrivalTime,from,version}");return delete this.definitions,this.definitions=e.definitions}},g={kind:"Document",get definitions(){const e=(0,d.G)("fragment meetingPostMessageLie on MeetingPostMessage {id,clientMessageId,originalArrivalTime,from,version}");return delete this.definitions,this.definitions=e.definitions}},p={kind:"Document",get definitions(){const e=(0,d.G)("fragment announcementPostMessageLie on AnnouncementPostMessage {id,clientMessageId,originalArrivalTime,from,version}");return delete this.definitions,this.definitions=e.definitions}},h={kind:"Document",get definitions(){const e=(0,d.G)("fragment guardiansPostMessageLie on GuardiansPostMessage {id,clientMessageId,originalArrivalTime,from,version}");return delete this.definitions,this.definitions=e.definitions}},f={kind:"Document",get definitions(){const e=(0,d.G)("fragment replyLie on ReplyChainMessage {id,clientMessageId,originalArrivalTime,from,version,attached}");return delete this.definitions,this.definitions=e.definitions}},y={kind:"Document",get definitions(){const e=(0,d.G)("fragment meetingReplyLie on MeetingReplyMessage {id,clientMessageId,originalArrivalTime,from,version,attached}");return delete this.definitions,this.definitions=e.definitions}},C={kind:"Document",get definitions(){const e=(0,d.G)("fragment replyChainSummaryLie on ReplyChainSummary {id,replyChainId,channelId,consumptionHorizon {...consumptionHorizonFields},postType,postMessage {...standardPostLie,...meetingPostLie,...emailPostMessageLie,...meetingPostMessageLie,...announcementPostMessageLie,...guardiansPostMessageLie},previewMessageSet {...replyLie,...meetingReplyLie},creationTime}");return delete this.definitions,this.definitions=[...e.definitions,...l.U.definitions,...c.definitions,...m.definitions,...u.definitions,...g.definitions,...p.definitions,...h.definitions,...f.definitions,...y.definitions]}},v={kind:"Document",get definitions(){const e=(0,d.G)("query replyChainSummaryList($channelId:ID!,$queryInput:ReplyChainSummaryQueryInput,$first:Int,$after:String,$last:Int,$before:String) {replyChainSummaries(channelId:$channelId,queryInput:$queryInput,first:$first,after:$after,last:$last,before:$before) {pageInfo {startCursor,endCursor,hasNextPage,hasPreviousPage},edges {node {id,...replyChainSummaryLie}},metadata {dataSource,channelRosterSizeExceeded},deeplinkedMessageState}}");return delete this.definitions,this.definitions=[...e.definitions,...C.definitions]}};var I=n(621803);const D="updateReplyChainSummariesCache";function T(e,t,n,a,r,d,l){const c=d?(0,I.Bh)(e,a,!1,l):a;try{const t=c.attached;e.writeFragment({id:`${(0,i.or)(a)}`,fragment:s.s,fragmentName:"replyMessage",data:{...c,...t&&{attached:t}}})}catch(e){return void l?.errorToTelemetry?.(`Failed to write replyMessageFragment for channelId: ${t}, replyChainId: ${n}, replaceExisting: ${d}`,"messaging_delete_message",{conversationId:t,operationType:D},!0)}if(!d){const i=b(e,t,l);if(!i)return void l?.warn(`updateReplyChainSummariesWithReply::No replyChainSummaries found in cache for channel ${t}`);const s=i.replyChainSummaries.edges.find((e=>e.node.replyChainId===n));if(!s)return void l?.warn(`updateReplyChainSummariesWithReply::ReplyChainSummary does not include post with replyChainId ${n}`);const{node:d}=s,c=[...d.previewMessageSet];c.length===o.L&&c.shift();let m="top";if(c.length){const e=c[c.length-1];m=(0,I.B6)(a,e)||"top"}const u={__typename:a.__typename||"ReplyChainMessage",id:a.clientMessageId||"",clientMessageId:a.clientMessageId||"",from:r,originalArrivalTime:a.originalArrivalTime||"",version:"-1",attached:m};c.push(u);try{e.writeFragment({id:`ReplyChainSummary:${t}::${n}`,fragment:C,fragmentName:"replyChainSummaryLie",data:{...d,previewMessageSet:c}})}catch(e){return void l?.errorToTelemetry?.(`Failed to write replyChainSummaryLieFragment for channelId: ${t}, replyChainId: ${n}`,"messaging_delete_message",{conversationId:t,operationType:D},!0)}}}function M(e,t,n,i,a,o,s,d){const l=a?(0,I.Bh)(e,n,!0,d,s):n,c={...l,version:(0,I.Es)(n,a),__typename:n.__typename||"StandardPostMessage",clientMessageId:n.clientMessageId||"",originalArrivalTime:n.originalArrivalTime||"",from:i||l.from||""},{fragmentName:m,fragmentTypeName:u,fragment:g}=(0,I.LT)(s),p=o?n.id:n.clientMessageId;try{e.writeFragment({id:`${u}:${p}`,fragment:g,fragmentName:m,data:c})}catch(e){return void d?.errorToTelemetry?.(`Failed to write ${u} for channelId: ${t}, messageId: ${p}, replaceExisting: ${a}, isEdit: ${o}`,"messaging_delete_message",{conversationId:t,operationType:D},!0)}if(!a){const i={__typename:"ReplyChainSummary",id:`${t}::${n.clientMessageId}`,channelId:t,replyChainId:n.clientMessageId||"",creationTime:n.originalArrivalTime||"",postType:s||"Standard",postMessage:c,previewMessageSet:[],mostRecentOverflowMessage:null,totalReplies:0,totalUsers:0,recentUsers:[],recentUserDisplayNameHints:[],updatedTime:null,hasMention:!1,hasChannelMention:!1,hasImportance:!1,hasFiles:!1,forceShowResponseSurface:!1,hasCurrentUserMention:!1,isCurrentUserParticipant:null,hasUnreadPostMessage:null,hasUnreadReplyMessage:null,consumptionHorizon:{id:"lie_ch"},consumptionHorizonBookmark:{id:"lie_ch-bookmark"}};try{e.writeFragment({id:`ReplyChainSummary:${t}::${p}`,fragment:r.x,fragmentName:"DataClientChannelReplyChainSummaryWithUserDetailsFragment",data:i})}catch(e){return void d?.errorToTelemetry?.(`Failed to write replyChainSummaryFragment for channelId: ${t}, messageId: ${p}, isEdit: ${o}`,"messaging_delete_message",{conversationId:t,operationType:D},!0)}const a=b(e,t,d);if(!a)return void d?.warn(`updateReplyChainSummariesWithPost::replyChainSummariesList is undefined for channel ${t}`);a.replyChainSummaries.edges.unshift({__typename:"ReplyChainSummaryEdge",node:i}),w(e,t,a,d)}}const S=(e,t,n,i,a,o)=>{const s=b(e,t,a);if(!s)return void a?.warn(`removePostClientLie::replyChainSummariesList is undefined for channel ${t}`);const r=s.replyChainSummaries.edges;let d;if(d=o?r.findIndex((e=>e.node.postMessage.clientMessageId===i)):r.findIndex((e=>e.node.id===`${t}::${i}`)),-1!==d){if(o)s.replyChainSummaries.edges=r.filter((e=>e.node.postMessage.clientMessageId!==i));else{const e=r[d].node;e.id=`${t}::${n}`,e.replyChainId=n,e.postMessage.id=n}w(e,t,s,a)}else a?.warn(`removePostClientLie::Could not find matching ${t}::${i} node in replyChainSummaries.`)},A=(e,t,n,i,a)=>{const o=b(e,t,a);if(!o)return void a.warn(`deleteFailedReplyLieFromReplyChainSummaries::replyChainSummariesList is undefined for channel ${t}`);const s=o.replyChainSummaries.edges.find((e=>e.node.replyChainId===n));if(!s)return void a.warn(`deleteFailedReplyLieFromReplyChainSummaries::ReplyChainSummaries does not include post with replyChainId ${n}`);const r=s.node.previewMessageSet.findIndex((e=>e.clientMessageId===i));-1!==r?(s.node.previewMessageSet.splice(r,1),w(e,t,o,a)):a.warn("deleteFailedReplyLieFromReplyChainSummaries::Failed to delete reply lie for replyChainSummary.")},b=(e,t,n)=>{try{const n=e.readQuery({query:v,variables:{channelId:t}});return(0,a.m)(n)}catch(e){return n?.errorToTelemetry?.(`Failed to getReplyChainSummariesData for channelId: ${t}`,"messaging_delete_message",{conversationId:t,operationType:D},!0),null}},w=(e,t,n,i)=>{try{e.writeQuery({query:v,variables:{channelId:t},data:n})}catch(e){i?.errorToTelemetry?.(`Failed to writeReplyChainSummariesData for channelId: ${t}`,"messaging_delete_message",{conversationId:t,operationType:D},!0)}}},142179:(e,t,n)=>{n.d(t,{$:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query DataClientChatInsertedHyperlinkQuery {insertedHyperlink @client {displayText,address}}");return delete this.definitions,this.definitions=e.definitions}}},501223:(e,t,n)=>{n.d(t,{W:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appDetailsResult {appDetailsResult @client {appId,appInstallId,isAppInstalled,errorCode}}");return delete this.definitions,this.definitions=e.definitions}}},644077:(e,t,n)=>{n.d(t,{l:()=>o});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment action on AlertAction {text,isSecondary,actionId,showCallWindowIfNotVisible}");return delete this.definitions,this.definitions=e.definitions}},o={kind:"Document",get definitions(){const e=(0,i.G)("fragment callingAlert on CallingAlert {teamsCallId,timestamp,alertType,title,text,ariaText,severity,narrated,actions {...action},dismissable}");return delete this.definitions,this.definitions=[...e.definitions,...a.definitions]}}},373558:(e,t,n)=>{n.d(t,{p:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment card on Card {appIcon,appId,appName,cardClientId,content,contentType,sourceType,locale,name,userSpecificContent {content,timeStamp,version,authBlockLastUsedOn}}");return delete this.definitions,this.definitions=e.definitions}}},214898:(e,t,n)=>{n.d(t,{T:()=>f});var i=n(67309),a=n(568513),o=n(406909),s=n(954312),r=n(411234),d=n(46229),l=n(373558),c=n(120157),m=n(136134),u=n(96562),g=n(509094),p=n(203820),h=n(20404);const f={kind:"Document",get definitions(){const e=(0,i.G)("fragment connectorPostMessage on ConnectorPostMessage {id,clientMessageId,content,version,originalArrivalTime,deleteTime,isDeletedByAdmin,editTime,files {...files},from,imDisplayName,messageType,importance,mentions {...mentions},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},subject,isPinned,status,cards {...card},isLastRead,isTimestampDividerNeeded,scheduledSendTime,draftId,isCrossPost,crossPostId,crossPostStatus,crossPostFailedChannels,postType,deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},connectorMetadata {connectorSenderGuid,providerAccountUniqueId},translation {...translation},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},softDeleteReason,messageRenderType,replyPermission,canUserReply,translationStatus,languageSeenBefore,translatedContent,embeddedLinks {...DataFragmentsCommonEmbeddedLinkFragment},sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,isUserFollowing,dlpContext {...dlpContext},suggestedActions {...DataFragmentsCommonMessageSuggestedActionsFragment},userHasSaved,forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.S.definitions,...o.M.definitions,...s.r.definitions,...r.Z.definitions,...d.$.definitions,...l.p.definitions,...c.K.definitions,...m.R.definitions,...u.C.definitions,...g.g.definitions,...p.m.definitions,...h.h.definitions]}}},952809:(e,t,n)=>{n.d(t,{n:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonAtpSharepointDataFragment on ATPSafelinksSharepointData {URL,Xsdata,Sdata}");return delete this.definitions,this.definitions=e.definitions}}},91501:(e,t,n)=>{n.d(t,{J:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatListItemLastMessageFragment on LastMessage {id,canShowEveryoneMentionBadge,isStreamOngoing,clientMessageId,content:preview,formattedArrivalTime,hasMention,importance,isSystemMessage,originalArrivalTime}");return delete this.definitions,this.definitions=e.definitions}}},186827:(e,t,n)=>{n.d(t,{n:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatListItemLastUpdateFragment on Conversation {id,lastUpdate {__typename,... on Presence {id,localizedGameStatus}}}");return delete this.definitions,this.definitions=e.definitions}}},136134:(e,t,n)=>{n.d(t,{R:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonEmbeddedLinkFragment on EmbeddedLink {objectUrl,title,description,fileShareUrlMeta {objectUrl,shareUrl,id,type}}");return delete this.definitions,this.definitions=e.definitions}}},961286:(e,t,n)=>{n.d(t,{m:()=>h});var i=n(67309),a=n(406909),o=n(954312),s=n(411234),r=n(46229),d=n(373558),l=n(568513),c=n(120157),m=n(136134),u=n(96562),g=n(509094),p=n(20404);const h={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonGuardiansPostMessageFragment on GuardiansPostMessage {id,clientMessageId,content,version,originalArrivalTime,editTime,deleteTime,isDeletedByAdmin,from,imDisplayName,messageType,importance,mentions {...mentions},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {...emotions},emotionsSummary {...emotionsSummary},subject,isPinned,status,cards {...card},isLastRead,isTimestampDividerNeeded,isCrossPost,scheduledSendTime,draftId,crossPostId,crossPostStatus,crossPostFailedChannels,files {...files},postType,urlPreview {url,title,description,previewEnabled,thumbnail,thumbnailMeta {width,height}},deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},translation {...translation},hardDeleteReason,hardDeleteTime,onBehalfOf {...mentions},softDeleteReason,parentsAnnouncementsStatus,messageRenderType,replyPermission,canUserReply,translationStatus,languageSeenBefore,translatedContent,embeddedLinks {...DataFragmentsCommonEmbeddedLinkFragment},sourceLanguageName,sourceLanguageCode,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},fromUser {id,displayName,avatarUrl},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,dlpContext {...dlpContext},userHasSaved,forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.M.definitions,...o.r.definitions,...s.Z.definitions,...r.$.definitions,...d.p.definitions,...l.S.definitions,...c.K.definitions,...m.R.definitions,...u.C.definitions,...g.g.definitions,...p.h.definitions]}}},20404:(e,t,n)=>{n.d(t,{h:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonMessageAnnouncementFragment on Announcement {title,originalImageUrl,croppedImageUrl,colorTheme,croppedImageHeight,croppedImageWidth,croppedImageAltText,isTeamsIllustration}");return delete this.definitions,this.definitions=e.definitions}}},509094:(e,t,n)=>{n.d(t,{g:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment dlpContext on DlpContext {policyViolation {verdictDetails,dlpAction,genericStreamItemId,state,justificationText,userAction,violationType},dlpData {id,content,subject,policyTip {generalText,complianceUrl,matchedConditionDescriptions}}}");return delete this.definitions,this.definitions=e.definitions}}},411234:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment emotions on Emotion {key,users {id,userId,time}}");return delete this.definitions,this.definitions=e.definitions}}},46229:(e,t,n)=>{n.d(t,{$:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment emotionsSummary on EmotionSummary {key,count}");return delete this.definitions,this.definitions=e.definitions}}},568513:(e,t,n)=>{n.d(t,{S:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment files on File {id,itemId,chicletBreadcrumbs {sourceTeamName,sourceChannelName},baseUrl,objectUrl,shareId,shareUrl,type,title,previewUrl,previewHeight,previewWidth,progressComplete,hasUploadFailed,serviceName,state,providerDataV2 {code,type}}");return delete this.definitions,this.definitions=e.definitions}}},506787:(e,t,n)=>{n.d(t,{v:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment meetingInformationFieldsShort on MeetingInformation {id,meetingType}");return delete this.definitions,this.definitions=e.definitions}}},406909:(e,t,n)=>{n.d(t,{M:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment mentions on Mention {id,itemId,userId,displayName,mentionType}");return delete this.definitions,this.definitions=e.definitions}}},284281:(e,t,n)=>{n.d(t,{R:()=>g});var i=n(67309),a=n(954312),o=n(20404),s=n(881538),r=n(203820),d=n(756806),l=n(49427),c=n(96562),m=n(730134),u=n(460977);const g={kind:"Document",get definitions(){const e=(0,i.G)("fragment messageFields on Message {content,contentHash,originalArrivalTime,imDisplayName,renamedDisplayName,id,callId,parentMessageId,originalParentMessageId,from,messageType,importance,interopDeliveryState,replyPermission,smsDeliveryReports {key,users {mri,time,errorCode,value}},diverseEmotions {...DataFragmentsCommonDiverseEmotionsFragment},emotions {key,users {id,time,userId}},emotionsSummary {key,count},blurhash {imageId,blurhash},mentions {id,itemId,userId,displayName,mentionType},meeting {organizerId,tenantId,itemId,meetingTitle,meetingJoinUrl,location,meetingJoinUrl,location,rsvpTo,body,meetingActionType,scheduledMeetingInfo {startTime,endTime,exchangeId,iCalUID,isCancelled,eventType,timeZoneId,originalStartTime,location,eventRecurrenceRange {startDate,endDate},eventRecurrencePattern {patternType,daily {interval},weekly {daysOfTheWeek,interval},monthly {dayOfMonth,interval},relativeMonthly {dayOfTheWeekIndex,dayOfTheWeek,interval},yearly {month,dayOfTheMonth},relativeYearly {month,dayOfTheWeekIndex,dayOfTheWeek}}}},onBehalfOf {id,itemId,userId,displayName,mentionType},cards {appIcon,appId,appName,cardClientId,content,contentType,sourceType,locale,name,userSpecificContent {content,timeStamp,version,authBlockLastUsedOn}},status,diagnosticInfo @client {diagnosticErrorCode,diagnosticMessage},clientMessageId,version,files {id,itemId,chicletBreadcrumbs {sourceTeamName,sourceChannelName},baseUrl,objectUrl,shareId,shareUrl,type,title,previewUrl,previewHeight,previewWidth,progressComplete,hasUploadFailed,serviceName,state,providerDataV2 {code,type}},deeplinks {id,title,channelId,siteUrl,objectUrl,serverRelativeUrl,state},urlPreview {url,title,description,previewEnabled,thumbnail,thumbnailMeta {width,height}},embeddedLinks {objectUrl,title,description,fileShareUrlMeta {id,shareUrl,type,objectUrl}},dlpContext {policyViolation {verdictDetails,dlpAction,genericStreamItemId,state,justificationText,userAction,violationType},dlpData {id,content,subject,policyTip {generalText,complianceUrl,matchedConditionDescriptions}}},deleteTime,editTime,version,userHasSaved,translation @client {status,content,fromLanguage,isChat},atpSharepointData {URL,Xsdata,Sdata},forwardedMessageContext {originalSenderMri,originalArrivalTime,originalMessageId,originalMessageContent,originalThreadId,originalChannelPostSubject,originalChannelPostTitle,originalMessageContains {fluid,appCard},originalAnnouncement {...DataFragmentsCommonMessageAnnouncementFragment}},isDeletedByAdmin,hardDeleteTime,deletionInfo {showMessageAsDeleted,canBeUndeleted,deleteFailed},hardDeleteReason,translatedSubject,translatedContent,translationStatus,isOnDemandTranslation,sourceLanguageName,sourceLanguageCode,isWrittenInPreferredLanguage,languageSeenBefore,scheduledSendTime,draftId,crossPostStatus,crossPostFailedChannels,isCrossPost,crossPostId,subject,postType,announcement {title,originalImageUrl,croppedImageUrl,colorTheme,croppedImageHeight,croppedImageWidth,croppedImageAltText,isTeamsIllustration},vivaTopicsAnnotations {entityAnnotation {sectionMatches {entityMatches {highlightedName,relevance {annotationScore},entities {id}}}},clientRequestId},repliesSummary @include(if:$includeRepliesSummary) {...DataFragmentsCommonRepliesSummaryFragment},feedbackLoopEnabled,sensitivity {title,description},poweredByAI,suggestedActions {...DataFragmentsCommonMessageSuggestedActionsFragment},citations {...DataFragmentsCommonMessageCitationFragment},streamingMetadata {...DataFragmentsCommonMessageStreamingMetadataFragment},botMetadata {...DataFragmentsCommonMessageBotMetadataFragment},sendPipelineStatus,botDeliveryReport {botId,status},fromUser {id,displayName},isUserFollowing,isSkypeMessage,scheduledCallStatus,isLastScheduledMeetingStartedMessage,sharedFromReplyChainId,sharedFromMessageId,sharedToMessageId,...DataFragmentsCommonThreadDetailsHeaderMessageFragment @nonreactive @skip(if:$includeRepliesSummary),...DataFragmentsCommonChannelMessageOnlyFragment}");return delete this.definitions,this.definitions=[...e.definitions,...a.r.definitions,...o.h.definitions,...s.l.definitions,...r.m.definitions,...d.B.definitions,...l.F.definitions,...c.C.definitions,...m.x.definitions,...u.J.definitions]}}},120157:(e,t,n)=>{n.d(t,{K:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment translation on Translation {content,fromLanguage,isChat,status,subject,title}");return delete this.definitions,this.definitions=e.definitions}}},507011:(e,t,n)=>{n.d(t,{ZV:()=>c,nG:()=>m,ud:()=>u});var i=n(480354),a=n(39431),o=n(773477),s=n(621803),r=n(195695),d=n(276952),l=n(435793);const c=async(e,t,n,i,s,l,{mentions:c,cards:m,onBehalfOf:u},h)=>{const{authenticationService:f,discover:y,loggerFactory:C}=t,v=C.newLogger("Client Lie Helper","data-resolvers-browser-chat"),[{profile:{name:I}},D]=await Promise.all([f.getUser(),y.skypeid((0,r.$q)("client-lie-helper:createAndPostClientLie"))]),T=(0,d.Ap)(l,i.subject||"",i.postType);let M=p(T,i,{mentions:c,cards:m,onBehalfOf:u});const{replyChainId:S}=i;M={...M,from:D,imDisplayName:I};const A="Update"===s;if(A){const{clientMessageId:e,id:t,originalArrivalTime:n,messageType:a}=i;t&&n&&a?M={...M,id:t,originalArrivalTime:n,editTime:new Date(Date.now()).toISOString(),messageType:a}:v.error(`can't find id, originalArrivalTime, messageType for ${e}`)}const b=A||h&&!!i.id;h&&"ConvUx"!==i.sendPipelineThreadType?(0,o.k)(e,n,S||void 0,g(M,i),D,b,A,i?.postType||void 0,v):(0,a.jC)(e,n,S??null,[M],D,!0,v)},m=e=>p(e.content,e,e.computed||{}),u=e=>g(m(e),e),g=(e,t)=>{const n=!t?.replyChainId,i=(0,d.l)(t?.subject||"",t?.postType),a=t?.replyPermission||null,o=n&&"Announcement"===t?.postType?v(t):null,{fragmentTypeName:r}=(0,s.LT)(t?.postType);return{...e,__typename:n?r:"ReplyChainMessage",id:e.id||"",isImportant:"Important"===e.importance,isPinned:!1,messageRenderType:"Standard",subject:i||"",isLastRead:!1,isTimestampDividerNeeded:!1,isCrossPost:!1,crossPostId:null,postType:t?.postType??null,attached:null,translation:null,translatedSubject:null,translatedContent:null,translationStatus:null,isOnDemandTranslation:!1,softDeleteReason:null,sourceLanguageName:null,sourceLanguageCode:null,isWrittenInPreferredLanguage:!0,languageSeenBefore:!0,announcement:o,replyPermission:a,deletionInfo:{__typename:"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},canUserReply:!0,parentsAnnouncementsStatus:null,fromUser:null,contentHash:null,isUserFollowing:null,feedbackLoopEnabled:null,sensitivity:null,poweredByAI:null,citations:null}},p=(e,{clientMessageId:t,files:n,deeplinks:i,importance:a,messageType:o,scheduledSendTime:s},{mentions:r,cards:d,onBehalfOf:c})=>({__typename:"Message",id:t||"",clientMessageId:t||"",originalArrivalTime:new Date(Date.now()).toISOString(),version:(0,l.yT)()[0].toString(),importance:a||null,content:e,contentHash:null,messageType:o||"RichText/Html",diverseEmotions:null,interopDeliveryState:null,smsDeliveryReports:null,emotionsSummary:null,emotions:null,mentions:h(r),onBehalfOf:h(c),cards:f(d),from:null,imDisplayName:null,renamedDisplayName:null,files:y(n),deeplinks:C(i),urlPreview:null,embeddedLinks:null,dlpContext:null,deleteTime:null,editTime:null,status:"Sending",diagnosticInfo:null,deletionInfo:{__typename:"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},userHasSaved:!1,callId:null,replyPermission:null,translation:null,atpSharepointData:null,isDeletedByAdmin:null,meeting:null,hardDeleteTime:null,hardDeleteReason:null,translatedSubject:null,translatedContent:null,translationStatus:null,isOnDemandTranslation:!1,sourceLanguageName:null,sourceLanguageCode:null,isWrittenInPreferredLanguage:!0,languageSeenBefore:!0,forwardedMessageContext:null,scheduledSendTime:s||null,draftId:s?t||"":null,threadTitle:null,crossPostStatus:null,crossPostFailedChannels:null,vivaTopicsAnnotations:null,repliesSummary:null,feedbackLoopEnabled:null,sensitivity:null,poweredByAI:null,citations:null,sendPipelineStatus:null,botDeliveryReport:null,botMetadata:null,streamingMetadata:null,suggestedActions:null,emailDetails:null,isPinned:null,parentMessageId:null,originalParentMessageId:null,fromUser:null,isUserFollowing:null,announcement:null,subject:null,crossPostId:null,isCrossPost:!1,postType:null,hasUserParticipated:null,blurhash:null,isSkypeMessage:!1,scheduledCallStatus:null,linkedMeetingMessage:null,isLastScheduledMeetingStartedMessage:null,sharedFromReplyChainId:null,sharedFromMessageId:null,sharedToMessageId:null}),h=e=>(0,i.map)(e,(({itemId:e,...t})=>({__typename:"Mention",id:e,itemId:e,...t}))),f=e=>(0,i.map)(e,(e=>({__typename:"Card",appIcon:e.appIcon||null,appId:e.appId,appName:e.appName||null,cardClientId:e.cardClientId,content:e.content,contentType:e.contentType,locale:e.locale||null,name:null,userSpecificContent:null,sourceType:e.sourceType||"NonLinkUnfurling"}))),y=e=>(0,i.map)(e,(({chicletBreadcrumbs:e,title:t,type:n,objectUrl:i,...a})=>({__typename:"File",id:a.id,itemId:a.itemId||null,chicletBreadcrumbs:e?{__typename:"ChicletBreadcrumbs",sourceChannelName:e.sourceChannelName||null,sourceTeamName:e.sourceTeamName||null}:null,baseUrl:null,objectUrl:i??"",shareId:null,shareUrl:null,type:n||null,title:t||null,previewUrl:null,previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1,serviceName:null,providerDataV2:null,state:null}))),C=e=>(0,i.map)(e,(({...e})=>({__typename:"DeepLink",id:e.id,channelId:null,title:null,siteUrl:null,objectUrl:null,serverRelativeUrl:null,state:null}))),v=e=>{const{cardContent:t}=(0,d.Mm)(e?.computed?.cards||[]);return{__typename:"Announcement",title:e?.title||"",colorTheme:t?.colorTheme||null,originalImageUrl:t?.imageData?.origImage?.src||null,croppedImageUrl:t?.imageData?.croppedImage?.src||null,croppedImageHeight:t?.imageData?.croppedImage?.imageHeight||null,croppedImageWidth:t?.imageData?.croppedImage?.imageWidth||null,croppedImageAltText:t?.imageData?.croppedImage?.imageAltText||null,isTeamsIllustration:null}}},659726:(e,t,n)=>{n.d(t,{r:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query DataResolversBrowserChatChannelIdQuery($conversationId:ID!) {channelByID(conversationId:$conversationId) {id,channelType,parentTeamId,memberRole,channelResourceTenantId,owningTeam {id,smtpAddress,teamSiteInformation {groupId,sharepointSiteUrl},membershipSummary {memberCount}},sharepointSiteUrl}}");return delete this.definitions,this.definitions=e.definitions}}},885622:(e,t,n)=>{n.d(t,{oD:()=>A,$L:()=>N});var i=n(480354),a=n(726723),o=n(403097),s=n(712839),r=n(347590),d=n(806658),l=n(84646),c=n(645095),m=n(800079),u=n(276952),g=n(390889),p=n(220192),h=n(851490),f=n(67309),y=n(706397);const C={kind:"Document",get definitions(){const e=(0,f.G)("query DataResolversBrowserChatAppDefinitionsQuery($scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinitions(scope:$scope,conversationId:$conversationId,options:$options) {...appDefinition}}");return delete this.definitions,this.definitions=[...e.definitions,...y.h.definitions]}};var v=n(659726),I=n(570947);const D={kind:"Document",get definitions(){const e=(0,f.G)("query DataResolversBrowserChatInstalledAppsV2Query($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsV2(installedContext:$installedContext,options:$options) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...I.B.definitions]}},T={kind:"Document",get definitions(){const e=(0,f.G)("query DataResolversBrowserChatOptionalTelemetryQuery {optionalTelemetry @client {fluidCorrelationId,fluidDataLossOccurred,fluidDataLossPrevented,hasLoopComponentAndContent,embedLoopLinks}}");return delete this.definitions,this.definitions=e.definitions}},M=e=>{switch(e){case"Standard":return"NORMAL";case"Important":return"HIGH";case"Urgent":return"URGENT"}return null},S=e=>{const t=e.computed?.cards;if(!t)return!1;return!!(0,i.find)(t,(e=>"application/vnd.microsoft.card.fluid"===e.contentType||"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType))},A=e=>{if(e)return e.startsWith("19:meeting")?a.bF.Meeting:e.includes("@unq.gbl.spaces")?a.bF.OneOnOneChat:e.includes("@thread.v2")?a.bF.GroupChat:e.includes("@thread.skype")||e.includes("@thread.tacv2")?a.bF.Channel:e.includes("48:notes")?a.bF.StreamOfNotes:void 0},b=(e,t)=>{const n=e.computed?.cards;return!!n&&n.some((e=>e.appName===t))},w=(e,t,n)=>{const i=[],a=e.computed?.cards;a&&a.forEach((e=>{i.push(e.appId)}));const o=e.computed?.mentions;return o&&o.forEach((e=>{"bot"===e.mentionType&&(0,d.MX)(e.userId,t)&&i.push(e.userId.substring(l.gN.BotPrefix.length))})),n.id&&i.push(n.id),i.length>0?i.join(","):""},P=e=>{const t=new RegExp(p.A.reply,"g");return(e.match(t)||[]).length},E=e=>e?e.replace(/(<([^>]+)>)/gi,""):"",R=(e,t)=>{const n={};if(e&&t?.isOneOnOne&&t?.hasFederatedUser){const e=m.af.getTflExtendedDirectoryMembership(t?.extendedDirectoryRedemptionRequired);e&&(n["DataBag.TFLUserInED"]=!0,n["DataBag.TFLUserEDState"]=e)}return n},F=(e,t,n)=>{if(t)return n?"replyConversation":"newConversation";const i="Update"===e;return n?i?"editThreadedChat":"replyThreadedChat":i?"chatEdit":"newP2PMessage"},B=e=>({"Messaging.additionalContentPresent":E(e.content).length>0,"Messaging.additionalContentLength":E(e.content).length,"Messaging.forwardCardContainsLoop":e.forwardMessageCardContents?.hasLoopComponent??void 0,"Messaging.forwardCardContainsAppCard":e.forwardMessageCardContents?.hasAppCard??void 0,"Messaging.sourceType":A(e.forwardMessageOriginalConvId)}),N=(e,t,n,i,{loggerFactory:a,userBiService:o,cache:s,coreSettings:r},d,l,c,m,u,g,p,h,f,y)=>{const C=a.newLogger("sendMessageTelemetry","data-resolvers-browser-chat");o?($(e,t,n,i,o,C,d,l,c,m,u,g,s,p,h,f,y,r),u&&!u.lastMessage&&O(u,o,C)):C.warn("userBiService is null")},U=(e,t)=>{if(e)return t?o.np.DrillDown:o.np.TopLevel},k=e=>e?.guardianChatInfo?o.Kt.GuardianChat:null,L=e=>e?.awarenessLiveState?"sync":"async",x=(e,t,n)=>{if(!e||e.chatSubType===c.vW.Channel||e.isChannel)return t?n?a.bF.Communities:a.bF.Channel:void 0;const i=e.memberIds?.map((e=>e))??[],o=(0,d.wD)(e.id,e.isFederated,e.isOneOnOne,e.hasFederatedUser,i);return(0,r.Dc)(e.id,e.chatType,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,o,e.isFederated)},O=(e,t,n)=>{const i=x(e,void 0);t.recordPanelAction({actionGesture:a.Od.click,actionOutcome:a.nd.select,actionScenario:a.vB.createNewChat,actionScenarioType:a.DB.chatCreation,moduleName:a.Sn.createNewChatButton,moduleType:a.nR.button,panelRegion:a.rP.main,panelType:a.HP.Chat,threadMembers:e?.memberIds?.length,threadType:i,dataBag:{id:"",data:{"DataBag.isNewChat":!0},dispose:()=>{}}},n)},$=(e,t,n,r,c,m,f,y,I,T,N,O,$,q,j,z,V,Q)=>{const Y=f&&z===e,K=I?A(e):x(N,q,Y);let Z={};const X=((e,t)=>t===a.bF.Channel?s.bY.team:e?.isOneOnOne?s.bY.personal:e?.isMeeting?s.bY.meeting:e?.isOneOnOneBotChat||e?.isOneOnOne?s.bY.general:s.bY.group)(N,K);K===a.bF.Botchat&&(Z=((e,t,n)=>{const i=e?.memberIds?.find(d.Iz);if(i){const e=i.substring(l.gN.BotPrefix.length);try{const i=t.readQuery({query:C,variables:{options:{botId:e}}}),a=i?.appDefinitions?null:t.readQuery({query:D,variables:{installedContext:{scope:"Personal"}}});if(i?.appDefinitions||a){const t=i?.appDefinitions?i.appDefinitions:a?.installedAppsV2?.filter((t=>t?.definition?.bots?.[0]?.id===e));if(t&&t.length>0)return{id:t[0]?.id,capabilityId:e,scenarioCapability:s.n3.bots,scope:n}}}catch(e){}}return{}})(N,$,X));let J={};K!==a.bF.Channel&&K!==a.bF.Communities||(J=((e,t,n,i)=>{let a;try{a=e.readQuery({query:v.r,variables:{conversationId:t}})}catch(e){i.error(`Failed to retrieve Team.Id and Team.OfficeGroupId from cache. Thread.Id: ${t}. Thread.Type: ${n}.`)}return{channelType:a?.channelByID.channelType,teamId:a?.channelByID?.owningTeam?.id,officeGroupId:a?.channelByID?.owningTeam?.teamSiteInformation?.groupId,memberCount:a?.channelByID?.owningTeam?.membershipSummary?.memberCount,channelResourceTeamId:a?.channelByID.parentTeamId??"",memberRole:a?.channelByID.memberRole,channelResourceTenantId:a?.channelByID.channelResourceTenantId}})($,e,K,m));const ee=((e,t,n,a,s,r,c,m,g,f,y,C,v)=>{return{"DataBag.messagelength":E(e.content).length,"DataBag.size":e.content.length,"DataBag.importantflag":M(e.importance),"DataBag.messageType":F(t,m,g),"DataBag.postType":"Announcement"===e.postType?"announcement":"normal","DataBag.richText":(D=e.messageType,"RichText/Html"===D),"DataBag.fluidCard":S(e),"DataBag.appId":w(e,y,C),"DataBag.sfbInteropMessage":"SfBInteropChat"===r?.chatType,"DataBag.mricollection":r?.memberIds?.map((e=>(0,d.Mq)(e)))?.join(" ")||"","DataBag.rostersize":r?.memberIds?.length||0,"DataBag.attachments":e.files?.length||0,"DataBag.attachmentIds":e.files?.map((e=>e.id))?.join(" ")||"","DataBag.fileTypeList":e.files?.map((e=>e.type))?.filter((e=>!(0,i.isNil)(e)))||[],"DataBag.suggestedFile":e.files?.some((e=>"smartReply"===e.context)),"DataBag.leftRailDirective":m?"channel-list":"chat-list","Messaging.messageChannelType":f.channelType??null,"DataBag.messageID":e.id!==e.clientMessageId?e.id:void 0,"DataBag.replyChainId":g,"DataBag.channelView":v??U(!!r?.isConversationalUXEnabled,!!g),"DataBag.isNewChat":!!c,"DataBag.newChatIntentId":c,"DataBag.tflOffNetworkEmailCount":r?.memberIds?r.memberIds.filter((e=>e.startsWith(l.Cl))).length:0,"DataBag.tflOffNetworkOneWayPhoneCount":r?.memberIds?r.memberIds.filter((e=>e.startsWith(l.I8))).length:0,"DataBag.tflSMSMembersCount":r?.memberIds?r.memberIds.filter(d.vd).length:0,"DataBag.offNetworkContactsSelected":r?.memberIds?r.memberIds.filter(d.mD).length:0,"DataBag.hasAADFederatedMembers":r?.hasFederatedUser||!1,"DataBag.hasMSAFederatedMembers":r?.hasTflConsumerUser||!1,"DataBag.quotedReplyCount":P(e.content),"DataBag.chatType":k(r),"DataBag.GIF":(0,h.x)(e.content,p.A.giphy),"DataBag.Sticker":(0,h.x)(e.content,p.A.sticker),"DataBag.customEmoji":(0,h.x)(e.content,p.A.customEmoji),"DataBag.emoji":(0,h.x)(e.content,p.A.emoji),"Designer.containsImageFromDesigner":b(e,u.M_)||(I=e.content,I.split(" ").filter((e=>e===`type="${u.Zj}"`)).length>0),"DataBag.composeVersion":a?"Simplified":"Classic",...R(n,r),"DataBag.lifeCycleFlavor":L(r),"DataBag.wasEdited":"Update"===t,"Messaging.isEnterpriseCrossCloudChat":(0,d.si)(r?.id),"Messaging.timeSinceDraftCreation":e.draftCreationTime?Date.now()-Number(e.draftCreationTime):void 0,"TeamsAndChannels.channelType":"Standard"===f.channelType?o.Cu.Regular:f.channelType,"TeamsAndChannels.channelResourceTeamId":f.channelResourceTeamId,"TeamsAndChannels.channelRole":f.memberRole,"TeamsAndChannels.channelResourceTenantId":f.channelResourceTenantId??"",...s?B(e):{}};var I,D})(t,n,f,y,I,N,O,q,j,J,Q,Z,r["DataBag.channelView"]);c.recordPanelAction({actionGesture:a.Od.click,actionOutcome:a.nd.submit,actionOutcomeNew:a.nd.submit,actionScenario:a.vB.composeSendMessage,...G(q),...W(q,V,T),...H(I),appId:ee["DataBag.appId"]||"",appScope:X.toString(),appScenarioCapability:void 0!==ee["DataBag.appId"]?s.n3.messaging.toString():"",moduleType:a.nR.sendMessageButton,moduleTypeNew:a.nR.sendMessageButton,officeGroupId:null!=J?.officeGroupId?J?.officeGroupId:void 0,threadId:e,childThreadId:N?.isConversationalUXEnabled?j??void 0:void 0,teamId:z??J?.teamId,threadMembers:J?.memberCount??N?.memberIds?.length,threadType:K,threadModality:ee["Thread.chatModality"]??(0,g.j)(N?.isConversationalUXEnabled,q),actionSubworkload:a.i7.composeMsg,tabId:"",tabType:"conversations",tabIdNew:"",tabTypeNew:"conversations",tabOrdinal:1,dataBag:{id:"",data:{...r,...ee,..._($,t,V,j)},dispose:()=>{}},extensibilityData:Z},m)};function H(e){return e?{actionScenarioType:a.DB.forwardMessage,moduleName:a.Sn.forwardButton,moduleNameNew:a.Sn.forwardButton,panelUri:"app.conversation"}:{actionScenarioType:a.DB.composeMsg,moduleName:a.Sn.sendButton,moduleNameNew:a.Sn.sendButton}}function _(e,t,n,i){const a={};let o=null;try{o=e.readQuery({query:T})}catch{}const s=o?.optionalTelemetry;return null!=s?.fluidDataLossOccurred&&(a["DataBag.fluidDataLossOccurred"]=o?.optionalTelemetry?.fluidDataLossOccurred),null!=s?.fluidDataLossPrevented&&(a["DataBag.fluidDataLossPrevented"]=o?.optionalTelemetry?.fluidDataLossPrevented),null!=s?.fluidCorrelationId&&(a["Messaging.fluidCorrelationId"]=o?.optionalTelemetry?.fluidCorrelationId),null!=s?.embedLoopLinks&&(a["Messaging.embedLoopLinks"]=o?.optionalTelemetry?.embedLoopLinks),null!=s?.hasLoopComponentAndContent&&(a["Messaging.hasLoopComponentAndContent"]=o?.optionalTelemetry?.hasLoopComponentAndContent),n&&(a["DiscoverSurface.requestId"]=n,a["DataBag.messageID"]=i),"Announcement"===t.postType&&(a["Channels.containsImageBanner"]=b(t,u.RG)),a}function G(e){return e?{appName:"channel",actionWorkload:a.E0.channelContent}:{appName:"chat",actionWorkload:a.E0.chatContent}}function W(e,t,n){let i=a.HP.Chat,o=a.rP.main;return e&&(i=t?a.HP.discoverSurface:a.HP.Channel),n&&(i=a.HP.CommentStreamChat,o=a.rP.right),{panelType:i,panelTypeNew:i,panelRegion:o,panelRegionNew:o}}},301587:(e,t,n)=>{n.d(t,{_:()=>i,L:()=>a});const i=3,a=3},435431:(e,t,n)=>{var i;n.d(t,{V5:()=>i,f7:()=>a,f5:()=>o,ni:()=>s,ui:()=>r}),function(e){e.SpeedDial="SpeedDial",e.CallHistory="CallHistory",e.PeopleApp="PeopleApp",e.LivePersonaCard="LivePersonaCard"}(i||(i={}));const a={addContact:"addContact",contactExist:"contactExist"},o={addContact:(e,t)=>({originator:e,type:a.addContact,data:()=>t}),contactExist:(e,t)=>({originator:e,type:a.contactExist,data:()=>t})},s=e=>d(e)&&e.type===a.addContact,r=e=>d(e)&&e.type===a.contactExist,d=e=>i.SpeedDial===e.originator||i.CallHistory===e.originator||i.PeopleApp===e.originator||i.LivePersonaCard===e.originator},462973:(e,t,n)=>{n.d(t,{Nv:()=>i,_D:()=>a,WV:()=>o,A8:()=>s,mq:()=>r});const i="CallHistory",a={viewCallHistoryDetails:"viewCallHistoryDetails",showCopilotSummary:"showCopilotSummary"},o={showCallLogSummary:e=>({originator:i,type:a.viewCallHistoryDetails,data:e}),showCopilotSummary:e=>({originator:i,type:a.showCopilotSummary,data:e})},s=e=>i===e.originator&&a.viewCallHistoryDetails===e.type,r=e=>i===e.originator&&a.showCopilotSummary===e.type},936873:(e,t,n)=>{n.d(t,{V5:()=>i,SV:()=>s,XD:()=>r,j:()=>d,Iu:()=>l,dz:()=>m,zj:()=>u,Ob:()=>g,Hu:()=>p});var i,a=n(516838),o=n(454897);!function(e){e.SpeedDial="SpeedDial",e.CallHistory="CallHistory",e.Header="Header"}(i||(i={}));const s={setSpeedDialSystemTag:(e,t)=>({originator:e,type:"setSpeedDialSystemTag",data:()=>t}),speedDialContactAlreadyExist:(e,t)=>({originator:e,type:"speedDialContactAlreadyExist",data:()=>t}),deleteContact:(e,t)=>({originator:e,type:"deleteContact",data:()=>t}),viewSpeedDial:e=>({originator:i.SpeedDial,type:"viewSpeedDial",data:()=>e}),toggleStartRail:(e={showOption:"toggle"})=>({originator:i.Header,type:"toggleStartRail",data:()=>e}),toggleEndRail:e=>({originator:i.Header,type:"toggleEndRail",data:()=>e})},r=e=>c(e)&&"setSpeedDialSystemTag"===e.type,d=e=>c(e)&&"speedDialContactAlreadyExist"===e.type,l=e=>c(e)&&"deleteContact"===e.type,c=e=>i.SpeedDial===e.originator||i.CallHistory===e.originator,m=e=>i.SpeedDial===e.originator&&"viewSpeedDial"===e.type,u=e=>i.Header===e.originator&&"toggleStartRail"===e.type,g=e=>i.Header===e.originator&&"toggleEndRail"===e.type,p=e=>e.originator===o.Nv&&e.type===o.mu.showBanner&&(0,a.FB)(e.data?.())},551561:(e,t,n)=>{n.d(t,{mu:()=>a,AZ:()=>o});const i="Chats",a={toggleInfoPane:"toggleInfoPane",openChatInEndSlot:"openChatInEndSlot",switchToChannel:"switchToChannel",openToggleGroupCopilotSkillsDialog:"openToggleGroupCopilotSkillsDialog",openBilateralChatDialog:"openBilateralChatDialog",openTFLCopilotControlDisableDialog:"openTFLCopilotControlDisableDialog"},o={toggleInfoPane:e=>({originator:i,type:a.toggleInfoPane,data:e}),openChatInEndSlot:e=>({originator:i,type:a.openChatInEndSlot,data:e}),switchToChannel:e=>({data:e,originator:i,type:a.switchToChannel}),openToggleGroupCopilotSkillsDialog:e=>({originator:i,type:a.openToggleGroupCopilotSkillsDialog,data:e}),openBilateralChatDialog:e=>({originator:i,type:a.openBilateralChatDialog,data:e}),openTFLCopilotControlDisableDialog:e=>({originator:i,type:a.openTFLCopilotControlDisableDialog,data:e})};var s;!function(e){e.None="None",e.Files="Files",e.Links="Links",e.Location="Location",e.People="People",e.PinnedMessages="PinnedMessages",e.Photos="Photos",e.Pinned="Pinned",e.Search="Search",e.Tasks="Tasks",e.TimeZone="TimeZone",e.Highlights="Highlights"}(s||(s={}))},406679:(e,t,n)=>{n.d(t,{Nv:()=>i,mu:()=>a,AZ:()=>o});const i="Layout",a={displayTitleBar:"displayTitleBar",toggleAppBar:"toggleAppBar",closeMonitor:"closeMonitor",collapseHeader:"collapseHeader",completeAppPhaseReached:"completeAppPhaseReached",criticalAppPhaseReached:"criticalAppPhaseReached",expandHeader:"expandHeader",expandTab:"expandTab",goBack:"goBack",hideHeader:"hideHeader",hideMonitor:"hideMonitor",sendImmersiveWindowEvent:"sendImmersiveWindowEvent",maximizeTab:"maximizeTab",postCriticalAppPhaseReached:"postCriticalAppPhaseReached",reset:"reset",resetLayoutOverrides:"resetLayoutOverrides",resizeSlot:"resizeSlot",showMonitor:"showMonitor",unhideHeader:"unhideHeader",unhideMonitor:"unhideMonitor",updateAmsV2Domain:"updateAmsV2Domain",updateBaseImageUrl:"updateBaseImageUrl",updateDialogState:"updateDialogState",updateIsImageAuthCookieValid:"updateIsImageAuthCookieValid",updateMeControlAvatarSrc:"updateMeControlAvatarSrc",closeEndSlot:"closeEndSlot"},o={collapseHeader:()=>({originator:i,type:a.collapseHeader}),completeAppPhaseReached:()=>({originator:i,type:a.completeAppPhaseReached}),criticalAppPhaseReached:()=>({originator:i,type:a.criticalAppPhaseReached}),expandHeader:e=>({originator:i,type:a.expandHeader,data:e}),expandTab:e=>({originator:i,type:a.expandTab,data:e}),maximizeTab:()=>({originator:i,type:a.maximizeTab}),postCriticalAppPhaseReached:()=>({originator:i,type:a.postCriticalAppPhaseReached}),resetLayoutOverrides:()=>({originator:i,type:a.resetLayoutOverrides}),resizeSlot:e=>({originator:i,type:a.resizeSlot,data:e}),updateAmsV2Domain:e=>({data:e,originator:i,type:a.updateAmsV2Domain}),updateMeControlAvatarSrc:e=>({data:e,originator:i,type:a.updateMeControlAvatarSrc}),updateBaseImageUrl:e=>({data:e,originator:i,type:a.updateBaseImageUrl}),updateIsImageAuthCookieValid:e=>({data:e,originator:i,type:a.updateIsImageAuthCookieValid}),closeMonitor:()=>({originator:i,type:a.closeMonitor}),hideMonitor:()=>({originator:i,type:a.hideMonitor}),showMonitor:e=>({originator:i,type:a.showMonitor,data:()=>({...e})}),updateDialogState:e=>({originator:i,type:a.updateDialogState,data:e}),unhideMonitor:()=>({originator:i,type:a.unhideMonitor}),toggleAppBar:()=>({originator:i,type:a.toggleAppBar}),displayTitleBar:e=>({data:e,originator:i,type:a.displayTitleBar}),goBack:()=>({originator:i,type:a.goBack}),hideHeader:()=>({originator:i,type:a.hideHeader}),unhideHeader:()=>({originator:i,type:a.unhideHeader}),closeEndSlot:()=>({originator:i,type:a.closeEndSlot}),sendImmersiveWindowEvent:e=>({data:e,originator:i,type:a.sendImmersiveWindowEvent})}},865561:(e,t,n)=>{n.d(t,{z6:()=>a,AZ:()=>o});const i="Platform",a={launchDefaultPersonalApp:"launchDefaultPersonalApp",openDeeplinkStageConsentDialog:"openDeeplinkStageConsentDialog",openPresentAppNowConfirmationDialog:"openPresentAppNowConfirmationDialog",launchAppDetails:"launchAppDetails",launchAppUninstall:"launchAppUninstall",launchAppError:"launchAppError",launchManifestParsingErrorDialog:"launchManifestParsingErrorDialog",toggleConversationPane:"toggleConversationPane"},o={launchAppDetails:e=>({data:e,originator:i,type:a.launchAppDetails}),launchAppUninstall:e=>({data:e,originator:i,type:a.launchAppUninstall}),launchDefaultPersonalApp:()=>({originator:i,type:a.launchDefaultPersonalApp}),openDeeplinkStageConsentDialog:e=>({data:e,originator:i,type:a.openDeeplinkStageConsentDialog}),openPresentAppNowConfirmationDialog:e=>({data:e,originator:i,type:a.openPresentAppNowConfirmationDialog}),launchAppError:e=>({data:e,originator:i,type:a.launchAppError}),launchManifestParsingErrorDialog:e=>({data:e,originator:i,type:a.launchManifestParsingErrorDialog}),toggleConversationPane:e=>({data:e,originator:i,type:a.toggleConversationPane})}},454897:(e,t,n)=>{n.d(t,{Nv:()=>i,mu:()=>a,AZ:()=>o});const i="InAppNotifications",a={showToast:"showToast",showBanner:"showBanner",removeToast:"removeToast",removeBanner:"removeBanner",emptyBannerQueue:"emptyBannerQueue"},o={showToast:e=>({data:e,originator:i,type:a.showToast}),showBanner:e=>({data:e,originator:i,type:a.showBanner}),removeToast:e=>({data:e,originator:i,type:a.removeToast}),removeBanner:e=>({data:e,originator:i,type:a.removeBanner}),emptyBannerQueue:()=>({originator:i,type:a.emptyBannerQueue})}},952375:(e,t,n)=>{n.d(t,{H4:()=>i,r_:()=>a,LZ:()=>o,x9:()=>s,$z:()=>r,X6:()=>d,dG:()=>l,Vt:()=>c});const i="grid",a="single",o="data-file-size",s="data-cache-key",r="data-orig-src",d="data-prev-blob",l="data-edit-mode",c="data-loading-state"},470646:(e,t,n)=>{var i;n.d(t,{n:()=>i}),function(e){e.SUCCESS="success",e.FAILED="failed",e.LOADING="loading",e.INITIALISING="initialising"}(i||(i={}))},231684:(e,t,n)=>{n.d(t,{yN:()=>a,xW:()=>s,yB:()=>r});var i=n(359676);const a=e=>!!e&&(e.endsWith(i.p2.mobile)||e.endsWith(i.p2.desktop)),o=(e,t)=>{try{const n=new URL(e);return"media.tenor.com"===n.hostname.toLowerCase()&&t.some((e=>n.pathname.endsWith(e)))}catch(e){return!1}},s=e=>o(e,[".gif"]),r=e=>o(e,[".gif",".png"])},692184:(e,t,n)=>{var i;n.d(t,{b:()=>i}),function(e){e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.Fluid="application/vnd.microsoft.card.fluid",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard",e.VideoMessage="application/vnd.microsoft.card.videoMessage"}(i||(i={}))},858554:(e,t,n)=>{n.d(t,{t:()=>m});var i=n(971510),a=n(754255),o=n(600824),s=n(795761),r=n(220192),d=n(102029),l=n(503210),c=n(729555);let m=class{transform(e,t){const n=t.superSizeEmoticons&&!t.disableBigEmoticons?"large":"small",i=(0,s.uj)(n),o=t=>d.L.DomUtils.getAttributeValue(e,t)||"",m=e.children?.[0],u=o("itemscope")===c.Fp||m&&d.L.DomUtils.getAttributeValue(m,"itemscope")===c.Fp,g=o("itemid"),p=u?"🪪":o("alt")||o("itemscope");t.telemetryDatabag&&(t.telemetryDatabag["DataBag.emojiList"]=[...t.telemetryDatabag["DataBag.emojiList"]||[],"TeamsEmojiId"]);const h=t.isLiteEmoticon?{"data-em":g}:{contenteditable:"false",title:o("title"),type:`(${g})`,class:`animated-emoticon-${i}-${g}`,itemscope:u?c.Fp:""},f=(0,l.VZ)("span",h);if(t.isLiteEmoticon){const e=(0,l.GZ)(p);d.L.DomUtils.appendChild(f,e)}else{const e={itemscope:"",itemtype:r.A.emoji,itemid:g,src:u?(0,c.El)(t.themeType):(0,s.ym)(g,n,t.coreSettings.get(a.w.Messaging),!1),title:o("title"),alt:p,style:`width:${i}px;height:${i}px;`},m=(0,l.VZ)("img",e);d.L.DomUtils.appendChild(f,m)}return f}};m=(0,i.__decorate)([(0,o.dL)({name:"EmoticonSerializer",filter:{itemtype:r.A.emoji}})],m)},729555:(e,t,n)=>{n.d(t,{Fp:()=>a,en:()=>o,PJ:()=>l,El:()=>c,CH:()=>m});var i=n(794171);const a="Share_Contact_Card",o=`<readonly contenteditable="false" title="ID card" itemid="idcard" itemtype="http://schema.skype.com/Emoji" itemscope=${a} aria-label="ID card"><img data-itemProps=${a} src="https://staticsint.teams.cdn.office.net/evergreen-assets/personal-expressions/v2/assets/emoticons/idcard/default/50_f.png?v=v5&itemscope=share_contact_card" alt="ID card" draggable="false" width="20px" height="20px" style="margin:0px 1px;overflow:hidden;"></readonly>`,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABNdJREFUeF7tml1sFFUUx/9ndmnwkxiCgaDGiomfGA3xAY1KgBhFd25n7JbEhER9MzE8ocSg4ieKBuNHYvTFNx9ku7N7Z7QmRCUaX/yI9KGIRqLYNAYIEKVokN2dYwa7Zbed7cxO72w77szj7jnn/s/vnnvnfgyhyx/q8vyRAkgroMsJpEOgywsgnQTTIZAOgS4nkA6BmQognx9a8k+ttoWYV4FwM4DFCSmY4wDvY2jfcgWvO07uWCvdLSugz7Q3MfhtgBYlJOlWMk+4jEecki79DHwBCMPeDMKbCU+8ST4R+stFvTg1p2kAcnm7V6vhZwCZ/xMAAKfcCvVOHQ7TAOim8w6BH21I/jCYtlay2p6hwn2HkwBlQ/7jpQuq7t0g3glgaV0zgZ8pW+KFxhymARCmPQrg8kknwsZyUd+dhMSnaux7wB5gxocNv38nLf3WIAA1AFrdqCdz+qJCYeBUEgEYhrXYpey5NwDjpCzpTZO6XwVwY7LS0hO9VhCmPWM+ygDcn3eWZ6rudhCtBbACwCjA33AVj9m2ODJXFdQRALop7yRQGcAlPokeJ7e2vlw2hucCQuwA8vndF56pLTwUsEo8xFW+ybbFeKchxA5AN50dBH4yRGI7pKVvC2Gn1CR2AMKQX4LojkDVjM9kSV8fZCdMpx/ML4JwTZBt0/+Mn0D0lLRyg42/xw/AtMcALA8Wy2PSEpPri1b2wrQPALg2OJ6vxX5p6Td2GsBXAG4PFBy2Agx7PwjXB8bzM2D8IEv6DR0FEHoOYLwiS3rgXHF2CIBfBnB1WxDmagiseWjvwkV/jg8HjNljlUxm5VzsJWKfA7xeMs3ishqygwDd5tNrozXA+MjSv2+rRxUZdwRAXaswnQcZvFYDehk8RqB9ZUt/Q1EukcJ0FEAkhTE7pQDi2AwZhnUpa9l1LtMKDW42TCcyk8sa/4IKPrdt8XsYHxU2yiugr99Zxy5/OhtxDBa2JezZxAjrqxyAMOy9IKwJK8DXjnhYFsUts4oR0lk9AFP+oeKovNVBy7zfCwjT/hvAeSE7oKVZT+Z0tlAY8I7fmh4x35fCwrRHADSttyPA+E1a+pV+frMCAIxIS18Z614g9Np/JirE78qiaDx6n7SOvBcADgC0TVq5UqwAvFdgjbIjBCyJ0PNnXVyi65xi7seo/u34KZ8EvcYnzgC/aEfIpC3za7IknojkG8EpFgCeDsNwVrvEuwCsDquLwM+VLfFsWHsVdrEBqIszDPsul3AvEV3FzL0TR+Le6vAgEX51mQ5q4JFahYqOk/PeIB19YgfQ0WwiNBYFgHcNdkG9rUoms2wuDjIi5DrN5b9zigWN+45xaekXNxr63Qw1vecJvLVsiVdVCOp0jD5TPs2g5yfb9VmC+12P7yRw8yzNeElD9a1SyTza6SSitGeaQ5fVuLIZRI83+TO2y5J+Dggw/UPJibLxbnp6ojQ+j33+6sn0XFEo3HNixiHg/SkM52EQvz+Pk2lXGhMhH+oTmXpkYTobAfc9FTu/dtUqtj9KGm0qD+b2+MWd8e7fW/a6yGwholUMePt3v9tfxXqVhDsC8DCYvj5zfnbXJx9sONkqaqI/flCBKgWggmKSY6QVkOTeU6E9rQAVFJMcI62AJPeeCu1pBaigmOQYXV8B/wITMWBflDVLfAAAAABJRU5ErkJggg==",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABM1JREFUeF7tmltoHGUUx/9ns0nUVotkZ5O2KsYKXiuK+FDFC20RfBKhWhD6oG+CFMWZTWdT7Xjb2e638VYQffFd2+LlsXhB8aUqNg+pVQw2hqDpTFIkbaRJNnNkNAmz2dnd2cnMJGNmHnfPOd///L7zXWcI6/yhdZ4/EgBJBaxzAskQWOcFkEyCyRBIhsA6J5AMgUYFoKp/ShWkZQB3A3wnQF3xKBieBOgUE3/PM5U3Bga2TNTTXbcCcurEPgYfAbApHknXVXmeLXq6fDjzqZuFKwBZNfYT6O2YJ14tn609oth9fHlONQDkg+O9NN/2K4C2/xMABi7y7Fzv8uFQA0BRzXcBPONIfhxEfZizTgiRHY8DFEUxetCeehjMhwH0LGpmxkvlovSqMwc3AKMArl1yIt5bLmQ/ikPiyzXKeeMJYvrQ8fsPQpfuaQZgHkBq0WhDJ1+padmLcQSgqlNdFcw4V4ApoUtVk7pbBbAzWaFLsd4rKKrZMJ/AADzfP7G13eJDDOwEsA3AKIO+66D5ZwuF7nOrVUGRAHihz3gglaJPAFxdmyhPgrBbFLKDqwEhdACaZmycnsFI410ij9A83VEqSReihhA6ADlvFIhJbZ4YFYSe6W9uF6xF6AAU1fwGwP0eZH8hdGl3M7ucauxhptdAuKmZbdX/jF+I+GBJzx5z/h4FgDEAWz2IHRO6tLS/qGevqOYZADd7iOdmclro0u1RA/gWwH0eBHuqAEU1TwO41UM8N5OfhC7dFikA73MAF4WebTpX2EPAAukE3NgShNUaApp29rLpSxsHG45ZwgTmePtqnCVCnwPsXnoub25OW3SMiO916bVREB4TBenHlno0IONIACxqlfPmkynGTgZ6wTzGRKfKuvRWQLn4ChMpAF8KQ3ZKAIRxGJLl8Syl23aBeBsRpb10IjMsJvotVeEvSyXpDy8+QdgEXgG5/MQuZv58JeIIeLSkS5+tJIZX38ABKKr5FYCHvAqoYzcodOmuFcbw5B4GgL+CuCqvd9Gy5s8Cimr+DeByT/gbGI0MZ9JHj5J9/Vb1rPmtsKKaQwCq9ts+YPwudOl6N7+VAeAhoWe3h3oW8L73b4CF8J4oSM6r9yVj32cBwhm2qL9czHwcLgB7CWxvs6tA8tHz/7pYoFsG9MzPfv1b8Qt8ErQbX7gD/LoVIYu2zBDlopTz4+vHJxQAthBZndxBmB8AaIdXYUR4uVSQNK/2QdiFBmBRnKKaDzLzI5RK3QDm3oUr8TQBwxb4LIGGCTR0RefscU3bYq8gkT6hA4g0Gx+N+QFgvwbbsNRWhTevxkWGj1xrXOx7inaG89xxQejSVU5DtzdDy9Z56hN6phSEoKhjyAfMF4nwiqPdmi24GwD7lXLVLE1Er1uzlXfK5R4j6iT8tJfLTV5jpaz9RFCW+R8SuuQEUvuh5ELZjADo8NP4GvaZrnR2XPemtul8wyHw3xJnPEWgD9ZwMi1JYwYTrMc9fSKztLwdMPaC6P0gTn4tqQ3e2ABb+0Sx+4Rb6Ibv/u2bH6TbZCL7MznY53eXt7/BKw4g4jkGDxLo5KXO1MARrWuqXsxYf/wQAKjka/GkAoIoozjHSCogzr0XhPakAoKgGOcYSQXEufeC0J5UQBAU4xzjH4bEWF/lx1UBAAAAAElFTkSuQmCC",d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA/pJREFUeF7tml2IVVUUx3//HCSxFBElqaTRwI8yDPEhoxKToCcJxgaCedC3IHoyRdSmD53KKLQg7MX3wsHscdBE8UWLxgfHDxS1GEKjQmaqt1yyL3fk3Dvn3rvvufuce0/37JdzOGettdf677X2XmvvLbq8qcvtpwCg8IAuR6AIgS53gGISLEKgCIEuR6AIgXoOYMYCYBuwBlgNzM+Jw/wJjAI/Ap9L/FFL75oeYMYA8CUwNydG11LzL2CrxLE4glgAzHgbOJhzw6vV75MYrv44DQAzeoGrwIz/GQB/A73V4RAHwFfAmxHjbwE7gBEJ997xzYxHgFeAT6D0PtXelfgwakAcAL8Cj0eI+iW+7XirYxQ043Xgm8ivnyTWNgLgP+CBCNHDEs59ctfMSqtWdAWYkCon9TgPsAqElO96wYy69gQDwIxHgUFgA7AUcKF0DnhL4na73CcTAMx4EfgOmBdjqEtKNkqcbwcIqQNgxkPAzQZZovv/jMRk1iBkAcAQsNPDsCGJXR50QUmyAOA08IKH1ickNjaiM6MP2Assa0Rb9f8KsFviSPR7FgCMQ2kCbNTGpYr8IpbejEvA8kbCavwfk3g6awDOAM97KOzrAWPASg95cSQXJZ7KGgDfOeBjqfFcUQ6Bj4AnmwShbSHwIJSWuHox67KxVe2oJVKfA9wombEISpPPuphRcwnRaxI/NzmiQcgzAWBKUzPeKGeCrqR2k+OoxIEgliQUkikACXVMla0AII1iyIyFwMvloqfHcwjvAteBHyR+8+RpmSy4B5iVDD/eomabJL5vUYYXexoAnATWe/Vem+i8xLMtyvBiTwOAOyG2ylVjo6XjawEz/gVmecFfn6hHwm2/VTQzOjsVNuMCVObbCcD4ReKJOL4WAbggsSrVWsAM39y/Hi6HpIqt9/u0LdQCrorcJXE0bQDcEui8wJ0bJm0rJC4nZW6GL/gk6Dov7wGeakaRCO2nEtsT8jbNlgoAZRCeAz4D3NO3vS/xni9xCLrUAJhSzoyXgFeBJe7sLZIdXgNuAO7pQmZYKq0gmbbUAcjUmgSdJQHAHYPNjvS1qB0bGQlsncZS3qeI1h2TEnOihHEnQ9Xr/A6J/SEUylqGGXuADyL9TkvB4wBwR8rVs/Q+4AuJ37M2Ikl/ZjwGpUse71TxD0oVgEw/+Cy7jTvJmZmk8w7m+QdYLOGuzNxvta7IbAEOd7AxzarmTog3e12RiSxv/cDXISq/ZrUNTO/CdkBiJE5u3XuC5Z2fqWtyrn6PO/0NrG8Qce443m3Vn3XJmsRELanFRckgeOdYSOEBOR68IKoXHhAExhwLKTwgx4MXRPXCA4LAmGMhhQfkePCCqH4P99SCUOXnkMIAAAAASUVORK5CYII=",l=/<img\s+(?=(?:[^>"']|"[^"]*"|'[^']*')*itemscope="Share_Contact_Card")([^>]+)>/g,c=e=>{switch(e){case i.SV.Contrast:return d;case i.SV.Dark:return r;case i.SV.Light:default:return s}},m=e=>e&&e===s||e===r||e===d},31651:(e,t,n)=>{n.d(t,{Z:()=>i});const i={MS_PER_SEC:1e3,SEC_PER_MIN:60,MIN_PER_HOUR:60,HOUR_PER_DAY:24,MS_PER_MIN:6e4,MS_PER_HOUR:36e5,MS_PER_DAY:864e5}},596188:(e,t,n)=>{n.d(t,{d:()=>s});var i=n(31651),a=n(480354);const o=/^-?[0-9]+:[0-5][0-9]:[0-5][0-9](\.[0-9]+)?$/;class s{constructor(e,t,n){if(this.i18n=e,n=n||0,t="number"==typeof(t=t||0)?t:t.getTime(),n="number"==typeof n?n:n.getTime(),this.duration={negative:t>n?1:0,ms:0,sec:0,min:0,hour:0,day:0,totalMs:0,totalSec:0,totalMin:0,totalHour:0},t||n){let e=this.duration.totalMs=Math.abs(n-t);this.duration.negative=t>n?1:0,this.duration.day=Math.floor(e/i.Z.MS_PER_DAY),e-=this.duration.day*i.Z.MS_PER_DAY,this.duration.hour=Math.floor(e/i.Z.MS_PER_HOUR),e-=this.duration.hour*i.Z.MS_PER_HOUR,this.duration.min=Math.floor(e/i.Z.MS_PER_MIN),e-=this.duration.min*i.Z.MS_PER_MIN,this.duration.sec=Math.floor(e/i.Z.MS_PER_SEC),this.duration.ms=e-this.duration.sec*i.Z.MS_PER_SEC,this.countTotals()}}static fromDurationTime(e,t){const n=new s(e,0,0);return(0,a.assignIn)(n.duration,t),n.countTotals(),n}static fromFormattedDurationString(e,t){if(!t||!o.test(t))throw new Error(`Invalid duration specified: ${t}`);const n=t.startsWith("-"),i=n?t.substring(1):t,[a,r,d]=i.split(":");return s.fromDurationTime(e,{negative:n?1:0,day:0,hour:+a,min:+r,sec:Math.floor(+d),ms:1e3*+d%1e3})}stringify(e,t,n,i){return e&&t?this.stringifyAsString(e,t,n,i):this.stringifyAsTime()}countTotals(){this.duration.totalHour=this.duration.day*i.Z.HOUR_PER_DAY+this.duration.hour,this.duration.totalMin=this.duration.totalHour*i.Z.MIN_PER_HOUR+this.duration.min,this.duration.totalSec=this.duration.totalMin*i.Z.SEC_PER_MIN+this.duration.sec,this.duration.totalMs=this.duration.totalSec*i.Z.MS_PER_SEC+this.duration.ms}getMasked(e){const t=(0,a.clone)(this.duration);for(const n of e)t[n]=0;return t}stringifyAsString(e,t,n,i){const o=n?this.getMasked(n):this.duration,s=(0,a.assignIn)({},o,i);return this.i18n.stringTranslate(e,t,s).trim().replace(/\s{2,}/g," ")}stringifyAsTime(){const e=this.duration,t=this.i18n.getLocaleTimeSettings();let n;if(e.totalHour>0){if(n=this.i18n.formatDateTime(new Date(0,0,0,0,e.min),{minute:t.minute}),"2-digit"===t.minute&&n.length<2){const e=this.i18n.formatDateTime(new Date(0,0,0,0,0),{minute:t.minute});n=this.i18n.stringTranslate("framework","time_min_to_double_digit",{min:n,zero:e})}}else n=this.i18n.formatDateTime(new Date(0,0,0,0,e.min),{minute:"numeric"});let i=this.i18n.formatDateTime(new Date(0,0,0,0,0,e.sec),{second:t.second});if("2-digit"===t.second&&i.length<2){const e=this.i18n.formatDateTime(new Date(0,0,0,0,0,0),{second:t.second});i=this.i18n.stringTranslate("framework","time_sec_to_double_digit",{sec:i,zero:e})}return this.formatTimeDuration(e.negative,e.totalHour,n,i)}formatTimeDuration(e,t,n,i){if(t>0){const a=e?"duration_time_negative_hours":"duration_time_hours";return this.i18n.stringTranslate("framework",a,{hour:t,min:n,sec:i})}{const t=e?"duration_time_negative_no_hours":"duration_time_no_hours";return this.i18n.stringTranslate("framework",t,{min:n,sec:i})}}}},774886:(e,t,n)=>{n.d(t,{Yx:()=>a,JR:()=>o,ob:()=>s});const i=(e,t)=>{let n=e[0];const i=[e[0]];let a=1;for(;a<e.length&&!(n.length+e[a].length>24);a++)n=n.concat(`, ${e[a]}`),i.push(e[a]);return{displayName:n,count:a<t?t-a+1:void 0,displayNames:i}},a=(e,t)=>{const n=i(e,t);return{displayName:n.displayName,count:n.count}},o=(e,t,n)=>{const a=i(e,t);if(!a.count){const e=a.displayNames;if(e.length>1){const t=new Intl.ListFormat(n).format(e);t.length<=26?a.displayName=t:(a.displayName=e.slice(0,e.length-1).join(", "),a.count=2)}}return{displayName:a.displayName,count:a.count}},s=(e,t,n,i)=>{let a;const o=n&&i?.startsWith(n),s=t&&i?.startsWith(t);return t&&"ja-jp"===e?.toLowerCase()?a=r(t):o&&!s?a=n:s&&!o&&(a=i&&r(i)),a||i};function r(e){const[,t=""]=/^([^(（]+)[(（]?/.exec(e)||[];return t.trim()}},973503:(e,t,n)=>{var i,a,o,s;n.d(t,{Xo:()=>a,UR:()=>s}),function(e){e.Unknown="Unknown",e.Persistent="Persistent",e.NonPersistent="NonPersistent"}(i||(i={})),function(e){e.None="None",e.Citrix="Citrix",e.VMware="VMware",e.AVD="AVD",e.Windows365="Windows365",e.AWS="AWS"}(a||(a={})),function(e){e.Unknown="Unknown",e.Dedicated="Dedicated",e.Shared="Shared"}(o||(o={})),function(e){e.none="none",e.webrtc="webrtc",e.slimcore="slimcore"}(s||(s={}))},445715:(e,t,n)=>{n.d(t,{y:()=>i});const i=e=>new Promise(((t,n)=>{if(null==e)return void n(new Error("Blob content was empty"));const i=new FileReader;i.addEventListener("loadend",(()=>{try{t(i.result)}catch(e){n(e)}})),i.readAsDataURL(e)}))},706591:(e,t,n)=>{n.d(t,{M1:()=>s,u_:()=>r,oJ:()=>d});var i=n(754255),a=n(291678);const o={enableOTPMeetings:!1},s=e=>{o.enableOTPMeetings=e},r=e=>e||!!o.enableOTPMeetings;async function d(e,t,n,s){try{n.addScenarioMark("auth-web-get-organizer-ring-start");const{disableSetOtpEnabledFromHostTenantId:r,enableOTPMeetings:d,otpMeetingEnabledRings:l}=t?.get(i.w.Auth)||{};if(d)return void(o.enableOTPMeetings=!0);if(!l||r)return;n.addEventData(["makeConfigApiCall:1"]);const c=await async function(e,t,n,o){try{const{disableSetOtpEnabledFromHostOid:s,configApiBaseUrlWeb:r}=o?.get(i.w.Auth)||{},{Tid:d,Oid:l}=function(e,t){if(!e)return{};const n={};try{const t=new URL(e).search.substring(1),i=t?.split("&");return i.forEach((e=>{const t=e.split("=");n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])})),{Tid:n.context?JSON.parse(n.context).Tid:null,Oid:n.context?JSON.parse(n.context).Oid:null}}catch(e){t.addEventData(["getUrlParams:Failure"])}return{Tid:null,Oid:null}}(e,n),c=t??d,m=r??"https://config.teams.microsoft.com/config/v1/MicrosoftTeams/1415_1.0.0.0?",u=s||!l?`${m}tenantId=${c}`:`${m}tenantId=${c}&id=${l}`,g=await(0,a.t)({url:u,method:"GET",headers:{},serviceName:"auth",apiName:"getConfig"}),p=await(g.body?.json()),h=p?.Segmentation?.TeamsRing;return n.addEventData([`organizerRing:${h}`]),h}catch(e){n.addEventData(["configApiCall:Failure"]),n.addScenarioMark("auth-web-get-meeting-config-failure")}return"general"}(e,s,n,t);if(!l.includes(c))return void n.addEventData(["setOTPEnabled:0"]);n.addEventData(["setOTPEnabled:1"]),o.enableOTPMeetings=!0}catch(e){n.addEventData(["setOTPEnabled:failure"])}}},710225:(e,t,n)=>{n.d(t,{D:()=>a});var i=n(455051);const a=new class{constructor(){this.logLevel=i.$b.Info,this.localCallback=void 0,this.error=e=>this.logMessage(i.$b.Error,e),this.warning=e=>this.logMessage(i.$b.Warning,e),this.warn=e=>this.logMessage(i.$b.Warning,e),this.info=e=>this.logMessage(i.$b.Info,e),this.log=e=>this.logMessage(i.$b.Info,e),this.verbose=e=>this.logMessage(i.$b.Verbose,e),this.debug=e=>this.logMessage(i.$b.Verbose,e)}initialize(e,t=i.$b.Verbose){this.localCallback=e,this.logLevel=t}executeCallback(e,t){this.localCallback?this.localCallback(e,t):console&&console.log(t)}logMessage(e,t){if(e>this.logLevel)return;const n=`[Auth]: ${t}`;this.executeCallback(e,n)}}},195695:(e,t,n)=>{n.d(t,{SM:()=>d,G4:()=>l,Bz:()=>c,Fy:()=>m,xz:()=>u,$q:()=>y});var i=n(710225),a=n(736626);const o=1e3,s="batch_",r=e=>({typeName:"BatchScenario",user:e});function d(e){const t=e.getAllOfType("User");t?.forEach((t=>{try{const n={user:{tenantId:t.profile.tid,oid:t.profile.oid,accountType:t.type,userName:t.userName,id:t.id},typeName:"BatchScenario"};e.del(n)}catch(e){i.D.log("[deleteAllBatchDataFromStorage] - failed to delete batcScenario from storage")}}))}function l(e,t,n,i,a){g(e,t,`${s}${n}`,(e=>(e.successMetaData=f(i,e.successMetaData),e.successMetaData.batchScenarioCounter)),a)}function c(e,t,n,i,a){g(e,t,`${s}${n}`,(e=>(e.failureMetaData=f(i,e.failureMetaData),e.failureMetaData.batchScenarioCounter)),a)}function m(e,t,n,i,a){g(e,t,`${s}${n}`,(e=>(e.abandonedMetaData=f(i,e.abandonedMetaData),e.abandonedMetaData.batchScenarioCounter)),a)}const u=async(e,t,n)=>{const i=r(n),a=await t.getValue(i);if(a){for(const t in a)if(a[t]){p(e,t,a[t],n.id)}t.del(i)}};function g(e,t,n,a,s){if(!s)return void i.D.log("[updateBatchScenarioCount] Unable to get batch cache key: user is not defined");const d=r(s);t.getValue(d).then((r=>{const l=r?.[n]??{};a(l)>=o?(p(e,n,l,s.id),function(e,t,n,a){try{i.D.log(`[clearBatchScenarioFromCache] scenario: ${n}`),delete a?.[n],e.put(t,a)}catch(e){i.D.log(`[clearBatchScenarioFromCache] ${e?.message}`)}}(t,d,n,r)):function(e,t,n,a,o){try{return o?o[n]=a:o={[n]:a},e.put(t,o),!0}catch(e){return i.D.log(`[setBatchScenarioToAuthCache] ${e?.message}`),!1}}(t,d,n,l,r)}))}function p(e,t,n,i){n?.successMetaData&&h(e,t,n.successMetaData,"success",i),n?.failureMetaData&&h(e,t,n.failureMetaData,"failure",i),n?.abandonedMetaData&&h(e,t,n.abandonedMetaData,"abandoned",i)}function h(e,t,n,o,s){const r=e.newScenario(t),d=(0,a.DA)();i.D.log(`[sendBatchScenario] for ${t}, status: ${o}, correlationId:${d}`);const l={accountId:s,context:"auth-telemetry-helper",secondaryCorrelationId:d,batchScenarioData:n};switch(o){case"success":r.stop(l);break;case"failure":r.fail(l);break;default:r.cancel(l)}}function f(e,t){return t?(t.batchScenarioCounter++,t.batchEventData.push(e)):t={batchScenarioCounter:1,batchEventData:[e]},t}const y=(e,t)=>({id:t??(0,a.DA)(),source:e})},736626:(e,t,n)=>{n.d(t,{hR:()=>a,Nw:()=>o,DA:()=>d});const i=globalThis;function a(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t?.errorCode)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}function o(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,r(s(t)))}catch(e){return"Stringifying error failed"}}const s=(e=!0)=>(t,n)=>{if(n instanceof Error){const t={};return Object.getOwnPropertyNames(n).forEach((i=>{"stack"===i?e||(t[i]=("string"==typeof n.stack?n.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))):t[i]=n[i]})),t}return n},r=e=>{const t=new WeakSet;return(n,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}},d=()=>{try{const e=i.msCrypto||i.crypto;return`${[1e7]}-1000-4000-8000-100000000000`.replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}catch{const e="xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx",t="0123456789abcdef";let n=0,i="";for(let a=0;a<36;a++)"-"!==e[a]&&"4"!==e[a]&&(n=16*Math.random()|0),"x"===e[a]?i+=t[n]:"y"===e[a]?(n&=3,n|=8,i+=t[n]):i+=e[a];return i}}},908060:(e,t,n)=>{n.d(t,{a9:()=>o,KQ:()=>d});var i=n(480354);const a="</at>",o=e=>{const t=e.msTeams??e.msteams;if(!t||!(0,i.isObject)(t)||!t.entities)return;let n;try{n=s(t.entities)}catch(e){return}return n},s=e=>{const t=new Map;let n=0;return e.forEach((e=>{e.type&&"mention"===e.type&&!c(e.text)&&e.mentioned&&!c(e.mentioned.id)&&r(e.text)&&!t.has(e.text)&&t.set(e.text,{__typename:"Mention",itemId:(n++).toString(),mentionType:"person",displayName:e.mentioned.name,userId:e.mentioned.id,id:`${e.mentioned.id}|person`})})),t},r=e=>{const t=e.toLowerCase(),n=0===t.lastIndexOf("<at>"),i=t.indexOf(a),o=-1!==i&&i===t.length-5;return n&&o},d=(e,t,n)=>{l(e,t,n)},l=(e,t,n)=>{(0,i.forEach)(e,((a,o)=>{(0,i.isEqual)(t,{[o]:a})&&n(e),a instanceof Array?(0,i.forEach)(a,(e=>{l(e,t,n)})):(0,i.isObject)(a)&&l(a,t,n)}))},c=e=>!e||!e.trim()},276952:(e,t,n)=>{n.d(t,{Kv:()=>o,rj:()=>s,Mc:()=>r,PR:()=>d,Kb:()=>l,xI:()=>c,M_:()=>m,RG:()=>u,Zj:()=>g,AU:()=>p,Mm:()=>h,Ap:()=>f,l:()=>y});var i=n(199448),a=n(850434);const o="announcement-card",s="application/vnd.microsoft.teams.messaging-announcementBanner",r=1317,d=366,l=878,c=244,m="Designer",u="AnnouncementBanner",g="designer-img",p=(e=[])=>{const t=e.findIndex((e=>e.contentType===s));return{announcementCard:e[t],announcementCardIndex:t}},h=e=>{const{announcementCard:t}=p(e);if(!t)return{cardContent:void 0};try{return{cardContent:JSON.parse(t.content),appName:t.appName??void 0}}catch(e){throw(0,i.$5)("PostComposeHelpers",a.O4.Undefined,"getAnnouncementCardContentFromDraft::JsonParseError")}},f=(e,t,n)=>"Guardians"===n&&t?C(e,t):e,y=(e,t)=>"Guardians"===t?"":e,C=(e,t)=>`\n    <div>\n      <h2 style="\n    font-size: 18px;\n  ">${t}</h2>\n      ${e}\n    </div>\n  `},250212:(e,t,n)=>{n.d(t,{xU:()=>l,SH:()=>c,a6:()=>m});var i=n(84646),a=n(806658),o=n(797922),s=n(737915),r=n(702183),d=n(800079);const l=(e,t,n,d,l,c,m,u,g)=>{const p=t?.postType,h=l;if("Guardians"===p)return r.Cu.GuardiansSendAnnouncement;const f=d?.length===i.Es,y=d?.some((e=>(0,a.W4)(e))),C=d?.some((e=>(0,a.dU)(e))),v=n||"",I=!h&&f&&y&&!(0,o.xl)(v),D=h&&f&&C;switch(e){case"Create":return(0,s.t0)(v)?r.Cu.P2PSendNewMessageSfB:(0,o.xl)(v)?r.Cu.P2PSendNewMessageSfC:m?r.Cu.CommentStreamSendMessage:(0,o.Yp)(v)?r.Cu.P2PSendNewMessageFederated:c?r.Cu.P2PSendNewMessageNativeFederated:I?r.Cu.P2PSendNewMessageTfl:D?r.Cu.P2PSendNewMessageTfw:t?.crossPostChannels&&t?.crossPostChannels.length>1?r.Cu.CrossPostSendMessage:(0,o.qL)(v)?r.Cu.PhonelinkSmsChatSendMessage:u&&!h?r.Cu.PaidTFWSmsChatSendMessage:g?r.Cu.LobbyChatSendMessage:r.Cu.ChatSendMessage;case"Update":return t?.crossPostChannels&&t?.crossPostChannels.length>1?r.Cu.CrossPostEditMessage:r.Cu.EditMessage}return r.Cu.ChatSendMessage},c=e=>!(!e||e.isOneOnOne||e.isMeeting||!e.hasFederatedUser),m=(e,t,n,o)=>!!(e?.includes(i.O)||e?.includes(i.hh)||e?.includes(i.vf)||e?.includes(i.OU)||e?.includes(i.s8)||e?.includes(i.L)||e?.includes(i.wx)||t||n?.some(d.af.isEnterpriseUserMri)&&(o||n?.some((e=>(0,a.W4)(e)))))},914573:(e,t,n)=>{function i(e,t,n){e.splice(function(e,t,n){let i=0,a=e.length;const o=n(t);for(;i<a;){const t=Math.floor((i+a)/2);o<n(e[t])?a=t:i=t+1}return i}(e,t,n),0,t)}n.d(t,{M:()=>i})},498409:(e,t,n)=>{n.d(t,{BY:()=>a,l1:()=>o});const i=e=>{const t=e.getComputedStyle(e.document.documentElement).fontSize||"10px";return parseFloat(t)},a=(e,t)=>i(e)*t,o=(e,t)=>t/i(e)},127671:(e,t,n)=>{n.d(t,{c:()=>o});var i=n(199448),a=n(850434);function o(e,...t){return n=>e(n).then((e=>{if(t.indexOf(e.status)>-1||t.filter(s).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.status.toString()))))return e;throw(0,i.$5)(a.Ir.RequireStatus,a.O4.RemoteOperationFailed,a.Ir.RequireStatus,{requiredStatus:1===t.length?t[0]:t,status:e.status},void 0,e)}))}function s(e){return"string"==typeof e}},390889:(e,t,n)=>{n.d(t,{j:()=>i});const i=(e,t)=>e?"Conversational":t?"PostReply":"Unthreaded"},691650:(e,t,n)=>{n.d(t,{l:()=>i,W:()=>a});const i={Help:"5a0e35f9-d3c8-45b6-9dd9-983ab47f1b83"},a="teams-copy-link"},884542:(e,t,n)=>{n.d(t,{Yn:()=>a,jT:()=>o,dk:()=>s,aE:()=>r});var i=n(691650);function a(e,t,n){return`${e}/${t}/${n}`}function o(e,t,n){let i=`${e}/l`;return t&&""!==t&&(i=`${i}/${t}`),n&&""!==n&&(i=`${i}?${n}`),i}function s(e,t,n,a=!1){return`\n    <div itemprop="${i.W}"><a href="${t}" title="${t}" data-origin-known="true">${e}</a></div>${n?`<div itemprop="${i.W}">${n}</div>`:""}${a?"<div>&nbsp;</div>":""}`}function r(e){const t=e.location.protocol;let n=e.location.host;return"local.teams.office.com"!==n&&"local.teams.office.com:8080"!==n||(n="teams.microsoft.com"),`${t}//${n}`}},198993:(e,t,n)=>{n.d(t,{eq:()=>s,rl:()=>r,n:()=>d,mJ:()=>l,as:()=>c,Bn:()=>m,At:()=>u,du:()=>g,rv:()=>p,jN:()=>h,Xf:()=>D});var i=n(480354),a=n(878336),o=n(712839);const s="ZeroInstallAppInstalledAppLinkUnfurl",r="NonZeroInstallAppInstalledAppLinkUnfurl",d="ZeroInstallAppNotInstalledAppLinkUnfurl",l="URLP",c="URLPRichInfo",m=(e,t,n=!0,a=!1,o=[])=>{let s=(0,i.first)(f(e,t,n));if(void 0!==s&&a&&o){const n=o.find((e=>e.lowerPriorityApp===s?.id));if(n){const i=t.find((e=>e.id===n.higherPriorityApp));i&&C(e,i)&&(s=i)}}return s},u=(e,t)=>!(!t||!(0,i.find)(t,(t=>t===e))),g=e=>e?.messageExtensions?.[0]?.messageHandlers?.[0]?.value?.supportsAnonymousAccess||!1,p=(e,t,n)=>!(!t||!e)&&(g(e)||u(e.id,n)),h=e=>{const t=(0,i.map)(e.messageExtensions,(e=>({type:"BotBased",botId:e.botId,commands:(0,i.map)(e.commands,(e=>({id:e.id||"",type:e.type,parameters:(0,i.map)(e.parameters,(e=>({name:e.name})))}))),messageHandlers:(0,i.map)(e.messageHandlers,(e=>({type:e.type,value:{domains:e.value?.domains,supportsAnonymousAccess:e.value?.supportsAnonymousAccess}})))})));return{id:e.id,name:e.name,largeImageUrl:e.largeImageUrl,privacyUrl:e.privacyUrl,termsOfUseUrl:e.termsOfUseUrl,validDomains:e.validDomains,messageExtensions:t,resource:e.webApplicationInfo?.resource}},f=(e,t,n)=>(0,i.filter)(t,(t=>{if(!t.definition)return!1;if(!y(n,t))return!1;const o=t.definition.messageExtensions?.[0],s=(0,i.first)(o?.messageHandlers);if(s){const{value:t}=s,n=t?.domains?.filter((e=>v(e)))??[],[o,r]=(0,i.partition)(n,(e=>e.includes("/")));return(0,a.F6)(e,r)||I(e,o)}return!1})),y=(e,t)=>!!e||!!t.definition&&(!(t.definition.externalId&&!t.definition.tenantId)&&(t.definition.externalId&&t.definition.tenantId,!0)),C=(e,t)=>{const n=t?.definition?.messageExtensions?.[0],o=(0,i.first)(n?.messageHandlers);if(o){const{value:t}=o,n=t?.domains?.filter((e=>v(e)))??[],[s,r]=(0,i.partition)(n,(e=>e.includes("/")));return(0,a.F6)(e,r)||I(e,s)}return!1},v=e=>{if(!e)return!1;const t=e.split("/")[0].split(".");if(t.length<=1)return!1;const n=t[t.length-1],i=t[t.length-2];return!n.includes("*")&&!i.includes("*")},I=(e,t)=>!!(0,i.some)(t,(t=>{const n=t.replace(new RegExp("[*]","g"),"(.*)"),i=new RegExp(n);return e.match(i)})),D=e=>{switch(e){case"GroupChat":return o.bY.group;case"Personal":return o.bY.personal;case"Team":return o.bY.team;default:return}}},872600:(e,t,n)=>{n.d(t,{K:()=>o});var i=n(349545),a=n(931328);const o=e=>e instanceof i.B?e.asObservable():e instanceof a.c?e:new a.c((t=>{const n=e.subscribe(t);return()=>n.unsubscribe()}))},851490:(e,t,n)=>{n.d(t,{x:()=>i,n:()=>a});const i=(e,t)=>e.split(" ").filter((e=>e.includes(`itemtype="${t}"`))).length,a=(e,t)=>t.map((t=>i(e,t))).reduce(((e,t)=>t+e),0)},811221:(e,t,n)=>{n.d(t,{Ay:()=>o,yG:()=>s,lk:()=>r,We:()=>d,a1:()=>l,XD:()=>c,gU:()=>m,uR:()=>u,bD:()=>g,iK:()=>p,sf:()=>h,EE:()=>f,Gu:()=>y,lp:()=>C});var i=n(726723),a=n(868553);const o="EmergencyLocationSettings",s="emergency-location-header",r="add-address",d="confirm-address",l="edit-address",c="address-editing-disabled",m="remove-custom-address",u="CallsAppV2",g="emergency-location-settings-pop-out-menu",p="change-emergency-location-settings",h="current-emergency-location-setting",f="emergency-location-stg",y="locationNotificationCoachmark",C={appName:"calls",panelType:i.HP.Call,panelRegion:i.rP.left,actionScenario:i.vB.call,actionScenarioType:i.DB.emergencyLocation,moduleType:i.nR.button,tabId:a.LT.Calls,tabType:a.f7.Calls,actionWorkload:i.E0.callMeetingContent,actionSubworkload:i.i7.emergencyLocation}},700135:(e,t,n)=>{n.d(t,{c:()=>i});const i={Connected:"Connected",ConsoleSession:"CONSOLE_SESSION",Disconnected:"Disconnected",Local:"Local",Unknown:"Unknown",None:"None",DisconnectedAVDisabled:"DisconnectedAVDisabled"}},146435:(e,t,n)=>{n.d(t,{g:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("mutation setUserAgreementEmergencyCustomDisclaimer($didUserAgree:Boolean!,$context:String!) {setUserAgreementEmergencyCustomDisclaimer(didUserAgree:$didUserAgree,context:$context)}");return delete this.definitions,this.definitions=e.definitions}}},868553:(e,t,n)=>{var i,a,o;n.d(t,{TN:()=>i,LT:()=>a,f7:()=>o}),function(e){e.CallHistory="CallHistory",e.CallHistoryButton="call-history-button",e.CallHistoryMenu="call-history-menu",e.HistoryItem="history-item",e.Dialpad="dialpad",e.DelegateMembersRowCallButton="delegate-team-row-call-button",e.UseVoicemail="use-voicemail",e.CallContactAddButton="call-contact-add-button",e.ToggleAgentOptInStatus="toggle-agent-optin-status",e.SharedLines="shared-lines",e.ResumeParkedCallButton="resume-parked-call-button",e.DismissParkedCallButton="dismiss-parked-call-button",e.SpeedDial="speed-dial",e.BuddyGroup="buddy-group",e.ChildWindowChatCallButton="ChildWindowChatCallButton",e.PstnCallButtonChatHeader="PstnCallButtonChatHeader"}(i||(i={})),function(e){e.Calls="2e5426a1-157b-4113-80e8-e81cfb4ead99",e.Contacts="a50dc230-2776-4a9f-9c0d-e68128c1e121",e.CallableChannel="998b667f-4751-4aba-bbd9-e4d465e32132",e.DelegatorCalls="edaf467a-66ba-11ed-9022-0242ac120002"}(a||(a={})),function(e){e.AgendaPage="AgendaPage",e.Calls="Calls",e.Contacts="Contacts",e.CallableChannel="callableChannel",e.MeetingRoom="MeetingRoom",e.DelegatorCalls="DelegatorCalls",e.Queues="Queues"}(o||(o={}))},395600:(e,t,n)=>{n.d(t,{p:()=>m});var i=n(67309),a=n(160606),o=n(410703),s=n(983168),r=n(506787),d=n(264345),l=n(875094);const c={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsChatQueriesNavigateToChatWithFragment on Conversation {id,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}},m={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatQueriesChatWithUserQuery($userId:ID!,$createLieIfNotFound:Boolean,$tflTwoWaySmsUserNamesMap:[SmsUserNamesMap!]) {chatWithUser(userId:$userId,createLieIfNotFound:$createLieIfNotFound,tflTwoWaySmsUserNamesMap:$tflTwoWaySmsUserNamesMap) {id,title,isOneOnOne,isOneOnOneBotChat,isDisabled,meetingChatPolicy,chatSubType,chatType,isSfB @client,isMeeting @client,isBotBlocked,isMuted,isFederated @client,isRetentionHorizonSet,isModerator,isAdmin,lastMessage {...lastMessageFields},consumptionHorizon {...consumptionHorizonFields},consumptionHorizonBookmark {...consumptionHorizonBookmarkFields},userConsumptionHorizon {...consumptionHorizonBookmarkFields},memberIds,creator,meetingInformation {...meetingInformationFieldsShort},userAdminSettings {adminDeleteEnabled,deleteMessagesEnabled},tenantId,chatDisabledContext @client {isUIDisabled,disabledReason,extendedData,lastUpdatedTime},interopConversationStatus,chatHistoryHiddenTime,userProperties {...userProperties},pinnedConversationItems {... on Message {...pinnedMessageItemFields}},identityMaskEnabled,...ComponentsChatQueriesNavigateToChatWithFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...a.L.definitions,...o.U.definitions,...s.q.definitions,...r.v.definitions,...d.p.definitions,...l.M.definitions,...c.definitions]}}},572637:(e,t,n)=>{n.d(t,{P:()=>m});var i=n(67309),a=n(160606),o=n(410703),s=n(983168),r=n(969037),d=n(506787),l=n(264345),c=n(875094);const m={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatQueriesChatsWithUsersQuery($userIds:[ID!]!,$createLieIfNotFound:Boolean,$topicName:String,$tflTwoWaySmsUserNamesMap:[SmsUserNamesMap!],$onlyFetchNonLieConversation:Boolean,$guardiansInfo:GuardiansInfoInput) {chatsWithUsers(userIds:$userIds,createLieIfNotFound:$createLieIfNotFound,topicName:$topicName,tflTwoWaySmsUserNamesMap:$tflTwoWaySmsUserNamesMap,onlyFetchNonLieConversation:$onlyFetchNonLieConversation,guardiansInfo:$guardiansInfo) {id,title,isOneOnOne,isOneOnOneBotChat,isDisabled,meetingChatPolicy,chatSubType,chatType,isSfB @client,isMeeting @client,isBotBlocked,isMuted,isFederated @client,isRetentionHorizonSet,isModerator,isAdmin,lastMessage {...lastMessageFields},consumptionHorizon {...consumptionHorizonFields},consumptionHorizonBookmark {...consumptionHorizonBookmarkFields},userConsumptionHorizon {...consumptionHorizonBookmarkFields},memberIds,botMembers {...userFields},creator,meetingInformation {...meetingInformationFieldsShort},userAdminSettings {adminDeleteEnabled,deleteMessagesEnabled},tenantId,chatDisabledContext @client {isUIDisabled,disabledReason,extendedData,lastUpdatedTime},interopConversationStatus,chatHistoryHiddenTime,clearHistoryTime,userProperties {...userProperties},pinnedConversationItems {... on Message {...pinnedMessageItemFields}},identityMaskEnabled,chatScheduleSuggestionSuppressUntil}}");return delete this.definitions,this.definitions=[...e.definitions,...a.L.definitions,...o.U.definitions,...s.q.definitions,...r.x.definitions,...d.v.definitions,...l.p.definitions,...c.M.definitions]}}},254216:(e,t,n)=>{n.d(t,{t:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatQueriesNewChatIntentIdQuery($convId:ID!) {newChatIntentId(convId:$convId)}");return delete this.definitions,this.definitions=e.definitions}}},39431:(e,t,n)=>{n.d(t,{RC:()=>u,TF:()=>p,ck:()=>I,jC:()=>m});var i=n(480354),a=n(324532),o=n(914573),s=n(67309);const r={kind:"Document",get definitions(){const e=(0,s.G)("fragment ComponentsChatQueriesMessageIdListFragment_messageIdFields on Message {id,clientMessageId,originalArrivalTime,from}");return delete this.definitions,this.definitions=e.definitions}},d={kind:"Document",get definitions(){const e=(0,s.G)("query ComponentsChatQueriesMessageIdListQuery($convId:ID!,$replyChainId:String,$cursor:String) {messages(convId:$convId,replyChainId:$replyChainId,cursor:$cursor) {messages {...ComponentsChatQueriesMessageIdListFragment_messageIdFields},cursor}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions]}};var l=n(284281);const c="updateMessageCache";function m(e,t,n,a,o,s=!1,r){try{if((0,i.isEmpty)(a))return void r?.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch is empty!`);const{messages:d,cursor:l}=g(e,t,n)??{};if(!d)return void r?.warn(`convId: ${t}, replyChainId: ${n}:: cachedMessages is undefined!`);if(l&&parseInt(l,10).toString()===l){const e=a.length;(a=a.filter((({clientMessageId:e,id:t})=>t&&(t===e||t>=l)))).length<e&&r?.log(`convId: ${t}, replyChainId: ${n}:: filtered out ${e-a.length} updates to messages as they are older than any in the message list.`)}r?.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch: [${a.map((e=>e.id))}]`);const c=f(e,a,d,o,s,!n,r);c?h(e,t,n,c,r):r?.log(`convId: ${t}, replyChainId: ${n}:: skipped writeCacheQuery. message list not updated!`)}catch(e){r?.errorToTelemetry?.(`Failed to updateMessageList for convId: ${t}, replyChainId: ${n}`,"messaging_delete_message",{conversationId:t,operationType:c},!0)}}const u=(e,t,n,a,o,s)=>{const r=d,l={convId:t,replyChainId:n};try{const d=e.readQuery({query:r,variables:l})?.messages;if(!d)return;const{messages:c,cursor:m,__typename:u}=d,g=(0,i.findLast)(c,(e=>e.id===a&&e.from===o));if(c&&g){const o=(0,i.without)(c,g);e.writeQuery({query:r,variables:l,data:{messages:{messages:o,cursor:m,__typename:u}}}),s?.log(`convId: ${t}, replyChainId: ${n}:: deleted from cache. message: ${a}`)}}catch(e){s?.errorToTelemetry?.(`Failed to deleteMessage for convId: ${t}, messageToDeleteId: ${a}`,"messaging_delete_message",{conversationId:t,operationType:c},!0)}},g=(e,t,n)=>{const i=e.readQuery({query:d,variables:{convId:t,replyChainId:n}});return i?.messages??null},p=(e,t,n)=>g(e,t,n)?.messages??null,h=(e,t,n,i,a)=>{const o=i.length>0?i[i.length-1].id:null,s={convId:t,replyChainId:n};e.writeQuery({query:d,variables:s,data:{messages:{messages:i,cursor:o,__typename:"MessagesResult"}}}),a?.log(`cache.writeQuery message: [${i.map((e=>e.id))}]`)},f=(e,t,n,i,a,o,s)=>{let r;const d=[];return t.forEach((t=>{let s=!1,l=!1;t.from===i&&n.find((e=>e.id===t.clientMessageId))?(l=!0,s=!0):n.find((e=>e.id===t.id||e.clientMessageId===t.id))||(s=!0),a&&v(e,t,o),s?(r||(r=[...n]),l&&C(r,t),y(r,t)):d.push(t.id)})),d.length>0&&s?.log(`Skipped message ids [${d.map((e=>e))}]`),r},y=(e,t)=>{(0,o.M)(e,t,(e=>-new Date(e.originalArrivalTime)))},C=(e,t)=>{const n=e.findIndex((e=>e.clientMessageId===t.clientMessageId));n>=0&&e.splice(n,1)},v=(e,t,n)=>{e.writeFragment({id:`${(0,a.or)(t)}`,fragment:l.R,variables:{includeRepliesSummary:n},fragmentName:"messageFields",data:{...t}})},I=(e,t,n,i)=>{if(!n||!i)return null;try{return e.readFragment({id:`Message:${i}`,fragment:l.R,variables:{includeRepliesSummary:!0},fragmentName:"messageFields"})}catch(e){return t.errorToTelemetry?.(`Failed to readCachedMessage for convId: ${n}, messageId: ${i}`,"messaging_delete_message",{conversationId:n,operationType:c},!0),t.error("readCachedMessage failed with error",e),null}}},777598:(e,t,n)=>{n.d(t,{$9:()=>p,J3:()=>f,ME:()=>y,eS:()=>u,Ki:()=>m,fU:()=>g,er:()=>h});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("mutation ComponentsChatUtilsCreateChatMutation($userIds:[ID!]!,$topicName:String) {createChat(userIds:$userIds,topicName:$topicName) {conversation {id,title,consumptionHorizon {id,timeStamp},memberIds,membersLimited {id,email,givenName},memberDisplayNamesLimited,chatDisabledContext @client {isUIDisabled,disabledReason,extendedData,lastUpdatedTime}},hasIBPolicyRejectedUsers}}");return delete this.definitions,this.definitions=e.definitions}},o={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatUtilsChatsWithUsersQuery($userIds:[ID!]!,$createLieIfNotFound:Boolean,$onlyFetchNonLieConversation:Boolean,$topicName:String) {chatsWithUsers(userIds:$userIds,createLieIfNotFound:$createLieIfNotFound,filters:{isDisabled:false,chatSubType:0},onlyFetchNonLieConversation:$onlyFetchNonLieConversation,topicName:$topicName) {id,title,chatType,consumptionHorizon {id,timeStamp},memberIds,membersLimited {id,email,givenName}}}");return delete this.definitions,this.definitions=e.definitions}};var s=n(572637),r=n(395600);const d={kind:"Document",get definitions(){const e=(0,i.G)("mutation ComponentsChatUtilsSendMessageMutation($convId:ID!,$message:SendMessageInput!,$action:SendMessageAction!,$withChatNetworkFallback:Boolean) {sendMessage(convId:$convId,message:$message,action:$action,withChatNetworkFallback:$withChatNetworkFallback) {id}}");return delete this.definitions,this.definitions=e.definitions}},l={kind:"Document",get definitions(){const e=(0,i.G)("mutation ComponentsChatUtilsDiscardChatMutation($convId:ID!) {discardChat(convId:$convId)}");return delete this.definitions,this.definitions=e.definitions}},c={kind:"Document",get definitions(){const e=(0,i.G)("mutation ComponentsChatUtilsDiscardDraftChatMutation($convId:ID!) {discardDraftChat(convId:$convId) {convId}}");return delete this.definitions,this.definitions=e.definitions}};async function m(e,t,n="",i=!0,a=!1,o=!1){const{data:r}=await e.query({query:s.P,variables:{userIds:t,createLieIfNotFound:a,topicName:n},fetchPolicy:i?"cache-first":"network-only"});let d=r?.chatsWithUsers;return o&&d&&(d=d.filter((e=>"SfBInteropChat"!==e.chatType))),[...d].sort(((e,t)=>{const n=new Date(e.consumptionHorizon?.timeStamp||0);return new Date(t.consumptionHorizon?.timeStamp||0).valueOf()-n.valueOf()}))[0]}async function u(e,t,n=!0,i=!1,a=!1,s=!1,r=void 0){const{data:d}=await e.query({query:o,variables:{userIds:t,createLieIfNotFound:i,onlyFetchNonLieConversation:a,topicName:r},fetchPolicy:n?"cache-first":"network-only"});let l=d?.chatsWithUsers;return s&&l&&(l=l.filter((e=>"SfBInteropChat"!==e.chatType))),[...l].sort(((e,t)=>{const n=new Date(e.consumptionHorizon?.timeStamp||0);return new Date(t.consumptionHorizon?.timeStamp||0).valueOf()-n.valueOf()}))[0]}async function g(e,t,n=!0,i=!1){const{data:a}=await e.query({query:r.p,variables:{userId:t,createLieIfNotFound:i},fetchPolicy:n?"cache-first":"network-only"});return a?.chatWithUser}async function p(e,t,n=""){const i=await e.mutate({mutation:a,variables:{userIds:t,topicName:n}});return i?.data?.createChat}async function h(e,t,n,i){const{data:a}=await e.mutate({mutation:d,variables:{action:"Create",convId:t,message:n,withChatNetworkFallback:i}});return a?.sendMessage}async function f(e,t){if(!t)return!1;const{data:n}=await e.mutate({mutation:l,variables:{convId:t}});return n?.discardChat}async function y(e,t){if(!t)return!1;const{data:n}=await e.mutate({mutation:c,variables:{convId:t}});return n?.discardDraftChat}},791158:(e,t,n)=>{n.d(t,{zL:()=>i,Ws:()=>r,jc:()=>d,gI:()=>l,SK:()=>c,ES:()=>m});var i,a=n(735652),o=n(754255),s=n(645095);function r(e){const{allowUserChat:t,messagingPolicy:n}=e;return"boolean"==typeof t||!!n?t?i.Enabled:i.Disabled:i.Unknown}function d(){const e=(0,a.w2)(o.w.Messaging);return e.enableComposeDisabledBasedOnPolicy?r(e):i.Enabled}function l(e){const t=d();return e===s.vW.Meeting||e===s.vW.Channel?i.Enabled:t}function c(e,t){const n=l(e),{enablePinMessageToChat:s}=(0,a.w2)(o.w.Messaging,["enablePinMessageToChat"]);return t&&!!s&&n!==i.Disabled}function m(){const{teamsUserPhoneNumbers:e}=(0,a.w2)(o.w.Messaging,["teamsUserPhoneNumbers"]);return!!e?.phoneNumbers?.find((e=>"Primary"===e?.assignmentCategory&&e?.acquiredCapabilities?.includes("InboundA2PSms")&&e?.acquiredCapabilities?.includes("OutboundA2PSms")))}!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unknown="Unknown"}(i||(i={}))},902867:(e,t,n)=>{n.d(t,{H:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment emergencyAddressResult on EmergencyAddressResult {address {companyName,streetName,streetSuffix,additionalInfo,houseNumber,houseNumberSuffix,postDirectional,preDirectional,cityOrTown,countyOrDistrict,stateOrProvince,country,postalOrZipCode},editable,type,geocoordinates {latitude,longitude}}");return delete this.definitions,this.definitions=e.definitions}}},573124:(e,t,n)=>{n.d(t,{S:()=>o});var i=n(67309),a=n(902867);const o={kind:"Document",get definitions(){const e=(0,i.G)("subscription emergencyAddressUpdatedEvent {emergencyAddressUpdatedEvent {...emergencyAddressResult}}");return delete this.definitions,this.definitions=[...e.definitions,...a.H.definitions]}}},663435:(e,t,n)=>{n.d(t,{lz:()=>o,My:()=>s,vU:()=>a,lH:()=>r});var i=n(289242);function a(e,t,n,i,a){if(!t)return void a.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:t,isShortProfileRequested:!1,callerInfo:i,peoplePickerFilters:void 0,isSharedChannel:!0,hostTenantId:n}}const o=({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i,personNodeId:a})=>JSON.stringify({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i,personNodeId:a});function s(e){const t={userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0};if(!e)return t;try{const{userId:t,isSharedChannel:n,hostTenantId:i,hostConversationId:a,personNodeId:o}=JSON.parse(e);return{userId:t,isSharedChannel:!0===n,hostTenantId:i,hostConversationId:a,personNodeId:o}}catch(e){return t}}function r(e){if(e)switch(e.config.platformId){case i.PU.Web:case i.PU.SttOutlookWeb:return"Web";default:return"Desktop"}}},505834:(e,t,n)=>{n.d(t,{cj:()=>r,vj:()=>d,Cd:()=>l,zB:()=>c,VH:()=>m,XC:()=>u,Tu:()=>g,Nx:()=>p,jQ:()=>h});var i=n(712839),a=n(572909),o=n(649728),s=n(363678);const r=e=>"com.microsoft.teams.callable-channel"===e||"com.microsoft.teamspace.tab.file.staticviewer.pdf"===e||"44263ed4-f1ac-4e96-93aa-d24dd50459ea"===e||"com.microsoft.teamspace.tab.web"===e,d=(e,t,n)=>{if(n){const{correlationId:i,installationScope:a,tabConfigurationData:o,threadId:s,teamId:r,isEduContext:d,isTmpLaunch:l}=n;switch(a){case"Team":return t.platform.inContextStorePostInstall({appId:e,teamId:r,correlationId:i,isEduContext:d,isTmpLaunch:l,tabConfigurationData:o,channelId:s,name:"openTabInstanceConfigDialogForChannel",inContextStoreLaunchOptions:n});case"GroupChat":return t.platform.inContextStorePostInstall({appId:e,correlationId:i,tabConfigurationData:o,isTmpLaunch:l,chatId:s,name:"openTabInstanceConfigDialogForChat",inContextStoreLaunchOptions:n})}}return Promise.resolve()},l=e=>"Student"===e||"Teacher"===e,c=async(e,t)=>{const{data:n}=await e.query({query:o.A,variables:{convId:t}});return n},m=e=>{let t=i.f4.na;switch(e){case s.hB.card:t=i.f4.card;break;case s.hB.deepLink:case s.hB.deepLinkStageView:t=i.f4.deepLink;break;case s.hB.stageViewOpenSDKApi:t=i.f4.stageViewOpenSDKApi;break;case s.hB.messageExtension:t=i.f4.messageExtension;break;case s.hB.chatTab:case s.hB.channelTab:case s.hB.sidePanel:case s.hB.privateMeetingSchedulingForm:case s.hB.channelMeetingSchedulingForm:case s.hB.tab:t=i.f4.platformExtensionTab;break;case s.hB.storeApp:t=i.f4.storeapp;break;case s.hB.personalApp:t=i.f4.personalApp;break;case s.hB.virtualEvent:t=i.f4.virtualEvent;break;case s.hB.shareToOutlook:t=i.f4.shareToOutlook;break;case s.hB.contentBubble:t=i.f4.contentBubble;break;case s.hB.adaptiveCardTab:case s.hB.adaptiveCardCollabStage:case s.hB.adaptiveCardStageModal:t=i.f4.adaptiveCardTab;break;case s.hB.botConfig:t=i.f4.botConfig;break;case s.hB.workflows:t=i.f4.workflows}return t},u=(e,t,n,i)=>!!n&&(!!e||t&&i),g=(e,t)=>"Private"===e&&!!t,p=e=>e===a.ck.channels||e===a.ck.channelthread,h=e=>!!p(e)||e===a.ck.communities},955456:(e,t,n)=>{n.d(t,{i:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsUrlPreviewUrlPreviewQuery($url:String!) {urlPreview(url:$url) {url,title,description,thumbnail,thumbnailMeta {width,height}}}");return delete this.definitions,this.definitions=e.definitions}}},29715:(e,t,n)=>{n.d(t,{fX:()=>m,ob:()=>u});var i=n(957032),a=n(513432),o=n(755029),s=n(879469),r=n(619761),d=n(596188);const l=e=>(0,i.Y)("span",{children:e}),c=e=>e?Date.now()-e:-1,m=a.memo((({startedAt:e,i18nCustomFormat:t,i18nCustomFormatNamespace:n,render:s})=>{const d=a.useContext(r.I18nContext);return(0,i.Y)(g,{startedAt:e,i18nCustomFormatNamespace:n,render:s,i18n:d,i18nCustomFormat:t,useUserContext:o.ur})})),u=e=>{const{startedAt:t,i18nCustomFormat:n,i18nCustomFormatNamespace:i,i18n:o,useUserContext:r}=e,{host:d}=r(),[l,m]=a.useState(0),[u,g]=a.useState(t);a.useEffect((()=>{if(!t)return;g(t),m(0);const e=d.setInterval((()=>{m((e=>++e))}),1e3);return()=>{d.clearInterval(e)}}),[d,t]);const h=a.useMemo((()=>(e=>Math.round(c(e)/1e3))(u)),[u]),f=a.useMemo((()=>c(u)),[u]);return f>=0?n&&o?p(o,1e3*l+f,n,i):(0,s.H)(l+h):"--:--"},g=a.memo((e=>{const t=u(e);return(e.render||l)(t)})),p=(e,t,n,i)=>new d.d(e,0,t).stringify(i,n)},836555:(e,t,n)=>{n.d(t,{sQ:()=>l,P8:()=>c,ur:()=>m,sz:()=>u,YE:()=>g});var i=n(957032),a=n(513432),o=n(386554),s=n(676209),r=n(552222),d=n(811221);const l=(e,t)=>a.useCallback((()=>{const n={context:d.uR};t({variables:n}).catch((t=>{var n,i;e.error((n=`Error was encountered while trying to remove custom emergency address. [message=${t&&t.message}]`,`[e911][EmergencyLocationSettings]${(i="removeCustomEmergencyAddress")?`[${i}]`:""} ${n}`))}))}),[e,t]),c=(e,t,n,a,r,l,c,m)=>{const u=[];if(e.editable&&"LIS"!==e.type){const s="Manual"===e.type||"Assist"===e.type,g="None"===e.type?d.lk:d.a1;if(!n||"CLS"!==e.type){const t="None"===e.type?m.stringTranslate("calling","add_address"):m.stringTranslate("calling","edit_address"),n="None"===e.type?m.stringTranslate("calling","add_address_aria_label"):m.stringTranslate("calling","edit_address_aria_label"),d="None"===e.type?o.o5:o.F4;a&&"None"!==e.type&&!1!==s||u.push({key:g,"data-tid":g,content:(0,i.Y)(d,{displayName:t,customAriaLabel:n}),onClick:e=>{r(),e.stopPropagation()}})}"CLS"===e.type&&u.push({key:d.We,"data-tid":d.We,content:(0,i.Y)(o.rA,{displayName:m.stringTranslate("calling","verify_address"),customAriaLabel:m.stringTranslate("calling","verify_address_aria_label")}),onClick:e=>{n?r():l(),e.stopPropagation()}}),((e,t,n,i,a)=>{e&&t&&a.push({key:d.gU,"data-tid":d.gU,content:(0,o.Sw)({displayName:i.stringTranslate("calling","remove_custom_address"),customAriaLabel:i.stringTranslate("calling","remove_custom_address_aria_label")}),onClick:e=>{n(),e.stopPropagation()}})})(t,s,c,m,u)}else{const t="LIS"===e.type?m.stringTranslate("calling","work_location"):m.stringTranslate("calling","location_not_editable");u.push({key:d.XD,"data-tid":d.XD,content:(0,i.Y)(s.B,{displayName:t,isSelected:!1}),disabled:!0})}return u},m=e=>(0,i.Y)(r.K,{displayName:e.stringTranslate("calling","current_emergency_location"),id:d.yG}),u=(e,t,n,i)=>{e({...d.lp,moduleName:t,actionGesture:n,actionOutcome:i})},g=e=>!!e&&("None"===e.type&&!0===e.editable||"CLS"===e.type)},676209:(e,t,n)=>{n.d(t,{B:()=>l});var i=n(957032),a=n(302983),o=n(828078),s=n(301173),r=n(230080);const d=(0,n(391567).O)({icon:{qb2dma:"fpydfdc",Frg6f3:["fcgxt0o","f1ujusj6"]},text:{t21cq0:["f1l2akhw","ff3wqvv"]}}),l=({isSelected:e,displayName:t,isTextTruncated:n})=>{const l=d();return(0,i.Y)(a.m,{content:t,relationship:"label",children:(0,i.Y)(o.s,{fill:!0,children:[(0,i.Y)(s.D,{className:l.text,truncate:n,wrap:!1,children:t}),e&&(0,i.Y)(r.MGO,{className:l.icon})]})})}},552222:(e,t,n)=>{n.d(t,{K:()=>s});var i=n(957032),a=n(301173);const o=(0,n(391567).O)({text:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fwkd1rq"}}),s=({displayName:e,id:t})=>{const n=o();return(0,i.Y)(a.D,{weight:"bold",size:"small",id:t,className:n.text,children:e})}},386554:(e,t,n)=>{n.d(t,{o5:()=>l,rA:()=>c,F4:()=>m,eK:()=>u,Sw:()=>g});var i=n(957032),a=n(828078),o=n(301173);const s=(0,n(391567).O)({icon:{qb2dma:"f7nlbp4",Be2twd7:"fod5ikn",t21cq0:["fv2wh3g","f1daddc4"]}}),r=({displayName:e,customAriaLabel:t,IconType:n})=>{const r=s();return(0,i.Y)(a.s,{fill:!0,children:[(0,i.Y)(n,{className:r.icon}),(0,i.Y)(o.D,{"aria-label":t,children:e})]})};var d=n(230080);const l=e=>(0,i.Y)(r,{...e,IconType:d.OMN}),c=e=>(0,i.Y)(r,{...e,IconType:d.MGO}),m=e=>(0,i.Y)(r,{...e,IconType:d.ffu}),u=e=>(0,i.Y)(r,{...e,IconType:d.wB_}),g=e=>(0,i.Y)(r,{...e,IconType:d.aZn})},6215:(e,t,n)=>{n.d(t,{f:()=>i});const i=()=>null},545647:(e,t,n)=>{n.d(t,{MM:()=>s,Rk:()=>r,pp:()=>d});var i=n(754255),a=n(735652);const o=({ageGroup:e,enableUnderAgeOfConsentPolicy:t})=>!!t&&("MinorWithMsaParentalConsent"===e||"MinorWithoutMsaParentalConsent"===e||"MinorNoMsaParentalConsentRequired"===e||"MinorWithoutParentalConsent"===e||"MinorWithParentalConsent"===e||"MinorNoParentalConsentRequired"===e),s=e=>{const{ageGroup:t,enableUnderAgeOfConsentPolicy:n}=e.get(i.w.AgeConsent);return o({ageGroup:t,enableUnderAgeOfConsentPolicy:n})},r=()=>{const{ageGroup:e,enableUnderAgeOfConsentPolicy:t}=(0,a.w2)(i.w.AgeConsent,["ageGroup","enableUnderAgeOfConsentPolicy"]);return o({ageGroup:e,enableUnderAgeOfConsentPolicy:t})},d=e=>{const{disableGiphyForUnderAgeUser:t}=e.get(i.w.AgeConsent);return s(e)&&!!t}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/129927-c6918cf6fe042dc6.js.map