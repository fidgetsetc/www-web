"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[956627],{476951:(e,t,n)=>{n.d(t,{k:()=>i});const i=(0,n(391567).O)({root:{Biw2w6l:"f2qiecf"}})},921103:(e,t,n)=>{var i,a,o,r,s,l;n.d(t,{pI:()=>i,$f:()=>a,yG:()=>o,Up:()=>s,D6:()=>l}),function(e){e.ExpandTab="expandTab",e.UndoExpandTab="undoExpandTab",e.MaximizeTab="maximizeTab",e.UndoMaximizeTab="undoMaximizeTab",e.WindowInitialized="windowInitialized",e.WindowErrored="windowErrored",e.GetAadToken="aadGetToken",e.Login="login",e.GetDriveItemResponse="getDriveItemResponse",e.GetAadCurrentUser="aadCurrentUser",e.AadClearCacheForResource="aadClearCache",e.GetStateData="getStateData",e.TriggerAutoBrb="triggerAutoBrb",e.ShouldShowChatNotification="shouldShowChatNotification",e.GetLeaks="getLeaks",e.GetMemory="getMemory",e.UpdateWindowState="updateWindowState",e.AppStateSyncMessage="appStateSyncMessage",e.CentralDataLayerRequest="centralDataLayer:request",e.CentralDataLayerResponse="centralDataLayer:response",e.ScreenSharingControlMessage="screenSharing:controlMessage",e.HideFileViewerLoader="hideFileViewerLoader",e.StopDocStageScenario="stopDocStageScenario",e.AddScenarioMarker="addScenarioMarker",e.FilesExperienceSendData="filesExperience:sendData",e.FilesExperienceRequestData="filesExperience:requestData",e.ActivityEvent="activityEvent",e.GetWindowLaunchSubSteps="getWindowLaunchSubSteps",e.CreateWebview="createWebview",e.UnhandledMouseEvent="unhandledMouseEvent",e.GetHeartbeat="getHeartbeat",e.GetApolloCacheStats="getApolloCacheStats",e.GetCdlStats="getCdlStats",e.GetWindowEntityTypeStats="getWindowEntityTypeStats",e.SetTouchBar="set-touch-bar",e.ClearTouchBar="clear-touch-bar",e.LayoutChangeMessage="layoutChangeMessage",e.UnhandledShortcut="unhandledShortcut",e.NavigateToOpenerLandmark="NavigateToOpenerLandmark",e.NavigateToLandmark="NavigateToLandmark",e.HybridRouteNavigation="hybridRouteNavigation",e.FocusManagementEvent="focusManagementEvent",e.FocusResetEvent="focusResetEvent",e.CdlRegistration="cdlRegistration",e.NotificationBannerUpdate="NotificationBannerUpdate",e.ActivateOutlook="activateOutlook",e.RequestTabMetrics="requestTabMetrics",e.SendWebviewIdentity="sendWebviewIdentity",e.HasDevicePermissions="hasDevicePermissions",e.HasDevicePermissionsCallback="hasDevicePermissionsCallback"}(i||(i={})),function(e){e.GlobalWindowError="error",e.UnhandledRejection="unhandledrejection"}(a||(a={})),function(e){e.Create="createIframe",e.Destroy="destroyIframe",e.ChildReady="iframeReady",e.Acquired="iframeAcquired",e.ToggleMinimized="toggleChatMinimize"}(o||(o={})),function(e){e.ConversationOpened="conversationOpened",e.CreateNewConversation="createNewConversation",e.EmbedClientInitializationSuccess="embedClientInitializationSuccess",e.EmbedClientInitializationFail="embedClientInitializationFail",e.NewConversationResolved="newConversationResolved",e.SetFocusOnChatList="setFocusOnChatList",e.UpdateSettings="UpdateSettings",e.ShowCoreIFrame="ShowCoreIFrame",e.HideCoreIFrame="HideCoreIFrame",e.TeamsPreAuthComplete="teamsPreAuthComplete",e.ContinueWithTeamsCoreTasks="continueWithTeamsCoreTasks"}(r||(r={})),function(e){e.LogoutSuccess="logoutSuccessful",e.LogoutFailed="logoutFailed",e.Logout="logout"}(s||(s={})),function(e){e.TrustedUIInit="trusted-ui:init",e.TrustedUIResize="trusted-ui:resize",e.TrustedUIRendered="trusted-ui:rendered",e.TrustedUIError="trusted-ui:error",e.TrustedUIShortcut="trusted-ui:shortcut",e.TrustedUINovaEvent="trusted-ui:novaevent",e.TrustedUIFocusEvent="trusted-ui:focus"}(l||(l={}))},501790:(e,t,n)=>{n.d(t,{Xp:()=>r,AX:()=>s,q0:()=>l,WD:()=>d,Tp:()=>c});var i=n(572909),a=n(287572),o=n(668625);function r(e,t){return{entity:{type:i.ck.chats,action:i.SY.create,id:s(e)},command:t}}function s(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function l(e,t,n,i){let a={};if(!e)return a;if(e.type===t&&e.action===n){const t=e.options;if(t&&"string"==typeof t)try{a=JSON.parse(t)}catch{i.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${String(t)}.`)}}else i.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${String(e.type)} != ${String(t)} or ${String(e.action)} != ${String(n)}`);return a}const d=e=>`${e.substring(0,32)}00000000${e.substring(40)}`,c=(e,t,n,i,r)=>{let s=`${a.Hr}-${n}`;if(i){const t=e.getApp({entityType:i})?.manifest.id;s=t?`${a.Hr}-${t}-${i}`:s}const l=t.get((0,a.up)(s,r),"Experience"),d=l?(0,o.j)(l):null;return d?.mainEntity}},983959:(e,t,n)=>{n.d(t,{BK:()=>o,PQ:()=>r,wX:()=>a});var i=n(67309);const a={parseFileLabelQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query parseFileLabelFromUrl($input:ParseFileLabelFromUrlInput!) {parseFileLabelFromUrl(input:$input) {fileLabel {fullUrl,objectUrl,threadId,linktype}}}");return delete this.definitions,this.definitions=e.definitions}},fileDetailsForChicletQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query fileDetailsForChiclet($input:FileDetailsForChicletInput!) {fileDetailsForChiclet(input:$input) {fileDetails {title,fileId,objectUrl,type,baseUrl,shareUrl,shareId,fileSourceDetail {fileSource,permissionScope},sharepointIds {listId,listItemUniqueId,siteId,webId,siteUrl},publication {level,versionId},site {dataLocationCode,template {id}}}}}");return delete this.definitions,this.definitions=e.definitions}},fetchShareInfoQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query fetchShareInfo($redeemFileInput:RedeemFileInput!,$shouldReturnError:Boolean) {redeemFile(redeemFileInput:$redeemFileInput,shouldReturnError:$shouldReturnError) {id,fileType,downloadUrl,webDavUrl,sharepointIds {siteUrl},name,error {code,context,redeemErrorReason {logErrorMessage,httpCode,internalErrorCode,correlationId,isExpected}},currentUserRole {blocksDownload},parentReference {id,driveId}}}");return delete this.definitions,this.definitions=e.definitions}},fetchFileUploadRedeemInfoQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query DataClientFilesFileUploadRedeemInfoQuery($redeemFileInput:RedeemFileInput!) {fileUploadRedeemInfo(redeemFileInput:$redeemFileInput) {id,fileType,downloadUrl,webDavUrl,sharepointIds {siteUrl,listId,listItemUniqueId,siteId,webId},publication {level,versionId},site {dataLocationCode,template {id}}}}");return delete this.definitions,this.definitions=e.definitions}},currentFilesQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query getFiles($fileContainerId:ID!) {currentFiles(fileContainerId:$fileContainerId) {id,itemId,title,status,type,progress,baseUrl,isReferencedFile,objectUrl,baseUrl,fileId,previewUrl,previewHeight,previewWidth,shareUrl,shareId,state,progressComplete,permissionScope,hasUploadFailed,serviceName,context,chicletBreadcrumbs {sourceTeamName,sourceChannelName},externalFileShareInfo,sharepointIds {listId,listItemUniqueId,siteId,webId,siteUrl},publication {level,versionId},site {dataLocationCode,template {id}}}}");return delete this.definitions,this.definitions=e.definitions}},userPreferencesQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query userPreferences {userPreferences {userPersonalSettings {filesSettings {fileOpenPreference,nonFileOpenPreferenceSelectedCount,safeDomainsList,teamsFileOpenPreferenceLastEditedTime}}}}");return delete this.definitions,this.definitions=e.definitions}},fileShareDialogAudience:{kind:"Document",get definitions(){const e=(0,i.G)("query shareDialogAudience($shareDialogAudienceInput:ShareDialogAudienceInput!) {shareDialogAudience(shareDialogAudienceInput:$shareDialogAudienceInput) {recipients,audienceConfig {entityName,audienceType}}}");return delete this.definitions,this.definitions=e.definitions}},fileDetailsByIdQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query fileDetailsById($redeemFileByIdInput:RedeemFileByIdInput!,$shouldReturnError:Boolean) {redeemFileById(redeemFileByIdInput:$redeemFileByIdInput,shouldReturnError:$shouldReturnError) {id,fileType,downloadUrl,webDavUrl,name,error {code,context,redeemErrorReason {logErrorMessage,httpCode,internalErrorCode,correlationId,isExpected}}}}");return delete this.definitions,this.definitions=e.definitions}},fileDetailsWithSharepointIdQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query fileDetailsWithSharepointId($fileDetailsWithSharepointIdInput:FileDetailsWithSharepointIdInput!) {fileDetailsWithSharepointId(fileDetailsWithSharepointIdInput:$fileDetailsWithSharepointIdInput) {fileType,webDavUrl,sharepointIds {listItemUniqueId}}}");return delete this.definitions,this.definitions=e.definitions}},fileDetailsForThumbnailQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query DataClientFilesFileRedeemThumbnailQuery($redeemFileInput:RedeemFileInput!) {fileDetailsForThumbnail(redeemFileInput:$redeemFileInput) {id,webUrl,size,eTag,webDavUrl,downloadUrl,odataContext,name,parentReference {driveId,driveType,id,path},cTag,sharepointIds {listId,listItemId,listItemUniqueId,siteId,siteUrl,syncResourceId,tenantId,webId},currentUserRole {allowEdit,blocksDownload,readOnly},thumbnails {id,small {height,url,width},medium {height,url,width},large {height,url,width}},file {mimeType,irmEnabled},fileSystemInfo {createdDateTime,lastModifiedDateTime},shared {effectiveRoles,scope}}}");return delete this.definitions,this.definitions=e.definitions}},openInDesktopAsDeviceSpecificFileOpenPreferenceQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query openInDesktopAsDeviceSpecificFileOpenPreference {openInDesktopAsDeviceSpecificFileOpenPreference {isDesktopSetAsDefaultFileOpenPreference}}");return delete this.definitions,this.definitions=e.definitions}},filesThumbnailContentQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query DataClientFilesFilesThumbnailBlobContentQuery($id:ID!,$fileRedeemInput:FileRedeemInputForThumbnail!,$thumbnailBlobInfoInput:ThumbnailBlobInfoInput,$latestThumbnailOnly:Boolean,$fileType:String) {thumbnailBlobObject(id:$id,fileRedeemInput:$fileRedeemInput,thumbnailBlobInfoInput:$thumbnailBlobInfoInput,latestThumbnailOnly:$latestThumbnailOnly,fileType:$fileType) {id,blobUrl,isContentFetchSuccessful,fetchResult,errorSubTypeParam {errorCode,errorType,errorSource}}}");return delete this.definitions,this.definitions=e.definitions}},filesThumbnailContentViaEncodedUrlQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query DataClientFilesThumbnailBlobContentViaEncodedUrlQuery($siteUrl:String!,$encodedUrl:String!,$doRedeem:Boolean,$latestThumbnailOnly:Boolean,$fileType:String) {thumbnailBlobObjectViaEncodedUrl(siteUrl:$siteUrl,encodedUrl:$encodedUrl,doRedeem:$doRedeem,latestThumbnailOnly:$latestThumbnailOnly,fileType:$fileType) {id,blobUrl,isContentFetchSuccessful,fetchResult,errorSubTypeParam {errorCode,errorType,errorSource}}}");return delete this.definitions,this.definitions=e.definitions}},thirdPartyFileDTOQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query DataClientFilesThirdPartyDtoQuery($fileContainerId:ID!) {thirdPartyFileDTO(fileContainerId:$fileContainerId) {name,blobUrl,lastModifiedInfo,size,fileType}}");return delete this.definitions,this.definitions=e.definitions}}},o={fileDownloadDetailsUsingItemDetailsServiceQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query fileDownloadDetailsUsingItemDetailsService($input:ItemDetailsServiceInput!,$shouldReturnError:Boolean) {fileDownloadDetailsUsingItemDetailsService(input:$input,shouldReturnError:$shouldReturnError) {id,fileType,downloadUrl,webDavUrl,name,restricted {restrictionType},error {code,context,redeemErrorReason {logErrorMessage,httpCode,internalErrorCode,correlationId,isExpected}}}}");return delete this.definitions,this.definitions=e.definitions}},fileDownloadDetailsUsingLegacyVroomServiceQuery:{kind:"Document",get definitions(){const e=(0,i.G)("query fileDownloadDetailsUsingLegacyVroomService($input:LegacyVroomServiceInput!) {fileDownloadDetailsUsingLegacyVroomService(input:$input) {fileType,downloadUrl}}");return delete this.definitions,this.definitions=e.definitions}}},r={downloadFileMutation:{kind:"Document",get definitions(){const e=(0,i.G)("mutation downloadFile($downloadUrl:String!,$authToken:String) {downloadFile(downloadUrl:$downloadUrl,authToken:$authToken) {downloadUrl}}");return delete this.definitions,this.definitions=e.definitions}}}},249649:(e,t,n)=>{n.d(t,{r:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query messageToParentResult($appId:ID!) {messageToParentResult(appId:$appId) @client {appId,message}}");return delete this.definitions,this.definitions=e.definitions}}},606855:(e,t,n)=>{n.d(t,{m:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query taskModuleResult {taskModuleResult @client {card {appIcon,appId,appName,content,contentType,locale},adaptiveCardTabResult {appIcon,appId,appName,content,contentType,locale},text,taskModuleId,draftId,conversationId,reason,entryPoint,entityType}}");return delete this.definitions,this.definitions=e.definitions}}},757010:(e,t,n)=>{n.d(t,{F:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment meetingInformationFields on MeetingInformation {id,iCalUid,scenario,meetingJoinUrl,meetingType,meetingData {meetingCode,passcode,meetingUrl},isCancelled,startTime,endTime,eventType,isRecurring,organizerId,tenantId,eventRecurrenceRange {startDate,endDate},eventRecurrencePattern {patternType,daily {interval},weekly {daysOfTheWeek,interval},monthly {dayOfMonth,interval},relativeMonthly {dayOfTheWeekIndex,dayOfTheWeek,interval},yearly {month,dayOfTheMonth},relativeYearly {month,dayOfTheWeekIndex,dayOfTheWeek}},resolvedSensitivityLabelId,isCopyRestrictionEnforced,templateDetails {id},messagingPolicy {textOnlyChat},exchangeDetails {substrateGroupId},lobbyThreadId}");return delete this.definitions,this.definitions=e.definitions}}},983292:(e,t,n)=>{n.d(t,{nv:()=>o,JT:()=>r,iO:()=>s});var i=n(754255),a=n(99425);const o=e=>e.get(i.w.Auth).buildCloud,r=(e,t)=>{const n=t?.get(i.w.Auth).cloudDomainMap;if(!n)return;const o=n.find((t=>t.domain===e))?.cloud;return o?a.el[o]:void 0},s=(e,t,n)=>{const a=t?.get(i.w.Auth).cloudDomainMap;if(!a||!e)return"";const o=a.find((t=>t.cloud===e))?.domain;return o?n?`https://${o}/`:`https://${o}/v2/`:""}},257237:(e,t,n)=>{n.d(t,{Qi:()=>l,TD:()=>d,wM:()=>p,vt:()=>u,q4:()=>m,Ru:()=>h,BY:()=>f,JU:()=>I,wX:()=>_,HR:()=>C,kR:()=>v,$E:()=>y,j8:()=>w});var i=n(850434),a=n(199448),o=n(480354),r=n(201973);const s="ParsingMeetingUrl",l=e=>{const t=decodeURIComponent(e),n=new RegExp("context=(.*)$","g").exec(t);if(!n||n.length<2)throw c(`Meeting context is not in valid format ${t}`);const i=JSON.parse(n[1]);if(!i||!i.Tid||!i.Oid)throw c("Meeting url is malformed Tid or Oid is missing");return{tenantId:i.Tid,organizerId:i.Oid}},d=e=>e.context===s&&e.code===i.O4.ErrorParsingQueryParams,c=e=>(0,a.$5)(s,i.O4.ErrorParsingQueryParams,"",void 0,e),p=(e,t)=>{const n="meet",o="meetup-join",l=new URL(e);let d;if(l.pathname.includes(n)||l.pathname.includes(o))d=l;else{if(!l.hash||!l.hash.includes(n)&&!l.hash.includes(o))throw c("Invalid URL - unsupported URL format");d=new URL(l.hash.substring(1),l.origin)}const p=t?Object.values(r.Y.allowedCloudDomains).find((e=>e===d.hostname)):d.hostname;if(!p)throw(0,a.$5)(s,i.O4.InvalidCloudDomain,"",void 0,"Invalid cloud domain.");const u=d.searchParams,m=d.pathname.split("/"),h={isLegacyUrl:!1,meetingCloud:p,meetingUrl:e};if(m[2]===o){const e=u.get("context");if(5!==m.length||!e)throw c("Invalid URL - context param is missing");h.threadId=decodeURIComponent(m[3]),h.messageId=decodeURIComponent(m[4]);try{const t=JSON.parse(decodeURIComponent(e));if(!t.Tid||!t.Oid)throw c("Invalid URL - context param is invalid. Tid or Oid missing.");h.tenantId=t.Tid,h.organizerId=t.Oid,h.isBroadcastMeeting=t.IsBroadcastMeeting||void 0,h.attendeeRole=t.role||void 0,h.replyChainMessageId=t.MessageId||void 0,h.isLegacyUrl=!0}catch(t){const n=/\{\"Tid\":\"([\w\-]{36})\",\"Oid\":\"([\w\-]{36})\",\"IsBr/,i=3,a=decodeURIComponent(e).match(n);if(a?.length!==i)throw t;{const e=1,t=2;h.tenantId=a[e],h.organizerId=a[t],h.isBroadcastMeeting=!0,h.attendeeRole=void 0,h.replyChainMessageId=void 0,h.isLegacyUrl=!0}}}else{if(m[1]!==n)throw c("Invalid URL - unsupported URL format");h.meetingId=m[2],h.passCode=u.get("p")||void 0}return h},u=(e,t,n,i,a,r)=>{const s=p(e,r),l=(0,o.isEmpty)(i)?"calendar_join_meeting_utils":i;let d;return s.isLegacyUrl?(t.mark("cal_join_executing_legacy_url_flow"),d={type:"Meeting",joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:n},context:l},coordinates:{legacyMeeting:{meetingCloud:s.meetingCloud,conversationId:s.threadId||"",rootMessageId:s.messageId||"",messageId:s.replyChainMessageId||s.messageId||"",isChannel:"0"!==s.messageId,isAdhoc:!1,tenantId:s.tenantId||"",organizerId:s.organizerId||"",broadcast:s.isBroadcastMeeting?{role:a??"None"}:null}}}):(t.mark("cal_join_executing_non_legacy_url_flow"),d={type:"Meeting",joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:n},context:l},coordinates:{meetingData:{meetingUrl:e}}}),d},m=(e,t)=>e&&e!==r.Y.tflConstants.consumerTenantId&&(t===r.Y.allowedCloudDomains.liveCloud||t===r.Y.allowedCloudDomains.devLive),h=(e,t,n)=>{try{const i=new URL(e).hostname;return m(t,i)&&n?.errorToTelemetry?.(`Expect TFW got TFL: ${e}`,"cmd_meeting_join_missing_data",void 0,!1),i}catch(i){const a=e.split("/")?.[2]?.split("@")?.pop()?.split(":").shift()||"";return m(t,a)&&n?.errorToTelemetry?.(`Expect TFW got TFL parsing ${e}`,"cmd_meeting_join_missing_data",void 0,!1),a}},f=(e,t=!1)=>{let n=!1;if(e&&e.skypeTeamsDataObj){n=1===e.skypeTeamsDataObj.type||g(e,!!t)}return n},g=(e,t)=>{if(!e?.skypeTeamsMeetingUrl||!t)return!1;const n=new URL(e.skypeTeamsMeetingUrl),i=new URLSearchParams(n.search).get("context");if(!i)return!1;try{const{IsBroadcastMeeting:e}=JSON.parse(i);return!!e}catch(e){return i.includes("IsBroadcastMeeting")}};function I(e){return!(!e||!e.skypeTeamsDataObj||(0,o.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}function _(e){return"Group"===e?.mailboxType}const C=e=>!!e.webinarRegistration?.webinarId,v=e=>!!e.virtualEventsData?.eventId,y=e=>{try{return"meet"===new URL(e).pathname.split("/")[1]}catch(e){return!1}},w=(e,t,n,i)=>e&&t&&(n||!1!==i)},201973:(e,t,n)=>{n.d(t,{Y:()=>i});const i={allowedCloudDomains:{publicCommercialCloud:"teams.microsoft.com",gccHighCloud:"gov.teams.microsoft.us",dodCloud:"dod.teams.microsoft.us",dev:"local.teams.office.com",devLive:"local.teams.live.com",liveCloud:"teams.live.com",ag08Cloud:"teams.eaglex.ic.gov",ag09Cloud:"teams.microsoft.scloud",gallatinCloud:"teams.microsoftonline.cn"},tflConstants:{consumerTenantId:"9188040d-6c67-4c5b-b112-36a304b66dad"}}},740875:(e,t,n)=>{n.d(t,{dz:()=>l,cd:()=>d,BD:()=>c,bo:()=>p,iy:()=>u,cF:()=>m,$f:()=>h,Cd:()=>f,sB:()=>g,t5:()=>I,iX:()=>_,lO:()=>C,k5:()=>v});var i=n(45153),a=n(141685),o=n(754255),r=n(257237),s=n(983292);const l=i.d,d=i.t.isLegacyMeetingUrl,c=i.t.isMeetingUrl,p=i.t.isTFLMeetingURL,u=i.t.getMeetingLegacyURL,m=(e,t)=>{const{enableIsTfwCloud:n}=t.get(o.w.Calling);return n?i.t.isTFWCloud((0,s.JT)(e,t)):i.t.isTFWDomain(e)},h=(e,t)=>{if(t){const n=(0,s.JT)(new URL(t).host,e);return!!n&&n!==(0,s.nv)(e)&&!g(t,e)}return!1},f=(e,t,n)=>{try{const a=(0,s.JT)(t,e),o=n?(0,s.JT)(n,e):(0,s.nv)(e),r=i.t.isInteropJoinAttemptBetweenTFLAndTFW(o,a);return!!a&&!!o&&a!==o&&!r}catch{return!1}},g=(e,t)=>{const{deepLinkDomain:n,enableMeetingBetweenTFWAndTFL:a,enableCrossCloudDetectionBasedOnLoggedInUserProps:r}=t.get(o.w.Calling);if(!r)return i.t.isDeepLinkExecutionForCrossCloudMeetingJoinBetweenTFLAndTFWAllowed(n||"",e,!!a);try{const o=new URL(e).hostname,r=(0,s.JT)(o,t),l=new URL(n||"").hostname,d=(0,s.JT)(l||"",t);return i.t.isMeetingUrl(e)&&i.t.isInteropJoinAttemptBetweenTFLAndTFW(d,r)&&!!a}catch(e){return!1}},I=e=>({coordinates:{meetingData:{instantMeetingOptions:void 0,isAdhoc:!0}},joinOptions:{outgoingVideo:!0,outgoingAudio:!0,context:"WatchParty",meeting:{deeplinkId:e,isWatchParty:!0,showPrejoin:!0}},type:"Meeting"}),_=(e,t,n,i,o,r,s,l,d,c,p,u)=>{let m;if((0,a.KX)(e)){const{conversationId:t,messageId:n,rootMessageId:i,isChannel:a,isAdhoc:o,tenantId:r,organizerId:s,meetingCloud:l,registration:d,participantPin:c,broadcast:p}=e;m={legacyMeeting:{conversationId:t,messageId:n,rootMessageId:i,isChannel:a,isAdhoc:o,tenantId:r,organizerId:s,meetingCloud:l,registration:d,broadcast:p,participantPin:c}}}else{const{meetingCode:t,passcode:n,meetingUrl:i}=e.meetingData,{isAdhoc:a,meetingCloud:o}=e;m={meetingData:{participantPin:e?.participantPin,meetingCode:t,passcode:n,meetingUrl:i,isAdhoc:a,meetingCloud:o}}}return{coordinates:m,joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:r||"DeepLink",meeting:{deeplinkId:t,showPrejoin:!0,isPSTN:!1,homeCloud:i,correlationId:o,launchAgent:s,laEntry:l,laExpId:d,isColdDeeplinkJoin:n,deeplinkEntityId:p,title:u}},scenarioCorrelationId:c,type:"Meeting"}},C=(e,t,n,i,a,o=!0)=>({coordinates:{legacyMeeting:{conversationId:n,messageId:i,rootMessageId:"",isChannel:!1,isAdhoc:!1,tenantId:e,organizerId:t,meetingCloud:"",broadcast:null,registration:a?{participantRegistrationId:a,isPublic:!0}:null,instantMeetingOptions:null}},joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"Meeting EmbedLink",meeting:{showPrejoin:o,isPSTN:!1,skipGUM:!0}},type:"Meeting"}),v=e=>{e=e.replace("v2/?meetingjoin=true#/","").replace("v2/#/","");let t;if(c(e))try{const n=(0,r.wM)(e);t=n.isLegacyUrl?n.threadId:n.meetingId}catch{return}return t}},369664:(e,t,n)=>{function i(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}n.d(t,{a:()=>i})},287572:(e,t,n)=>{n.d(t,{Hr:()=>i,jE:()=>a,eW:()=>o,E:()=>r,up:()=>s});const i="appActiveEntitiesHistory",a="mainWindowNavHistory",o="mainWindowNavHistoryIndex",r=e=>{const t=["mainWindowNavHistory","mainWindowNavHistoryIndex"];return e&&t.push(`${e}-mainWindowNavHistory`,`${e}-mainWindowNavHistoryIndex`),t},s=(e,t)=>`${t?`${t}-`:""}${e}`},231758:(e,t,n)=>{n.d(t,{RB:()=>r,ip:()=>s,vN:()=>l,SR:()=>d,jK:()=>c,WG:()=>p,Vz:()=>u});var i=n(754255),a=n(691650),o=n(884542);function r(e){if(""===e)return null;const t=(0,o.Yn)("entity",a.l.Help,"training");return(0,o.jT)(e,t)}function s(e,t,n,i,a,r,s){const l=new URLSearchParams({source:n});return i&&l.append("sharedAppResource",i),a&&l.append("templateInstanceId",a),r&&l.append("environment",r),s&&l.append("titleId",s),(0,o.jT)(e,`app/${t}`,l.toString())}function l(e,t,n,i,a,o,r){const s=new URLSearchParams;return!t||a||i||o||r||s.append("appId",t),t&&"MOS3"===r&&s.append("titleId",t),i&&s.append("templatedAppId",i),a&&s.append("templateInstanceId",a),o&&s.append("environment",o),n&&s.append("source",n),`${e}?${s.toString()}`}function d(e,t,n,i,a){if(!(e&&t&&n&&i))return"";const r=new URLSearchParams({templateInstanceId:n,environment:i,source:a});return(0,o.jT)(e,`app/${t}`,r.toString())}function c(e,t,n){return e&&t&&void 0!==n?(0,o.jT)(e,"marketplace",`deviceId=${t}&isTeamsRoomDevice=${n}`):""}function p(e,t){const{harmonyAppUrlRegex:n,enableHarmonyDeeplinkConversion:a}=t.get(i.w.Extensibility);return!(!n||!a)&&new RegExp(n).test(e)}function u(e,t,n){const{harmonyAppUrlRegex:a,enableHarmonyDeeplinkConversion:r,enableViralSharingLinkUnfurlingAndShortening:l}=n.get(i.w.Extensibility);if(!a||!r)return e;let d=e.replace(/&amp;/g,"&");const c=new RegExp(a),p=d.match(c);if(!p)return e;const u=new URLSearchParams(p[1]),m=u.get("templatedAppId")||"",h=u.get("templateInstanceId")||"",f=u.get("environment")||"",g=l&&u.get("titleId")||"",I=u.get("source")||(g?"biz-chat":"");return d=s((0,o.aE)(t),m,I,void 0,h,f,g),d}},103155:(e,t,n)=>{n.d(t,{u8:()=>d,qL:()=>c,VC:()=>f,ai:()=>g});var i=n(754255),a=n(702183),o=n(131647);const r=["msteams:","ms-teams:"],s=36,l=["/l/esp/whats-new-content","/l/esp/teams-insider"];function d(e,t,n=!1){const{deepLinkDomains:a,deepLinkPaths:o,supportHashDeeplinks:r}=t.get(i.w.Messaging),s=n?[""]:o||[];let l=a||[];return n||(l=l.concat(function(e){const{enableCrossCloudLaunch:t}=e.get(i.w.Core);if(!t)return[];const n=e?.get(i.w.Auth).cloudDomainMap;if(!n)return[];const a=n.map((e=>`https://${e.domain}`));return a}(t))),h({url:e,deepLinkDomains:l,deepLinkPaths:s,supportHashDeeplinks:!!r,coreSettings:t})}function c(e,t){if(r.includes(e.protocol)){const n=t.get(i.w.Host).deepLinkDomain||void 0,a=p(e,t)||n;return new URL(`${e.pathname}${e.search}${e.hash}`,a)}return e}const p=(e,t)=>{const{enableOriginValidationForIncomingIntents:n}=t.get(i.w.Core);if(!n||"null"!==e.origin)return e.origin;if(!r.includes(e.protocol))return;const a=e.searchParams.get("fqdn");return a?new URL(`https://${a}`).origin:"null"===e.origin&&e.hostname?new URL(`https://${e.hostname}`).origin:void 0},u=(e,t,n,i)=>{const a=p(e,i);return!(a&&a!==t.origin||!e.pathname.startsWith(n))},m=(e,t,n)=>{const i=p(e,n);return!(i&&i!==t.origin||!e.hash||"/_"!==e.pathname)},h=({url:e,deepLinkDomains:t,deepLinkPaths:n,supportHashDeeplinks:i,coreSettings:a})=>{for(const o of t)for(const t of n){let n,r;try{n=new URL(e),r=new URL(t,o)}catch(e){return!1}if(u(n,r,t,a))return!0;if(i&&m(n,r,a))return!0}return!1};function f(e){return e?.slice(0,s)??null}function g(e,t){e.scenarioName===a.Cu.ActivitySwitch&&e.source===o.p.ActivityFeedBellClick&&l.includes(t)&&(e.scenarioName=a.Cu.NavigationCommand)}},92118:(e,t,n)=>{n.d(t,{q:()=>i});const i=(e,t)=>{if(e&&t){const t=/^(.*); expires=(.*); path=\/(; (.*))?$/,n=2,i=e.match(t);if(i){return new Date(i[n]).getTime()>Date.now()}}return!1}},625730:(e,t,n)=>{n.d(t,{Id:()=>i,JL:()=>a,hV:()=>o,rm:()=>r,w7:()=>s,a$:()=>l});const i={filePickerSource:{upload_from_pc:"upload_from_pc",share_from_odb:{key:"share_from_odb",sourceName:"OneDrive",icon:"fluent-onedrive"}},telemetry:{errorCodes:{messageSentBeforeSyncLinkConversion:"MessageAlreadySent",asyncLinkConversionPretransformFailure:"PretransformRuntimeError",asyncLinkMultiplePretransform:"MultiplePretransform",fileSharingErrorBoundaryError:"FileSharingErrorBoundaryError",asyncImportFailed:"AsyncImportFailed",pickerLocaleLoadFailed:"PickerLocaleLoadFailed",itemsViewStringsNotPresentInWindow:"ItemsViewStringsNotPresentInWindow",siteInfoError:"SiteInfoError"},errors:{messageSentBeforeLinkConversion:"message_sent_before_link_conversion"},markers:{auth_token_call_start:"auth_token_call_start",auth_token_received:"auth_token_received",auth_token_empty:"auth_token_empty",auth_token_requested_with_claims_challenge:"auth_token_requested_with_claims_challenge",super_picker_initialisation_auth_token_start:"super_picker_initialisation_auth_token_start",super_picker_initialisation_auth_token_received:"super_picker_initialisation_auth_token_received",super_picker_render_auth_token_start:"super_picker_render_auth_token_start",super_picker_render_auth_token_end:"super_picker_render_auth_token_end",super_picker_render_third_party_providers:"super_picker_render_third_party_providers",render_third_party_providers_start:"render_third_party_providers_start",render_third_party_providers_end:"render_third_party_providers_end",render_third_party_provider_content_start:"render_third_party_provider_content_start",render_third_party_provider_with_provider_type:"render_third_party_provider_with_provider_type",render_third_party_provider_content_end:"render_third_party_provider_content_end",super_picker_render_auth_token_failed:"super_picker_render_auth_token_failed",auth_token_call_failed:"auth_token_call_failed",claims_challenge_auth_token_call_start:"claims_challenge_auth_token_call_start",claims_challenge_auth_token_received:"claims_challenge_auth_token_received",claims_challenge_auth_token_failed:"claims_challenge_auth_token_failed",claims_challenge_auth_token_empty:"claims_challenge_auth_token_empty",site_info_call_started:"site_info_call_started",site_info_data_received:"site_info_data_received",async_bundle_import_start:"async_bundle_import_start",async_bundle_import_complete:"async_bundle_import_complete",picker_locale_load_start:"locale_load_start",picker_locale_retry:"picker_locale_retry",picker_locale_load_end:"picker_locale_load_end",items_view_strings_loaded_on_host:"items_view_strings_loaded_on_host",items_view_strings_loaded_on_parent:"items_view_strings_loaded_on_parent",filebrowser_prewarm_auth_token_failed:"filebrowser_prewarm_auth_token_failed",filebrowser_prewarm_auth_token_end:"filebrowser_prewarm_auth_token_end",filebrowser_prewarm_auth_token_start:"filebrowser_prewarm_auth_token_start",filebrowser_prewarm_close_post_message:"filebrowser_prewarm_close_post_message",filebrowser_prewarm_auth_post_message:"filebrowser_prewarm_auth_post_message",filebrowser_prewarm_window_creation_successful:"filebrowser_prewarm_window_creation_successful",filebrowser_prewarm_window_creation_failed:"filebrowser_prewarm_window_creation_failed",filebrowser_prewarm_window_removed:"filebrowser_prewarm_window_removed",filebrowser_prewarm_partition_window_removed:"filebrowser_prewarm_partition_window_removed"},reasons:{auth_token_call_failed:"auth_token_call_failed",personal_site_info_query_failed:"personal_site_info_query_failed",personal_site_info_query_empty:"personal_site_info_query_empty",invalid_site_info_data:"invalid_site_info_data",async_bundle_import_fail:"async_bundle_import_fail",picker_locale_load_fail:"picker_locale_load_fail",error_loading_component_package:"error_loading_component_package"}},localeRetries:1,asyncLinkToChicletConversionIdentifier:"unprocessed-filelink",odsp2013IllegalCharsRegex:/[~"#%&*:<>?/\\{|}\r?\n\r]/g,odspM365IllegalCharsRegex:/["*:<>?/\\|\r?\n\r]/g,odspIllegalWordRegex:/_vti_/gi,odspUnsupportedFilenameList:["con","prn","aux","nul","com0","com1","com2","com3","com4","com5","com6","com7","com8","com9","lpt0","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9"],odspUnsupportedFilenameWithExtList:[".lock","desktop.ini"]};var a,o;!function(e){e.Treatment="TEAMS-TREATMENT",e.Control="TEAMS-CONTROL"}(a||(a={})),function(e){e.teamsMaglev="TEAMS-MAGLEV",e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(o||(o={}));const r="Teams";var s,l;!function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(s||(s={})),function(e){e.ODPicker="ODPicker",e.SharePointLink="SharePointLink",e.Slimpicker="Slimpicker",e.Superpicker="Superpicker",e.ConflcitReshare="ConflictResahre"}(l||(l={}))},251680:(e,t,n)=>{n.d(t,{W:()=>r});var i=n(49180);const a=new RegExp(i.vg.oneDriveFile),o=new RegExp(i.vg.sharePointFile),r=(e,t)=>{if(t){const n=t.replace(i.vg.leadingAndTrailingSlashesRegex,"").split("/");n.pop();const a=n.join("/");return`${new URL(e).origin}/${a}/`}if(o.test(e)){const t=e.match(o);return t?t[0]:null}if(a.test(e)){const t=e.match(a);return t?t[0]:null}if(e){const t=e.split("/"),n=2;if(t.length>=n)return`${t[0]}//${t[n]}/`}return e}},609113:(e,t,n)=>{n.d(t,{re:()=>o,uO:()=>r,Af:()=>s,QC:()=>l,rj:()=>d});var i=n(480354),a=n(625730);const o=e=>{if(e){if(-1===e.indexOf("."))return e;{const t=/(.+)\.[^.]+$/.exec(e);if(null==t)return e;{const e=t[1];return void 0!==e?e:""}}}return""},r=e=>{const t=/(\s[1-9]\d*)$/g;let n=1,i=o(e);const a=t.exec(i);if(a){const e=i.search(t);n=parseInt(a[1],10)+1,i=i.substring(0,e)}return`${i} ${n}.${l(e)}`},s=e=>{const t=/\ \(([1-9]\d*)\)$/g;let n=1,i=o(e);const a=t.exec(i);if(a){const e=i.search(t);n=parseInt(a[1],10)+1,i=i.substring(0,e)}return`${i} (${n}).${l(e)}`},l=e=>{const t=new RegExp("(?:\\.([^.]+))?$").exec(e);return(0,i.toLower)(t&&t[1]?t[1]:"")},d=(e,t=-1,n=!0)=>{let i=o(e),a=e.substr(i.length);if(i=m(n,u(i)),a=m(n,u(a)),i&&t>-1&&(i=i.substr(0,t)),c(i))return;const r=a?`${i}${a}`:i;return p(r)?void 0:r},c=e=>!e||a.Id.odspUnsupportedFilenameList.includes(e.toLowerCase()),p=e=>!e||a.Id.odspUnsupportedFilenameWithExtList.includes(e.toLowerCase()),u=e=>e.replace(a.Id.odspIllegalWordRegex,"vti"),m=(e,t)=>t.replace(e?a.Id.odsp2013IllegalCharsRegex:a.Id.odspM365IllegalCharsRegex,"").trim()},763501:(e,t,n)=>{n.d(t,{Jp:()=>a,Dg:()=>o,oZ:()=>r,j9:()=>s,JH:()=>l,Om:()=>d,iC:()=>c,b6:()=>p});var i=n(480354);const a=e=>(0,i.endsWith)(e,".sharepoint.com")||(0,i.endsWith)(e,".sharepoint-df.com"),o=e=>(0,i.endsWith)(e,".microsoftpersonalcontent.com"),r=(e,t)=>{try{return{objectUrl:e.objectUrl&&new URL(e.objectUrl)||void 0,baseUrl:e.baseUrl&&new URL(e.baseUrl)||void 0,shareUrl:e.shareUrl&&new URL(e.shareUrl)||void 0,previewUrl:e.previewUrl&&new URL(e.previewUrl)||void 0}}catch(e){return t?.error(`Error validating file URLs format: ${e}`),!1}},s=e=>{const t=[e.objectUrl,e.baseUrl,e.shareUrl].filter((e=>void 0!==e));return t.every((e=>e.hostname===t[0].hostname))},l=(e,t)=>{const n=[e.objectUrl,e.baseUrl,e.shareUrl,e.previewUrl].filter((e=>void 0!==e));for(const e of n)if(!t.includes(e.protocol))return e;return!0},d=(e,t)=>{const n=e.providerDataV2?.code||void 0;if(n&&t){const e=Object.keys(t);return t.__typename&&e.shift(),e.includes(n)}return!1},c=(e,t,n)=>{const i=[t.objectUrl,t.baseUrl,t.shareUrl,t.previewUrl].filter((e=>void 0!==e)),a=n[e];let o;for(const e of i){o=!1;for(const t of a)if(e.hostname.endsWith(t)){o=!0;break}if(!o)return e}return!0},p=(e,t)=>{const n=[e.objectUrl,e.baseUrl,e.shareUrl].filter((e=>void 0!==e));for(const e of n)if(!t.includes(e.hostname))return e;return!0}},49180:(e,t,n)=>{n.d(t,{R1:()=>i,CK:()=>a,fe:()=>o,ff:()=>r,z4:()=>s,xp:()=>l,pN:()=>d,vg:()=>c,IO:()=>p,$3:()=>u,tV:()=>m,BK:()=>h,jL:()=>f,ae:()=>g,zu:()=>I,nW:()=>_,rA:()=>C,lk:()=>v,cP:()=>y,lP:()=>w,PX:()=>S,kG:()=>b,Y2:()=>E,ro:()=>A,LA:()=>T,R6:()=>F,jH:()=>D,GU:()=>k,AY:()=>P,FV:()=>L});const i={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",fetchPreviewInfo:"/_api/v2.0/shares/{shareID}/driveItem/preview",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1=",getFileWebDavUrl:"/_api/v2.1/drives/{driveId}/items/{itemId}?$select=webDavUrl",getFileDetails:"/_api/v2.1/drives/{driveId}/items/{itemId}?$select=id,name,webDavUrl"}},a={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},o={personal:"personal",teams:"teams"},r={bim:"bim",mw:"mw",ns:"ns",rwc:"rwc"},s="3a867b4a-7429-0e1a-b02e-bf4b240ff1ce",l=["splistform"],d=["splistform"],c={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${o.personal}/[^/]*/`,sharePointFile:`.*/(${o.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/,spPageRegex:/(?:.*\/SitePages\/|.*\/:u:\/t.*)/,spFormsUrlRegex:/(.*\/:l:\/.*?nav=.*|.*\/listforms.aspx.*)/,spListUrlRegex:/(?:.*\/:l:\/|.*\/Lists\/.*)/,spListItemUrlRegex:/(?:.*\/Lists\/.*?ID=.*|.*\/:li:\/.*)/,spListItemPersonalUrlRegex:`/.*/${o.personal}/.*/Lists/.*/`},p={personal:"personal",sharePoint:"share-point"},u={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},m={type:"oneNote",extension:"one",extensionWithDot:".one"},h={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},f={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},g={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",invalidRequest:"invalidRequest",fileAccessDenied:"FileAccessDenied",accessDenied:"accessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked",authChallengeRequired:"authChallengeRequired",InteractionRequired:"InteractionRequired"};var I,_,C,v,y;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI",e.videUploadAsAttachment="VIDEO_UPLOAD_AS_ATTACHMENT",e.imageFileSizeExceeds="IMAGE_FILE_SIZE_EXCEEDS",e.imageDimensionExceeds="IMAGE_DIMENSION_EXCEEDS"}(I||(I={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(_||(_={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(C||(C={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedGuestAndAnonymousCSL="files_messages_sharelink_federated_guest_anonymous_csl",e.ShareLinkFederatedAndAnonymousCSL="files_messages_sharelink_federated_anonymous_csl",e.ShareLinkGuestAndAnonymousCSL="files_messages_sharelink_guest_anonymous_csl",e.ShareLinkAnonymousCSL="files_messages_sharelink_anonymous_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel",e.ShareLinkCSLGeneric="files_messages_sharelink_csl_generic",e.ShareLinkCSLXTenantSharedChannelGeneric="files_messages_sharelink_csl_xtenant_sharedchannel_generic",e.ShareLinkFederatedAndGuestCSLGeneric="files_messages_sharelink_federated_and_guest_csl_generic",e.ShareLinkFederatedCSLGeneric="files_messages_sharelink_federated_csl_generic",e.ShareLinkPSLWithoutFullAccessGeneric="files_messages_sharelink_psl_without_full_access_generic",e.ShareLinkPSLWithoutFullAndFutureAccessGeneric="files_messages_sharelink_psl_without_full_and_future_access_generic",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannelGeneric="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel_generic",e.ShareLinkPSLWithoutFutureAccessGeneric="files_messages_sharelink_psl_without_future_access_generic",e.ShareLinkPSLWithoutIndividualAccessGeneric="files_messages_sharelink_psl_without_individual_access_generic"}(v||(v={})),function(e){e.StringFile="string_file",e.StringList="string_list",e.StringItem="string_item",e.StringForm="string_form",e.StringPlaylist="string_playlist"}(y||(y={}));const w=100,S=10485760,b=12e4,E=3e5,A=600;var T;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(T||(T={}));const F="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var D;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains",e.ObjectUrlMissing="ObjectUrlMissing"}(D||(D={}));const k="https://my.microsoftpersonalcontent.com",P="/v2/.default",L={file:y.StringFile,splist:y.StringList,splistitem:y.StringItem,splistplaylist:y.StringPlaylist,splistform:y.StringForm}},694257:(e,t,n)=>{var i;n.d(t,{b:()=>i}),function(e){e.logErrorMessage="logErrorMessage",e.internalErrorCode="internalErrorCode",e.spoInnerErrorCode="spoInnerErrorCode",e.correlationId="correlationId",e.httpCode="httpCode",e.errorCode="errorCode",e.isExpected="isExpected",e.isRedirect="isRedirect",e.redirectUrl="redirectUrl",e.reason="reason",e.serverResponse="serverResponse"}(i||(i={}))},228113:(e,t,n)=>{n.d(t,{m:()=>a});var i=n(49180);const a=e=>{switch(e){case i.jL.unauthorizedAccess:return!1;case i.jL.clientError:case i.jL.badRequest:case i.jL.internalServerError:case i.jL.serviceUnavailable:case i.jL.tooManyRequests:return!0;default:return!1}}},926948:(e,t,n)=>{n.d(t,{N:()=>c});var i=n(754255),a=n(572909),o=n(937545),r=n(693973),s=n(702183),l=n(740875),d=n(164145);const c=async(e,t,n,c,p,u,m,h)=>{if("Meeting"!==e.type)return Promise.reject("callingIntent must be of type Meeting");let f,g,I;if(h?.mark(s.BQ.PrepareMeetingJoinEntityCommand),e.coordinates.legacyMeeting){const{conversationId:t,rootMessageId:n,tenantId:i,meetingCloud:a}=e.coordinates.legacyMeeting;f=`${t}/${n}`,g=i,I=(0,l.iy)({...e.coordinates.legacyMeeting,meetingCloud:a||""})}else{if(!e.coordinates.meetingData)return Promise.reject("meeting coordinates not set on callingIntent");{const{meetingCode:t,meetingUrl:n}=e.coordinates.meetingData;if(!t&&!n)return Promise.reject("no meetingCode/meetingUrl in meetingData coordinates");f=t||n;const{enableTenantIdFromMeetingDataResolutionMTMA:a}=c.get(i.w.Calling);if(a)try{g=await(0,d.j)(e.coordinates.meetingData,(()=>Promise.resolve(p)),c,u,m),h?.mark(s.BQ.TenantIdResolutionFinished)}catch(e){h?.mark(s.BQ.TenantIdResolutionFailed,{reason:e})}if(!g){const{defaultAnonTenantId:e}=c.get(i.w.Calling);g=e||void 0}I=n||void 0}}const _=(0,l.sB)(I||"",c);h?.mark(s.BQ.FireMeetingJoinEntityCommand),await n.deepLink.executeIntent({entityCommand:{entity:{type:a.ck.meetings,action:a.SY.join,id:f},command:{visibilityState:o.Rp.show,stateTransition:o.Ar.new,layoutMode:r.Rm.focus,correlation:t},entityOptions:{callingIntent:e,isBroadcastMeeting:!!e.coordinates.legacyMeeting?.broadcast||void 0,scenarioCorrelationId:h?.clientId||void 0}},metadata:{allowAnonymous:!0,tenantId:g,deepLink:I}},_)}},164145:(e,t,n)=>{n.d(t,{j:()=>s});var i=n(754255),a=n(67309);const o={kind:"Document",get definitions(){const e=(0,a.G)("query ComponentsCallingUtilsTenantIdFromMeetingDataQuery($meetingData:MeetingDataInput!,$isMTMA:Boolean) {tenantIdFromMeetingData(meetingData:$meetingData,isMTMA:$isMTMA)}");return delete this.definitions,this.definitions=e.definitions}};var r=n(702183);const s=async(e,t,n,a,o)=>{const{enableTenantIdFromMeetingDataResolutionMTMA:s}=n.get(i.w.Calling);if(!s)return;const d=a.newScenario(r.Cu.ResolveMeetingTenantId);a.hoistScenarioToCore?.(d),d.appendEventData({meetingCode:Number(e.meetingCode),context:"MTMA"});try{const n=await t(d);if(!n)return o.log("No client available, skipping resolving tenantId"),"";d.mark("client_retrieved");const i=await l(e,n);return d.stop({meetingTenantId:i}),o.log(`TenantId ${i} has been resolved from ${e.meetingCode}`),i}catch(t){const n=`getMeetingTenantIdForMTMAJoin failed: ${t}`;return o.error(n),d.fail({reason:n}),Promise.reject(`MeetingId: ${e.meetingCode}. Error: ${t}`)}},l=async(e,t)=>{const{data:n,error:i,errors:a}=await t.query({query:o,variables:{meetingData:e,isMTMA:!0}});return i?Promise.reject(i):a?Promise.reject(a):n?.tenantIdFromMeetingData||""}},812943:(e,t,n)=>{n.d(t,{q:()=>a});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsFileActionsChannelQuery($conversationId:ID!) {channelByID(conversationId:$conversationId) {channelType,displayName,description,defaultFileSettings {filesRelativePath},id,owningTeam {id,displayName,teamSiteInformation {groupId},isArchived,teamType,tenantId},memberRole}}");return delete this.definitions,this.definitions=e.definitions}}},106309:(e,t,n)=>{n.d(t,{v6:()=>i,Nr:()=>a,Lx:()=>o,Hy:()=>r,$j:()=>s,te:()=>l,kc:()=>d,Wj:()=>c,I5:()=>p,XJ:()=>h,yj:()=>g,r2:()=>I,R$:()=>_,BK:()=>C,Rp:()=>v,Q$:()=>y,g0:()=>w,Jr:()=>S,Jh:()=>b,wu:()=>E,qf:()=>A,_l:()=>T,MI:()=>F});const i="resourceRequiresConsent",a="resourceRequiresMfa",o="InteractionRequired",r="tokenRevoked",s="list-chiclet-icon",l="list-item-chiclet-icon",d="list-form-chiclet-icon",c="list-playlist-chiclet-icon";var p,u,m;!function(e){e.Chat="chat",e.MeetingChat="meetingChat",e.HoloLensChat="holoLensChat",e.EmbedFeedbackChat="embedFeedbackChat",e.SmartReply="smartReply",e.MeetingPPT="meetingPPT",e.Channel="channel",e.ChannelMeeting="channelMeeting",e.ChannelMeetingPPT="channelMeetingPPT",e.ChatFilesTab="chatFilesTab",e.Unknown="unknown"}(p||(p={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(u||(u={})),function(e){e[e.Recent=0]="Recent",e[e.Aggregate=1]="Aggregate",e[e.Personal=2]="Personal",e[e.Teams=3]="Teams",e[e.Channels=4]="Channels",e[e.Downloads=5]="Downloads",e[e.PersonalWopi=6]="PersonalWopi",e[e.PersonalGoogle=7]="PersonalGoogle",e[e.CustomSpo=8]="CustomSpo",e[e.SharedWithMe=9]="SharedWithMe",e[e.Chats=10]="Chats"}(m||(m={}));const h=(new Map).set("Sharepoint",u.Sharepoint).set("WOPI",u.WOPI).set("Google",u.Google).set("OneDrive",u.OneDrive).set("Recent",u.Recent).set("Aggregate",u.Aggregate).set("FileSystem",u.FileSystem).set("Search",u.Search).set("AllFiles",u.AllFiles).set("SharedWithMe",u.SharedWithMe);var f,g,I;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google"}(f||(f={})),function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE"}(g||(g={})),function(e){e.Secure="Secure",e.InvalidFormat="InvalidFormat",e.InvalidProtocol="InvalidProtocol",e.InvalidExternalProviderDomain="InvalidExternalProviderDomain",e.DomainMismatchForDifferentUrl="DomainMismatchForDifferentUrl",e.InvalidInternalDomain="InvalidInternalDomain",e.ObjectUrlMissing="ObjectUrlMissing"}(I||(I={}));const _=new Map;_.set("DROPBOX",f.WopiIntegration).set("BOX",f.WopiIntegration).set("SHAREFILE",f.WopiIntegration).set("EGNYTE",f.WopiIntegration).set("GOOGLEDRIVE",f.Google);const C=new Map;C.set(u.Sharepoint,"Sharepoint").set(u.WOPI,"WOPI").set(u.Google,"Google").set(u.OneDrive,"OneDrive").set(u.Recent,"Recent").set(u.Aggregate,"Aggregate").set(u.FileSystem,"FileSystem").set(u.Search,"Search").set(u.AllFiles,"AllFiles").set(u.SharedWithMe,"SharedWithMe");const v=new Map;v.set("DROPBOX",g.Dropbox).set("BOX",g.Box).set("SHAREFILE",g.Sharefile).set("GOOGLEDRIVE",g.GoogleDrive).set("EGNYTE",g.Egnyte);const y=new Map;y.set("Recent",m.Recent).set("Aggregate",m.Aggregate).set("Personal",m.Personal).set("Teams",m.Teams).set("Channels",m.Channels).set("Downloads",m.Downloads).set("PersonalWopi",m.PersonalWopi).set("PersonalGoogle",m.PersonalGoogle).set("CustomSpo",m.CustomSpo).set("SharedWithMe",m.SharedWithMe).set("Chats",m.Chats);const w=e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}},S=e=>{switch(e){case u.Sharepoint:return"Sharepoint";case u.WOPI:return"WOPI";case u.Google:return"Google";case u.OneDrive:return"OneDrive";case u.Recent:return"Recent";case u.Aggregate:return"Aggregate";case u.FileSystem:return"FileSystem";case u.Search:return"Search";case u.AllFiles:return"AllFiles";case u.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}},b="https://teams.microsoft.com/scripts/items-view-strings.js",E=/[\u202A-\u202E\u2066-\u2069]/g,A="â€ª",T=/[\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\uFB1D-\uFB4F\uFB50-\uFDFF\uFE70-\uFEFF]/,F="GetValidFileDomains"},5059:(e,t,n)=>{n.d(t,{X2:()=>i,LZ:()=>l,VL:()=>d,RK:()=>c,EY:()=>p,hB:()=>u,F9:()=>m,pP:()=>h,nn:()=>f,uY:()=>g});var i,a=n(648260),o=n(726723),r=n(702183),s=n(799366);!function(e){e.Start="Start",e.Stop="Stop",e.Cancel="Cancel",e.Fail="Fail"}(i||(i={}));const l=(e,t)=>{const{appId:n,appConfigEntryPoint:i,appEntryPoint:o,threadId:s,messageId:l,tabType:d,actionType:c,tabId:p}=t;switch(o){case a.v.Meeting:case a.v.ChannelMeeting:case a.v.PrivateMeetingSchedulingForm:case a.v.ChannelMeetingSchedulingForm:e.newScenario(r.Cu.PlatformTabsHeaderUpdate).appendEventData({"App.Id":n,"App.EntryPoint":o,"Thread.Id":s,"Message.Id":l,"PlatformApp.TabType":d,"PlatformApp.ActionType":c,"PlatformApp.TabId":p,"PlatformApp.ConfigEntryPoint":i})}},d=(e,t)=>{const n=e.findScenario(r.Cu.PlatformTabsHeaderUpdate);if(n){const e=n.eventData?.["PlatformApp.TabId"];t(e||"")&&n.stop()}},c=e=>{const t=e.findScenario(r.Cu.PlatformTabsHeaderUpdate);t?.cancel()},p=e=>t=>e.some((e=>e.tabInfo.tabId===t)),u=(e,t,n)=>{const a=r.Cu.ExtMeetingAppVisualIndicator,o=e.findScenario(r.Cu.ExtMeetingAppVisualIndicator);switch(t){case i.Start:const t=o||e.newScenario(a);o||t.appendEventData({"Bot.Id":n});break;case i.Stop:o?.stop();break;case i.Cancel:o?.cancel();break;case i.Fail:o?.fail()}};function m(e,t,n){const i=new s.I,a=e.showNotificationBadge;i.tabId=e.tabInfo.tabId,i.appId=e.appInfo.appId,i.appName=e.appInfo.appName;const r={panelType:o.HP.MeetingAppVisualIndicator,moduleName:o.Sn.meetingAppVisualIndicator,moduleType:o.nR.meetingAppVisualIndicator,actionOutcome:a?o.nd.meetingAppVisualIndicatorCreated:o.nd.dismissActionMeetingAppVisualIndicator,actionScenario:a?o.vB.meetingAppVisualIndicatorCreated:o.vB.dismissActionMeetingAppVisualIndicator,actionScenarioType:a?o.DB.meetingAppVisualIndicatorCreated:o.vB.dismissActionMeetingAppVisualIndicator,dataBag:i};return t.recordPanelAction(r,n,[o.E0.callType,o.E0.callMeetingContent]),i.dispose(),null}function h(e,t){e.findScenario(r.Cu.PlatformTabLaunch)?.cancel({errors:t}),e.findScenario(r.Cu.PlatformTabFrameLoading)?.cancel({errors:t})}function f(e,t){e.findScenario(r.Cu.PlatformTabLaunch)?.incomplete({errors:t}),e.findScenario(r.Cu.PlatformTabFrameLoading)?.incomplete({errors:t})}function g(e,t){I(e,r.Cu.PlatformTabLaunch,t),I(e,r.Cu.PlatformTabFrameLoading,t)}function I(e,t,n){e.findScenario(t)?.fail({errors:n})}},748875:(e,t,n)=>{n.d(t,{x:()=>o});var i=n(67309);const a={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsStageViewUtilsAppDefinitionQuery($appId:ID!,$scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinition(appId:$appId,scope:$scope,conversationId:$conversationId,options:$options) {id,bots {id,scopes},connectors {scopes},messageExtensions {scopes,commands {id,context}},meetingExtensionDefinition {scenes {id},filters {id}},galleryTabs {scopes},staticTabs {scopes},tenantId,isMicrosoftOwned,isFullScreenApp,isBlocked}}");return delete this.definitions,this.definitions=e.definitions}},o=async(e,t,n,i,o,r)=>{let s;n&&(s=i||"GroupChat");const{data:l,error:d}=await e.query({query:a,variables:{appId:t,scope:s,conversationId:n,options:{allowBlockedApps:r}},context:{callerInfo:`${o}-getAppDefinition`}});if(l&&l.appDefinition&&!d)return l.appDefinition}},416638:(e,t,n)=>{n.d(t,{H:()=>r});var i=n(702183),a=n(806440),o=n(748875);const r=async(e,t,n,r,s)=>{try{const{appId:l}=e,d=await(0,o.x)(t,l,e.convId,e.appInstallScope,"launch-mw-stage-view-without-chat");e.isFullScreenApp=!!d&&(0,a.QP)(d),r?.appendEventData({"App.isFullScreenApp":e.isFullScreenApp,"StageView.OpenMode":"popout","StageView.CorrelationId":e.correlationId}),r?.mark(i.BQ.StageViewAppDefFetchedBeforeLaunch);const c=(0,a.Gi)(e,e.contentUrl);return c?(r?.mark(i.BQ.LaunchingCollabStageWithoutChatEntityCommand),n.platform.launchStageMWWithoutChat({id:c,stageOptions:e,commandSource:s})):Promise.reject("Entity commanding not available")}catch(e){throw r?.mark(i.BQ.StageViewFailedBeforeCommandTrigger),e}}},579966:(e,t,n)=>{n.d(t,{p:()=>o});var i=n(702183),a=n(806440);const o=async(e,t,n,o,r)=>{o?.appendEventData({"StageView.OpenMode":"popoutWithChat","StageView.CorrelationId":e.correlationId});const{stageViewId:s,linkedEntity:l}=await(0,a.iE)(e,t,o);return s&&l?(o?.mark(i.BQ.LaunchingCollabStageWithChatEntityCommand),n.platform.launchStageMW({id:s,linkedEntity:l,stageOptions:e,commandSource:r})):Promise.reject("Entity commanding not available")}},836189:(e,t,n)=>{n.d(t,{N:()=>M});var i=n(505834),a=n(712839),o=n(726723),r=n(754255),s=n(131647),l=n(572909),d=n(937545),c=n(702183),p=n(363678),u=n(806440),m=n(321245),h=n(550497),f=n(649728);var g=n(67309);const I={kind:"Document",get definitions(){const e=(0,g.G)("fragment ComponentsStageViewUtilsAppDefinitionFragment on AppDefinition {id,name,developerName,developerUrl,privacyUrl,termsOfUseUrl,version,shortDescription,longDescription,smallImageUrl,largeImageUrl,accentColor,categories,validDomains,externalId,tenantId,isBlocked,isFullScreenApp,isFullTrustApp,isMicrosoftOwned,showTabLoadingIndicator,videoUrl,devicePermissions,defaultInstallScope,manifestVersion,disabledScopes,galleryTabs {configurationUrl,canUpdateConfiguration,canHaveTabConversation,scopes,meetingSurfaces,context},staticTabs {entityId,name,order,contentUrl,contentBotId,websiteUrl,scopes,context,containerAppIds},webApplicationInfo {id,appKey,resource,applicationPermissions}}");return delete this.definitions,this.definitions=e.definitions}},_={kind:"Document",get definitions(){const e=(0,g.G)("fragment ComponentsStageViewUtilsInstalledAppFragment on InstalledApp {id,installationState,installedVersion,definition {id,...ComponentsStageViewUtilsAppDefinitionFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...I.definitions]}},C={kind:"Document",get definitions(){const e=(0,g.G)("query ComponentsStageViewUtilsInstalledSideLoadAppQuery($installedScope:AppInstallScope!,$externalId:String!,$conversationId:String) {installedSideLoadApp(installedScope:$installedScope,externalId:$externalId,conversationId:$conversationId) {id,...ComponentsStageViewUtilsInstalledAppFragment}}");return delete this.definitions,this.definitions=[...e.definitions,..._.definitions]}},v={kind:"Document",get definitions(){const e=(0,g.G)("query ComponentsStageViewUtilsInstalledAppByIdQuery($installedScope:AppInstallScope!,$appId:ID!,$conversationId:String) {installedApp(installedScope:$installedScope,appId:$appId,conversationId:$conversationId) {id,installationState}}");return delete this.definitions,this.definitions=e.definitions}};var y=n(748875);const w=async(e,t,n,i,a,o)=>{const{appId:r,convId:s,replyChainId:l,channelId:d}=e,p=d||l?void 0:s,u=l?d||s:d,h=u||p||"";let f="Personal";try{f=await S(t,p,u),e.appInstallScope=f,E(c.BQ.StageViewTargetInstallationScopeConfirmed,`confirmed installed scope for chatThreadId: ${p}, channelThreadId: ${u} is ${f}`,a,o),i.log(`confirmed installed scope for chatThreadId: ${p}, channelThreadId: ${u} is ${f}`);const s={conversation:{id:h,scope:f},shouldFetchPersonalApps:!0},l=await(async(e,t,n,i,a)=>{const o=a||{},r=t.newScenario(c.Cu.ExtInstalledAppsV2);try{const t=[];if(r.appendEventData({dataSource:"installedApp query",correlationId:i}),o.shouldFetchPersonalApps){const a=e.query({query:v,variables:{installedScope:"Personal",appId:n},context:{callerInfo:`${i}-getInstalledAppById`}}).then((e=>e.data?.installedApp));t.push(a)}if(o.conversation&&o.conversation.id){const a=e.query({query:v,variables:{installedScope:o.conversation.scope,appId:n,conversationId:o.conversation.id},context:{callerInfo:`${i}-getInstalledAppsById`}}).then((e=>e.data?.installedApp));t.push(a)}const a=(await Promise.all(t)).filter((e=>!!e));return r.mark(c.BQ.ExtAppsProcessed),r.stop({appCount:a.length}),a}catch(e){return r.fail({errors:`failed to get installed app id: ${n}`}),[]}})(t,n,r,`jit-install-for-stage-view-${e.entryPoint}`,s);i.log(`Fetched Installed apps length: ${l.length} `);const d=l.find((e=>(0,m.e6)(e)));if(E(c.BQ.StageViewInstalledAppsFetched,`${l?.length} appEntitlements returned with preInstalledApp as ${!!d}, for ${f} scope and ${h} threadId.`,a,o),d)return a?.mark(c.BQ.StageViewAppIsPreInstalled),o?.mark(c.BQ.StageViewAppIsPreInstalled),{appInstalled:!0,appInstallScope:d.installedScope};{const s=await F(t,i,r,f,h,!l.length,a,o);if(s?.definition)return e.appId=s.definition.id||e.appId,e.appInstallScope=f,a?.appendEventData({"App.isSideLoaded":!!s.definition.externalId}),o?.appendEventData({"App.isSideLoaded":!!s.definition.externalId}),E(c.BQ.StageViewAppIsPreInstalled,`App ${s.definition.externalId} is sideloaded, with internalAppId ${s.definition.id}`,a,o),{appInstalled:!0,appInstallScope:f};E(c.BQ.StageViewAppIsNotPreInstalled,`${l?.length} appEntitlements returned for ${f} scope and ${h} threadId.`,a,o);const{appInstalled:d,appInstallScope:p}=await b(r,h,f,t,n,i,a,o);return e.appInstallScope=p,{appInstalled:d,appInstallScope:p}}}catch(e){return T(i,f,a,o,e?.message,h),{appInstalled:!1,appInstallScope:f}}},S=async(e,t,n)=>{if(n)return"Team";if(t){const n=await(async(e,t,n)=>{const{data:i}=await t.query({query:f.A,variables:{convId:e},context:{callerInfo:n}});return i.chat?.isOneOnOneBotChat??!1})(t,e,"handleJITInstallForStageView");return n?"Personal":"GroupChat"}return"Personal"},b=async(e,t,n,i,a,o,r,s)=>{let l=!1,d=n;const p=await(0,y.x)(i,e,t,n,"jit-install-for-stage-view",!0);if(!p)return A(o,`App ${e} could'nt be fetched from app catalog. App might not exist in the store.`,r,s),{appInstalled:l,appInstallScope:d};if(E(c.BQ.StageViewAppDefFetched,`App.isBlocked: ${p?.isBlocked||!1}`,r,s),p.isBlocked)return A(o,`App ${e} is blocked by tenant, can not show the app content`,r,s),{appInstalled:l,appInstallScope:d};const u=(0,h.Z1)("Personal",p);let m;if(u){d="Personal";const t=`installing in personal scope: isPersonalScopeSupported: ${u}`;E(c.BQ.StageViewInstallingInPersonalScope,t,r,s),m=await(0,h.Pe)(i,a,c.Cu.AppInstallationDialogInstallApp,e,"Personal",o,!0,void 0,{reason:t,"App.Scope":"Personal",correlationId:s?.id},void 0,"jit-install-for-stage-view"),l=!!m}else if("Personal"!==n&&(0,h.Z1)(n,p)){const p=`installing in scope: ${n}, conversationId: ${t}`;E(c.BQ.StageViewInstallingInChatChannelScope,p,r,s);try{m=await(0,h.Pe)(i,a,c.Cu.AppInstallationDialogInstallApp,e,n,o,!0,t,{reason:p,correlationId:s?.id,"App.Scope":n},void 0,"jit-install-for-stage-view")}catch(e){T(o,n,r,s,e?.message,t)}l=!!m,d=n}else A(o,`installScope: ${n} is not supported by app: ${e}`,r,s);return l&&E(c.BQ.StageViewAppInstallationDone,`installed in ${d} scope, conversationId: ${t}`,r,s),{appInstalled:l,appInstallScope:d}},E=(e,t,n,i)=>{n?.mark(e,{reason:t}),i?.mark(e,{reason:t})},A=(e,t,n,i)=>{e.warn(t),n?.incomplete({reason:t}),i?.incomplete({reason:t})},T=(e,t,n,i,a,o)=>{const r=`JIT-Install failed in scope: ${t}, conversationId: ${o} Reason: ${a}`;e.error(r),a?.includes("NoPermissionToInstallApp")?A(e,"User does not have permissions to install app in scope",n,i):(n?.fail({errors:r}),i?.fail({errors:r}))},F=async(e,t,n,i,a,o,r,s)=>{const l={installedScope:i,externalId:n,conversationId:a};try{if(o){const{data:t}=await e.query({query:C,variables:l,fetchPolicy:"cache-first",context:{callerInfo:"jit-install-for-stage-view"}});return E(c.BQ.StageViewSideLoadQueryReturned,`Side load query returned for app ${n}`,r,s),t?.installedSideLoadApp}return null}catch(e){return t.error(`Failed fetching side loading details for app ${n}, threadId: ${a}, scope, ${i}: ${e}`),null}};var D=n(579966);const k=(e,t,n,i,a)=>{const{enableReactStageModal:o}=t.get(r.w.Extensibility);return o?(a?.appendEventData({"StageView.OpenMode":"modal","StageView.CorrelationId":e.correlationId}),a?.mark(c.BQ.LaunchingStageModalEntityCommand),n.platform.launchReactStageModal(e.appId,e,{visibilityState:d.Rp.show,stateTransition:d.Ar.extend,correlation:{source:i,id:e.correlationId}}).toPromise()):n.platform.launchStage({stageOptions:e,entityCommand:{stateTransition:d.Ar.extend,visibilityState:d.Rp.show,correlation:{source:i}}}).toPromise()};var P=n(416638),L=n(645095);const U=e=>{let t=a.bY.personal;switch(e){case"Team":t=a.bY.team;case"GroupChat":t=a.bY.group}return t},M=async(e,t,n,i,s,l,d,c,p)=>{const{enableCommandingTelemetryForCollabStageMW:m,enableReactStageModal:h,enableProgrammaticPopoutStageViewOpenAPI:f,enableProgrammaticPopoutStageDeeplink:g}=t.get(r.w.Extensibility);let I,_,C=e;if(!m){const{phase1CollabStageScenario:e,endToEndScenario:t}=(0,u.d1)(i);I=e,_=t,C.launchScenarioId=t.id,C.phase1OnlyScenarioDetails={scenarioMarkerName:e.name,scenarioMarkerId:e.id}}if(!C.appId)return I?.incomplete({errors:"AppId cannot be empty for launching stage view"}),_?.incomplete({errors:"AppId cannot be empty for launching stage view"}),Promise.reject("AppId cannot be empty for launching stage view");if(l)try{C=await R(s,l,C,n,I,_)}catch(e){return Promise.reject(`Could not determine if threadId passed is chat/channel: ${e}`)}if(C.openMode=(0,u.mg)(t,C),I?.appendEventData({"App.Id":C.appId,"Thread.Id":C.convId,"PlatformApp.ScenarioCapability":a.n3.tabs,"App.EntryPoint":C.entryPoint,"StageView.OpenMode":C.openMode,"StageView.inputThreadIdDefined":!!l,"StageView.CorrelationId":C.correlationId}),_?.appendEventData({"App.Id":C.appId,"Thread.Id":C.convId,"App.EntryPoint":C.entryPoint,"StageView.OpenMode":C.openMode,"StageView.inputThreadIdDefined":!!l,"StageView.CorrelationId":C.correlationId}),!h&&C.openMode===u.bq.modal&&d)return I?.cancel({errors:"Opening angular modal hence cancelling react scenarios"}),_?.cancel({errors:"Opening angular modal hence cancelling react scenarios"}),O(C,t,n,d,void 0);const{appInstalled:v,appInstallScope:y}=await w(C,n,i,s,I,_);if(c&&c.recordPanelAction(((e,t,n,i,r)=>{const{actionOutcome:s,panelType:l}=(0,u.lT)(n,i),d=r.createDatabag(),c={actionGesture:o.Od.auto,actionOutcome:s,actionScenario:o.vB.openStageView,actionScenarioType:o.DB.stageView,moduleName:o.Sn.stageViewMainContent,moduleType:o.nR.stageview,panelRegion:n===u.bq.modal?o.rP.dialog:o.rP.main,panelType:l,extensibilityData:{id:e,scope:t,scenarioCapability:a.n3.tabs}};return c.dataBag=d,c})(C.appId,U(y),C.openMode,C.entryPoint,c)),p){const e=p.createDatabag(),{actionOutcome:t,panelType:n}=(0,u.lT)(C.openMode,C.entryPoint),i={actionGesture:o.Od.auto,actionOutcome:t,actionScenario:o.vB.openStageView,actionScenarioType:o.DB.stageView,moduleName:o.Sn.stageViewMainContent,moduleType:o.nR.stageview,panelRegion:C.openMode===u.bq.modal?o.rP.dialog:o.rP.main,panelType:n,dataBag:e,extensibilityData:{id:C.appId,scope:U(y),scenarioCapability:a.n3.tabs}};p.recordPanelAction(i,s)}return v?(I?.appendEventData({"App.Scope":y}),_?.appendEventData({"App.Scope":y}),O(C,t,n,d,I,_,!!f,!!g).catch((()=>(_?.fail({errors:"Failed to launch"}),I?.fail({errors:"Failed to launch"}),Y())))):(I?.fail({errors:`App could not be installed- ${y}`}),_?.fail({errors:`App could not be installed- ${y}`}),Y())},R=async(e,t,n,a,o,r)=>{let s={chat:null};try{s=await(0,i.zB)(a,t)}catch(n){o?.mark(c.BQ.ChatQueryFailed,{reason:`ChatQuery failed for inputThreadId: ${t}`}),r?.mark(c.BQ.ChatQueryFailed,{reason:`ChatQuery failed for inputThreadId: ${t}`}),e.error(`Could not determine if inputThreadId is chat/channel, ChatQuery failed for inputThreadId: ${t}`)}if(s?.chat){const{chatSubType:i,memberIds:a}=s.chat;switch(o?.mark(c.BQ.ChatQuerySuccessful,{reason:`chatSubType: ${i}, memberIds.length: ${a?.length}`}),r?.mark(c.BQ.ChatQuerySuccessful,{reason:`chatSubType: ${i}, memberIds.length: ${a?.length}`}),i){case L.vW.Channel:return e.log(`inputThreadId is a channel ${t}`),{...n,convId:t,channelId:t,replyChainId:void 0,messageId:void 0};case L.vW.Meeting:case L.vW.None:e.log(`inputThreadId is a chat ${t}`);const i={...n,convId:t,channelId:void 0,replyChainId:void 0,messageId:void 0};return a&&0!==a.length||n.openMode===u.bq.modal?i:{...i,openMode:u.bq.popout};default:return e.error("chatSubType is not present in chatQuery return, launching stage view in personal scope context"),{...n,convId:"",channelId:void 0,replyChainId:void 0,messageId:void 0}}}return o?.mark(c.BQ.ChatQueryReturnedEmptyData,{reason:`ChatQuery result is empty for inputThreadId: ${t}`}),r?.mark(c.BQ.ChatQueryReturnedEmptyData,{reason:`ChatQuery result is empty for inputThreadId: ${t}`}),e.error(`Could not determine if inputThreadId is chat/channel, ChatQuery result is empty for inputThreadId: ${t}`),{...n,convId:"",channelId:void 0,replyChainId:void 0,messageId:void 0}},O=async(e,t,n,i,a,o,r,s)=>{try{const l=W(e.entryPoint);switch(e.entryPoint){case p.hB.adaptiveCardCollabStage:return await x(e,n,l,i,a);case p.hB.fileChiclet:return await V(e,n,l,i,a);case p.hB.deepLinkStageView:return await $(e,n,a,o,s);case p.hB.stageViewOpenSDKApi:return await B(e,t,n,l,i,a,r);case p.hB.adaptiveCardStageModal:return await H(e,t,l,i,a);default:return Promise.reject(`Stage view entry point not supported. Entrypoint: ${e.entryPoint}`)}}catch(e){return N(e,a,o),Promise.reject(e)}},x=async(e,t,n,i,a)=>i?(0,D.p)(e,t,i,a,n):Promise.reject("Entity commanding not available"),V=async(e,t,n,i,a)=>i?e.openMode===u.bq.popout?(0,P.H)(e,t,i,a,n):(0,D.p)(e,t,i,a,n):Promise.reject("Entity commanding not available"),$=async(e,t,n,i,a)=>{if(!e.contentUrl)return n?.incomplete({errors:"ContentUrl cannot be empty for deeplink"}),i?.incomplete({errors:"ContentUrl cannot be empty for deeplink"}),Y();if(!a)return q(e,n);switch(e.openMode){case u.bq.modal:return q(e,n);case u.bq.popoutWithChat:return e={...e,showChatTitleForHeader:!0},G(e,t,n);case u.bq.popout:return j(e,n);default:return q(e,n)}},B=async(e,t,n,i,a,o,r)=>{if(!r)return a?k({...e,openMode:"modal"},t,a,i,o):Promise.reject("Entity commanding not available");switch(e.openMode){case u.bq.popout:return a?(0,P.H)(e,n,a,o,i):Promise.reject("Entity commanding not available");case u.bq.popoutWithChat:return a?(0,D.p)(e,n,a,o,i):Promise.reject("Entity commanding not available");case u.bq.modal:default:return a?k(e,t,a,i,o):Promise.reject("Entity commanding not available")}},H=async(e,t,n,i,a)=>i?k(e,t,i,n,a):Promise.reject("Entity commanding not available"),N=(e,t,n)=>{const i=e instanceof Error?e.message:String(e);t?.fail({errors:`Unexpected error occurred-${i}`}),n?.fail({errors:`Unexpected error occurred-${i}`})},W=e=>{switch(e){case p.hB.stageViewOpenSDKApi:return s.p.StageViewOpenSDKApi;case p.hB.deepLinkStageView:return s.p.StageViewDeeplink;case p.hB.fileChiclet:return s.p.FileChicletActions;default:return s.p.AdaptiveCardInvokeButton}},G=async(e,t,n)=>{const{stageViewId:i,linkedEntity:a}=await(0,u.iE)(e,t,n);return i&&a?(n?.mark(c.BQ.LaunchingCollabStageWithChatEntityCommand),Promise.resolve({entityCommand:{entity:{id:i,type:l.ck.platformStage,action:l.SY.create,linkedEntity:a},command:{stateTransition:d.Ar.new,visibilityState:d.Rp.show,correlation:{id:e.correlationId,source:s.p.StageViewDeeplink,startTimestamp:e.scenarioStartTime}},entityOptions:e},metadata:{allowAnonymous:!1}})):Promise.reject("Entity commanding not available")},Y=async()=>Promise.resolve({entityCommand:{entity:{type:l.ck.unsupportedcollabstageerrordialog,action:l.SY.view},command:{stateTransition:d.Ar.extend,visibilityState:d.Rp.show},entityOptions:{}},metadata:{allowAnonymous:!1}}),j=async(e,t)=>{const n=(0,u.Gi)(e,e.contentUrl);return n?(t?.mark(c.BQ.LaunchingCollabStageWithoutChatEntityCommand),Promise.resolve({entityCommand:{entity:{id:n,type:l.ck.platformstagewithoutchat,action:l.SY.view},command:{stateTransition:d.Ar.new,visibilityState:d.Rp.show,correlation:{id:e.correlationId,source:s.p.StageViewDeeplink,startTimestamp:e.scenarioStartTime}},entityOptions:e},metadata:{allowAnonymous:!1}})):Promise.reject("Entity commanding not available")},q=async(e,t)=>{const n={entityCommand:{entity:{id:e.appId,type:l.ck.platformstagemodal,action:l.SY.view},command:{visibilityState:d.Rp.show,stateTransition:d.Ar.extend,correlation:{id:e.correlationId,source:s.p.StageViewDeeplink}},entityOptions:e},metadata:{allowAnonymous:!1}};return t?.mark(c.BQ.LaunchingStageModalEntityCommand),Promise.resolve(n)}},662201:(e,t,n)=>{n.d(t,{Y:()=>c});var i=n(513432),a=n(155762),o=n(289259),r=n(67309);const s={kind:"Document",get definitions(){const e=(0,r.G)("mutation ComponentsSurveyCommonFloodgateLogActivityMutation($activityName:String!,$increment:Int) {floodgateLogActivity(activityName:$activityName,increment:$increment)}");return delete this.definitions,this.definitions=e.definitions}},l={kind:"Document",get definitions(){const e=(0,r.G)("query ComponentsSurveyCommonFloodgateGetActiveSurveyQuery {floodgateActiveSurvey {id}}");return delete this.definitions,this.definitions=e.definitions}},d={kind:"Document",get definitions(){const e=(0,r.G)("mutation ComponentsSurveyCommonFloodgateDismissSurveyMutation {floodgateDismissSurvey}");return delete this.definitions,this.definitions=e.definitions}},c=()=>{const[e]=(0,a.n)(s,{ignoreResults:!0}),[t]=(0,a.n)(d,{ignoreResults:!0}),[n]=(0,o._)(l),r=i.useCallback((async(t,n=1)=>{await e({variables:{activityName:t,increment:n}})}),[e]),c=i.useCallback((async()=>n()),[n]),p=i.useCallback((async()=>{await t()}),[t]);return i.useMemo((()=>({logActivity:r,getActiveSurvey:c,dismissSurvey:p})),[c,r,p])}},217391:(e,t,n)=>{n.d(t,{Ze:()=>i,I_:()=>U,h5:()=>R});var i,a=n(513432),o=n(755029),r=n(552355),s=n(754255),l=n(911234),d=n(572909),c=n(735652),p=n(418709),u=n(550497),m=n(160177),h=n(272924),f=n(79743),g=n(544825),I=n(323040),_=n(182504),C=n(169195),v=n(924162),y=n(196131),w=n(753318),S=n(384609),b=n(288325),E=n(764076),A=n(702183),T=n(812943),F=n(49180),D=n(832669),k=n(836189),P=n(363678),L=n(730941);!function(e){e.PlatformApp="PlatformApp",e.OneUp="OneUp",e.OneUpPageEmbed="OneUpPageEmbed"}(i||(i={}));const U=()=>{const{entityCommanding:e,scenarioFactory:t,windowHistoryNavigationService:n,coreSettings:i}=(0,o.ur)(),{entity:d,getEntityOptions:u}=(0,r.At)(),m=(0,p.m)(),{enableAppBasedFileHandlingForWXPTMP:h,enableFilesAppBasedFileHandlingForPDFTMP:f,enableFilesPDFAppIdForViewTMP:g,enableFilesAdminPreinstallCheckForPDFAppTMP:I,enableFilesAAACheckForPDFAppTMP:_,allowedInstallerAzureADAppIdsForPDFApp:C,enableAppBasedFileHandlingForOneNoteTMP:v,enableAppBasedFileHandlingForVisioTMP:y}=(0,c.w2)(s.w.Files,["enableAppBasedFileHandlingForWXPTMP","enableFilesAppBasedFileHandlingForPDFTMP","enableFilesPDFAppIdForViewTMP","enableFilesAdminPreinstallCheckForPDFAppTMP","enableFilesAAACheckForPDFAppTMP","allowedInstallerAzureADAppIdsForPDFApp","enableAppBasedFileHandlingForOneNoteTMP","enableAppBasedFileHandlingForVisioTMP"]),{enableCollabStageForWXP:w}=(0,c.w2)(s.w.Extensibility,["enableCollabStageForWXP"]),{enableAppsQueryOptimization:S,enablePopOutFileChicletInMultiWindow:b,enableInstalledAppQueryOptimization:E}=(0,c.w2)(s.w.Extensibility,["enableAppsQueryOptimization","enablePopOutFileChicletInMultiWindow","enableInstalledAppQueryOptimization"]),{isPrimaryWindow:A}=(0,c.w2)(s.w.Core,["isPrimaryWindow"]),T=(0,l.U)("InTeamsFileViewerResolver"),F=a.useRef(new Map),{sdkHostType:D}=(0,c.w2)(s.w.Sdk,["sdkHostType"]);return a.useCallback((async(a,o,r,s)=>{M(B(a,!!b,!!A),o,r,s,e,i,d,n,u,m,!!h,!!f,!!_,g,C,!!I,!!v,!!y,!!S,!!E,!!w,D,T,t,F)}),[b,A,e,i,d,n,u,m,h,f,_,g,C,I,v,y,S,E,w,D,T,t])},M=async(e,t,n,i,a,o,r,s,l,c,p,u,h,f,g,I,_,C,v,y,w,S,b,E,T)=>{const U=E.newScenario(A.Cu.FileViewerResolver);try{const M=(0,m.sI)(e.fileType),O=await $(e,c,b),x=T.current;e={...e,tenantId:O?.channelByID.owningTeam?.tenantId||void 0};const V=await R(c,e.fileType,p,u,h,f,g,I,_,C,v,y,b,E);if(e.subEntityId){const t=l(d.ck.extensions,d.SY.view);s.pushToWindowHistory(r,{...t,subEntityId:e.subEntityId})}if(V){if(U.mark(A.BQ.FileViewerResolverRoutingToInstalledApp),i(t,{...n,dataBagProperties:{...n.dataBagProperties,fileViewerType:"PlatformApp",fileViewerAppId:V,fileAction:F.BK.editInTeams},actionKey:"edit_in_teams"}),x.get(e.fileId)!==e.threadId&&(0,D.RL)(E,V,"personalApp",b,e.shouldOpenInMultiWindow,!0),x.set(e.fileId,e?.threadId),e.threadId&&w&&"Desktop"===S){const n={convId:e.threadId,messageId:e.messageId,appId:V,entryPoint:P.hB.fileChiclet,contentUrl:e.shareUrl||e.objectUrl,websiteUrl:e.shareUrl||e.objectUrl,entityId:e.fileId,subEntityId:JSON.stringify({...e,hideClose:!0,fileTitle:t.title}),correlationId:(0,L.A)(),scenarioStartTime:(new Date).getTime()};return e.replyChainId&&(n.replyChainId=e.replyChainId),(0,k.N)(n,o,c,E,b,void 0,a).then((()=>U.stop())).catch((e=>{const t=`Unexpected error while launching stage: ${e?.errorCode}`;b.errorToTelemetry?.(t,"files_viewer_resolver"),U.mark("StageViewLaunchFailed")}))}return a.file.launchFileViewApp(V,{...e,baseUrl:e.siteUrl}),void U.stop()}M===m.j_.OneUpViewer?(U.mark(A.BQ.FileViewerResolverRoutingToOneupViewer),i(t,{...n,dataBagProperties:{...n.dataBagProperties,fileViewerType:"OneUp",fileAction:F.BK.openInTeams},actionKey:"edit_in_teams"}),a.file.openInOneup(e)):(b.errorToTelemetry?.("This means no platform app installed for a office file type. Not good","files_viewer_resolver"),U.mark(A.BQ.FileViewerResolverFallback),i(t,{...n,actionKey:"edit_in_teams"}),a.file.fileById(e)),U.stop()}catch(e){const t=`Unexpected error while file viewer resolution with error code: ${e?.errorCode}`;b.errorToTelemetry?.(t,"files_viewer_resolver"),U.fail({errorCode:e?.errorCode,message:t,reason:"Unexpected error while file viewer resolution"})}},R=async(e,t,n,i,a,o,r,s,l,d,c,p,m,h)=>{const f=await O(e,t,n,i,a,o,r,s,l,d,c,p,m,h);if(f){const t=await(0,u.tN)(e,m,h,f,c,"file-viewer-route-to-platform-app",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:p});if(t&&t.length>0&&(m.logNoPii?.(`getDocumentViewAppId: Pre-install check enabled: app pre-install state ${t[0].installationState}`),V(t[0])))return f}},O=async(e,t,n,i,a,o,r,s,l,d,c,p,u,A)=>{const{icon:T}=(0,m.ao)(t);switch(T){case h.f:case f.K:if(n)return"3e0a4fec-499b-4138-8e7c-71a9d88a62ed";break;case g.E:case I.j:if(n)return"d7958adf-f419-46fa-941b-1b946497ef84";break;case _.V:case C.g:if(n)return"1c256a65-83a6-4b5c-9ccf-78f8afb6f1e8";break;case v.P:if(i)return x(o,s,a,r,e,c,p,u,A);break;case y.y:case w.T:case S.v:if(l)return"0d820ecd-def2-4297-adad-78056cde7c78";break;case b.a:case E.r:if(d)return"d7958adf-f419-46fa-941b-1b946497ef95"}},x=async(e,t,n,i,a,o,r,s,l)=>{const d=e;if(d){const e=await(0,u.tN)(a,s,l,d,o,"check-status-and-give-pdf-app-for-user",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:r});if(n){if(!(e&&e.length>0))return;{const t=e[0].installerIdentity?.azureAdAppId,n=t&&i?.includes(t);if(s.logNoPii?.(`getDocumentViewAppId: AAA Pre-install check enabled: Is App Installed by AAA:  ${n} and installedByAppId: ${t}}`),n)return d}}return t?e&&e.length>0?(s.logNoPii?.(`getDocumentViewAppId: Pre-install check enabled: app pre-install state ${e[0].installationState}`),"AdminPreInstalled"===e[0].installationState?d:void 0):void 0:d}},V=e=>!!e.installationState&&["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"].includes(e.installationState),$=async(e,t,n)=>{try{if(e.threadId){const{data:i,error:a}=await t.query({query:T.q,fetchPolicy:"cache-first",variables:{conversationId:e.threadId}});return a?void n.errorToTelemetry?.(`getChannelFields threw error ${a.message}`,"files_viewer_resolver"):i}return}catch(e){return void(e?.message?.includes("Id is not of a channel")?n.logNoPii?.(`Not called from channel ${e.message}`):n.errorToTelemetry?.(`Exception while fetching channel info ${e?.message}`,"files_viewer_resolver"))}},B=(e,t,n)=>t&&!n?{...e,shouldOpenInMultiWindow:!0}:e},160177:(e,t,n)=>{n.d(t,{j_:()=>ge,I3:()=>se,ao:()=>le,oF:()=>de,sI:()=>Ie,yi:()=>he,eq:()=>ve,pf:()=>ce,Ju:()=>pe,$7:()=>ye,St:()=>fe,Jr:()=>ue,_s:()=>me,xH:()=>we,EC:()=>Se,i5:()=>Ee,j6:()=>_e,_w:()=>Ce});var i=n(513432),a=n(544825),o=n(182504),r=n(272924),s=n(196131),l=n(967009),d=n(453740),c=n(513485),p=n(572954),u=n(352179),m=n(166825),h=n(669344),f=n(924162),g=n(721560),I=n(371171),_=n(72113),C=n(948678),v=n(882563),y=n(288325),w=n(760840),S=n(27226),b=n(736633),E=n(731953),A=n(323040),T=n(169195),F=n(79743),D=n(384609),k=n(753318),P=n(764076),L=n(662201),U=n(957032),M=n(370118),R=n(476951),O=n(757146);const x=(0,O.A)((e=>{const t=(0,R.k)();return(0,U.Y)("svg",{width:"20",height:"20",viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,className:(0,M.z)(t.root,e.className),children:[(0,U.Y)("path",{d:"M21.9623 1.2543L4.2291 4.64572C3.12934 4.85604 2.33402 5.81792 2.33406 6.93761L2.33409 7.58175L2.91823 9.62879C3.0845 10.2115 3.66915 10.5699 4.26383 10.4537L22.9919 6.79439C23.9263 6.6118 24.5434 5.71562 24.3805 4.77752L24.0152 2.6738C23.8479 1.71004 22.9231 1.07056 21.9623 1.2543Z",fill:"url(#paint0_linear_4412_60534)"}),(0,U.Y)("path",{d:"M2.33398 19.834H25.6673V22.459C25.6673 24.2309 24.2309 25.6673 22.459 25.6673H5.54232C3.77041 25.6673 2.33398 24.2309 2.33398 22.459V19.834Z",fill:"url(#paint1_linear_4412_60534)"}),(0,U.Y)("path",{d:"M18.6673 9.33398H2.33398V15.1673H18.6673V9.33398Z",fill:"url(#paint2_linear_4412_60534)"}),(0,U.Y)("path",{d:"M9.33399 15.166H2.33398V19.8327H9.33399V15.166Z",fill:"url(#paint3_linear_4412_60534)"}),(0,U.Y)("path",{d:"M18.666 9.33398L23.6244 9.33399C24.7519 9.33399 25.666 10.2481 25.666 11.3757V15.1673H18.666V9.33398Z",fill:"url(#paint4_linear_4412_60534)"}),(0,U.Y)("path",{d:"M25.6673 15.166H9.33398V19.8327H25.6673V15.166Z",fill:"url(#paint5_linear_4412_60534)"}),(0,U.Y)("path",{d:"M2.33398 18.666V19.8327H4.66732C3.37432 19.8327 2.33398 19.3125 2.33398 18.666Z",fill:"#8362F6"}),(0,U.Y)("path",{d:"M2.33398 12.834V15.1673H4.66732C3.37432 15.1673 2.33398 14.127 2.33398 12.834Z",fill:"#D78FF9"}),(0,U.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.66536 9.33333H2.33203V7C2.33203 8.28866 3.3767 9.33333 4.66536 9.33333Z",fill:"#EEACFB"}),(0,U.Y)("defs",{children:[(0,U.Y)("linearGradient",{id:"paint0_linear_4412_60534",x1:"2.33398",y1:"0.919922",x2:"21.596",y2:"14.8996",gradientUnits:"userSpaceOnUse",children:[(0,U.Y)("stop",{stopColor:"#5A4CDB"}),(0,U.Y)("stop",{offset:"1",stopColor:"#AD58DB"})]}),(0,U.Y)("linearGradient",{id:"paint1_linear_4412_60534",x1:"2.33398",y1:"21.7784",x2:"25.6673",y2:"21.7784",gradientUnits:"userSpaceOnUse",children:[(0,U.Y)("stop",{stopColor:"#8462F6"}),(0,U.Y)("stop",{offset:"1",stopColor:"#4D37F1"})]}),(0,U.Y)("linearGradient",{id:"paint2_linear_4412_60534",x1:"2.33398",y1:"11.6673",x2:"18.6822",y2:"12.5614",gradientUnits:"userSpaceOnUse",children:[(0,U.Y)("stop",{stopColor:"#EFADFB"}),(0,U.Y)("stop",{offset:"1",stopColor:"#D28CF8"})]}),(0,U.Y)("linearGradient",{id:"paint3_linear_4412_60534",x1:"2.33398",y1:"17.4993",x2:"7.93398",y2:"17.4993",gradientUnits:"userSpaceOnUse",children:[(0,U.Y)("stop",{stopColor:"#D991F9"}),(0,U.Y)("stop",{offset:"1",stopColor:"#C680F7"})]}),(0,U.Y)("linearGradient",{id:"paint4_linear_4412_60534",x1:"18.666",y1:"12.834",x2:"25.666",y2:"12.834",gradientUnits:"userSpaceOnUse",children:[(0,U.Y)("stop",{stopColor:"#B874F6"}),(0,U.Y)("stop",{offset:"1",stopColor:"#A866F5"})]}),(0,U.Y)("linearGradient",{id:"paint5_linear_4412_60534",x1:"9.33398",y1:"17.4993",x2:"25.6673",y2:"17.4993",gradientUnits:"userSpaceOnUse",children:[(0,U.Y)("stop",{stopColor:"#A66BF6"}),(0,U.Y)("stop",{offset:"1",stopColor:"#814DF3"})]})]})]})}),"ClipchampBrandIcon"),V=(0,O.A)((e=>(0,U.Y)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"none",...e,children:[(0,U.Y)("path",{d:"M27.3333 3.33337H9.09666L3.33333 9.09671V27.3334C3.33333 27.687 3.4738 28.0261 3.72385 28.2762C3.9739 28.5262 4.31304 28.6667 4.66666 28.6667H22.9033L28.6667 22.9034V4.66671C28.6667 4.31309 28.5262 3.97395 28.2761 3.7239C28.0261 3.47385 27.6869 3.33337 27.3333 3.33337Z",fill:"white"}),(0,U.Y)("path",{opacity:"0.67",d:"M27.3333 2.66663H8.82L2.66667 8.81996V27.3333C2.66667 27.8637 2.87739 28.3724 3.25246 28.7475C3.62753 29.1226 4.13624 29.3333 4.66667 29.3333H23.18L29.3333 23.18V4.66663C29.3333 4.13619 29.1226 3.62749 28.7476 3.25241C28.3725 2.87734 27.8638 2.66663 27.3333 2.66663ZM28.6667 22.9033L22.9033 28.6666H4.66667C4.31305 28.6666 3.97391 28.5262 3.72386 28.2761C3.47381 28.0261 3.33334 27.6869 3.33334 27.3333V9.09663L9.09667 3.33329H27.3333C27.687 3.33329 28.0261 3.47377 28.2761 3.72382C28.5262 3.97387 28.6667 4.313 28.6667 4.66663V22.9033Z",fill:"#605E5C"}),(0,U.Y)("path",{d:"M11.3333 9.66663H7.00001C6.81591 9.66663 6.66667 9.81586 6.66667 9.99996V11.3333C6.66667 11.5174 6.81591 11.6666 7.00001 11.6666H11.3333C11.5174 11.6666 11.6667 11.5174 11.6667 11.3333V9.99996C11.6667 9.81586 11.5174 9.66663 11.3333 9.66663Z",fill:"#ECCF35"}),(0,U.Y)("path",{d:"M25 9.66663H13.6667C13.4826 9.66663 13.3333 9.81586 13.3333 9.99996V11.3333C13.3333 11.5174 13.4826 11.6666 13.6667 11.6666H25C25.1841 11.6666 25.3333 11.5174 25.3333 11.3333V9.99996C25.3333 9.81586 25.1841 9.66663 25 9.66663Z",fill:"#FED912"}),(0,U.Y)("path",{d:"M11.3333 13.3334H7.00001C6.81591 13.3334 6.66667 13.4826 6.66667 13.6667V15C6.66667 15.1841 6.81591 15.3334 7.00001 15.3334H11.3333C11.5174 15.3334 11.6667 15.1841 11.6667 15V13.6667C11.6667 13.4826 11.5174 13.3334 11.3333 13.3334Z",fill:"#E25A01"}),(0,U.Y)("path",{d:"M25 13.3334H13.6667C13.4826 13.3334 13.3333 13.4826 13.3333 13.6667V15C13.3333 15.1841 13.4826 15.3334 13.6667 15.3334H25C25.1841 15.3334 25.3333 15.1841 25.3333 15V13.6667C25.3333 13.4826 25.1841 13.3334 25 13.3334Z",fill:"#F18C0A"}),(0,U.Y)("path",{d:"M11.3333 17H7.00001C6.81591 17 6.66667 17.1492 6.66667 17.3333V18.6667C6.66667 18.8508 6.81591 19 7.00001 19H11.3333C11.5174 19 11.6667 18.8508 11.6667 18.6667V17.3333C11.6667 17.1492 11.5174 17 11.3333 17Z",fill:"#BF3207"}),(0,U.Y)("path",{d:"M25 17H13.6667C13.4826 17 13.3333 17.1492 13.3333 17.3333V18.6667C13.3333 18.8508 13.4826 19 13.6667 19H25C25.1841 19 25.3333 18.8508 25.3333 18.6667V17.3333C25.3333 17.1492 25.1841 17 25 17Z",fill:"#D83B01"}),(0,U.Y)("path",{d:"M11.3333 20.6666H7.00001C6.81591 20.6666 6.66667 20.8159 6.66667 21V22.3333C6.66667 22.5174 6.81591 22.6666 7.00001 22.6666H11.3333C11.5174 22.6666 11.6667 22.5174 11.6667 22.3333V21C11.6667 20.8159 11.5174 20.6666 11.3333 20.6666Z",fill:"#773C6E"}),(0,U.Y)("path",{d:"M25 20.6666H13.6667C13.4826 20.6666 13.3333 20.8159 13.3333 21V22.3333C13.3333 22.5174 13.4826 22.6666 13.6667 22.6666H25C25.1841 22.6666 25.3333 22.5174 25.3333 22.3333V21C25.3333 20.8159 25.1841 20.6666 25 20.6666Z",fill:"#974B8B"})]})),"SPListIcon"),$=(0,O.A)((e=>i.createElement("svg",{width:"32",height:"32",fill:"none",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M24.6667 4C25.0203 4 25.3594 4.14048 25.6095 4.39052C25.8595 4.64057 26 4.97971 26 5.33333V26.6667C26 27.0203 25.8595 27.3594 25.6095 27.6095C25.3594 27.8595 25.0203 28 24.6667 28H7.33333C6.97971 28 6.64057 27.8595 6.39052 27.6095C6.14048 27.3594 6 27.0203 6 26.6667V5.33333C6 4.97971 6.14048 4.64057 6.39052 4.39052C6.64057 4.14048 6.97971 4 7.33333 4H24.6667Z",fill:"white"}),i.createElement("path",{opacity:"0.67",fillRule:"evenodd",clipRule:"evenodd",d:"M24.6667 3C25.2855 3 25.879 3.24583 26.3166 3.68342C26.7542 4.121 27 4.7145 27 5.33333V26.6667C27 27.2855 26.7542 27.879 26.3166 28.3166C25.879 28.7542 25.2855 29 24.6667 29H7.33333C6.7145 29 6.121 28.7542 5.68342 28.3166C5.24583 27.879 5 27.2855 5 26.6667V5.33333C5 4.71449 5.24583 4.121 5.68342 3.68342C6.121 3.24583 6.71449 3 7.33333 3H24.6667ZM25.6095 4.39052C25.3594 4.14048 25.0203 4 24.6667 4H7.33333C6.97971 4 6.64057 4.14048 6.39052 4.39052C6.14048 4.64057 6 4.97971 6 5.33333V26.6667C6 27.0203 6.14048 27.3594 6.39052 27.6095C6.64057 27.8595 6.97971 28 7.33333 28H24.6667C25.0203 28 25.3594 27.8595 25.6095 27.6095C25.8595 27.3594 26 27.0203 26 26.6667V5.33333C26 4.97971 25.8595 4.64057 25.6095 4.39052Z",fill:"#605E5C"}),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 9H11C10.7239 9 10.5 9.22386 10.5 9.5C10.5 9.77614 10.7239 10 11 10H21C21.2761 10 21.5 9.77614 21.5 9.5C21.5 9.22386 21.2761 9 21 9ZM11 8C10.1716 8 9.5 8.67157 9.5 9.5C9.5 10.3284 10.1716 11 11 11H21C21.8284 11 22.5 10.3284 22.5 9.5C22.5 8.67157 21.8284 8 21 8H11Z",fill:"#ECCF35"}),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 13.3335H11C10.7239 13.3335 10.5 13.5574 10.5 13.8335C10.5 14.1096 10.7239 14.3335 11 14.3335H21C21.2761 14.3335 21.5 14.1096 21.5 13.8335C21.5 13.5574 21.2761 13.3335 21 13.3335ZM11 12.3335C10.1716 12.3335 9.5 13.0051 9.5 13.8335C9.5 14.6619 10.1716 15.3335 11 15.3335H21C21.8284 15.3335 22.5 14.6619 22.5 13.8335C22.5 13.0051 21.8284 12.3335 21 12.3335H11Z",fill:"#F18C0A"}),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 17.6665H11C10.7239 17.6665 10.5 17.8904 10.5 18.1665C10.5 18.4426 10.7239 18.6665 11 18.6665H21C21.2761 18.6665 21.5 18.4426 21.5 18.1665C21.5 17.8904 21.2761 17.6665 21 17.6665ZM11 16.6665C10.1716 16.6665 9.5 17.3381 9.5 18.1665C9.5 18.9949 10.1716 19.6665 11 19.6665H21C21.8284 19.6665 22.5 18.9949 22.5 18.1665C22.5 17.3381 21.8284 16.6665 21 16.6665H11Z",fill:"#D83B01"}),i.createElement("path",{d:"M9.5 23.5C9.5 22.6716 10.1716 22 11 22H14C14.8284 22 15.5 22.6716 15.5 23.5C15.5 24.3284 14.8284 25 14 25H11C10.1716 25 9.5 24.3284 9.5 23.5Z",fill:"#974B8B"})))),B=(0,O.A)((e=>i.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M10.25 3H27.75C28.4404 3 29 3.55964 29 4.25V27.75C29 28.4404 28.4404 29 27.75 29H10.25C9.55964 29 9 28.4404 9 27.75V25C12.8889 25 9 21.8889 9 18C9 14.1111 12.8889 11 9 11V4.25C9 3.55964 9.55964 3 10.25 3Z",fill:"white"}),i.createElement("path",{opacity:.67,d:"M10.25 3H27.75C28.4403 3 29 3.55963 29 4.25V27.75C29 28.4404 28.4403 29 27.75 29H10.25C9.55969 29 9 28.4404 9 27.75V25H8V27.75C8 28.9926 9.00732 30 10.25 30H27.75C28.9927 30 30 28.9926 30 27.75V4.25C30 3.00735 28.9927 2 27.75 2H10.25C9.00732 2 8 3.00735 8 4.25V11.0697C8.32642 11.0237 8.66016 11 9 11V4.25C9 3.55963 9.55969 3 10.25 3Z",fill:"#605E5C"}),i.createElement("g",{clipPath:"url(#clip0_333_16553)"},i.createElement("path",{d:"M2 14.5L5.5 11H15.4437C15.7521 11 16 11.2479 16 11.5563V14.5L9 16.1042L2 14.5Z",fill:"#FEE200"}),i.createElement("path",{d:"M6.33333 17.8958L2 19.6875V14.5H5.5L6.33333 17.8958Z",fill:"url(#paint0_linear_333_16553)"}),i.createElement("path",{d:"M16 18.0417V14.5H5.5V18.0833L10.2708 18.9375L16 18.0417Z",fill:"url(#paint1_linear_333_16553)"}),i.createElement("path",{d:"M16 21.5V18H4.72917V21.5208L11.6667 22.1667L16 21.5Z",fill:"url(#paint2_linear_333_16553)"}),i.createElement("path",{d:"M5.5 21.5L2 22.6667V18H5.5V21.5Z",fill:"url(#paint3_linear_333_16553)"}),i.createElement("path",{d:"M5.49999 21.5L4.95833 23.1667L5.49999 25H12.5L16 21.5H5.49999Z",fill:"url(#paint4_linear_333_16553)"}),i.createElement("path",{d:"M5.5 25H2.65833C2.29375 25 2 24.7063 2 24.3417V21.5H5.5V25Z",fill:"url(#paint5_linear_333_16553)"})),i.createElement("path",{opacity:.67,d:"M25.8007 13.5L18.75 13.5C18.3358 13.5 18 13.1642 18 12.75C18 12.3358 18.3358 12 18.75 12H25.8007C26.2149 12 26.5507 12.3358 26.5507 12.75C26.5507 13.1642 26.2149 13.5 25.8007 13.5Z",fill:"#605E5C"}),i.createElement("path",{opacity:.67,d:"M25.8007 23.5L18.75 23.5C18.3358 23.5 18 23.1642 18 22.75C18 22.3358 18.3358 22 18.75 22H25.8007C26.2149 22 26.5507 22.3358 26.5507 22.75C26.5507 23.1642 26.2149 23.5 25.8007 23.5Z",fill:"#605E5C"}),i.createElement("path",{opacity:.67,d:"M25.8007 18.5L18.75 18.5C18.3358 18.5 18 18.1642 18 17.75C18 17.3358 18.3358 17 18.75 17H25.8007C26.2149 17 26.5507 17.3358 26.5507 17.75C26.5507 18.1642 26.2149 18.5 25.8007 18.5Z",fill:"#605E5C"}),i.createElement("defs",null,i.createElement("linearGradient",{id:"paint0_linear_333_16553",x1:4.16667,y1:19.6875,x2:4.16667,y2:14.5,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#E25A01"}),i.createElement("stop",{offset:.6095,stopColor:"#E15801"}),i.createElement("stop",{offset:.8778,stopColor:"#E05101"}),i.createElement("stop",{offset:1,stopColor:"#DE4A01"})),i.createElement("linearGradient",{id:"paint1_linear_333_16553",x1:10.75,y1:18.9375,x2:10.75,y2:14.5,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#F18C0A"}),i.createElement("stop",{offset:.4373,stopColor:"#F0880A"}),i.createElement("stop",{offset:.8679,stopColor:"#EC7C0A"}),i.createElement("stop",{offset:1,stopColor:"#EB770A"})),i.createElement("linearGradient",{id:"paint2_linear_333_16553",x1:10.3646,y1:22.1667,x2:10.3646,y2:18,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#D83B01"}),i.createElement("stop",{offset:.4718,stopColor:"#D63701"}),i.createElement("stop",{offset:.9366,stopColor:"#CE2B01"}),i.createElement("stop",{offset:1,stopColor:"#CD2901"})),i.createElement("linearGradient",{id:"paint3_linear_333_16553",x1:3.75,y1:22.6667,x2:3.75,y2:18,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{offset:0,stopColor:"#BF3207"}),i.createElement("stop",{offset:.4718,stopColor:"#BB3207"}),i.createElement("stop",{offset:.9366,stopColor:"#AF3007"}),i.createElement("stop",{offset:1,stopColor:"#AD3007"})),i.createElement("linearGradient",{id:"paint4_linear_333_16553",x1:10.4792,y1:25,x2:10.4792,y2:21.5,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#854A81"}),i.createElement("stop",{offset:.4817,stopColor:"#82497E"}),i.createElement("stop",{offset:.8116,stopColor:"#794475"}),i.createElement("stop",{offset:1,stopColor:"#703F6C"})),i.createElement("linearGradient",{id:"paint5_linear_333_16553",x1:3.75,y1:25,x2:3.75,y2:21.5,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#703D6E"}),i.createElement("stop",{offset:.6307,stopColor:"#6C3B6A"}),i.createElement("stop",{offset:1,stopColor:"#663764"})),i.createElement("clipPath",{id:"clip0_333_16553"},i.createElement("rect",{width:14,height:14,fill:"white",transform:"translate(2 11)"})))))),H=(0,O.A)((e=>(0,U.Y)("svg",{viewBox:"0 0 256 256",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,U.Y)("path",{d:"M66 192V220C66 222.209 67.7909 224 70 224H220C222.209 224 224 222.209 224 220V68C224 65.7909 222.209 64 220 64H190V188C190 190.209 188.209 192 186 192H66Z",fill:"white"}),(0,U.Y)("path",{d:"M58 192V220C58 226.627 63.3726 232 70 232H220C226.627 232 232 226.627 232 220V68C232 61.3726 226.627 56 220 56H190V64H220C222.209 64 224 65.7909 224 68V220C224 222.209 222.209 224 220 224H70C67.7909 224 66 222.209 66 220V192H58Z",fill:"#908F8E"}),(0,U.Y)("path",{d:"M32 36C32 33.7909 33.7909 32 36 32H186C188.209 32 190 33.7909 190 36V188C190 190.209 188.209 192 186 192H36C33.7909 192 32 190.209 32 188V36Z",fill:"white"}),(0,U.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 24H186C192.627 24 198 29.3726 198 36V188C198 194.627 192.627 200 186 200H36C29.3726 200 24 194.627 24 188V36C24 29.3726 29.3726 24 36 24ZM36 32C33.7909 32 32 33.7909 32 36V188C32 190.209 33.7909 192 36 192H186C188.209 192 190 190.209 190 188V36C190 33.7909 188.209 32 186 32H36Z",fill:"#908F8E"}),(0,U.Y)("path",{d:"M151 113C150.991 113.587 150.828 114.16 150.53 114.661C150.231 115.161 149.808 115.571 149.303 115.848L91.525 149.479C90.9701 149.805 90.3446 149.983 89.7052 149.999C89.0657 150.014 88.4327 149.866 87.8633 149.568C87.3159 149.303 86.8514 148.888 86.5222 148.367C86.193 147.847 86.0121 147.243 86 146.623V113H151Z",fill:"#BC1948"}),(0,U.Y)("path",{d:"M151 113C150.991 112.445 150.828 111.902 150.53 111.429C150.231 110.955 149.808 110.567 149.303 110.305L91.525 78.4815C90.42 77.8725 89.0117 77.8375 87.8633 78.3975C86.715 78.9576 86 80.0216 86 81.1766V113H151Z",fill:"#E8467C"})]})),"SPListPlaylistIcon");var N=n(680817),W=n(206978),G=n(866648),Y=n(763501),j=n(49180),q=n(609113),Q=n(754255),Z=n(735652),z=n(702183),J=n(924820),X=n(106309);const K={appName:"Word"},ee={appName:"Excel"},te={appName:"PowerPoint"},ne={appName:"Visio"},ie={appName:"OneNote"},ae={appName:"Whiteboard"},oe={WordIcon:a.E,ExcelIcon:o.V,PowerPointIcon:r.f,OneNoteIcon:s.y,FilesCodeIcon:l.q,FilesSketchIcon:d.b,FilesIllustratorIcon:c.e,FilesFlashIcon:p.f,FilesPhotoshopIcon:u.N,FilesIndesignIcon:m.m,FilesAftereffectsIcon:h.v,FilesPdfIcon:f.P,FilesTxtIcon:g.X,FilesZipIcon:I.k,FilesImageIcon:_.E,FilesGifIcon:C.V,FilesSoundIcon:v.g,VisioIcon:y.a,ClipchampIcon:N.b,LoopFileIcon:w.o,WhiteboardColorIcon:S.g,SharepointIcon:b.x,SPListBrandIcon:W.w,ThreeDFileIcon:G.O},re=new Map;["docx","doc","docm","dotx","dot","dotm","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"].forEach((e=>{re.set(e,a.E)})),["xlsx","xlsb","xls","xlsm","csv","ods","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12"].forEach((e=>{re.set(e,o.V)})),["pptx","potm","ppt","pptm","pot","potx","pps","ppsm","ppsx","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.template.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"].forEach((e=>{re.set(e,r.f)})),["note","one","onenote","onepkg","notebk","onetoc2"].forEach((e=>{re.set(e,s.y)})),["js","cs","html","htm","cmd","c","class","xml","cpp","ts"].forEach((e=>{re.set(e,l.q)})),["sketch"].forEach((e=>{re.set(e,d.b)})),["ai","ait","eps"].forEach((e=>{re.set(e,c.e)})),["fla","swf","as"].forEach((e=>{re.set(e,p.f)})),["psd","pdd"].forEach((e=>{re.set(e,u.N)})),["indd","indl","indt","indb"].forEach((e=>{re.set(e,m.m)})),["aep","aet","aaf","aepx"].forEach((e=>{re.set(e,h.v)})),["pdf","application/pdf"].forEach((e=>{re.set(e,f.P)})),["txt"].forEach((e=>{re.set(e,g.X)})),["zip","rar"].forEach((e=>{re.set(e,I.k)})),["image/png","image/jpg","png","jpg","image/jpeg","jpeg","bmp","tiff","tif"].forEach((e=>{re.set(e,_.E)})),["image/gif","gif"].forEach((e=>{re.set(e,C.V)})),["mp3","wav","m4a","wma"].forEach((e=>{re.set(e,v.g)})),["vsdx","vsdm","vsd"].forEach((e=>{re.set(e,y.a)})),["3g2","3gp","3gpp","asf","avi","m2ts","m4v","mkv","mp4v","mts","mp4","mov","wmv","webm"].forEach((e=>{re.set(e,N.b)})),["fluid","loop"].forEach((e=>{re.set(e,w.o)})),["whiteboard"].forEach((e=>{re.set(e,S.g)})),["glb","gltf","splat","ply","obj","stl","fbx","3mf"].forEach((e=>{re.set(e,G.O)})),["splist","splistform","splistitem","splistplaylist"].forEach((e=>{re.set(e,W.w)})),["sppage"].forEach((e=>{re.set(e,b.x)})),["splistform"].forEach((e=>{re.set(e,W.w)})),["splistitem"].forEach((e=>{re.set(e,W.w)})),["splistplaylist"].forEach((e=>{re.set(e,W.w)}));const se=e=>oe[e],le=(e,t)=>{let n,i,l="",d="",c="";switch(n=re.get(e||"")||E.C,e){case"docx":case"doc":case"docm":case"dotx":case"dot":case"dotm":case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":case"application/vnd.ms-word.document.macroEnabled.12":case"application/vnd.ms-word.template.macroEnabled.12":n=t?a.E:A.j,l="ms-word",d="microsoft word",c=K.appName;break;case"xlsx":case"xlsb":case"xls":case"xlsm":case"csv":case"ods":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":case"application/vnd.ms-excel.sheet.macroEnabled.12":case"application/vnd.ms-excel.template.macroEnabled.12":case"application/vnd.ms-excel.addin.macroEnabled.12":case"application/vnd.ms-excel.sheet.binary.macroEnabled.12":n=t?o.V:T.g,l="ms-excel",d="microsoft excel",c=ee.appName;break;case"pptx":case"potm":case"ppt":case"pptm":case"pot":case"potx":case"pps":case"ppsm":case"ppsx":case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.openxmlformats-officedocument.presentationml.template":case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":case"application/vnd.ms-powerpoint.addin.macroEnabled.12":case"application/vnd.ms-powerpoint.presentation.macroEnabled.12":case"application/vnd.ms-powerpoint.template.macroEnabled.12":case"application/vnd.ms-powerpoint.slideshow.macroEnabled.12":n=t?r.f:F.K,l="ms-powerpoint",d="microsoft powerpoint",c=te.appName;break;case"note":n=t?s.y:D.v,l="onenote",d="microsoft onenote",c=ie.appName;break;case"one":case"onenote":case"onepkg":case"notebk":case"onetoc2":n=t?s.y:k.T,l="onenote",d="microsoft onenote",c=ie.appName;break;case"pdf":case"application/pdf":l="pdf";break;case"vsdx":case"vsdm":case"vsd":n=t?y.a:P.r,l="ms-visio",d="microsoft visio",c=ne.appName;break;case"3g2":case"3gp":case"3gpp":case"asf":case"avi":case"m2ts":case"m4v":case"mkv":case"mp4v":case"mts":case"mp4":case"mov":case"wmv":case"webm":n=t?x:N.b;break;case"fluid":case"loop":n=w.o;break;case"whiteboard":d="microsoft whiteboard",c=ae.appName;break;case"splist":n=t?W.w:V,i=X.$j;break;case"splistform":n=t?W.w:$,i=X.kc;break;case"splistitem":n=t?W.w:B,i=X.te;break;case"splistplaylist":n=t?W.w:H,i=X.Wj}return{icon:n,isImage:n===_.E,uriScheme:l,applicationName:d,applicationDisplayName:c,dataTid:i}},de=(e,t)=>{const{icon:n,isImage:i,dataTid:a}=le(e,t);return{icon:n,isImage:i,dataTid:a}},ce=e=>{switch(le(e).icon){case A.j:case T.g:case k.T:case F.K:case P.r:return!0;default:return!1}},pe=e=>le(e,!0).icon===s.y,ue=e=>le(e,!0).icon===y.a,me=e=>{switch(le(e).icon){case A.j:case T.g:case F.K:return!0;default:return!1}},he=e=>{switch(le(e).icon){case A.j:case a.E:case T.g:case o.V:case F.K:case r.f:case k.T:case s.y:case D.v:case P.r:case y.a:case v.g:case N.b:case w.o:case S.g:return!0}return!1},fe=e=>{switch(le(e).icon){case v.g:case N.b:return!0;default:return!1}};var ge;!function(e){e[e.UnifiedAppViewer=0]="UnifiedAppViewer",e[e.OneUpViewer=1]="OneUpViewer",e[e.EmailViewer=2]="EmailViewer",e[e.None=3]="None"}(ge||(ge={}));const Ie=e=>{if(!e)return ge.None;const{icon:t}=le(e);switch(t){case f.P:return ge.OneUpViewer;case r.f:case F.K:case a.E:case A.j:case o.V:case T.g:case s.y:case D.v:case k.T:case y.a:case P.r:return ge.UnifiedAppViewer;case w.o:case S.g:return ge.None;default:return ge.OneUpViewer}},_e=(e,t,n,i,a,o,r,s)=>{const l=t.newScenario(z.Cu.FileInfoValidation),d=(0,Y.oZ)(e,n);if(!d)return n.errorToTelemetry?.("validateFileUrlsFormat: One of the file URLs is invalid","files_chiclet_url_validation"),l.fail({errors:"invalid url",errorCode:j.jH.InvalidURL}),X.r2.InvalidFormat;if(i){if(l.mark("validating-file-url-protocols"),!r)return n.errorToTelemetry?.("No file protocols have been allow-listed, all chiclets will be hidden","files_chiclet_url_validation"),X.r2.InvalidProtocol;const e=(0,Y.JH)(d,r);if(e instanceof URL)return n.errorToTelemetry?.(`validateFileUrlsProtocol: Invalid protocol - '${e.protocol}'`,"files_chiclet_url_validation"),l.fail({errors:`invalid url protocol, protocol : ${e.protocol} and hostname : ${e.hostname}`,errorCode:j.jH.InvalidURLProtocol}),X.r2.InvalidProtocol}if(o&&(l.mark("validating-file-urls-same-domain"),!(0,Y.j9)(d)))return n.errorToTelemetry?.("validateFileUrlsSameDomain: File URLs are from different domains!","files_chiclet_url_validation"),l.fail({errors:"File URLs are from different domains",errorCode:j.jH.DifferentURLDomains}),X.r2.DomainMismatchForDifferentUrl;if((0,Y.Om)(e,s)&&a){l.mark("validating-3P-file-url-domains");const t=(0,Y.iC)(e.providerDataV2.code,d,s);if(t instanceof URL)return n.errorToTelemetry?.(`validate3PFileUrlsDomain: Invalid 3P domain - '${t.hostname}'`,"files_chiclet_url_validation"),l.fail({errors:`invalid 3P url domain, protocol : ${t.protocol} and domain : ${t.hostname}`,errorCode:j.jH.Invalid3PURLDomain}),X.r2.InvalidExternalProviderDomain}return l.stop(),X.r2.Secure},Ce=(e,t,n,i,a,o)=>{const r=n.newScenario(z.Cu.FileInfoValidation),s=(0,Y.oZ)(e);if(!s)return i.errorToTelemetry?.("validateFileUrlsFormat: One of the file URLs is invalid","files_chiclet_url_validation"),r.fail({errors:"invalid url",errorCode:j.jH.InvalidURL}),X.r2.InvalidFormat;if(a&&!o&&!s.objectUrl)return i.errorToTelemetry?.("validateODAndSPODomains: Object URL is missing","files_chiclet_url_validation"),r.fail({errors:"object url is missing",errorCode:j.jH.ObjectUrlMissing}),X.r2.ObjectUrlMissing;r.mark("validating-spo-od-file-url-domains");const l=(0,Y.b6)(s,t);if(l instanceof URL){i.errorToTelemetry?.("validateODAndSPODomains: Invalid SPO / OD domain","files_chiclet_url_validation");const e=`invalid SPO / OD file url domain: ${l.hostname}`,t=(0,J.y)(e);return r.fail({errors:t,errorCode:j.jH.InvalidSPOOrPersonalSiteDomain}),X.r2.InvalidInternalDomain}return r.stop(),X.r2.Secure},ve=e=>!!me(e),ye=e=>!e||!(e=>"Google"===e||"WOPI"===e)(e),we=e=>{const t=Se(e.title);return{...e,title:t,type:t!==e.title?(0,q.QC)(t||""):e.type}},Se=e=>e&&be(e)?`${X.qf}${e.replace(X.wu,"")}`:e?`${e.replace(X.wu,"")}`:e,be=e=>X._l.test(e),Ee=()=>{const{enableTeamsFileChicletFps:e}=(0,Z.w2)(Q.w.Files,["enableTeamsFileChicletFps"]),{logActivity:t}=(0,L.Y)();return i.useCallback((n=>{e&&n&&["ChatChicletActionMenu","ChicletDefaultClick","chat","channel"].includes(n)&&t("teamsFileChicletFps")}),[e,t])}},806440:(e,t,n)=>{n.d(t,{bq:()=>m,iE:()=>y,$o:()=>g,Lx:()=>f,pE:()=>v,lT:()=>b,Gi:()=>C,mg:()=>w,QP:()=>A,d1:()=>_,A_:()=>I});var i=n(754255),a=n(572909),o=n(726723),r=n(505834),s=n(832669),l=n(501790),d=n(702183),c=n(363678),p=n(67309);const u={kind:"Document",get definitions(){const e=(0,p.G)("query ComponentsStageViewUtilsQuery($conversationId:ID!) {callByThreadId(conversationId:$conversationId) {id}}");return delete this.definitions,this.definitions=e.definitions}};var m,h=n(480354);!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(m||(m={}));const f=(e,t)=>e.entryPoint===c.hB.fileChiclet&&t?t:e.contentUrl,g=(e,t)=>t?`${e};replyChainId=${t}`:e,I=(e,t,n)=>{const{licenseType:a}=e.get(i.w.UserResources),{enableStageviewMW:o,enableStageviewMWInChannels:s,enableCollabStageForEDU:l}=e.get(i.w.Extensibility),d=t===c.hQ.desktop;return!(!l&&(0,r.Cd)(a)||!d)&&(!(!o&&!s)&&("chats"===n.type||"channels"===n.type||"callingchats"===n.type))},_=e=>{const t=d.Cu.PlatformTabStageViewFrameLoading,n=e.newScenario(t),i=e.newScenario(d.Cu.PlatformTabLaunch);return n.clientId=n.id,i.clientId=i.id,e.hoistScenarioToCore?.(n),e.hoistScenarioToCore?.(i),{phase1CollabStageScenario:n,endToEndScenario:i}},C=(e,t)=>`${e.appId}-${e.convId}-${t}-${e.reloadToggle}`;function v(e,t,n){const i={};try{if(n?.linkedEntity?.type===a.ck.calls){const{convId:t,messageId:o}=(0,l.q0)(n,a.ck.extensions,a.SY.view,e);o&&"0"!==o?(i.channelId=t,i.parentMessageId=o,i.channelMeetingMessageId=o,i.chatId=t):i.chatId=t}else if(n?.linkedEntity?.type===a.ck.channels){const{channelId:t}=n?.linkedEntity?.id&&JSON.parse(n?.linkedEntity?.id);i.channelId=t;const{messageId:o,replyChainId:r}=(0,l.q0)(n,a.ck.extensions,a.SY.view,e);i.replyChainId=r,i.parentMessageId=o,i.channelMeetingMessageId=o}else switch(n?.type){case a.ck.channels:const{channelId:o}=n?.id&&JSON.parse(n.id);i.channelId=o;break;case a.ck.chats:const r=(n.id??"").split(";replyChainId=");r.length>1&&(i.replyChainId=r[1],i.channelId=r[0]),i.chatId=r[0];break;case a.ck.extensions:const l=(0,s.Wo)(n,t,e);i.parentMessageId=l?.messageId,i.channelMeetingMessageId=l?.messageId,i.chatId=l?.messageId?void 0:l?.threadId,i.channelId=l?.messageId?l?.threadId:void 0}}catch(t){e.log("Error while parsing source view entity.",t?.message)}return i}const y=async(e,t,n)=>{try{const{convId:i}=e;n?.appendEventData({"StageView.OpenMode":"popoutWithChat"});const{data:o}=await t.query({query:u,fetchPolicy:"no-cache",variables:{conversationId:i}}),r=C(e,e.contentUrl);n?.mark(d.BQ.StageViewGetCallByThreadIdSuccessful);return{stageViewId:r,linkedEntity:o?.callByThreadId?{id:`${i}-stageview`,type:a.ck.platformstageinactivemeeting}:{id:g(i,e.replyChainId),type:a.ck.chats}}}catch(e){return n?.mark(d.BQ.StageViewFailedBeforeCommandTrigger),{}}},w=(e,t)=>{const{sdkHostType:n}=e.get(i.w.Sdk),a="Desktop"===n,{enableProgrammaticPopoutStageViewOpenAPI:o,enableProgrammaticPopoutStageDeeplink:r}=e.get(i.w.Extensibility);return t.entryPoint===c.hB.adaptiveCardCollabStage?m.popoutWithChat:t.entryPoint===c.hB.deepLinkStageView?S(t,a,!!r):S(t,a,!!o)},S=(e,t,n)=>{if(!t||!n)return m.modal;const i=e.openMode||m.popoutWithChat;return i===m.popoutWithChat?e.convId||e.channelId?e.channelId&&!e.replyChainId?m.popout:m.popoutWithChat:m.popout:i},b=(e,t)=>{switch(t){case c.hB.adaptiveCardCollabStage:return{actionOutcome:E(e),panelType:o.HP.AdaptiveCardCollabStage};case c.hB.stageViewOpenSDKApi:return{actionOutcome:E(e),panelType:o.HP.StageViewOpenSDKAPI};case c.hB.adaptiveCardStageModal:return{actionOutcome:E(e),panelType:o.HP.CollabStageViewModal};case c.hB.deepLinkStageView:return{actionOutcome:E(e),panelType:o.HP.DeeplinkStageView};default:return{actionOutcome:E(e),panelType:o.HP.AdaptiveCardCollabStage}}},E=e=>{switch(e){case m.modal:return o.nd.modal;case m.popout:return o.nd.popout;default:return o.nd.popoutWithChat}},A=e=>{const t=!(0,h.isEmpty)(e.tenantId),n=e.isMicrosoftOwned??!1;return(e.isFullScreenApp??!1)&&(t||n)}},680817:(e,t,n)=>{n.d(t,{b:()=>s});var i=n(957032),a=n(757146),o=n(370118),r=n(476951);const s=(0,a.A)((e=>{const t=(0,r.k)();return(0,i.Y)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"none",viewBox:"0 0 48 48",role:"presentation",...e,className:(0,o.z)(t.root,e.className),children:[(0,i.Y)("path",{d:"M43 6.5c0-.827-.673-1.5-1.5-1.5h-35C5.673 5 5 5.673 5 6.5v35c0 .827.673 1.5 1.5 1.5h35c.827 0 1.5-.673 1.5-1.5v-35z",fill:"#fff"}),(0,i.Y)("path",{opacity:".67",fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 44h35c1.379 0 2.5-1.122 2.5-2.5v-35C44 5.122 42.879 4 41.5 4h-35A2.503 2.503 0 0 0 4 6.5v35A2.503 2.503 0 0 0 6.5 44zM5 6.5C5 5.673 5.673 5 6.5 5h35c.827 0 1.5.673 1.5 1.5v35c0 .827-.673 1.5-1.5 1.5h-35c-.827 0-1.5-.673-1.5-1.5v-35z",fill:"#605E5C"}),(0,i.Y)("path",{d:"M32.508 23.162a.96.96 0 0 1 0 1.676l-14.004 8.026c-.665.382-1.504-.086-1.504-.838V15.974c0-.752.839-1.22 1.504-.838l14.004 8.026z",fill:"url(#a)"}),(0,i.Y)("path",{d:"M32.508 23.162a.96.96 0 0 1 0 1.676l-14.004 8.026c-.665.382-1.504-.086-1.504-.838V15.974c0-.752.839-1.22 1.504-.838l14.004 8.026z",fill:"url(#b)"}),(0,i.Y)("defs",{children:[(0,i.Y)("linearGradient",{id:"a",x1:"18.927",y1:"18.076",x2:"22.737",y2:"25.504",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#A966FF"}),(0,i.Y)("stop",{offset:"1",stopColor:"#892FFF"})]}),(0,i.Y)("linearGradient",{id:"b",x1:"25",y1:"28.594",x2:"23.366",y2:"20.581",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#A966FF"}),(0,i.Y)("stop",{offset:"1",stopColor:"#892FFF"})]})]})]})}),"ClipchampIconBase")},206978:(e,t,n)=>{n.d(t,{w:()=>a});var i=n(957032);const a=(0,n(757146).A)((e=>(0,i.Y)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,i.Y)("g",{clipPath:"url(#clip0_343_16222)",children:[(0,i.Y)("path",{d:"M2 6L6 2H17.3643C17.7167 2 18 2.28333 18 2.63571V6L10 7.83333L2 6Z",fill:"#FEE200"}),(0,i.Y)("path",{d:"M6.95238 9.88095L2 11.9286V6H6L6.95238 9.88095Z",fill:"url(#paint0_linear_343_16222)"}),(0,i.Y)("path",{d:"M18 10.0476V6H6V10.0952L11.4524 11.0714L18 10.0476Z",fill:"url(#paint1_linear_343_16222)"}),(0,i.Y)("path",{d:"M18 14V10H5.11902V14.0238L13.0476 14.7619L18 14Z",fill:"url(#paint2_linear_343_16222)"}),(0,i.Y)("path",{d:"M6 14L2 15.3333V10H6V14Z",fill:"url(#paint3_linear_343_16222)"}),(0,i.Y)("path",{d:"M6.00003 14L5.38098 15.9048L6.00003 18H14L18 14H6.00003Z",fill:"url(#paint4_linear_343_16222)"}),(0,i.Y)("path",{d:"M6 18H2.75238C2.33571 18 2 17.6643 2 17.2476V14H6V18Z",fill:"url(#paint5_linear_343_16222)"})]}),(0,i.Y)("defs",{children:[(0,i.Y)("linearGradient",{id:"paint0_linear_343_16222",x1:"4.47619",y1:"11.9286",x2:"4.47619",y2:"6",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#E25A01"}),(0,i.Y)("stop",{offset:"0.6095",stopColor:"#E15801"}),(0,i.Y)("stop",{offset:"0.8778",stopColor:"#E05101"}),(0,i.Y)("stop",{offset:"1",stopColor:"#DE4A01"})]}),(0,i.Y)("linearGradient",{id:"paint1_linear_343_16222",x1:"12",y1:"11.0714",x2:"12",y2:"6",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#F18C0A"}),(0,i.Y)("stop",{offset:"0.4373",stopColor:"#F0880A"}),(0,i.Y)("stop",{offset:"0.8679",stopColor:"#EC7C0A"}),(0,i.Y)("stop",{offset:"1",stopColor:"#EB770A"})]}),(0,i.Y)("linearGradient",{id:"paint2_linear_343_16222",x1:"11.5595",y1:"14.7619",x2:"11.5595",y2:"10",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#D83B01"}),(0,i.Y)("stop",{offset:"0.4718",stopColor:"#D63701"}),(0,i.Y)("stop",{offset:"0.9366",stopColor:"#CE2B01"}),(0,i.Y)("stop",{offset:"1",stopColor:"#CD2901"})]}),(0,i.Y)("linearGradient",{id:"paint3_linear_343_16222",x1:"4",y1:"15.3333",x2:"4",y2:"10",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{offset:"2.66389e-07",stopColor:"#BF3207"}),(0,i.Y)("stop",{offset:"0.4718",stopColor:"#BB3207"}),(0,i.Y)("stop",{offset:"0.9366",stopColor:"#AF3007"}),(0,i.Y)("stop",{offset:"1",stopColor:"#AD3007"})]}),(0,i.Y)("linearGradient",{id:"paint4_linear_343_16222",x1:"11.6905",y1:"18",x2:"11.6905",y2:"14",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#854A81"}),(0,i.Y)("stop",{offset:"0.4817",stopColor:"#82497E"}),(0,i.Y)("stop",{offset:"0.8116",stopColor:"#794475"}),(0,i.Y)("stop",{offset:"1",stopColor:"#703F6C"})]}),(0,i.Y)("linearGradient",{id:"paint5_linear_343_16222",x1:"4",y1:"18",x2:"4",y2:"14",gradientUnits:"userSpaceOnUse",children:[(0,i.Y)("stop",{stopColor:"#703D6E"}),(0,i.Y)("stop",{offset:"0.6307",stopColor:"#6C3B6A"}),(0,i.Y)("stop",{offset:"1",stopColor:"#663764"})]}),(0,i.Y)("clipPath",{id:"clip0_343_16222",children:(0,i.Y)("rect",{width:"16",height:"16",fill:"white",transform:"translate(2 2)"})})]})]})),"SPListBrandIcon")},866648:(e,t,n)=>{n.d(t,{O:()=>a});var i=n(957032);const a=(0,n(757146).A)((e=>(0,i.Y)("svg",{width:"1em",height:"1em",viewBox:"0 0 28 28",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",role:"presentation",...e,children:(0,i.Y)("path",{d:"M7.0575 9.3139C7.22892 8.86207 7.73416 8.63476 8.18599 8.80618L14.0006 11.0122L19.8152 8.80618C20.267 8.63476 20.7723 8.86207 20.9437 9.3139C21.1151 9.76572 20.8878 10.271 20.436 10.4424L14.8757 12.5519V18.9577C14.8757 19.4409 14.4839 19.8327 14.0007 19.8327C13.5174 19.8327 13.1257 19.4409 13.1257 18.9577V12.552L7.56522 10.4424C7.1134 10.271 6.88608 9.76572 7.0575 9.3139ZM12.3569 2.92989C13.4111 2.50254 14.5902 2.50254 15.6444 2.92989L24.3927 6.47652C25.1632 6.78888 25.6673 7.53723 25.6673 8.36861V19.6301C25.6673 20.4615 25.1632 21.2098 24.3927 21.5222L15.6444 25.0688C14.5902 25.4962 13.4111 25.4962 12.3569 25.0688L3.60859 21.5222C2.83811 21.2098 2.33398 20.4615 2.33398 19.6301V8.36861C2.33398 7.53723 2.83811 6.78888 3.60859 6.47652L12.3569 2.92989ZM14.9869 4.55168C14.3544 4.29527 13.6469 4.29527 13.0144 4.55168L4.26607 8.09831C4.156 8.14294 4.08398 8.24985 4.08398 8.36861V19.6301C4.08398 19.7489 4.156 19.8558 4.26607 19.9004L13.0144 23.447C13.6469 23.7034 14.3544 23.7034 14.9869 23.447L23.7352 19.9004C23.8453 19.8558 23.9173 19.7489 23.9173 19.6301V8.36861C23.9173 8.24985 23.8453 8.14294 23.7352 8.09831L14.9869 4.55168Z"})})),"ThreeDFileIcon")}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/956627-716a14166436b5ff.js.map