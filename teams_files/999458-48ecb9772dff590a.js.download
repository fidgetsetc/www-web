"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[999458],{945824:(e,t,n)=>{var a,i;n.d(t,{x:()=>a,k:()=>i}),function(e){e.Default="Default",e.Regular="Regular"}(a||(a={})),function(e){e.ChannelListHeaderContextMenu="ChannelListHeaderContextMenu",e.TeamContextMenu="TeamContextMenu",e.ChannelContextMenuLeftRail="ChannelContextMenuLeftRail",e.ManageTeam="ManageTeam",e.ManageChannel="ManageChannel",e.ChannelHeader="ChannelHeader",e.TrinityLeftRail="TrinityLeftRail",e.OnboardTeam="OnboardTeam",e.TrinityChannelsTab="TrinityChannelsTab"}(i||(i={}))},543804:(e,t,n)=>{n.d(t,{Km:()=>a,tu:()=>i,Xg:()=>o,_A:()=>s});const a={Safari:11.1},i=11,o=11.1,s={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},808692:(e,t,n)=>{n.d(t,{hl:()=>s,OS:()=>r,oW:()=>d,bR:()=>c});var a=n(737035),i=n(543804),o=n(779898);function s(e=i._A){return!!e&&!!l().satisfies(e)}function r(){return!p("ie")}function d(){return!!l().satisfies({safari:`>=${i.Km.Safari}`})}function c(){return p("safari")&&void 0===l().getBrowserVersion()}function l(){return a.getParser((0,o.z)().navigator.userAgent)}function p(e){return l().isBrowser(e,!0)}},908480:(e,t,n)=>{n.d(t,{g:()=>i});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("query DataClientChatSmartReplyFileSuggestionQuery($convId:String!) {smartReplyFileSuggestion(convId:$convId) @client {fileName,url}}");return delete this.definitions,this.definitions=e.definitions}}},3711:(e,t,n)=>{n.d(t,{$6:()=>l,Ss:()=>p,rY:()=>u,l:()=>m,oC:()=>g,Sk:()=>h,E2:()=>E,qb:()=>f,iV:()=>v,zr:()=>I,Nh:()=>y,I0:()=>T,rt:()=>_,RI:()=>A,Zk:()=>S,hI:()=>D,rz:()=>R,Q6:()=>k,e6:()=>L,pj:()=>w,jU:()=>b,gK:()=>N,O:()=>P,v6:()=>M,Y6:()=>U,n$:()=>O,ab:()=>F,PW:()=>V,OF:()=>x,tP:()=>G,NX:()=>$,Dt:()=>H,fK:()=>z,UK:()=>W,gl:()=>K,xs:()=>Q});var a=n(754255),i=n(141685),o=n(784109),s=n(150768),r=n(975887),d=n(315931),c=n(96594);const l="acceptStreamPermissionsDebug",p={__typename:"PrejoinState",id:"",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,withByod:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{id:"",__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1,wasByodConnectedDeviceRoomSelected:!1,byodRoomSpeakerId:null,byodRoomMicrophoneId:null,byodRoomCameraId:null,byodRoomName:null,roomType:null,shouldSuggestRoomAudioForByod:!1,wasByodMoveToRoomAudioTriggered:!1,adhocMeetingSpace:null},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1,timestamp:1};function u(e){e.writeQuery({query:d.U,data:{shouldShowVideoApp:!1}})}const m={__typename:"ByodState",isToggleEnabled:!1,isPoppedOut:!1,byodScreenBounds:null,targetMonitorId:null,sourceMonitorId:null,displayModeBeforeByod:null},g={__typename:"DebugRttStatusEvent",realTimeTextStatus:"None"},h={__typename:"DebugRttEntryEvent",id:"id",text:"",isFinal:!1,userId:"1",userDisplayName:"RTT tester"},E=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogRendered:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,isRosterVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isTogetherModeAssignSeatsDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,interpretationDialogInfo:{isInterpretationDialogVisible:!1,interpretationJoinDialogEntryPoint:null},isMeetingLevelSpokenLanguageDialogVisible:!1,isUserLevelSpokenLanguageDialogVisible:!1,spokenLanguageDialogEntryPoint:null,isPinConfirmDialogVisible:!1}),f=e=>({__typename:"CallingScreenLayout",currentLayout:e.get(a.w.Calling).defaultLayoutSelection||"Grid",meetingRoomLayoutSelection:"ContentAndPeople",lastSelectedLayout:"Grid",initialLayoutBeforeContentPopout:"Grid",meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInMeetingRoom:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeWithContentActive:!1,shouldDisableAutoNarrowMode:!1,isMeetingRoomPrioritizeVideoActive:!1,isLayoutFlipped:!1,isContentPoppedOut:!1,shouldMeBeInOverlay:!1,isPresenterHostModeWithContent:!1,isGalleryInCentralSegment:!0,isMyselfInBarSegment:!1,isFrontRowUnifiedBackgroundActivated:!0,isPanoramicAudienceViewActivated:!1,productionStudioViewType:"None",isPrioritizeVideoViewUnsupported:!1}),v=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),I=e=>({__typename:"VideoScanTypeResponse",videoScanType:"none",id:e}),C="microsoft_none",y={__typename:"BackgroundsInfo",imageId:C,imagePath:"",imageStatus:"",imageProvider:"default",imageName:"",imageSrc:""},T={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:C},_=e=>({__typename:"MyselfSettings",isMyselfHidden:!1,id:e}),A={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},S={__typename:"ImmersiveViewModeAppAvailabilityInfo",isAppAvailable:null,timestamp:null},D={__typename:"ImmersiveEventAppAvailabilityInfo",isAppAvailable:null,timestamp:null},R={__typename:"AudioVideoFrameworkInfo",id:"",isInFlyoutAvatarTab:!1,dismissedComponentIds:[]},k={__typename:"AiInterpretationInfo",id:"",isFirstExpOfAiInterpretation:!1},L={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},w={__typename:"ActiveVideoEffects",first:L,second:L,third:L},b={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},N={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:b,isShowingAppPageVideoEffect:L,isAppliedVideoEffect:L,isUnderApplyingProcessVideoEffect:L,allVideoApps:[]},P={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},M={__typename:"AvatarPayload",avatarItems:[]},U=(e,t)=>t.readQuery({query:o.W,variables:{id:e}})?.callParticipants||[],O=(e,t)=>t.readFragment({id:B(e),fragment:c.bs,fragmentName:"participantFields"})||null,F=(e,t,n)=>{const a=O(e,n);a&&n.writeFragment({id:B(e),fragment:c.bs,data:{...a,...t},fragmentName:"participantFields"})},B=e=>`Participant:{"participantId":"${e}"}`,V=(e,t)=>{e.writeQuery({query:s.t,data:{callingAlerts:t}})},x=e=>`No call found with id ${e}`,G=(e,t)=>{const n=e.coordinates;return{conversationId:(0,i.KX)(n)&&n.conversationId||null,isOneOnOne:"OneToOneCall"===e.type,isMeetup:"Meeting"===e.type,isBroadcast:(0,i.KX)(n)&&"LegacyMeetingCoordinates"===n.__typename&&!!n.broadcast,broadcastRole:(0,i.KX)(n)&&"LegacyMeetingCoordinates"===n.__typename?(0,i.KX)(n)&&n.broadcast?.role:null,withVideo:t&&t.outgoingVideo,withAudio:t&&t.outgoingAudio}},$=e=>({tenantId:"tenantId",organizerId:e??"31eedce6-db0e-44e3-9a76-56d1fa5f010a",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),H=()=>{return{__typename:"BreakoutRoom",coordinates:{__typename:"RoomCoordinates",...$(),additionalMessageId:"additionalMessage"},roomName:"Room 1",participants:[(e="9342492d-d51e-4317-bbf6-8341bf69f07a",{__typename:"BreakoutRoomParticipant",mri:e,role:null,objectId:null,upn:null})],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null};var e},q=(e,t)=>e?{...e,__typename:"VideoEffectInfo"}:t,z=e=>({__typename:"ActiveVideoEffects",first:q(e.activeVideoEffects.first,L),second:q(e.activeVideoEffects.second,L),third:q(e.activeVideoEffects.third,L)}),W=(e,t)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:t&&t.allVideoApps&&t.allVideoApps.length>0&&t.allVideoApps.map((e=>({...e,__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:t.isInstallingVideoEffectInfo?{...t.isInstallingVideoEffectInfo,__typename:"InstallingVideoEffectInfo"}:e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:q(t.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:q(t.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:q(t.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),K=()=>"None",Q=(e,t)=>{const n=t.filter((e=>"TM bot"!==e.displayName)).length+1,a=t.filter((e=>e.state===r.ParticipantState.InLobby)).length;return{__typename:"CallParticipantsCounts",teamsCallId:e,participantCounts:{__typename:"ParticipantCounts",id:"id",totalParticipants:n,totalConnectedTflParticipants:0,lobbyParticipants:a,totalPresenters:n-a,totalAttendees:0,requestingAttentionPresenters:0,requestingAttentionAttendees:0,overflowAttendees:0,streamingAttendees:0,hasParticipantsInLobby:a>0}}}},150768:(e,t,n)=>{n.d(t,{t:()=>o});var a=n(67309),i=n(644077);const o={kind:"Document",get definitions(){const e=(0,a.G)("query callingAlerts {callingAlerts {...callingAlert}}");return delete this.definitions,this.definitions=[...e.definitions,...i.l.definitions]}}},484302:(e,t,n)=>{n.d(t,{F:()=>i});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("query DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery {shouldKeepPreviewWindowInSidePanelOpen @client}");return delete this.definitions,this.definitions=e.definitions}}},315931:(e,t,n)=>{n.d(t,{U:()=>i});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("query shouldShowVideoApp {shouldShowVideoApp @client}");return delete this.definitions,this.definitions=e.definitions}}},503127:(e,t,n)=>{n.d(t,{F:()=>i});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("query shouldShowVideoEffectsPreview {shouldShowVideoEffectsPreview @client}");return delete this.definitions,this.definitions=e.definitions}}},86221:(e,t,n)=>{n.d(t,{Nv:()=>a,mu:()=>i,y8:()=>o,fL:()=>s,k8:()=>r,AZ:()=>d});const a="BroadcastSchedulingEvents",i={closeViewBroadcastEvent:"closeViewBroadcastEvent",createBroadcastEvent:"createBroadcastEvent",editBroadcastEvent:"editBroadcastEvent",viewBroadcastEvent:"viewBroadcastEvent",cancelBroadcastEvent:"cancelBroadcastEvent",showBroadcastEventError:"showBroadcastEventError",discardBroadcastEvent:"discardBroadcastEvent",viewCalendarApp:"viewCalendarApp",policyChangeEvent:"policyChangeEvent"},o=e=>"object"==typeof e&&!!e&&"eventId"in e,s=e=>"object"==typeof e&&!!e&&"eventId"in e,r=e=>"object"==typeof e&&!!e&&"eventId"in e,d={closeViewBroadcastEvent:()=>({originator:a,type:i.closeViewBroadcastEvent}),createBroadcastEvent:()=>({originator:a,type:i.createBroadcastEvent}),editBroadcastEvent:e=>({originator:a,type:i.editBroadcastEvent,data:e}),viewBroadcastEvent:e=>({originator:a,type:i.viewBroadcastEvent,data:e}),cancelBroadcastEvent:e=>({originator:a,type:i.cancelBroadcastEvent,data:e}),showBroadcastEventError:()=>({originator:a,type:i.showBroadcastEventError}),discardBroadcastEvent:()=>({originator:a,type:i.discardBroadcastEvent}),viewCalendarApp:()=>({originator:a,type:i.viewCalendarApp}),policyChangeEvent:()=>({originator:a,type:i.policyChangeEvent})}},825225:(e,t,n)=>{var a;n.d(t,{V5:()=>a,Mi:()=>i,we:()=>o,E:()=>s,Wr:()=>r}),function(e){e.ChannelCard="ChannelCard",e.Channels="Channels",e.ManageTeams="ManageTeams"}(a||(a={}));const i={getLinkToChannel:"getLinkToChannel",viewChannelEmail:"viewChannelEmail",manageChannelMembers:"manageChannelMembers",manageTeamMembers:"manageTeamMembers",manageTeamChannels:"manageTeamChannels",leaveChannel:"leaveChannel",manageChannel:"manageChannel",channelAddMembers:"channelAddMembers",shareChannelWithUser:"shareChannelWithUser",shareChannelWithTeam:"shareChannelWithTeam",channelNotificationSettings:"channelNotificationSettings",toggleInfoPane:"toggleInfoPane",channelHeaderBackAction:"channelHeaderBackAction"},o={teamAddMember:"teamAddMember",teamAddChannel:"teamAddChannel",manageTags:"manageTags",leaveTeam:"leaveTeam",hideAllChannelsDialog:"hideAllChannelsDialog",getLinkToTeam:"getLinkToTeam",deleteTeam:"deleteTeam",manageTeam:"manageTeam",archiveTeam:"archiveTeam",toastMessageTeam:"toastMessageTeam"},s={getLinkToChannel:(e,t)=>({data:t,originator:e,type:i.getLinkToChannel}),viewChannelEmail:(e,t)=>({data:t,originator:e,type:i.viewChannelEmail}),manageChannelMembers:(e,t)=>({data:t,originator:e,type:i.manageChannelMembers}),manageTeamMembers:(e,t)=>({data:t,originator:e,type:i.manageTeamMembers}),manageTeamChannels:(e,t)=>({data:t,originator:e,type:i.manageTeamChannels}),leaveChannel:(e,t)=>({data:t,originator:e,type:i.leaveChannel}),manageChannel:(e,t)=>({data:t,originator:e,type:i.manageChannel}),channelAddMembers:(e,t)=>({data:t,originator:e,type:i.channelAddMembers}),shareChannelWithUser:(e,t)=>({data:t,originator:e,type:i.shareChannelWithUser}),shareChannelWithTeam:(e,t)=>({data:t,originator:e,type:i.shareChannelWithTeam}),channelNotificationSettings:(e,t)=>({data:t,originator:e,type:i.channelNotificationSettings}),toggleInfoPane:e=>({data:e,originator:a.Channels,type:i.toggleInfoPane}),channelHeaderBackAction:()=>({originator:a.Channels,type:i.channelHeaderBackAction})},r={teamAddMember:(e,t)=>({data:t,originator:e,type:o.teamAddMember}),teamAddChannel:(e,t)=>({data:t,originator:e,type:o.teamAddChannel}),manageTags:(e,t)=>({data:t,originator:e,type:o.manageTags}),leaveTeam:(e,t)=>({data:t,originator:e,type:o.leaveTeam}),hideAllChannelsDialog:(e,t)=>({data:t,originator:e,type:o.hideAllChannelsDialog}),getLinkToTeam:(e,t)=>({data:t,originator:e,type:o.getLinkToTeam}),deleteTeam:(e,t)=>({data:t,originator:e,type:o.deleteTeam}),archiveTeam:(e,t)=>({data:t,originator:e,type:o.archiveTeam}),toastMessageTeam:(e,t)=>({data:t,originator:e,type:o.toastMessageTeam}),manageTeam:(e,t)=>({data:t,originator:e,type:o.manageTeam})}},496779:(e,t,n)=>{n.d(t,{Nv:()=>a,AZ:()=>o,v0:()=>s});const a="Messaging",i="messageById",o={messageById:e=>({originator:a,type:i,data:()=>e})},s={isMessageByIdEvent:e=>e.type===i}},373639:(e,t,n)=>{n.d(t,{Pj:()=>a,X1:()=>i,$v:()=>o,Os:()=>s,Lm:()=>r,xD:()=>d,UV:()=>c,bH:()=>l,Pf:()=>p,iz:()=>u,EF:()=>m});const a="aria-label",i="card",o="itemid",s="data-itemprops",r="itemscope",d="animated-emoticon-50-",c=50,l=20,p="readonly",u="mention",m=/[\u200B]/},333704:(e,t,n)=>{n.d(t,{C:()=>h,j:()=>E});var a=n(971510),i=n(480354),o=n(754255),s=n(359676),r=n(702183),d=n(373639),c=n(600824),l=n(649288),p=n(220192),u=n(102029),m=n(503210),g=n(692184);const h="~~~~###@@TACOCAT@@###~~~~";let E=class{async transform(e,t){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer","services-io-browser-compose-serializer-extensions"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,i.unescape)(u.L.DomUtils.getAttributeValue(e,d.Os)),a=u.L.DomUtils.getAttributeValue(e,d.$v),[o]=u.L.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!o)return this._logger.error("The code snippet was missing"),null;if(!a)return this._logger.error("The id of the card was missing"),null;try{await this._uploadAndUpdateCard(a,JSON.parse(n),o,t);const e=(0,m.VZ)("span",{content:a,itemprop:"cardId"}),i=(0,m.VZ)("span",{class:"inline-compose-card",itemid:a,itemscope:"",itemtype:p.A.inputExtension});return u.L.DomUtils.appendChild(i,e),this._logger.debug("Uploaded code snippet",a),i}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}async _uploadCodeSnippet(e,t,n){const{source:a}=e,i=u.L.DomUtils.getInnerHTML(t),s=`${a}${h}${i}`,d=this._scenarioFactory?.newScenario(r.Cu.CodeSnippetUpload);try{const{objectId:e}=await this._uploadToAMS(s,n,this._logger);return d?.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),d?.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(o.w.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=await this._uploadToCache(s,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{d?.stop()}}async _uploadToAMS(e,t,n){n.log("Uploading to code snippet to ams");const{objectId:a}=await t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT",s.Y2.CodeSnippetsSerializer,void 0,l.vV.Attached,!1,t.correlationId);return{objectId:a}}async _uploadToCache(e,t,n){try{n.log("uploading inline image to offline cache storage");const[a,i]=await t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${i} objectId: ${a}`),{objectId:a}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}async _uploadAndUpdateCard(e,t,n,a){const{amsReferenceId:i}=t,{name:o,language:s,wrap:r}=t,d=a.messageProperties.cards||[];let c={objectId:i,uploadType:"AMS"};if(i||(c=await this._uploadCodeSnippet(t,n,a)),"AMS"===c.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,c.objectId]}else if("OfflineCache"===c.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,c.objectId]}a.messageProperties.cards=[...d.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:g.b.CodeSnippet,content:JSON.stringify({type:g.b.CodeSnippet,editable:!0,id:e,name:o,language:s,wrap:r,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:c.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}};E=(0,a.__decorate)([(0,c.hY)({name:"CodeSnippets",filter:{[d.Lm]:"CodeSnippetCard"}})],E)},827558:(e,t,n)=>{n.d(t,{C:()=>g});var a=n(971510),i=n(480354),o=n(600824),s=n(220192),r=n(102029);const d=new RegExp(/animated-emoticon.*?/),c=/img|table/,l=e=>!!e&&r.L.DomUtils.getAttributeValue(e,"itemtype")===s.A.customEmoji,p=e=>!!e&&(r.L.DomUtils.getAttributeValue(e,"itemtype")===s.A.emoji||d.test(r.L.DomUtils.getAttributeValue(e,"class")||"")),u=(e,t)=>!t.containsPotentiallyIncludedWhitespace&&e<m&&e+1,m=3;let g=class{preTransform(e,t){const n=(0,i.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;(p(e)||l(e))&&(t.isSingleImageMessage=!1),(t.files?.length??0)>0||(t.cards?.length??0)>0?t.superSizeEmoticons=!1:"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:"img"===e.name?(l(e)||p(e)||(t.superSizeEmoticons=!1),(0,i.isNumber)(n)&&l(e)?t.superSizeEmoticons=u(n,t):(0,i.isUndefined)(t.superSizeEmoticons)&&(t.superSizeEmoticons=!1)):(0,i.isNumber)(n)&&p(e)?t.superSizeEmoticons=u(n,t):t.superSizeEmoticons=!(e=>e&&!p(e.parent)&&!l(e.parent)&&!(e.parent&&p(e.parent.parent))&&(c.test(e.name||"")||!(!e.data||!e.data.replace("Â ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n}};g=(0,a.__decorate)([(0,o.dL)({name:"BigEmoticonPreprocessor",filter:"*"})],g)},6680:(e,t,n)=>{n.d(t,{TQ:()=>m,Td:()=>g,YG:()=>h});var a=n(971510),i=n(480354),o=n(754255),s=n(850434),r=n(702183),d=n(600824),c=n(431286),l=n(781463),p=n(780952),u=n(102029);const m="app-preview-card",g="app-preview-card-ps";let h=class{async transform(e,t){const n=t.coreSettings.get(o.w.Extensibility).postSendTimeoutInMs||2e3,{enableAppBasedLinkUnfurlingPostSend:a}=t.coreSettings.get(o.w.Extensibility),{areUrlPreviewsAllowed:i}=t.coreSettings.get(o.w.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||t.isForwardedMessage||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!u.L.DomUtils.hasAttrib(e,"href"))return;const s=t.loggerFactory.newLogger("UrlPreviewSerializer","services-io-browser-compose-serializer-extensions"),r=e.attribs.href||"",d=[this.getLinkUnfurlingPreviewFromAppTimed(r,n,t,s),this.getUrlPreviewTimed(r,n,t,s)],[c,p]=await Promise.all(d),m=c?.urlPreview??(p&&f(p));return m?(t.messageProperties.urlPreview=m,t.messageProperties.cards=c?.card&&a?[{...(0,l.h)({...c?.card,cardClientId:`${g}${c?.card?.cardClientId}`},"__typename")},...t.messageProperties.cards||[]]:t.messageProperties.cards,e):void 0}async getLinkUnfurlingPreviewFromAppTimed(e,t,n,a){const{enableAppBasedLink:i}=n.coreSettings.get(o.w.Extensibility),{enableGetRichLinkToTeamOrChannel:d}=n.coreSettings.get(o.w.TeamsAndChannels),{deepLinkDomains:l}=n.coreSettings.get(o.w.Messaging);if(!i)return Promise.resolve(void 0);const u={enableDomainLinks:d,currentDomainLinks:l};if((0,c.c)(e,u))return;const m=n.scenarioFactory.newScenario(r.Cu.ExtGetAppPreviewPostSend),g="post send app preview timed out";try{let a;return n.linkUnfurlingAppDetails&&(a=await(0,p.a)(n.appBasedLinkService.getLinkUnfurlingPreviewFromApp(e,n.linkUnfurlingAppDetails,m,n.convId),t,g)),m.stop(),a}catch(e){return E(e)&&e.code===s.O4.TimedOut&&e.context===s.Ir.Timed?m.incomplete({errors:g}):m.fail(),void a.warn(`fetching app preview for url failed with error: ${e}`)}}async getUrlPreviewTimed(e,t,n,a){const{enableGetRichLinkToTeamOrChannel:i}=n.coreSettings.get(o.w.TeamsAndChannels),{deepLinkDomains:s}=n.coreSettings.get(o.w.Messaging),r={enableDomainLinks:i,currentDomainLinks:s};if(!(0,c.c)(e,r))try{return await(0,p.a)(n.urlPreviewService.getPreview(e,n.correlationId),t,"url preview timed out")}catch(e){return void a.warn(`fetching url preview for url failed with error: ${e}`)}}};h=(0,a.__decorate)([(0,d.hY)({name:"URLPreviewSerializer",filter:"a",transient:!0})],h);const E=e=>!!(e&&((0,i.get)(e,"code")&&(0,i.get)(e,"context")||(0,i.get)(e,"reason"))),f=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta})},448681:(e,t,n)=>{n.d(t,{hi:()=>d,n7:()=>r,ZN:()=>c,Hs:()=>l});var a=n(902537),i=n(67309);const o={kind:"Document",get definitions(){const e=(0,i.G)("query ServicesIoDataEspLockCurrentSurfaceIdQuery {currentEspSurfaceId @client}");return delete this.definitions,this.definitions=e.definitions}},s="growth_growthplatform_esp_common_component",r=async(e,t,n)=>{try{const a=e.readQuery({query:o});if(a&&a?.currentEspSurfaceId)return t.infoToTelemetry?.(`Couldn't show surface (${n}). ${a.currentEspSurfaceId} is showing`,s,void 0,!0),Promise.reject(!1);e.writeQuery({query:o,data:{currentEspSurfaceId:n}})}catch{return t.errorToTelemetry?.(`Couldn't show surface (${n}). Could not update current surface`,s,void 0,!0),Promise.reject(!1)}return Promise.resolve(!0)},d=async(e,t)=>{try{const n=e.readQuery({query:o});n&&n?.currentEspSurfaceId===t&&e.writeQuery({query:o,data:{currentEspSurfaceId:""}})}catch{return Promise.reject(!1)}return Promise.resolve(!0)},c=(e,t)=>{try{e.writeQuery({query:o,data:{currentEspSurfaceId:t}})}catch{throw new Error(`Couldn't change current surface to "${t}".`)}},l=()=>{const{data:e}=(0,a.I)(o);return e?.currentEspSurfaceId??""}},431286:(e,t,n)=>{n.d(t,{C:()=>_,c:()=>C});var a=n(480354),i=n(845097),o=n(575930),s=n(84646),r=n(199448),d=n(850434),c=n(198993),l=n(878336),p=n(327080),u=n(654703),m=n(726723),g=n(712839),h=n(754255),E=n(702183),f=n(908060);const v=["teams","/l/message/","chat"],I=["teams","/l/meetingrecap","threadId"],C=(e,t)=>{if(t?.enableDomainLinks){const n=t.currentDomainLinks;return!!n&&n.some((t=>y(e,t)))}return v.every((t=>e.includes(t)))||I.every((t=>e.includes(t)))||e.startsWith("mailto")||T(e)},y=(e,t)=>{try{const n=new URL(e),a=new URL(t),i=n.hostname===a.hostname&&n.pathname&&(n.pathname.includes("/l/message")||n.pathname.includes("/l/channel")||n.pathname.includes("/l/chat")),o=n.hostname===a.hostname&&n.pathname&&n.pathname.includes("/l/meetingrecap");return i||o}catch(e){return!0}},T=e=>{try{if(!e.startsWith(u.kN))return!1;const t=e.split("nav=");if(t.length<2)return!1;const n=t[t.length-1];return decodeURIComponent(atob(n)).includes(u.ZP)}catch(e){return!1}};class _{constructor(e,t,n,a,i){this.botsPlatformService=t,this.scenarioFactory=n,this.queryLinkRequestsInProgress={},this.logTelemetryForACv2CardInResponse=(e,t)=>{if(!e)return;const n=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:m.Od.auto,actionOutcome:m.nd.AsyncUnfurlACv2CardInAsyncLUResponse,actionScenario:m.vB.LinkUnfurlingPostSendCardPreviewACv2CardInResponse,actionScenarioType:m.DB.sendMsgs,moduleName:m.Sn.linkUnfurl,moduleType:m.nR.link,panelRegion:m.rP.main,panelType:m.HP.AppBasedLink,extensibilityData:n})},this.logTelemetryForLinkUnfurlingCardViewPostSend=(e,t)=>{if(!e)return;const n=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:m.Od.auto,actionOutcome:m.nd.appBasedLinkUnfurlingCardPreviewPostSend,actionScenario:this.getPreviewActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1),actionScenarioType:m.DB.sendMsgs,moduleName:m.Sn.linkUnfurl,moduleType:m.nR.link,panelRegion:m.rP.main,panelType:m.HP.AppBasedLink,extensibilityData:n})},this.logTelemetryForLinkUnfurlingInvokePostSend=(e,t,n=!0)=>{if(!e)return;const a=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:m.Od.asyncStateChange,actionOutcome:m.nd.invoke,actionScenario:this.getInvokeActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1,n),actionScenarioType:m.DB.sendMsgs,moduleName:m.Sn.linkUnfurl,moduleType:m.nR.link,panelRegion:m.rP.main,panelType:m.HP.AppBasedLink,extensibilityData:a})},this.getExtensibilityData=(e,t)=>({id:e?.appId||"",botId:e?.botId||"",scenarioCapability:g.n3.messaging,name:e?.appName||"",threadId:t||"",externalId:e?.externalId||"",installationState:e.installationState}),this.getInvokeActionScenarioName=(e,t)=>e&&t?m.vB.linkUnfurlingAnonymousInvokePostSend:e&&!t?m.vB.linkUnfurlingAnonymousInvokePostSendNoResult:!e&&t?m.vB.linkUnfurlingInvokePostSend:m.vB.linkUnfurlingInvokePostSendNoResult,this.getPreviewActionScenarioName=e=>e?m.vB.linkUnfurlingPostSendAnonymousCardPreview:m.vB.linkUnfurlingPostSendCardPreview,this.enableAppBasedLinkSsoAuth=e.get(h.w.Extensibility).enableAppBasedLinkSsoAuth,this.tokenPrefetchBots=e.get(h.w.Extensibility).tokenPrefetchBots,this.ssoForBotsDefaultWebResourceEnabledBotIds=e.get(h.w.Extensibility).ssoForBotsDefaultWebResourceEnabledBotIds,this.enableAnonymousAppBasedLink=e.get(h.w.Extensibility).enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps=e.get(h.w.Extensibility).anonymousAppBasedLinkApps,this.enablePreAuthCard=e.get(h.w.Extensibility).enablePreAuthCard,this.logger=a.newLogger("AppBasedLinkService","services-io-app-based-link"),this.enableGetRichLinkToTeamOrChannel=e.get(h.w.TeamsAndChannels).enableGetRichLinkToTeamOrChannel,this.deepLinkDomains=e.get(h.w.Messaging).deepLinkDomains,this.userBiService=i}async getLinkUnfurlingPreviewFromApp(e,t,n,a){const i={enableDomainLinks:this.enableGetRichLinkToTeamOrChannel,currentDomainLinks:this.deepLinkDomains};if(u.$Q===a||C(e,i))return void this.logger.log(`${u.Bt} getLinkUnfurlingPreviewFromApp: url is a chat url and no link preview is needed for url`);let o,s,r;try{o=this.toAppDefinition(t),o&&(s=(0,c.jN)(o?.definition))}catch{return this.logger.error("Ran into an error trying to create the linkUnfurlingAppDetails object"),void n.incomplete({errors:"Could not fetch app details for link unfurling app"})}if(s){"NotInstalled"===t?.installationState&&(0,c.rv)(s,this.enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps)?(this.logTelemetryForLinkUnfurlingInvokePostSend(t,a),n.mark(E.BQ.ExtAppBasedLinkUnfurlingPostSendAnonymousInvoke),r=await this.getAnonymousAppPreview(e,s,a),this.logger.log(`${u.Bt} Fetching anonymous app preview for url`)):"Installed"===t?.installationState&&(this.logTelemetryForLinkUnfurlingInvokePostSend(t,a),n.mark(E.BQ.ExtAppBasedLinkUnfurlingPostSendInvoke),r=await this.getAppPreview(e,s,a),this.logger.log(`${u.Bt} Fetching app preview for url`))}if("HasResult"===r?.type&&r.messageExtensionItem){const{card:n,previewCard:i}=r.messageExtensionItem,o=this.processResponseCard(n,t,a);return o&&this.logTelemetryForLinkUnfurlingCardViewPostSend(t,a),{card:o,urlPreview:(0,p.w)(e,i)}}this.logger.log("LinkUnfurling: No app preview found for url (async)")}async getAnonymousAppPreview(e,t,n){try{const a=this.getQueryLinkVariables(e,t,n);if(!a)throw(0,r.$5)("AppBasedLinkService",d.O4.InvalidInput,"getAnonymousAppPreview",void 0,this.getErrorMessage("Invalid message extension passed to invoke",t));this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(a,t,E.Cu.ExtGetAnonymousAppPreview,void 0,"composeExtension/anonymousQueryLink"));const i=await this.queryLinkRequestsInProgress[e];return delete this.queryLinkRequestsInProgress[e],!i||this.isEmptyResult(i)?null:this.matchedAnonymousResult(e,t,i)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}async getAppPreview(e,t,n,a,i){if(!t)return null;try{const o=await this.tryPrefetchingToken(t,i,this.logger),s={},r=i??o,d=!!r,c=await this.getMessageExtensionResult(e,t,n,a,r,s);return delete this.queryLinkRequestsInProgress[e],!c||this.isEmptyResult(c)?null:this.matchedResult(e,t,c,d,n,a,s)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}async matchedAnonymousResult(e,t,n){switch(n.type){case"result":return this.logger.log(`${u.Bt} Initiating result type response for url`),this.handleResultResponse(e,n,t);case"auth":return this.logger.log(`${u.Bt} Initiating anonymous auth for url`),this.handleAnonymousAuthConfigResponse(e,n,t);default:return this.logger.error(this.getErrorMessage(`${u.Bt} Invalid value ${n.type} for field 'type' in invoke response`,t)),null}}async matchedResult(e,t,n,a,i,o,s){switch(n.type){case"result":return this.logger.log(`${u.Bt} Initiating result type response for url`),this.handleResultResponse(e,n,t);case"auth":case"config":return"config"===n.type?this.logger.log(`${u.Bt} Initiating config type response for url`):this.logger.log(`${u.Bt} Initiating auth type response for url`),this.handleAuthConfigResponse(e,n,t);case"silentAuth":if(a)return this.logger.error(this.getErrorMessage(`${u.Bt} Result type ${n.type} not allowed for duplicate request`,t)),null;if(this.enableAppBasedLinkSsoAuth){if(s?.consentOverride)return this.handleSsoAuthResponse({isFailure:!1,isConsentRequired:!0,token:void 0},n,e,t,i,o);const a=await this.tryGetAuthToken(t);return this.handleSsoAuthResponse(a,n,e,t,i,o)}default:return this.logger.error(this.getErrorMessage(`Invalid value ${n.type} for field 'type' in invoke response`,t)),null}}isEmptyResult(e){const t=Object.keys(e);return 1===t.length&&"__typename"===t[0]}processResponseCard(e,t,n){return(e=>{let t=!1;return(0,f.KQ)(JSON.parse(e),{type:"Action.Execute"},(()=>{t=!0})),t})(e.content)?void this.logTelemetryForACv2CardInResponse(t,n):e}async handleSsoAuthResponse(e,t,n,a,i,o){const{isFailure:s,isConsentRequired:r,token:d}=e;if(s)return null;if(d&&!r){return await this.getAppPreview(n,a,i,o,{token:d})}return this.handleAuthConfigResponse(n,t,a)}toAppDefinition(e){return e&&e.appId?{installationState:e.installationState,id:e.appId||"",definition:{id:e.appId,name:e.appName||"",messageExtensions:[{type:"BotBased",botId:e.botId||"",fetchCommands:!1,commands:[],canUpdateConfiguration:!0,messageHandlers:[{type:"link",value:{domains:[],supportsAnonymousAccess:e.supportsAnonymousAccess||!1}}],scopes:[]}],largeImageUrl:e.appIcon||"",externalId:e.externalId||"",tenantId:e.tenantId||"",validDomains:e.validDomains||[]}}:null}getWebApplicationInfo(e){const t=e.messageExtensions&&e.messageExtensions[0].botId;return t&&this.ssoForBotsDefaultWebResourceEnabledBotIds&&this.ssoForBotsDefaultWebResourceEnabledBotIds?.indexOf(t)>=0?{botId:t,resource:`api://botid-${t}`}:{botId:t,resource:e.resource}}async tryPrefetchingToken(e,t,n){const{botId:a,resource:i}=this.getWebApplicationInfo(e);if(t||!this.enableAppBasedLinkSsoAuth||!a||!i||!this.tokenPrefetchBots||-1===this.tokenPrefetchBots.indexOf(a))return null;const o=this.scenarioFactory.newScenario(E.Cu.AppBasedLinkAadAuth);o.appendEventData({"Bot.Id":a,context:"tokenPrefetch"});try{const e=await this.botsPlatformService.getAuthTokenForBot(a,i,!0,n);return o.stop(),{token:e}}catch(e){o.incomplete({errors:"tryPrefetchingToken: Token failed to acquire"})}return null}async tryGetAuthToken(e){const{botId:t,resource:n}=this.getWebApplicationInfo(e);if(!t||!n)return{isFailure:!0,isConsentRequired:!1,token:void 0};const a=this.scenarioFactory.newScenario(E.Cu.AppBasedLinkAadAuth);a.appendEventData({"Bot.Id":t,context:"silent:true"});try{const e=await this.botsPlatformService.getAuthTokenForBot(t,n,!0,this.logger);return a.stop(),{isFailure:!1,isConsentRequired:!1,token:e}}catch(e){return e.code===d.O4.UserConsentRequired?(a.incomplete(),{isFailure:!1,isConsentRequired:!0,token:void 0}):e.code===d.O4.InvalidInput?(a.stop(),{isFailure:!0,isConsentRequired:!1,token:void 0}):(a.fail({errorCode:e.code}),{isFailure:!0,isConsentRequired:!1,token:void 0})}}async getMessageExtensionResult(e,t,n,a,i,o){const s=this.getQueryLinkVariables(e,t,n,a,i);return s?(this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(s,t,E.Cu.GetAppPreviewResult,o)),this.queryLinkRequestsInProgress[e]):(this.logger.error(this.getErrorMessage("Invalid message extension passed to invoke",t)),Promise.resolve(null))}queryLink(e,t,n,s,r){const d=(0,i.v4)(),c=this.scenarioFactory.newScenario(n);return c.appendEventData({"Bot.Id":e.botInvokeParams.botMri,"App.Id":t.id,"Thread.Id":e.botInvokeParams.threadId??"",appType:(0,a.isEmpty)(t.externalId)?"GlobalApp":(0,a.isEmpty)(t.tenantId)?"CustomApp":"TenantApp",correlationId:d}),this.botsPlatformService.executeBotInvoke(e.botInvokeParams,e.invokeValue,o.gp,this.logger,d,r||"composeExtension/queryLink",void 0,void 0,c).then((e=>(c.stop(),e))).catch((t=>{if(this.logger.warn(`Invoke failed with error: ${t} and args: ${JSON.stringify(e)}`),this.handleInvokeFailure(c,t,s),s?.consentOverride)return{type:"silentAuth"};throw t}))}handleInvokeFailure(e,t,n){if(t)if((e=>!!e&&!!(0,a.get)(e,"code")&&!!(0,a.get)(e,"message"))(t))switch(t.code){case d.O4.BotError:case d.O4.BotDisabledByAdmin:case d.O4.Forbidden:case d.O4.InvalidRequestFormat:e.cancel({errorCode:t.code,errors:JSON.stringify([t.message])});break;case d.O4.UserConsentRequired:e.incomplete({errorCode:t.code,errors:JSON.stringify([t.message])}),n&&(n.consentOverride=!0);break;default:e.fail({errorCode:t.code,errors:JSON.stringify([t.message])})}else e.fail({errorCode:d.O4.Unknown});else e.fail({errorCode:d.O4.Empty,errors:"Error message is empty"})}handleResultResponse(e,t,n){const o=(0,a.first)(t.items),s=o?.card,{defaultPreviewType:r,cachePolicyType:d}=this.processSuggestedActions(t.suggestedActions);if(s){const t=(0,i.v4)().replace(new RegExp("-","g"),""),c=(0,a.cloneDeep)(s),l=o?.previewCard||this.isSupportedPreviewCardType(c)&&c;return l?{__typename:"AppPreviewResult",id:e,type:"HasResult",messageExtensionItem:{__typename:"MessageExtensionItem",previewCard:l,card:{__typename:"Card",contentType:s.contentType,content:s.content,cardClientId:t,appId:n.id,appName:n.name,appIcon:n.largeImageUrl}},...r&&{defaultPreviewType:r},...d&&{cachePolicyType:d}}:(this.logger.error(this.getErrorMessage(`Could not use card with content type: ${s.contentType} as a preview card`,n)),null)}return null}handleAnonymousAuthConfigResponse(e,t,n){let a;return this.enablePreAuthCard&&t.items?.length&&(a=t.items[0]?.card),t.suggestedActions?.actions&&this.logger.warn("Suggested actions are not supported for anonymous query link invoke!"),{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,card:a,isAnonymous:!0}}}handleAuthConfigResponse(e,t,n){const i=t.suggestedActions?.actions?.[0];let o;if(this.enablePreAuthCard&&t.items?.length&&(o=t.items[0]?.card),i&&n.validDomains&&(0,l.F6)(i.value,(0,a.compact)(n.validDomains)))return{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,card:o,openUrlResult:{__typename:"AppBasedLinkOpenUrlResult",title:i.title,url:i.value,isAuth:"auth"===t.type||"silentAuth"===t.type}}};const{resource:s}=this.getWebApplicationInfo(n);return"silentAuth"===t.type&&!i&&s?{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,aadAuthResult:{__typename:"AppBasedLinkAadAuthResult",resource:s}}}:(this.logger.error(this.getErrorMessage("Invalid auth/config result from bot",n)),null)}isSupportedPreviewCardType(e){const t=e.contentType.toLowerCase();return"application/vnd.microsoft.card.hero"===t||"application/vnd.microsoft.card.thumbnail"===t}getQueryLinkVariables(e,t,n,a,i){const o=t.messageExtensions?.[0];if(o){return{botInvokeParams:{threadId:n??"",botMri:`${s.gN.BotPrefix}${o.botId??""}`},invokeValue:JSON.stringify({url:e,...a&&{state:a},...i&&{authentication:i}})}}}getErrorMessage(e,t){return`${e} for app id: ${t.id}`}processSuggestedActions(e){let t,n;return e?(e.actions?.forEach((e=>{switch(e.type){case"setDefaultUrlPreviewType":t=this.getPreviewType(e.value),t||this.logger.error(`Invalid invoke response: invalid setDefaultUrlPreviewType ${e.value}`);break;case"setCachePolicy":try{const t=JSON.parse(e.value);n=this.getCachePolicy(t.type)}catch(t){this.logger.error(`Invalid invoke response: setCachePolicy requires stringified JSON payload, but got ${e.value}`);break}n||this.logger.error("Invalid invoke response: invalid cache policy type");break;default:this.logger.error(`Invalid invoke response: unsupported suggestedAction type: ${e.type}`)}})),{defaultPreviewType:t,cachePolicyType:n}):{defaultPreviewType:t,cachePolicyType:n}}getPreviewType(e){switch(e){case"Thumbnail":return"Thumbnail";case"Card":return"Card";default:return}}getCachePolicy(e){if("no-cache"===e)return"NoCache"}}},654703:(e,t,n)=>{n.d(t,{$Q:()=>a,Bt:()=>i,kN:()=>o,ZP:()=>s});const a="48:notes",i="LinkUnfurlingService:",o="https://1drv.ms/",s="loop-page-container"},503853:(e,t,n)=>{n.d(t,{wy:()=>a,sm:()=>i,Bc:()=>o,Ue:()=>s,rR:()=>p,Mn:()=>m,w1:()=>g,dY:()=>h,zo:()=>E,kF:()=>f,f9:()=>T});var a,i,o,s,r=n(199448),d=n(850434);!function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidMessageResponse=3]="InvalidMessageResponse",e[e.BothCardAndUrl=4]="BothCardAndUrl",e[e.MissingCardAndUrl=5]="MissingCardAndUrl",e[e.InvalidAdaptiveCard=6]="InvalidAdaptiveCard",e[e.InvalidUrl=7]="InvalidUrl"}(a||(a={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(i||(i={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(o||(o={})),function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidAdaptiveCards=3]="InvalidAdaptiveCards",e[e.InvalidSubmitTaskResponse=4]="InvalidSubmitTaskResponse"}(s||(s={}));const c="BotsPlatformResolvers",l="retry-after",p=async e=>{const t=await v(e),n=I(t.errorCode),a=C(t);return n?(0,r.$5)(c,d.O4.BotError,"executeBotInvoke",void 0,a,void 0):u(e,a)},u=(e,t)=>412===e.status?(0,r.$5)(c,d.O4.UserConsentRequired,"executeBotInvoke",void 0,t,void 0):429===e.status?(0,r.$5)(c,d.O4.Throttled,"executeBotInvoke",void 0,t,{status:e.status,headers:{[l]:e.headers[l]},body:{},url:""}):403===e.status&&t.toLowerCase().includes("BotDisabledByAdmin".toLowerCase())?(0,r.$5)(c,d.O4.Forbidden,"executeBotInvoke",void 0,t,void 0):400===e.status?(0,r.$5)(c,d.O4.InvalidRequestFormat,"executeBotInvoke",void 0,t,void 0):(0,r.$5)(c,d.O4.RemoteOperationFailed,"executeBotInvoke",void 0,t,void 0),m=e=>{const t=e&&a[e]||void 0;return(0,r.$5)(c,d.O4.InvalidResponse,"executeTaskModuleInvoke",void 0,t,void 0)},g=e=>{const t=e&&s[e]||void 0;return(0,r.$5)(c,d.O4.InvalidResponse,"executeAdaptiveCardTabInvoke",void 0,t,void 0)},h=()=>(0,r.$5)(c,d.O4.Unauthorized,"getCurrentUserName",void 0,void 0,void 0),E=e=>{const t=e&&o[e]||void 0;return(0,r.$5)(c,d.O4.InvalidResponse,"executeMessageExtensionInvoke",void 0,t,void 0)},f=e=>{const t=e&&i[e]||void 0;return(0,r.$5)(c,d.O4.InvalidResponse,"executeBotConfigInvoke",void 0,t,void 0)},v=async e=>{const t=await e.body.text();return t&&t.length>0?JSON.parse(t):{}},I=e=>null!=e&&(1008===e||209===e),C=e=>`Error code: ${e.errorCode} message: ${y(e.message)}`,y=e=>{const t=e&&e.match(/<[^>]*>/g);return t&&t.length>0?t[0]:""},T=(e,t)=>{const n="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",t);return new RegExp(n,"i").test(e)}},410312:(e,t,n)=>{n.d(t,{l:()=>s,Z:()=>g});var a=n(220192),i=n(908060),o=n(702183);const s=(e,t)=>{const n=(0,i.a9)(e),a=e.body;a&&n&&r(a,n,t)},r=(e,t,n)=>{const a=n?.newScenario(o.Cu.ExtCardMentionsInvoke),i={hasMentions:!1};e.forEach((e=>d(e,t,i))),a&&(i.hasMentions?a.mark(o.BQ.ExtCardMentionsInvokeComplete):a.mark(o.BQ.ExtCardMentionsInvokeMissing),a.stop())},d=(e,t,n)=>{(0,i.KQ)(e,{type:"TextBlock"},(e=>{c(t,n)(e)})),(0,i.KQ)(e,{type:"FactSet"},(e=>{l(t,n)(e)}))},c=(e,t)=>n=>{e.forEach(((e,a)=>{n.text=p(n.text,a,e,t)}))},l=(e,t)=>n=>{n.facts.forEach((n=>{e.forEach(((e,a)=>{n.title=p(n.title,a,e,t),n.value=p(n.value,a,e,t)}))}))},p=(e,t,n,i)=>{const{mentionsText:o,isMentionsApplied:s}=u(e,t,n,a.A.mention);return i.hasMentions=i.hasMentions||s,o},u=(e,t,n,a)=>{let i=!1;if(-1!==e.indexOf(t)){const o=`<span contenteditable="false" itemscope="" itemtype="${a}" itemid="${n.itemId}">${g(m(t))}</span>`;e=e.replace(new RegExp(t,"g"),o),i=!0}return{mentionsText:e,isMentionsApplied:i}},m=e=>e.substring(4,e.length-5),g=e=>e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;"):""},575930:(e,t,n)=>{n.d(t,{gp:()=>d,fh:()=>c,CH:()=>l});var a=n(480354),i=n(970778),o=n(503853),s=n(410312),r=n(605288);const d=(e,t)=>{const n={__typename:"MessageExtensionResult"},a=e?.composeExtension;if(!a)return n;const i=a.type,o=a.text,d=a.attachments,c=a.suggestedActions;if(!d){const e=p(a.activityPreview);return{...n,...i&&{type:i},...o&&{text:o},...c&&{suggestedActions:c},...e&&{activityPreview:e}}}const l=a.attachmentLayout;d.forEach((e=>{e.contentType.toLowerCase()===r.s.Adaptive&&(0,s.l)(e.content,t)}));const u={items:Array.from(d,(e=>({card:{content:JSON.stringify(e.content),contentType:e.contentType},previewCard:e.preview?{content:JSON.stringify(e.preview.content),contentType:e.preview.contentType}:void 0}))),...i&&{type:i},...l&&{attachmentLayout:l},...c&&{suggestedActions:c},...o&&{text:o}};return{...n,...u}},c=e=>{if((0,a.isEmpty)(e))return(0,i.Lp)(e);switch(e.responseType){case"composeExtension":return d(e);case"task":return(0,i.Lp)(e);default:throw(0,o.zo)(o.Bc.InvalidInvokeResponseType)}},l=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,a.first)(e?.attachments);return{type:e?.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.parse(t.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(t)?void 0:t},p=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,a.first)(e?.attachments);return{type:e?.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.stringify(t.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(t)?void 0:t}},970778:(e,t,n)=>{n.d(t,{Lp:()=>o,wL:()=>s,KA:()=>p});var a=n(480354),i=n(503853);const o=e=>{if((0,a.isEmpty)(e))return p();if(r(e))return c(e.task);if(d(e))return l(e.task);throw(0,i.Mn)(i.wy.Unknown)},s=e=>{const t=e.value,n=(0,a.get)(t,"url"),o=(0,a.get)(t,"card");let s;if(!o&&!n)throw(0,i.Mn)(i.wy.MissingCardAndUrl);if(o&&n)throw(0,i.Mn)(i.wy.BothCardAndUrl);if(o)s=m(e);else if(!(0,a.isString)(n))throw(0,i.Mn)(i.wy.InvalidUrl);const{title:r,fallbackUrl:d,completionBotId:c,height:l,width:p}=t;return{title:r,fallbackUrl:d,completionBotId:c,url:n,card:s,height:u(l),width:u(p)}},r=e=>e.task&&"continue"===e.task.type&&(0,a.isObject)(e.task.value),d=e=>e.task&&"message"===e.task.type&&(0,a.isString)(e.task.value),c=e=>{const t=s(e);return{__typename:"TaskModuleTaskContinue",type:e.type,value:t}},l=({type:e,value:t})=>({__typename:"TaskModuleTaskMessage",type:e,value:t}),p=()=>({__typename:"TaskModuleTaskDone",text:"Done"}),u=e=>{if((0,a.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,a.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},m=e=>{const t=e.value.card;try{if(t&&g(t)){const e=(0,a.get)(t,"content")||{};return{__typename:"Card",contentType:(0,a.get)(t,"contentType"),content:JSON.stringify(e)}}throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}catch{throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}},g=e=>{const t=(0,a.get)(e,"contentType");return(0,a.isString)(t)&&t.toLowerCase()==="application/vnd.microsoft.card.adaptive".toLowerCase()}},108053:(e,t,n)=>{n.d(t,{Kw:()=>a,A$:()=>i,_7:()=>o,_3:()=>s});const a={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call",REQUEST_TIMEOUT_MESSAGE:"Request timeout"},i={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",GET_MEETING_FROM_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/{tenantId}/{organizerId}/{threadId}/{messageId}",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false"}},V2:{Unified:{GET_CALENDAR_EVENTS:"v2.0/unified/calendarEvents?startDate={startDate}&endDate={endDate}",GET_CALENDAR_VIEWS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",GET_CALENDAR_EVENT_FROM_JOIN_URL:"v2.0/unified/calendarEvent/joinUrl?joinUrl={joinUrl}"},Private:{GET_OUTLOOK_CALENDAR_SETTINGS:"v1/calendarSettings?settingName={outlookCalendarSettings}",GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_ATTACHMENTS:"v2.0/me/events/{eventId}/attachments/{attachmentId}"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW_V2_1:"v2.1/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}},Outlook:{V2:{Private:{GET_ATTACHMENT_BY_ID:"/v2.0/me/events/{eventId}/attachments/{attachmentId}"}}}},o="Personal",s={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover",NOTIFICATIONS_FLYOUT:"notifications-flyout",DRAG_DROP_EDIT_DIALOG:"drag-and-drop-edit-dialog",CHANNEL_PRE_STATE_SCHEDULE_MEETING_DETAILS_MENU_CONTEXT:"channel-pre-state-schedule-meeting-details-menu-context"}},649288:(e,t,n)=>{var a;n.d(t,{CK:()=>a,e:()=>i,eu:()=>o,vV:()=>s,Y2:()=>r}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(a||(a={}));const i="Thumbnails";var o,s,r;!function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort",e.RichFilePreviewFromChatsAndChannels="Thumbnails_RichFilePreviewFromChatsAndChannels",e.RichFilePreviewFromSearchFileCards="Thumbnails_RichFilePreviewFromSearchFileCards",e.RichFilePreviewFromShareTray="Thumbnails_RichFilePreviewFromShareTray"}(o||(o={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(s||(s={})),function(e){e.manualRedirect="manualRedirect"}(r||(r={}))},327080:(e,t,n)=>{n.d(t,{w:()=>o});var a=n(809110),i=n(924820);const o=(e,t)=>{try{if(!t)return;const n=JSON.parse(t.content);return{url:e,title:n.title&&s(n.title),description:n.text&&s(n.text),thumbnail:n.images&&n.images[0]?.url}}catch(e){throw new Error(`parsing preview content failed with error: ${(0,i.y)(e.message||"")}`)}},s=e=>(new a.J).stripHtml(e)||""},345640:(e,t,n)=>{n.d(t,{yr:()=>i,OE:()=>o,wr:()=>s,Ru:()=>r,Si:()=>d,Ls:()=>c,iH:()=>l,q2:()=>p,x$:()=>u,B6:()=>m});const a="__",i=(e,t,n,a,i)=>{if(!(e&&t&&n&&a))return"";return(i?[e,t,n,a,i]:[e,t,n,a]).join("__")},o=e=>{const[t,n,a,i]=e.split("__");return{tenantId:t,organizerId:n,conversationId:a,messageId:i}},s=e=>e.split(a)[0],r=e=>e.split(a)[1],d=e=>e.split(a)[2],c=e=>e.split(a)[3],l=e=>e.split(a)[4],p=(e,t,n)=>{const a=s(e),i=d(e),o={IsBroadcastMeeting:!0,role:"a",Tid:a,Oid:r(e)},c=`/l/meetup-join/${i}/0?context=${encodeURIComponent(JSON.stringify(o))}`;let l=t.replace("/{broadcastId}/join",`?url=${encodeURIComponent(c)}`);return n&&(l+=`&isanonymous=true&tenantId=${a}`),l},u=e=>{if(e){const t=e.stream,n=t?.wamsStreamingUrl,a=!!t?.decryptionToken,i=e.altStream,o=i?.wamsStreamingUrl;return!!(n&&a||o&&!!i?.decryptionToken)}return!1},m=(e,t,n,a,i)=>{const o=new URL(`/l/meetup-join/${encodeURIComponent(a)}/0`,`${e}`),s={Tid:t,Oid:n,...i?{IsBroadcastMeeting:!0,role:"a"}:{}},r=new URLSearchParams({context:JSON.stringify(s),...i?{btype:"a",role:"a"}:{}});return o.search=r.toString(),o.toString()}},605288:(e,t,n)=>{var a;n.d(t,{s:()=>a}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard"}(a||(a={}))},510699:(e,t,n)=>{function a(){return new Date}n.d(t,{AV:()=>a,Hs:()=>i,Ae:()=>c,iB:()=>l});const i=9999,o=59,s=59,r=23,d=999,c=new Date(i,11,31,0,0,0);function l(){const e=a();return e.setHours(r,s,o,d),e}},139496:(e,t,n)=>{n.d(t,{Gu:()=>a,dB:()=>i,nC:()=>o,Yl:()=>s,RJ:()=>r});class a{constructor(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class i extends a{constructor(e,t){super(e,t,((e,t)=>Math.pow(e,t)))}}class o extends a{constructor(e,t,n){super(n,e,((e,n)=>e*Math.pow(t,n-1)))}}class s extends a{constructor(e){super(e,e,(()=>e))}}class r extends a{constructor(e,t){super(t,e,((e,t)=>{const n=Math.random()*Math.pow(2,t-1);return Math.floor((.5*Math.pow(4,t-1)+n)*e)}))}}},781463:(e,t,n)=>{n.d(t,{h:()=>i});var a=n(480354);function i(e,t){function n(e){if(!(0,a.isArray)(e)&&!(0,a.isObject)(e)||(0,a.isDate)(e))return e;const n={};(0,a.forOwn)(e,((e,a)=>{n[a]=i(e,t)}));const{[t]:o,...s}=n;return s}return(0,a.isArray)(e)?e.map(n):n(e)}},891664:(e,t,n)=>{var a;n.d(t,{EE:()=>a,Dy:()=>i,Ig:()=>o,d0:()=>s,wP:()=>r}),function(e){e.SPPage="sppage",e.SPList="splist",e.SPListItem="splistitem",e.SPListForm="splistform",e.SPListPlaylist="splistplaylist",e.CustomCopilot="copilot",e.CopilotAgent="agent"}(a||(a={}));const i={[a.SPListItem]:"link_list_item_default_title",[a.SPListForm]:"link_list_form_default_title"},o=e=>d(e,[a.SPList,a.SPListPlaylist]),s=e=>d(e,[a.SPListItem]),r=e=>d(e,[a.SPListForm]),d=(e,t)=>!!e&&-1!==t.indexOf(e)},458648:(e,t,n)=>{var a,i,o;n.d(t,{YM:()=>a,uM:()=>i,oF:()=>o}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.THIRTY=30]="THIRTY",e[e.ONE_HUNDRED=100]="ONE_HUNDRED",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(a||(a={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_CACHE_TTL_IN_MS=6e4]="DEFAULT_SKYPE_CACHE_TTL_IN_MS",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR",e[e.DEFAULT_REGION_GTM_MIN_LENGTH=10]="DEFAULT_REGION_GTM_MIN_LENGTH"}(i||(i={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(o||(o={}))},218324:(e,t,n)=>{n.d(t,{$:()=>r});var a=n(694257),i=n(228113),o=n(49180),s=n(199448);const r=(e,t,n)=>{const r=c(e),l=(0,s.xZ)(e,a.b.internalErrorCode),p=(0,s.xZ)(e,a.b.httpCode,e?.code||l||""),u={errorMessage:r,serverRequestId:(0,s.xZ)(e,a.b.correlationId)};t(r),(0,i.m)(parseInt(p||"",10))&&!d(parseInt(p||"",10),l)?n&&n.fail({errors:JSON.stringify(u),errorCode:`${p}`}):n&&n.incomplete({errors:JSON.stringify(u),errorCode:`${p||o.rA.Unhandled}`})},d=(e,t)=>e&&e===o.jL.badRequest&&t&&t===o.rA.InvalidRequest,c=e=>{let t=(0,s.xZ)(e,a.b.logErrorMessage,e?.message||"");const n=(0,s.xZ)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const i={context:e?.context,subContext:e?.subContext};return t=`${t}. ${JSON.stringify(i)}`,t}},265954:(e,t,n)=>{var a;n.d(t,{G:()=>a}),function(e){e.About="about",e.Accounts="accounts",e.Appearance="appearance",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.ChatsAndChannels="chats_and_channels",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices",e.Recognition="recognition",e.FilesAndLinks="files_and_links",e.PhoneLink="phonelink",e.AppDevicePermission="app_permissions",e.Insiders="teams_insider",e.Localization="localization"}(a||(a={}))},299144:(e,t,n)=>{n.d(t,{Bg:()=>s,kF:()=>r,eq:()=>d,Vb:()=>c,q8:()=>l,pc:()=>p,Mw:()=>u,$A:()=>m,bV:()=>g,cN:()=>h,gm:()=>E,eV:()=>v});var a=n(779898),i=n(836176);const o=/[a-z]+-[a-z]+/gi,s=e=>{const t=e.match(/\/objects\/(.*)\/views\/video/);return t?.[1]},r=e=>`${e}.mpd`,d=(e,t,n)=>e.replace(new RegExp("/video$"),`/${n}/videoSegment/${t}`),c=e=>e.includes("canary")?"canary":"prod",l=e=>e?"2":"1",p=e=>e.replace("views/video","views/transcript"),u=(e,t,n)=>{if(!n||!e||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")},m=e=>r(e),g=(e,t)=>({...e&&{authorization:`skype_token ${e}`},...t&&{"ms-cv":t}}),h=()=>{const{document:e}=(0,a.z)(),t=e?.defaultView?.navigator.userAgent;return void 0!==t&&-1!==t.indexOf("Electron")},E=()=>{const{document:e}=(0,a.z)(),t=e?.defaultView?.navigator.userAgent;return void 0!==t&&-1!==t.indexOf("Firefox")},f=e=>(0,i.zU)(e).locale??e,v=(e,t,n)=>{const a=new Set;e&&a.add(f(e.toLowerCase())),t&&!a.has(t)&&a.add(f(t.toLowerCase()));const i=n.map((e=>f(e))).filter((e=>e.match(o)));if(i)for(const e of i){if(a.size>=4)break;a.has(e.toLowerCase())||a.add(e.toLowerCase())}return[...a].slice(0,4).join(";")}},370604:(e,t,n)=>{n.d(t,{Ow:()=>a,YZ:()=>i,IQ:()=>o,cg:()=>s,sY:()=>r,Vy:()=>d,Qw:()=>c,gM:()=>l,pK:()=>p});const a="video-message",i="video-message-gc",o="Creation-Epoch",s=(e,t)=>{const n=parseInt(t||"",10);return isNaN(n)||e-n>144e5},r=(e,t)=>e-t>2592e5,d=e=>l(e,"videoBlob"),c=e=>l(e,"thumbnailBlob"),l=(e,t)=>`${a}?cacheId=${e}&type=${t}`,p=e=>{try{const t=new URL(e);if(t.pathname.slice(Math.max(0,t.pathname.length-a.length))!==a)return;const n=t.searchParams.get("cacheId"),i=t.searchParams.get("type"),o="videoBlob"===i||"thumbnailBlob"===i?i:void 0;return n&&o?{cacheId:n,type:o}:void 0}catch{return}}},871894:(e,t,n)=>{n.d(t,{H:()=>i});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("query ComponentsChatQueriesUserPreferencesQuery {userPreferences {controllerConnectedServicesEnabled,readReceiptsEnabled}}");return delete this.definitions,this.definitions=e.definitions}}},748959:(e,t,n)=>{n.d(t,{H:()=>i});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsConnectedCalendarConnectedCalendarSettingFragment on ConnectedCalendarSetting {source,accountAddress,accountId,isSyncAllowed,eTag}");return delete this.definitions,this.definitions=e.definitions}}},359922:(e,t,n)=>{n.d(t,{V:()=>o});var a=n(67309),i=n(748959);const o={kind:"Document",get definitions(){const e=(0,a.G)("query syncConnectedCalendarSettings($callerInfo:String!) {syncConnectedCalendarSettings(callerInfo:$callerInfo) {...ComponentsConnectedCalendarConnectedCalendarSettingFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...i.H.definitions]}}},18113:(e,t,n)=>{n.d(t,{q6:()=>c,O3:()=>l,ei:()=>p,tn:()=>f,qE:()=>v,lW:()=>I});var a=n(755029),i=n(726723),o=n(754255),s=n(418709),r=n(448681);const d="growth_growthplatform_esp_common_component",c=()=>{const{entityCommanding:e}=(0,a.ur)(),t=(0,s.m)();return n=>((0,r.ZN)(t,n),e.esp.launchDialog(n))};function l(e,t,n,a){return e&&t?`${n(a,e,void 0,!0)} ${n(a,t,void 0,!0)}`:n(a,e||t,void 0,!0)}function p(e,t,n,a){const i=I(t,a).reduce(((e,t)=>(e[t.id]=t,e)),{})[e];if(i)if(i?.id||(i.id=e),"Coachmark"!==i.surface||function(e,t){if(e.__typename&&"EspCoachmarkParams"!==e.__typename)return!1;const n=e,a=(e,n)=>h(e,n,t),{targetId:i,content:o,header:s,position:r,align:d,pointing:c,sticky:l,closeButton:p,primaryButton:m,secondaryButton:g,selector:f}=n;return(E(i)||E(f)||a(void 0,"target"))&&a(o,"content")&&(!s||"localized"===s.type&&a(s.localizedContent,"header.localizedContent")||a(s.key,"header.key")&&a(s.namespace,"header.namespace"))&&a(r,"position")&&a(d,"align")&&a(c,"pointing")&&a(l,"sticky")&&a(p,"closeButton")&&u(m,"primaryButton",t)&&u(g,"secondaryButton",t)}(i.params,n))if("Modal"!==i.surface||function(e,t){if(e.__typename&&"EspModalParams"!==e.__typename)return!1;const n=e,a=(e,n)=>h(e,n,t),{userInterfaceControls:i}=n;return a(i,"userInterfaceControls")&&function(e,t){const n=e&&e.map((e=>{switch(e.type){case"image":return g(e,t);case"video":return function(e,t){return e&&h(e.title,"title",t)&&h(e.src,"src",t)}(e,t);case"button":return function(e,t){return e&&h(e.isPrimary,"isPrimary",t)&&h(e.action,"action",t)}(e,t);case"text":return m(e,t);case"space":return function(e,t){return e&&h(e.height,"height",t)}(e,t);case"infoItem":return function(e,t){return g(e.image,t)&&m(e.title,t)&&m(e.description,t)}(e,t);case"themePicker":case"simpleCollabViewPicker":return!0;case"accountPicker":return function(e,t){return e&&h(e.filterAccountType,"filterAccountType",t)}(e,t);case"freePremiumExperience":return function(e,t){return e&&h(e.items,"items",t)}(e,t);default:return!1}}));return!(!n||n.indexOf(!1)>-1)}(i,t)}(i.params,n)){if("QuickGuide"!==i.surface||function(e,t,n){if(e.__typename&&"EspQuickGuideParams"!==e.__typename)return!1;const a=e,i=a.cards,o=(e,t)=>h(e,t,n),{cards:s}=a;if(!o(s,"cards"))return!1;if(0===s.length)return n.errorToTelemetry?.(`Cards for surface: ${t} are not defined.`,d,void 0,!0),!1;return i.every((({targetId:e,selector:t,content:n,header:a,position:i,align:s,pointing:r})=>(E(e)||E(t)||o(void 0,"target"))&&o(n,"content")&&(!a||"localized"===a.type&&o(a.localizedContent,"header.localizedContent")||o(a.key,"header.key")&&o(a.namespace,"header.namespace"))&&o(i,"position")&&o(s,"align")&&o(r,"pointing")))}(i.params,e,n))return i;n.errorToTelemetry?.(`QuickGuide surface: ${e} is incorrectly defined.`,d,void 0,!0)}else n.errorToTelemetry?.(`Dialog surface: ${e} is incorrectly defined.`,d,void 0,!0);else n.errorToTelemetry?.(`Coachmark surface: ${e} is incorrectly defined.`,d,void 0,!0);else n.errorToTelemetry?.(`Cannot find surface: ${e} in ESP configuration.`,d,void 0,!0)}function u(e,t,n){return!e||h(e.content,`${t}.content`,n)&&h(e.action,`${t}.action`,n)}function m(e,t){return e&&h(e.resource,"resource",t)}function g(e,t){return e&&h(e.alt,"alt",t)&&h(e.src,"src",t)}function h(e,t,n){return void 0===e&&n.errorToTelemetry?.(`Required property ${t} is not defined.`,d,void 0,!0),void 0!==e}function E(e){return void 0!==e}function f(e){return"Coachmark"===e||"QuickGuide"===e}const v=e=>{switch(e){case"Modal":return i.rP.dialog;case"Coachmark":default:return i.rP.popover;case"QuickGuide":return i.rP.quickGuide;case"SyntheticNotification":case"TfwNotification":return i.rP.activityFeed}},I=(e,t)=>{const n=C(e);return t&&t.length?n.concat(t):n},C=e=>{const t=e.get(o.w.Esp),{testAutomation:n}=e.get(o.w.Test),a=[];return Object.keys(t).forEach((e=>{const i=t[e];i&&i.surface&&!!n==!!i.isTest&&a.push(y(i,e))})),a},y=(e,t)=>({...e,id:t,priority:e.priority,trigger:e.trigger,surface:e.surface,recur:Math.max(-1,e.recur||1),isControlGroup:!!e.isControlGroup,triggerFilter:e.triggerFilter,targetWindow:e.targetWindow,condition:e.condition,fetchDataKeys:e.fetchDataKeys||[],dataCondition:e.dataCondition,expiryDate:e.expiryDate,viewExternalTelemetry:e.viewExternalTelemetry,closeExternalTelemetry:e.closeExternalTelemetry,dataIdentifier:e.dataIdentifier,categories:e.categories,delayInSeconds:Math.max(Number.isInteger(e.delayInSeconds)?e.delayInSeconds:0,0),ignoreLock:!!e.ignoreLock,params:e.params})},256375:(e,t,n)=>{n.d(t,{t_:()=>f});var a=n(67309);const i={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espLocalizedResource on EspLocalizedResource {type,localizedContent}");return delete this.definitions,this.definitions=e.definitions}},o={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espImage on EspImage {src,alt {...ComponentsEspCommonSurfaceFragment_espLocalizedResource}}");return delete this.definitions,this.definitions=[...e.definitions,...i.definitions]}},s={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espExternalTelemetry on EspExternalTelemetry {type,value}");return delete this.definitions,this.definitions=e.definitions}},r={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espAction on EspAction {... on EspEntityCommandAction {type,entityCommand {entity {type,action,id,linkedEntity {id,type}},command {visibilityState,stateTransition},entityOptions {option,value}},externalTelemetry {...ComponentsEspCommonSurfaceFragment_espExternalTelemetry}},... on EspUrlNavigationAction {type,url,externalTelemetry {...ComponentsEspCommonSurfaceFragment_espExternalTelemetry}},... on EspDeeplinkNavigationAction {type,url,externalTelemetry {...ComponentsEspCommonSurfaceFragment_espExternalTelemetry}},... on EspNoParamsAction {type,externalTelemetry {...ComponentsEspCommonSurfaceFragment_espExternalTelemetry}}}");return delete this.definitions,this.definitions=[...e.definitions,...s.definitions]}},d={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espCoachmarkButton on EspCoachmarkButton {content {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},action {...ComponentsEspCommonSurfaceFragment_espAction}}");return delete this.definitions,this.definitions=[...e.definitions,...i.definitions,...r.definitions]}},c={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalImage on EspImageControl {src,alt {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},type,isLocalized,width,align}");return delete this.definitions,this.definitions=[...e.definitions,...i.definitions]}},l={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalButton on EspButtonControl {isPrimary,disabled,icon,backgroundImage {...ComponentsEspCommonSurfaceFragment_espModalImage},resource {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},action {...ComponentsEspCommonSurfaceFragment_espAction},type}");return delete this.definitions,this.definitions=[...e.definitions,...c.definitions,...i.definitions,...r.definitions]}},p={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalSpace on EspSpaceControl {height,type}");return delete this.definitions,this.definitions=e.definitions}},u={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalText on EspTextControl {removeDefaultMargin,resource {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},size,weight,align,type}");return delete this.definitions,this.definitions=[...e.definitions,...i.definitions]}},m={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalInfoItem on EspInfoItemControl {image {...ComponentsEspCommonSurfaceFragment_espModalImage},title {...ComponentsEspCommonSurfaceFragment_espModalText},description {...ComponentsEspCommonSurfaceFragment_espModalText},align,type}");return delete this.definitions,this.definitions=[...e.definitions,...c.definitions,...u.definitions]}},g={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalThemePicker on EspThemePickerControl {type}");return delete this.definitions,this.definitions=e.definitions}},h={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalSimpleCollabViewPicker on EspSimpleCollabViewPickerControl {type}");return delete this.definitions,this.definitions=e.definitions}},E={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment_espModalFreePremiumExperience on EspFreePremiumExperienceControl {type}");return delete this.definitions,this.definitions=e.definitions}},f={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonSurfaceFragment on EspSurfaceConfiguration {id,isControlGroup,trigger,triggerFilter,condition,fetchDataKeys,dataCondition,surface,priority,recur,delayInSeconds,ignoreLock,params {... on EspCoachmarkParams {targetId,selector,content {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},header {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},image {...ComponentsEspCommonSurfaceFragment_espImage},position,align,offset {primary,secondary},pointing,sticky,closeButton,primaryButton {...ComponentsEspCommonSurfaceFragment_espCoachmarkButton},secondaryButton {...ComponentsEspCommonSurfaceFragment_espCoachmarkButton},zIndex},... on EspNotificationParams {visibility,titleNotification:title {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},descriptionNotification:description {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},deeplinkUrlNotification:deeplinkUrl},... on EspTfwNotificationParams {teamsAppId,titleTfwNotification:title {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},previewText {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},description {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},source,deeplinkUrl,activityType},... on EspModalParams {userInterfaceControls {...ComponentsEspCommonSurfaceFragment_espModalImage,...ComponentsEspCommonSurfaceFragment_espModalButton,...ComponentsEspCommonSurfaceFragment_espModalSpace,...ComponentsEspCommonSurfaceFragment_espModalText,...ComponentsEspCommonSurfaceFragment_espModalInfoItem,...ComponentsEspCommonSurfaceFragment_espModalThemePicker,...ComponentsEspCommonSurfaceFragment_espModalSimpleCollabViewPicker,...ComponentsEspCommonSurfaceFragment_espModalFreePremiumExperience},hideCloseIcon,closeOnOutsideClick,footerAlign,dialogWidth,removeImageDefaultPadding,removeFooterTopPadding,removeFooterBottomPadding,backgroundColor,closeOnEscape,title {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},headerContent {resource {...ComponentsEspCommonSurfaceFragment_espLocalizedResource},removeDefaultMargin,align,size,weight},entityType}},viewExternalTelemetry {...ComponentsEspCommonSurfaceFragment_espExternalTelemetry},closeExternalTelemetry {...ComponentsEspCommonSurfaceFragment_espExternalTelemetry},dataIdentifier {irisCampaignId}}");return delete this.definitions,this.definitions=[...e.definitions,...i.definitions,...o.definitions,...d.definitions,...c.definitions,...l.definitions,...p.definitions,...u.definitions,...m.definitions,...g.definitions,...h.definitions,...E.definitions,...s.definitions]}}},613712:(e,t,n)=>{n.d(t,{e:()=>s});var a=n(67309),i=n(256375);const o={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsEspCommonEspStateSurfacesFragment on EspState {surfaces {...ComponentsEspCommonSurfaceFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...i.t_.definitions]}},s={kind:"Document",get definitions(){const e=(0,a.G)("query ComponentsEspCommonEspStateSurfacesQuery {espState {...ComponentsEspCommonEspStateSurfacesFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...o.definitions]}}},995598:(e,t,n)=>{n.d(t,{j:()=>o,Q:()=>s});var a=n(67309),i=n(256375);const o={kind:"Document",get definitions(){const e=(0,a.G)("fragment espDisplayedSurface on EspDisplayedSurface {id,controlGroupTimestamps,displayedTimestamps}");return delete this.definitions,this.definitions=e.definitions}},s={kind:"Document",get definitions(){const e=(0,a.G)("fragment espState on EspState {displayed {...espDisplayedSurface},userState {completedActions {action}},priorityThrottlesInMinutes,surfaces {...ComponentsEspCommonSurfaceFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...o.definitions,...i.t_.definitions]}}},824066:(e,t,n)=>{var a,i;n.d(t,{DG:()=>a,Mv:()=>i,qh:()=>o}),function(e){e.CreateTeam="CreateTeam",e.CreateChannel="CreateChannel",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.MarkAllChannelsAsRead="MarkAllChannelsAsRead",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(a||(a={})),function(e){e.None="None",e.PinChannel="PinChannel",e.UnpinChannel="UnpinChannel",e.ShowChannel="ShowChannel",e.HideChannel="HideChannel",e.ShowTeam="ShowTeam",e.HideTeam="HideTeam",e.ExpandTeam="ExpandTeam",e.CollapseTeam="CollapseTeam",e.ReorderTeam="ReorderTeam",e.ReorderPinnedChannels="ReorderPinnedChannels",e.ForceHideTeam="ForceHideTeam",e.SetChannelRecommendation="SetChannelRecommendation",e.StopChannelRecommendation="StopChannelRecommendation"}(i||(i={}));const o={forceSync:!1}},603574:(e,t,n)=>{n.d(t,{a:()=>a});const a={}},965919:(e,t,n)=>{n.d(t,{GT:()=>p,Ep:()=>u,wo:()=>h,Cd:()=>f,us:()=>v,RR:()=>I,V2:()=>C,yt:()=>y,vf:()=>T,Wo:()=>_,WG:()=>A,ii:()=>S});var a=n(850434),i=n(199448),o=n(370054),s=n(945824),r=n(131647),d=n(572909),c=n(668625),l=n(824066);const p=(e,t)=>e.isGeneral?"OwnersPost"!==t||"Admin"===e.memberRole:"Admin"===e.memberRole||e.isModerator||"Everyone"===e.channelSettings?.channelPostPermissions||"EveryoneButGuests"===e.channelSettings?.channelPostPermissions&&"Guest"!==e.memberRole&&"Undefined"!==e.memberRole,u=(e,t)=>{const n=m(e,t);let a=n.channelId;const i=n.replyChainId,o="string"==typeof a,s="string"==typeof i||null==i;return o&&(a=a.includes("login")?a.substring(0,a.indexOf("/?login")):a),o&&s||g("extractChannelMessageCompoundId",e,t),{channelId:a,replyChainId:i}},m=(e,t)=>{const n=decodeURIComponent(e);return E(n,t)},g=(e,t,n)=>{const o=`TeamsAndChannelsHelper::${e}::${a.O4.InvalidInput}::${t}`;throw n?.error(o),(0,i.$5)("TeamsAndChannelsHelper",a.O4.InvalidInput,e,{compoundId:t},o)},h=(e,t)=>{const n=m(e,t);let a=n.channelId;const i=n.teamId,o=n.replyChainId,s="string"==typeof a,r="string"==typeof o||null==o,d="string"==typeof i||null==i;return s&&(a=a.includes("login")?a.substring(0,a.indexOf("/?login")):a),s&&d&&r||g("extractChannelCopilotMessageCompoundId",e,t),{channelId:a,teamId:i,replyChainId:o}},E=(e,t)=>{try{const{channelId:t,teamId:n,replyChainId:a}=JSON.parse(e);return{channelId:t,teamId:n,replyChainId:a}}catch(n){return t?.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},f=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:t,channelId:n}=JSON.parse(e);return{teamId:t,channelId:n}}catch{return{channelId:e}}},v=(e,t,n,a,i,d,c,p,u,m,g,h,E,f)=>{switch(e){case l.DG.CreateTeam:i&&f?t.teamsAndChannels.createTeamV2({entryPoint:o.qF.teamsAndChannels}):a?t.teamsAndChannels.createTeamOnMainView({source:o.$D.template,canUserCreateTeam:!!f,entryPoint:o.qF.teamsAndChannels},p):t.teamsAndChannels.createTeam();break;case l.DG.CreateChannel:h&&g&&t.teamsAndChannels.createChannelOnLeftRail({entryPoint:s.k.ChannelListHeaderContextMenu});break;case l.DG.JoinTeamByCode:p===r.p.SchoolTeams?t.school.gridTeamDiscover():t.teamsAndChannels.teamDiscover();break;case l.DG.JoinTeam:d?t.teamsGallery.launchTeamsGallery():t.teamsAndChannels.teamDiscover();break;case l.DG.AddChannel:n&&g?t.teamsAndChannels.createChannel({teamId:n.id,groupId:n.groupId||"",teamType:n.teamType}):n&&t.teamsAndChannels.addChannel(n.id);break;case l.DG.AddMember:n&&(c?t.teamsAndChannels.addMemberToTeamDialog(n.id):t.teamsAndChannels.addMember(n.id));break;case l.DG.MarkAllChannelsAsRead:u?.();break;case l.DG.ManageTeamsList:t.teamsAndChannels.manageTeamsList(r.p.ChannelList,E?{entityCommand:E}:void 0,m?.()),u?.();break;case l.DG.ManageTeamsInvites:t.teamsAndChannels.manageSharedChannelsPendingInvites(r.p.ChannelList,void 0,m?.()),u?.();break;case l.DG.CrossTeamAnalytics:t.teamsAndChannels.crossTeamAnalytics(r.p.ChannelList,void 0,m?.()),u?.()}},I=e=>{const t=e,n=t.graphQLErrors?.find((e=>"CDLResolver"===e.extensions?.source)),a=n?.extensions?.prevError,i=a?.extraInfo;return i},C=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const t=decodeURIComponent(e),{teamId:n,channelId:a,replyChainId:i}=JSON.parse(t);return{teamId:n,channelId:a,replyChainId:i}}catch{return{channelId:e}}},y=e=>`overflow-${e}`,T=e=>{if("options"in e&&e.options)return(0,c.j)(e.options||"")},_=e=>{let t;try{t=JSON.parse(e?.id||"{}")}catch{t={}}return t},A=d.ck?[d.ck.teammanage,d.ck.teammembers,d.ck.teamchannels,d.ck.teampendingrequests,d.ck.teammanagetags]:[],S=d.ck?[d.ck.channelapps,d.ck.channelmanage,d.ck.channelmembers,d.ck.channelinvitations]:[]}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/999458-48ecb9772dff590a.js.map