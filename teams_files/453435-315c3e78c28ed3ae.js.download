"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[453435],{541381:(e,t,i)=>{i.d(t,{D:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformAppButtonQuery($appId:ID!) {appButtonResult(appId:$appId) @client {appId,action}}");return delete this.definitions,this.definitions=e.definitions}}},415216:(e,t,i)=>{i.d(t,{$:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformAppFocusEnterQuery($appId:ID!) {focusEnterHandlerState(appId:$appId) @client {appId,action}}");return delete this.definitions,this.definitions=e.definitions}}},878647:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformAppFocusRegisterQuery($appId:ID!) {registerFocusEnterHandlerState(appId:$appId) @client {appId,isRegistered}}");return delete this.definitions,this.definitions=e.definitions}}},883038:(e,t,i)=>{i.d(t,{E:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformBackButtonHandlerStateQuery {backButtonHandlerState @client {id,registered}}");return delete this.definitions,this.definitions=e.definitions}}},335483:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformChangeSettingsQuery($id:ID!) {changeSettingsResult(id:$id) @client {id,status,appId,tabId}}");return delete this.definitions,this.definitions=e.definitions}}},950362:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformChangeSettingsTriggerQuery($id:ID!) {changeSettingsTriggerResult(id:$id) @client {id,appId,tabId,message}}");return delete this.definitions,this.definitions=e.definitions}}},793236:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformLocalFrameContextQuery {localFrameContext @client {id,threadId,messageId,tabId,websiteUrl,contentUrl}}");return delete this.definitions,this.definitions=e.definitions}}},861216:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformTabSdkApiRequestResultQuery($apiRequestId:ID!,$operationType:TabSdkApiOperationType!) {tabSdkApiRequestResult(apiRequestId:$apiRequestId,operationType:$operationType) @client {sdkError {message,errorCode},data {tabId}}}");return delete this.definitions,this.definitions=e.definitions}}},828822:(e,t,i)=>{i.d(t,{V:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query mapCoordinateResult {mapCoordinateResult @client {latitude,longitude,locationApiError}}");return delete this.definitions,this.definitions=e.definitions}}},530811:(e,t,i)=>{i.d(t,{B:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query messageToChildResult($appId:ID!) {messageToChildResult(appId:$appId) @client {appId,message}}");return delete this.definitions,this.definitions=e.definitions}}},609904:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query selectMediaResult {selectMediaResult @client {selectMediaError,mediaUrls}}");return delete this.definitions,this.definitions=e.definitions}}},800520:(e,t,i)=>{i.d(t,{m:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query selectPeoplePickerResult {selectPeoplePickerResult @client {objectId,displayName,email}}");return delete this.definitions,this.definitions=e.definitions}}},186070:(e,t,i)=>{i.d(t,{z:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query showLocationResponse {showLocationResponse @client}");return delete this.definitions,this.definitions=e.definitions}}},189261:(e,t,i)=>{i.d(t,{g:()=>o});var n=i(67309);const o={kind:"Document",get definitions(){const e=(0,n.G)("query viewImagesResult {viewImagesResult @client {viewImagesError,errorCode}}");return delete this.definitions,this.definitions=e.definitions}}},211489:(e,t,i)=>{var n;i.d(t,{AZ:()=>c,B4:()=>d,sT:()=>l,QV:()=>u,Sx:()=>p}),function(e){e.StoreDevices="StoreDevices",e.StoreCart="StoreCart",e.StoreCartCheckout="StoreCartCheckout",e.Store="Store"}(n||(n={}));const o="openDeviceDetailsDialog",r="openStoreCartCheckoutDialog",a="openStoreCartDialog",s="closeStoreCartCheckoutDialog",c={openDeviceDetailsDialog:e=>({originator:n.StoreDevices,type:o,data:()=>({...e})}),openStoreCartDialog:()=>({originator:n.StoreCart,type:a}),openStoreCartCheckoutDialog:e=>({originator:n.StoreCartCheckout,type:r,data:()=>({...e})}),closeStoreCartCheckoutDialog:()=>({originator:n.StoreCartCheckout,type:s})},d=e=>h(e)&&e.type===o,l=e=>h(e)&&e.type===a,u=e=>h(e)&&e.type===r,p=e=>h(e)&&e.type===s,h=e=>Object.keys(n).includes(e.originator)},81670:(e,t,i)=>{i.d(t,{yq:()=>n,QF:()=>o,ct:()=>r,CO:()=>a,D2:()=>s,iS:()=>c,kj:()=>d,pw:()=>l,GT:()=>u,yx:()=>p,$Z:()=>h,fu:()=>_,tG:()=>f,Cd:()=>m,p2:()=>g,Pj:()=>E,NI:()=>y,xM:()=>I,Qr:()=>S,X7:()=>b,mJ:()=>v,oF:()=>T,$X:()=>C,i3:()=>k,vF:()=>A,ar:()=>N,Ib:()=>w,FQ:()=>O,jL:()=>P,zB:()=>M,xD:()=>x,J:()=>U,yB:()=>F,bw:()=>L,Xz:()=>$,Oi:()=>B,OF:()=>q,wk:()=>Y,xH:()=>W,aF:()=>G,gl:()=>H,Qc:()=>K,Ee:()=>Q});const n="TflFreProfileCardDisplayed",o="LogoutState",r="authSessionId",a={nopa:"2"},s={coa:"1"},c={2003:"1"},d="tenantId",l="loginhint",u="login_hint",p="clientexperience",h="t2",_={TfwToTfl:"teams.live.com",TflToTfw:"teams.microsoft.com"},f={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",CloudMismatch:"CloudMismatch",CloudMismatchNoMultiCloud:"CloudMismatchNoMultiCloud",MultiMSARoadBlock:"MultiMSARoadBlock",InitFailure:"Core-auth init failure",NoMatchingUserFound:"NoMatchingUserFound",InteractionRequired:"InteractionRequired",RefreshTokenExpired:"refresh_token_expired",UnsupportedAccountType:"UnsupportedAccountType",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",NoNetwork:"NoNetwork",MachineAsleep:"MachineAsleep",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",InvalidEndpoint:"endpoints_resolution_error",UnsupportedParameter:"UnsupportedParameter",UserAuthOrHomeAccountNotAvailable:"UserAuthOrHomeAccountNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken",HiddenUserErrorForLogin:"HiddenUserErrorForLogin",MsaUserNotAllowed:"MsaUserNotAllowed",ShowTenantPicker:"ShowTenantPicker",LogOutTriggeredFromCrossCloud:"Log out triggered cross cloud",NoSkypetokenAvailableInResponse:"NoSkypetokenAvailableInResponse",PushNotificationEventWithErrors:"PushNotificationEventWithErrors",NoTenantsFound:"NoTenantsFound",SkypeTokenResponseInvalidJson:"SkypeTokenResponseInvalidJson",AcquireTokenCloudMismatch:"AcquireTokenCloudMismatch",CrossCloudTenantInWeb:"CrossCloudTenantInWeb",SkypeTokenMigrationUnsupportedClient:"SkypeTokenMigrationUnsupportedClient",InvalidTenantResponse:"InvalidTenantResponse",RestartDevice:"RestartDevice"},m={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},g="https://login.microsoftonline.com/",E=[{cloud:"prod",authority:g},{cloud:"gallatin",authority:"https://login.partner.microsoftonline.cn/"},{cloud:"dod",authority:"https://login.microsoftonline.us/"},{cloud:"gcch",authority:"https://login.microsoftonline.us/"},{cloud:"life",authority:g},{cloud:"airgap09",authority:"https://login.microsoftonline.microsoft.scloud/"},{cloud:"airgap08",authority:"https://login.microsoftonline.eaglex.ic.gov/"}],y="InteractionRequiredAuthError",I="skype-token",S="discover-region-gtm",b="tmp.otp-meeting-key";var v,T,C;!function(e){e.signInButton="signInButton",e.joinNowButton="joinNowButton",e.authAddAccount="authAddAccount"}(v||(v={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com",e.IC3_GATEWAY_CAE_KEY_INT="https://ic3-testing.teams.office.com",e.IC3_GATEWAY_AAD_KEY_INT="https://ic3-non-cae-testing.teams.office.com"}(T||(T={})),function(e){e.openId="openId",e.profile="profile"}(C||(C={}));let D=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error","Sending silent Cross-Cloud request on unsupported version of Windows"];const k=e=>(e&&(D=[...D,...e]),D),A=()=>D;let R=[];const N=e=>(e&&(R=[...R,...e]),R),w=e=>R.includes(e);var O;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.TEN=10]="TEN",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY",e[e.TWO_HUNDRED_FIFTY_FIVE=255]="TWO_HUNDRED_FIFTY_FIVE"}(O||(O={}));const P={CLIENT_ERROR:-1,OK:200,BAD_REQUEST:400,UNAUTHORIZED_ACCESS:401,FORBIDDEN:403,NOT_FOUND:404,NOT_ACCEPTABLE:406,CONFLICT:409,LOCKED:423,TOO_MANY_REQUESTS:429,INTERNAL_SERVER_ERROR:500,SERVICE_UNAVAILABLE:503,NOT_MODIFIED:304};var M,x;!function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.ONE_DAY=864e5]="ONE_DAY"}(M||(M={})),function(e){e.services="f8cdef31-a31e-4b4a-93e4-5f571e91255a"}(x||(x={}));const U="9188040d-6c67-4c5b-b112-36a304b66dad",F="organizations",L="wids",$="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",B="b44d8d43-c828-450b-9b6f-ae3788447705",q="X-MS-Migration",Y="X-Ms-Test-User",W="tmp.trialLicenseSignUpAccountId",G=(O.TWO,M.MILLI_PER_SECOND,M.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim",SKYPE_ONLY_TEAMS_SHARED_DEVICES:"skype_only_teams_shared_devices"}),H={MTO:"MTO"},K={TENANTSV2:"/beta/users/tenantsv2"},Q="auth_home_tenant_placeholder"},663789:(e,t,i)=>{i.d(t,{l:()=>n});class n{}n._authTelemetryCollection={},n._correlationMap={},n._userBiServiceMap={},n.getUserBiService=e=>n._userBiServiceMap[e]||n._userBiServiceMap.GLOBAL,n.setUserBiService=(e,t)=>{t?n._userBiServiceMap[e]=t:delete n._userBiServiceMap[e]},n.getAuthTelemetry=e=>n._authTelemetryCollection[e],n.setAuthTelemetry=(e,t)=>n._authTelemetryCollection[e]=t,n.delete=e=>{delete n._authTelemetryCollection[e];const t=Object.keys(n._correlationMap);for(const i in t)if(n._correlationMap.hasOwnProperty(t[i])){const o=t[i],r=n._correlationMap[o];r&&(n._correlationMap[o]=r.filter((t=>t!==e)))}},n.getCorrelation=e=>n._correlationMap[e],n.setCorrelation=e=>{if(!e.scenarioName)return;const t=n.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),n._correlationMap[e.scenarioName]=t}},899855:(e,t,i)=>{i.d(t,{we:()=>_,yw:()=>h,d9:()=>p,$C:()=>g,nd:()=>m,FS:()=>E});var n=i(710225),o=i(736626),r=i(726723),a=i(195695),s=i(667606),c=i(663789),d=i(199448);class l{constructor(e,t,i,l,u,p,h,_,f){this._scenarioFactory=e,this._correlation=t,this._asyncAuthCache=i,this._subContext=l,this._shouldCreateScenario=u,this._isBatch=p,this._timeoutMs=h,this._telemetryService=_,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{e=this.scrubEuiiFromEventData(e),this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData={...this._localScenarioEventData,...e}},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},i)=>{t=this._mapEventData(t,i),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),this.logMessage(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,o.hR)(t)}]`)},this.closeScenario=(e={},t,i,o)=>{if(e=this._mapEventData(e,t),i)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(this._isBatch&&this._correlation.scenarioName&&(this._batchScenarioStartTime&&(e.perfDelta=performance.now()-this._batchScenarioStartTime),e.correlationId=e.correlationId??this._correlation.id,"success"===e.status?(0,a.G4)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,o):"failure"===e.status?(0,a.Bz)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,o):(0,a.Fy)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,o)),!this._scenario){const t=this._shouldCreateScenario?n.D.warn:n.D.log,i=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${i} [scenarioEventData]`,e),void c.l.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const r="failure"===e.status?n.D.error:n.D.log;this.logEventData(r,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),c.l.delete(this._correlation.id)},this.createScenario=(e,t,i)=>{this._scenario?this.logMessage(`createScenario called with [${this._subContext}][${(0,o.hR)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`,n.D.warn):(this._createScenario(e,i||this._timeoutMs,{...this._localScenarioEventData,...t}),this.logMessage(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const i={panelRegion:r.rP.main,panelType:r.HP.AuthStart,actionWorkload:r.E0.auth,actionSubworkload:r.i7.sisu,actionScenarioType:r.DB.appAuth,actionScenario:t.scenario,actionGesture:t.actionGesture||r.Od.auto},o=c.l.getUserBiService(e||"GLOBAL");o&&o.recordPanelAction(i,n.D)},this.setUserToTelemetryContext=e=>{e&&(this._telemetryService?.setAuthContext(e),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`))},this.setUserDetailsToTelemetryContext=e=>{if(e){const{region:t}=e;void 0!==t&&this._telemetryService?.setCoreContext("UserInfo.Region",t),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{if(e.subContext=e.subContext||this._subContext,(e={...this._localScenarioEventData,...e}).error){const t=(0,d.Mr)(e.error.message);e.error={...e.error,message:t,errorMetadata:void 0},e.errorCode=e.error.code??e.error.errorCode,e.message=t||"",this.addEventData([`errorCode:${e.error.errorCode}`]),"errorMessage"in e.error&&"string"==typeof e.error.errorMessage&&(e.error.errorMessage=(0,d.Mr)(e.error.errorMessage))}return!t&&e.error&&(t=(0,s.$z)(e.error)?"incomplete":"failure"),e.eventData=(0,d.Mr)(this._eventData.join(",")),e.status=t||"success",e},this._createScenario=(e,t,i)=>{const o=t?{timeoutMs:t}:{};this._scenario=this._scenarioFactory.findScenario(e)||void 0,this._scenario||(this._scenario=this._scenarioFactory.newScenario(e,o),this._scenario.appendEventData({createdBy:"authTelemetry"}));try{this._scenarioFactory.hoistScenarioToCore?.(this._scenario)}catch(e){n.D.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source,...i}),this._shouldCreateScenario=!0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,i)=>{i.error||delete i.error;const n=this.splitStringEqually((0,d.Mr)((0,o.hR)(i)));for(const i of n)this.logMessage(`${t}${i}`,e)},this.splitStringEqually=(e,t=300)=>{const i=new RegExp(`.{1,${t}}`,"g"),n=e.match(i);return n||[]},this.logMessage=(e,t)=>{this._isBatch||(t?t(e):n.D.log(e))},this.scrubEuiiFromEventData=e=>{for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const i=t,n=e[i];"string"==typeof n&&(e[i]=(0,d.Mr)(n))}return e},this._loggingPrefix=this.loggingPrefix(),this._isBatch&&(this._batchScenarioStartTime=performance.now()),u&&(f?this._scenario=f:this._correlation?.scenarioName&&this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),this.logMessage(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${u}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return{...this._correlation}}}class u{constructor(e,t,i){this._scenarioProvider=e,this._asyncAuthCache=t,this._telemetryService=i,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{const t=new l(this._scenarioProvider,e.correlation,this._asyncAuthCache,e.subContext,!0,e.isBatch??!1,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>c.l.getCorrelation(e)||[],this._createScenario=(e,t)=>{const{correlation:i,subContext:n,scenarioEventData:o,timeoutMs:r,scenario:a,isBatch:s}=e;let d=c.l.getAuthTelemetry(i.id);if(d)d.addEventData([`fn:${n}`]);else{const o=this._telemetryService?.getTelemetryServicesCache().get(e.scenarioEventData?.accountId);d=new l(o?.coreScenarioFactory||this._scenarioProvider,i,this._asyncAuthCache,n,t,s??!1,r,o?.telemetryService||this._telemetryService,a),c.l.setAuthTelemetry(i.id,d)}return o&&d.appendScenarioEventData(o),c.l.setCorrelation(i),d}}}const p=(e,t)=>{c.l.setUserBiService(e||"GLOBAL",t)},h=e=>f({...e,startWithoutScenario:!1}),_=e=>{e.options.correlation={id:e.options.correlation?.id??(0,o.DA)(),scenarioName:e.options.correlation?.scenarioName??e.scenarioName,source:e.options.correlation?.source??e.source};const{options:{correlation:t},...i}=e;return f({correlation:t,...i})},f=e=>{const{correlation:t,subContext:i,scenarioEventData:n,eventData:o,timeoutMs:r,scenario:a,isBatch:s}=e,d=c.l.getAuthTelemetry(t.id),l=(e.startWithoutScenario||!t.scenarioName?g.createWithoutScenario:g.create)({correlation:t,subContext:i,scenarioEventData:n,timeoutMs:r,scenario:a,isBatch:s});o&&l.addEventData(o);return[l,(e,t,i)=>l.closeScenario(e,t,!!d,i)]},m=e=>g.getCorrelation(e);let g;const E=(e,t,i)=>{g||(g=new u(e,t,i),n.D.log("authTelemetryProvider initialized"))}},667606:(e,t,i)=>{i.d(t,{$5:()=>a,r$:()=>s,pz:()=>c,BI:()=>d,$z:()=>l,Oi:()=>u});var n=i(81670),o=i(850434),r=i(736626);function a(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}const s=(e,t,i)=>{switch(e.code){case o.O4.NoNetwork:return c({name:"offlineEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"OfflineError",errorMetadata:void 0});case o.O4.SignInRestrictions:return c({name:"signInRestrictionEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"SignInRestriction",errorMetadata:i});case o.O4.RestartDevice:return c({name:"restartDeviceNeededEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"RestartDevice",errorMetadata:i})}return e};function c(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetadata:e.errorMetadata,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError,message:e.message})}function d(e){return(0,n.vF)().indexOf(e)>=0}function l(e){return e&&(e.isExpected||d(e.errorCode)||!!(t=e.message)&&(0,n.vF)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}function u(e,t,i,a=!0){let s,d,l="";const{name:u,email:p,pictureBlob:h,customError:_,shouldBypassEndPageLogout:f}=e;let m={accountId:i,name:u,email:p,pictureBlob:h,userLoggedIn:a};switch(t){case"LicenseError":s="licenseEndPage",d="show-license-error",l=o.O4.Forbidden;break;case"SignInRestriction":s="signInRestrictionEndPage",d="show-signin-restriction-error",l=o.O4.SignInRestrictions;break;case"MsaUserNotAllowed":s="msaUserNotAllowedEndPage",d="show-msa-user-not-allowed-error",l=n.tG.ShowTenantPicker,m={...m,preventLogout:f||!1};break;default:s="",d=""}return c({authSubErrorCode:t,errorCode:l,errorMetadata:m,name:s,message:_?.message||"",correlationId:_?.correlationId||(0,r.DA)(),context:_?.context||"endPageDataToAuthError",subContext:_?.subContext||d})}},701750:(e,t,i)=>{i.d(t,{j:()=>n});const n="44263ed4-f1ac-4e96-93aa-d24dd50459ea"},639908:(e,t,i)=>{i.d(t,{cP:()=>r,Xb:()=>a,CM:()=>s});const n=200;function o(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=t,new Promise(((e,t)=>{i.onload=()=>{i.status===n&&i.response?e(i.response):t(i.status!==n?{status:i.status,statusText:i.statusText}:{status:404,statusText:"no response data"})},i.onerror=()=>{t({status:i.status,statusText:i.statusText})},i.send()}))}async function r(e){return await o(e,"blob")}async function a(e){const t=await o(e,"arraybuffer");return new Uint8Array(t)}async function s(e){return e.then((e=>URL.createObjectURL(e)))}},440945:(e,t,i)=>{i.d(t,{lD:()=>v,_C:()=>D,VI:()=>A,ao:()=>T,s4:()=>M,hT:()=>P,fQ:()=>C,_v:()=>R,YT:()=>b,jI:()=>O});var n=i(572909),o=i(754255),r=i(937545),a=i(131647),s=i(903502),c=i(363678),d=i(601440),l=i(665360),u=i(702183),p=i(832669);const h=["bd9fb5cb-4d02-4cc6-a7f4-52a8a62d30b7","9d17e873-c4c4-424d-869c-67f62a3d3174","77be3f72-7c14-415f-992c-3511dd54a4ae","66aeee93-507d-479a-a3ef-8f494af43945","62554c36-4756-4d4e-b8fb-f4b24875ae0c","2c95977d-f2fb-4df3-ad70-1aece87afe03","98eb9edc-3b11-4950-8780-c6ec73d71571","98eb9edc-3b11-4950-8780-c6ec73d71572","be9c77ca-202c-4f11-9241-b27afd891781","5a22b425-b693-4f86-b668-31baeb3dad6c","b85718a3-6d15-4f59-8fad-b6809c6fc6a9","2c95977d-f2fb-4df3-ad70-1aece87afe00","2c95977d-f2fb-4df3-ad70-1aece87afe01","2c95977d-f2fb-4df3-ad70-1aece87afe02"],_={qna:"5db56dd0-534d-467b-aeda-d622bee2574a"};var f=i(5059),m=i(743288),g=i(701750),E=i(464202),y=i(884451),I=i(872661);const S="_djb2_msteams_prefix_",b="tab::",v=2,T=(e,t)=>t?.startsWith(S)?t:`${S}${(0,d.M)(`${e}:${t?.replace(/\+/g," ")}`)}`,C=(e,t,i,o)=>{let r=e?n.ck.channels:n.ck.chats;return t===l.LS.unified?r=n.ck.simplecollab:t===l.LS.split&&(r=e?i&&o&&(0,I.X)({coreSettings:i,userPreferences:o})?n.ck.channels:n.ck.simplecollabchannels:n.ck.simplecollabchats),r},D=async(e,t,i,s,d,l,u,p,h,_,f,m)=>{const g=m?.get(o.w.Extensibility);if(g?.enableDeeplinkSupportForEngageCommunity&&p?.contextType===y.u0)return k(e,t,i,s,d,u,p,h,_);const I=g?.disablePlatformDeeplinkResolverQuery?null:await(f?.query({query:E.C,variables:{appId:e}}));return{entity:{type:n.ck.extensions,id:JSON.stringify({appId:e,tabEntityId:l,threadId:I?.data?.installedPersonalApp?.conversationForBot?.id??void 0,subEntityId:p?.subEntityId}),action:n.SY.view},command:{visibilityState:u?.visibilityState??r.Rp.show,stateTransition:t?r.Ar.new:u?.stateTransition??r.Ar.flush,correlation:{source:d??a.p.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:s?c.hB.activityFeed:c.hB.personalApp,isMultiWindow:t,subEntityId:p?.subEntityId,source:d,originalDeeplink:h||void 0,reloadTrigger:i,isFromActivityFeed:s,skipAppCacheRemoveOnReload:_}}},k=(e,t,i,o,s,d,l,u,p)=>({entity:{type:n.ck.extensions,id:JSON.stringify({appId:e,threadId:l?.internalId}),action:n.SY.view,linkedEntity:{id:JSON.stringify({appId:e}),type:n.ck.simplecollab,action:n.SY.view}},command:{visibilityState:d?.visibilityState??r.Rp.show,stateTransition:t?r.Ar.new:d?.stateTransition??r.Ar.flush,correlation:{source:s??a.p.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:o?c.hB.activityFeed:c.hB.personalApp,isMultiWindow:t,subEntityId:l?.subEntityId,source:s,originalDeeplink:u||void 0,reloadTrigger:i,isFromActivityFeed:o,skipAppCacheRemoveOnReload:p,contextType:l?.contextType}}),A=(e,t,i,o,d,l,u,p,_,f,m,g,E,y)=>{if(N(e)){const t=w(e,i,o,l,_,d,m,p);if(t)return t}return{entity:{type:n.ck.extensions,id:JSON.stringify({appId:e,threadId:t||i,tabId:null,tabEntityId:T(e,u)}),action:n.SY.view,linkedEntity:{id:t?JSON.stringify({channelId:t}):i,type:C(t,g,E,y),action:n.SY.view}},command:{visibilityState:p?.visibilityState??r.Rp.show,stateTransition:p?.stateTransition??r.Ar.forceFlush,correlation:{source:a.p.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{entryPoint:t?c.hB.channelTab:c.hB.chatTab,source:a.p.PlatformTabDeepLink,subEntityId:_,reloadTabTrigger:f,originalDeeplink:d,isAppTeamLevelApp:h.includes(e),...!!i&&{focusOnLoad:s.I.DoNotMove}}}},R={files:"files",photos:"photos",attendancereport:"attendancereport",recordingsandtranscripts:"recordingsandtranscripts",recap:"recap",breakoutrooms:"breakoutrooms",coachReport:"coachReport",qna:"qna"},N=e=>Object.values(_).includes(e),w=(e,t,i,o,d,l,u,p)=>((0,f.pP)(i,"Non apps platform tab deeplink handling"),o?.cancel(),e===_.qna?{entity:{type:n.ck.yammerqna,id:JSON.stringify({chatId:t,subEntityId:d}),action:n.SY.view,linkedEntity:{action:null,id:t,type:n.ck.chats}},command:{visibilityState:p?.visibilityState??r.Rp.show,stateTransition:p?.stateTransition??r.Ar.flow,correlation:{source:a.p.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{conversationId:t,entryPoint:c.hB.activityFeed,source:a.p.ActivityFeed,subEntityId:d,meetingTenantId:u,originalDeeplink:l,...!!t&&{focusOnLoad:s.I.DoNotMove}}}:null),O=async(e,t,i,o,d,l,p,h,_,f,m,g)=>{p?.findScenario(u.Cu.PlatformTabDeeplinkHandling)?.cancel();const E=p?.newScenario(u.Cu.PlatformTabDeeplinkHandling);E&&p?.hoistScenarioToCore?.(E),E?.appendEventData({"PlatformTabDeeplink.pathname":i.pathname,"PlatformTabDeeplink.search":i.search}),E?.mark("create_deeplink_command");const y="files"===l,I=(e=>{switch(e){case R.files:return n.ck.file;case R.photos:return n.ck.gallery;case R.attendancereport:return n.ck.meetinganalytics;case R.recordingsandtranscripts:return n.ck.transcriptcontent;case R.recap:return n.ck.meetingrecap;case R.breakoutrooms:return n.ck.breakoutrooms;case R.coachReport:return n.ck.coachreport;case R.qna:return n.ck.yammerqna;default:return n.ck.extensions}})(l),{entityType:S,appId:b}=await x(I,e,l,_),v={entityCommand:{entity:{type:S,action:y?n.SY.list:n.SY.view,id:I===n.ck.extensions?JSON.stringify({appId:b,threadId:e||t,tabId:l,tabEntityId:S===n.ck.channelcalendar?"":null}):null,linkedEntity:{id:e?JSON.stringify({channelId:e}):t,type:C(e,f,m,g),action:n.SY.view}},command:{stateTransition:h?.stateTransition??r.Ar.flush,visibilityState:h?.visibilityState??r.Rp.show},entityOptions:{subEntityId:d?.subEntityId,entryPoint:e?c.hB.channelTab:c.hB.chatTab,source:a.p.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:i,...I===n.ck.coachreport&&{threadId:t},...!!t&&{focusOnLoad:s.I.DoNotMove}}},metadata:{allowAnonymous:!1,tenantId:o}};return E?.mark("return_deeplink_command"),E?.appendEventData({"PlatformTabDeeplink.generatedCommand":v.toString()}),Promise.resolve(v)},P=(e,t,i)=>{const n=t?.baseInfo?.appId??"",o=t?.baseInfo?.id??"";let r="";return"StaticExtensionTab"!==t?.__typename&&"ExtensionTab"!==t?.__typename||!t?.entityId||(r=t?.entityId),{appId:n,threadId:e,tabId:o,tabEntityId:r,messageId:(0,p.JU)(i)?i:void 0}},M=(e,t,i,n,o)=>{const r=t?.baseInfo?.appId??"",a=t?.baseInfo?.id??"";let s="";return"StaticExtensionTab"!==t?.__typename&&"ExtensionTab"!==t?.__typename||!t?.entityId||(s=t?.entityId),n&&o?JSON.stringify(((e,t,i,n,o)=>{const r=("ExtensionTab"===e?.__typename||"StaticExtensionTab"===e?.__typename)&&e?.entityId||null,a=r?`_djb2_msteams_prefix_${(0,d.M)(`${n?e?.baseInfo?.externalAppId:e?.baseInfo?.appId}:${r?.replace(/\+/g," ")}`)}`:null;return i?{appId:r?n?e?.baseInfo?.externalAppId:e?.baseInfo?.appId:null,threadId:t,tabId:r?null:e?.baseInfo?.id,tabEntityId:a,messageId:(0,p.JU)(o)?o:void 0}:{appId:e.baseInfo.appId,threadId:t,tabId:e.baseInfo.id,tabEntityId:r,messageId:(0,p.JU)(o)?o:void 0}})(t,e,n,void 0,i)):JSON.stringify({appId:r,threadId:e,tabId:a,tabEntityId:s,messageId:(0,p.JU)(i)?i:void 0})},x=async(e,t,i,o)=>{let r=e,a=null;if(e===n.ck.extensions&&i&&o)try{const e=await o.query({query:m.F,variables:{threadId:t,tabId:i},fetchPolicy:"network-only"});"CalendarTab"===e?.data?.platformTab?.__typename&&e?.data?.platformTab?.baseInfo?.appId===g.j&&(r=n.ck.channelcalendar,a=g.j)}catch(e){}return{entityType:r,appId:a}}},464202:(e,t,i)=>{i.d(t,{C:()=>r});var n=i(67309),o=i(706397);const r={kind:"Document",get definitions(){const e=(0,n.G)("query ComponentsPlatformTabUtilsPersonalAppInstalledAppWithConversationQuery($appId:ID!) {installedPersonalApp(appId:$appId) {id,installationState,installedScope,definition {...appDefinition},conversationForBot {id},installedAppProps {isNewAdminPreInstalled}}}");return delete this.definitions,this.definitions=[...e.definitions,...o.h.definitions]}}},872661:(e,t,i)=>{i.d(t,{X:()=>o});var n=i(754255);const o=({coreSettings:e,userPreferences:t})=>{if(!e?.get(n.w.TeamsAndChannels)?.enableTeamLayoutSetting&&!e?.get(n.w.TeamsAndChannels)?.enableTeamLayoutSettingOverride)return!1;if(e?.get(n.w.Edu)?.enableDogfoodingInEduGridLayout)return!0;switch(t?.teamLayout?.currentLayout){case"grid":return!0;case"list":return!1;default:return e?.get(n.w.TeamsAndChannels)?.defaultTeamLayoutSettingIsGrid}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/453435-315c3e78c28ed3ae.js.map