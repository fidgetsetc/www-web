"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[917134],{858108:(e,n,t)=>{var i,o;t.d(n,{d:()=>i,J:()=>o}),function(e){e.HighMemoryUsage="HighMemoryUsage",e.CallingStackInitTimeoutOrFailure="CallingStackInitTimeoutOrFailure",e.GroupCallTimeoutOrFailure="GroupCallTimeoutOrFailure"}(i||(i={})),function(e){e.MeetingsAudio="1",e.MeetingsVideoOrScreenSharing="2",e.CallingCallDrops="3",e.MessagingOther="5",e.ActivityFeed="6",e.Crashing="7",e.Files="8",e.SearchSERPSearchResultsPage="9",e.SearchPowerbarAutosuggest="10",e.Other="11",e.MeetingsLiveCaptionsOrTranscript="14",e.TeamsChannelsMembership="15",e.Accessibility="17",e.Calendar="18",e.MeetingsOther="19",e.PlatformApps="20",e.PlatformBotsConnectors="21",e.PlatformTabs="22",e.TeamsChannelsCreateManageSettings="23",e.MessagingSync="25",e.PeopleProfiles="26",e.StatusPresence="27",e.TeamsChannelsPrivateAndSharedChannels="28",e.LocalizationTranslation="29",e.MeetingsAgendaNotes="30",e.MessagingCreateNewOrEdit="31",e.MessagingConversationWithExternalOrSkypeUsers="32",e.Tasks="34",e.Lists="35",e.Approvals="36",e.CallingOther="38",e.Performance="39",e.MessagingChatWindow="40",e.MessagingMissingOrDelayed="41",e.VivaLearning="42",e.MeetingsPowerPointLive="43",e.MeetingsChat="44",e.MeetingsRecording="45",e.MeetingsBreakoutRooms="46",e.MeetingsJoinExperience="47",e.MeetingsGalleryViews="48",e.CallingAudio="49",e.CallingVideoOrScreenSharing="50",e.VirtualAppointments="51",e.MeetingsSpeakerCoach="52",e.NotificationToasts="53",e.WebinarsVirtualEvents="54",e.MessagingVideo="55",e.MeetingsExcelLive="56",e.MeetingsWordLive="57",e.Avatars="58",e.ImmersiveSpace="59",e.MessagingLoopComponents="60",e.Discover="61",e.MeetingsMeetApp="62",e.Communities="63",e.Dashboard="64",e.Photos="65",e.Groups="66",e.InvitingJoiningTeams="67",e.Gaming="68",e.MessagingMessageCompose="70",e.MessagingMessagePaneScrolling="71",e.MessagingReactionsEmojisGIFsStickers="72",e.TeamsChannelsApp="73",e.UpdatesApp="74",e.MeetingsAttendanceReport="75",e.Devices="76",e.VideoFilters="77",e.AuthenticationOrSignIn="78",e.PerformanceMemory="79",e.DesktopAppLaunch="80",e.DesktopAppUpdate="81",e.TaskbarOrSystrayExperiences="82",e.Settings="83",e.AppSwitcherPreview="84",e.MeetingsRecap="86",e.FlyoutAndMinimode="87",e.MultiTenantMultiAccount="88",e.CallingCallNotifications="89",e.TagsChatMentions="90",e.TagsManagement="91",e.MeetingsCopilot="92",e.MessagingSMSIntegration="93",e.PlatformWorkflowsAndConnectors="94",e.MessagingThreading="121",e.QueuesApp="122"}(o||(o={}))},403097:(e,n,t)=>{var i,o,r,s,a,l,c,u,d,p,g,h,m,f,C,b,w,S,v,M,I;t.d(n,{qv:()=>i,Kt:()=>r,VA:()=>a,lM:()=>l,Pr:()=>c,Kv:()=>u,To:()=>d,PY:()=>p,bh:()=>g,D2:()=>h,np:()=>f,zD:()=>C,pU:()=>b,s4:()=>w,d8:()=>S,Cu:()=>v,wy:()=>M}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(i||(i={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(o||(o={})),function(e){e.GuardianChat="GuardianChat"}(r||(r={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(s||(s={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(a||(a={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(l||(l={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(c||(c={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(u||(u={})),function(e){e.background="background",e.foreground="foreground"}(d||(d={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(p||(p={})),function(e){e.copy="Copy"}(g||(g={})),function(e){e.nav="nav",e.notification="notification"}(h||(h={})),function(e){e.Cold="cold",e.Warm="warm"}(m||(m={})),function(e){e.TopLevel="L1",e.DrillDown="L2"}(f||(f={})),function(e){e.SettingsPrivacyPage="SettingsPrivacyPage",e.LpcMeProfileCard="LpcMeProfileCard"}(C||(C={})),function(e){e.tflExternal="TFLExternal",e.tfwUser="TFWUser",e.pstnUser="PSTN"}(b||(b={})),function(e){e.addMembers="addMembers",e.pinChannel="pinChannel",e.unpinChannel="unpinChannel",e.favoriteChannel="favoriteChannel",e.manageChannel="manageChannel",e.getChannelEmail="getChannelEmail",e.getChannelLink="getChannelLink",e.editChannel="editChannel",e.editChannelConnectors="editChannelConnectors",e.editChannelWorkflows="editChannelWorkflows",e.editChannelRetentionLabel="editChannelRetentionLabel",e.deleteChannel="deleteChannel",e.leaveChannel="leaveChannel",e.toggleChannelOrder="toggleChannelOrder",e.archiveChannel="archiveChannel",e.unarchiveChannel="unarchiveChannel",e.findInChannel="findInChannel",e.channelNotificationSettings="channelNotificationSettings",e.lastChannelHide="lastChannelHide",e.manageTeam="manageTeam",e.setChannelRecommendation="setChannelRecommendation"}(w||(w={})),function(e){e.pinned="pinned",e.shown="shown",e.hidden="hidden"}(S||(S={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared",e.Standalone="Standalone"}(v||(v={})),function(e){e.General="General",e.NotGeneral="NotGeneral"}(M||(M={})),function(e){e.Unknown="Unknown",e.VSB="VSB",e.MM="MM",e.Lrg="Lrg"}(I||(I={}))},784109:(e,n,t)=>{t.d(n,{W:()=>r});var i=t(67309),o=t(96594);const r={kind:"Document",get definitions(){const e=(0,i.G)("query callParticipants($id:ID!) {callParticipants(id:$id) {...participantFields}}");return delete this.definitions,this.definitions=[...e.definitions,...o.bs.definitions]}}},607954:(e,n,t)=>{t.d(n,{ou:()=>g,C4:()=>h,Tc:()=>m,Ib:()=>f,C5:()=>C,ru:()=>b,yw:()=>w,$G:()=>E,VF:()=>O,lN:()=>U,EU:()=>R,jy:()=>V,is:()=>x,Ss:()=>L,pH:()=>B,dq:()=>W,zx:()=>$,X8:()=>G,A8:()=>M,gb:()=>I,dG:()=>j,N6:()=>X,BD:()=>H,Nl:()=>J,l5:()=>q,mf:()=>K,$h:()=>Q,xv:()=>Y,KK:()=>Z});var i=t(845097),o=t(754255),r=t(289242),s=t(131647),a=t(572909),l=t(634664),c=t(702183),u=t(480354),d=t(195695);const p="remote-brb-participants-banner",g="79",h="2",m="118",f="119",C="11";var b,w,S,v,M,I;function y(e){const{clientId:n}=e.get(o.w.Brb);return n}function k(e){const{licenseType:n}=e.get(o.w.UserResources);return n}function A(e,n){const{platformAdoTagPrefix:t,platformAdoTagSuffix:i}=e.get(o.w.Brb);let s=`${t||"teams"}_${i||n.config.browser}`;return t&&i&&n?.config?.platformId===r.PU.Web&&(s=n?.config?.browser?`${s}_${n?.config?.browser}`:s),s}function T(e,n,t,i,r){const{adoTagsForAllItems:s,categories:a,enableBrbTags:l,enableRemoteParticipantIdsCollectionForModality:c}=e.get(o.w.Brb),u=a?.find((e=>e?.id===n));return[s,u?.additionalAdoTags||"",t.get(w.Ring)||"unknownRing",A(e,i),t.get(w.MTMA)?"MTMA":"",l&&r?r:"",c&&c?.length?"RemoteParticipantIdsCollectionEnabled":""].filter((e=>e)).join(";")}function D(e,n,t){const i=n.get(w.Ring)||"",o=n.get(w.UserEmail)||"",r=i.replace("ring","R").replace("_",".")||"",s=function(e,n){return A(e,n).split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join("")}(e,t);return`[${r}] ${s}: ${function(e){const n=e&&e.split("@")[1];return n&&n.substr(0,n.lastIndexOf("."))}(o)||""}: `}function _(e,n,t,i){const r=`${function(e,n,t){const i=n.get(w.Build)||"",{enableDetailedBrbTitlePrefix:r}=e.get(o.w.Brb);return i.startsWith("local")?"[LOCAL] ":i.indexOf("oncdn")>=0?"[CONTAINER] ":r?D(e,n,t):""}(n,t,i)||""}${e||""}`,{brbItemTitleMaxLength:s}=n.get(o.w.Brb);return F(r,s||1500)}function P(e,n){const{brbItemDescriptionMaxLength:t}=n.get(o.w.Brb);return F(e||"",t||5e3)}function F(e,n){return(e=e||"No text provided").length>n?`${e.substring(0,n-3)}...`:e}function N(e){let n="";const t=e.get(w.MTMA);t&&"MTMA"===t&&(n="<h3>(This is MTMA scenario, please check logs from user's other accounts under Links tab)</h3><br>");let i="";return e?.forEach(((e,n)=>{i=`${i}<b>${n}:</b> ${e}<br>`})),`<h3><strong>All the logs & screenshots (if attached) are available in the devlogs link which is present in the Links tab.</strong></h3><br>${n}${i}`.trim()}async function E(e,n,t){try{const t=await n.loadModule("toasts");if(t){const n=await(t?.getFocusAssistStateAsync?.());e.set(S.FocusAssistant,n||"");const i=await(t?.getGlobalNotificationSettingsAsync?.());e.set(S.GlobalNotificationSettings,i?.global||"")}}catch(e){t.log("Failed to obtain system notification settings: ",e)}}function O(e,n,t,i,s){e.set(w.UserEmail,n?.profile?.email||n?.profile?.upn||n?.profile?.preferred_username||""),e.set(w.UserType,n?.type?.toString()||""),e.set(w.TenantID,n?.profile?.tid||""),e.set(w.Ring,t.get(o.w.Metadata)?.ring?.id||""),e.set(w.UserID,n?.profile?.oid?.toString()||"");const a=t.get(o.w.Brb)?.sendBrbMSAlias?i.config.clientType===r.sK.Maglev?n?.userName:n?.profile?.upn||n?.profile?.email:"";e.set(w.MSAlias,a||"");const{sessionId:l}=t.get(o.w.Platform);e.set(w.SessionId,l||""),e.set(w.Language,s?.locale||"")}async function U(e,n,t){try{const t=await n.loadModule("osutils");if(t){const n=await(t?.getDeviceInfo?.());e.set(w.OsVersion,n?.osVersion||""),e.set(w.UbrVersion,n?.ubrVersion||""),e.set(w.DeviceID,n?.deviceId||"unkown deviceID"),e.set(w.SystemManufacturer,n?.make||""),e.set(w.DeviceModel,n?.model||""),e.set(w.AppCenterInstallerId,n?.appCenterInstallerId||"")}}catch(e){t.log("Error while obtaining BRB device informations: ",e)}}async function R(e,n,t){try{e.set(w.slimCoreVersion,n?.SlimCore?.getVersion().toString()||"unkown slimcore version")}catch(e){t.log("Impossible fetch slimcore version: ",e)}}async function V(e,n,t,i){try{const{browser:i,browserVersion:r,clientVersion:s}=t.get(o.w.Platform);e.set(w.Browser,i||""),e.set(w.BrowserVersion,r||""),e.set(w.WebClientBuild,s||"");const{systemInfoClient:a}=t.get(o.w.Brb);e.set(w.Client,a||"");const{desktopVersion:l}=t.get(o.w.Host);e.set(w.DesktopClientVersion,l||"unknown"),e.set(w.Platform,n?.config?.platformId?.toString()||""),e.set(w.Os,n?.config?.osPlatform||"")}catch(e){i.log("Failed to obtain app information: ",e)}}async function x(e,n,t){try{const{enableCustomNotificationsForCalls:t,enableCustomNotificationsForChats:i,enableCustomNotificationsOnDesktop:r}=n.get(o.w.Core);e.set(S.CustomNotificationOnDesktop,r?"Enabled":"Disabled"),e.set(S.CustomNotificationForCalls,t?"Enabled":"Disabled"),e.set(S.CustomNotificationForChats,i?"Enabled":"Disabled")}catch(e){t.log("Failed to obtain app information: ",e)}}function L(e,n,t){try{const{callingEnableUnifiedJoinFlowForPlaceCalls:t}=n.get(o.w.Calling);e.set(v.callingEnableUnifiedJoinFlowForPlaceCalls,t?"Enabled":"Disabled")}catch(e){t.log("Failed to obtain FF callingEnableUnifiedJoinFlowForPlaceCalls status: ",e)}}async function B(e,n){const t=await(n?.getCachedUsers?.({id:(0,i.v4)(),scenarioName:c.Cu.AuthWebCachedUser,source:"brb-utils::addMTMAInfo"})),o=t?.length&&t.length>1;e.set(w.MTMA,o?"MTMA":"")}function W(e,n,t,r,s){const a={ReportTitle:_(e.text,n,r,s),ReportDescription:P(e.description??e.text,n),CategoryName:e.categoryId,UploadID:e?.diagnosticsUploadId??(0,i.v4)(),InitiatorIDs:[],ClientID:y(n),ClientVersion:z(r),CorelibVersion:"",Ring:r.get(w.Ring),SkypeAuthToken:t,TenantName:"",TenantID:r.get(w.TenantID),UserID:r.get(w.UserID),Email:r.get(w.UserEmail),MSAlias:r.get(w.MSAlias)||"",SkipEmailNotification:!1,SkipVsoTicketCreation:!1,SystemInfo:N(r),VsoTags:T(n,e.categoryId,r,s,e.routingTags),LicenseType:k(n),IsAutoBrb:"true"===r.get(w.IsAutoBrb),ClientFeedbackId:e?.clientFeedbackId??void 0,OngoingCallId:r.get(w.OngoingCallId),LastCallId:r.get(w.LastCallId),LastCallParticipantId:r.get(w.LastCallParticipantId),OngoingCallParticipantId:r.get(w.OngoingCallParticipantId),Microphones:r.get(w.Microphones),Speakers:r.get(w.Speakers),Cameras:r.get(w.Cameras)},{enabledRequestProperties:c}=n.get(o.w.Brb);if(c){const e=(0,u.pick)(a,c);return(0,l.hR)(e)}return(0,l.hR)(a)}function $(e,n,t){const{extendBrbReportsUrl:i,clientId:r}=n.get(o.w.Brb);return{baseUrl:i?.substring(0,i.lastIndexOf("/"))??"",title:e.text,clientId:r??"",clientVersion:z(t),ring:t.get(w.Ring)}}function G(e,n,t,r,s,a){const c={ReportTitle:_(e.text,r,s,a),ReportDescription:P(e.text,r),CategoryName:e.categoryId,SkypeAuthToken:n,UploadID:(0,i.v4)(),InitiatorIDs:[t],ClientID:y(r),ClientVersion:z(s),Email:s.get(w.UserEmail),TenantID:s.get(w.TenantID),UserID:s.get(w.UserID),Ring:s.get(w.Ring),IsRemoteBrb:e.isRemoteBrb,ClientFeedbackId:e?.clientFeedbackId??void 0},{enabledRequestProperties:d}=r.get(o.w.Brb);if(d){const e=(0,u.pick)(c,d);return(0,l.hR)(e)}return(0,l.hR)(c)}function z(e){return e.get(w.WebClientBuild)||"1.1.11.1111_11/1.1.1.1111111111"}function j(e,n,t,i,o){let r=i;r=r?r===I.ApiFailure?I.ApiFailure:r.includes(I.TimedOut)?I.TimedOut:I.Unknown:void 0;let s=e.get(n);return s?(s.uploadStatus=t,s.byteSize=o??s.byteSize,s.error=r??s.error):(s={uploadStatus:t,byteSize:o,error:r},e.set(n,s)),r}function X(e){let n=!0;const t=[];for(const[i,o]of e.entries()){const e=o.byteSize?`(${o.byteSize} bytes)`:"",r=`Status: ${o.uploadStatus}`;n=o.uploadStatus===M.Success&&n;const s=`FileName: ${i} ${e}, ${r}${o.error?`, error: ${o.error}`:""}`;t.push(s)}return{content:t.join("\r\n"),allLogFilesUploaded:n,summaryFileUploaded:!1}}function H(e){const n=e.split("/"),t=n.length>1?n[n.length-1]:e;return e.includes("WebLogs/Core")?`WebLogs/Core/${t}`:e.includes("WebLogs/User")?`WebLogs/User/${t}`:t}function J(e,n){e.shell.showBanner({id:p,source:s.p.RemoteBrbParticipantsBanner,bannerScenario:"remote_brb_banner",intentLevel:"Neutral",cause:"RemoteBrbBanner",text:n.stringTranslate("framework","remote_brb_participants_banner"),action:{text:n.stringTranslate("framework","remote_brb_participants_banner_privacy_statement"),command:{entity:{type:a.ck.remotebrbbanner,action:a.SY.view}},dismissOnAction:!0},dismissable:!0,duration:0})}function q(e){e.shell.dismissBanner(p,s.p.RemoteBrbParticipantsBanner)}!function(e){e.Skype="skype",e.AAD="aad"}(b||(b={})),function(e){e.UserEmail="UserEmail",e.TenantID="TenantID",e.Ring="Ring",e.UserID="UserID",e.WebClientBuild="WebClient build",e.Build="Build",e.MTMA="MTMA",e.MSAlias="MSAlias",e.DeviceID="Device ID",e.Language="Language",e.SystemManufacturer="System Manufacturer",e.DeviceModel="Device Model",e.DesktopVersion="Desktop Version",e.slimCoreVersion="Slimcore Version",e.UbrVersion="Update Build Revision",e.Platform="Platform",e.Os="OS",e.OsVersion="OS Version",e.Browser="Browser",e.BrowserVersion="Browser Version",e.Client="Client",e.UserType="User Type",e.SessionId="Session Id",e.DesktopClientVersion="Desktop Client Version",e.AppCenterInstallerId="AppCenter Installer ID",e.IsAutoBrb="IsAutoBrb",e.OngoingCallId="OngoingCallId",e.LastCallId="LastCallId",e.LastCallParticipantId="LastCallParticipantId",e.OngoingCallParticipantId="OngoingCallParticipantId",e.Microphones="Microphones",e.Speakers="Speakers",e.Cameras="Cameras"}(w||(w={})),function(e){e.FocusAssistant="Focus Assistant",e.GlobalNotificationSettings="Global Notification Settings",e.CustomNotificationOnDesktop="Custom Notification on Desktop",e.CustomNotificationForChats="Custom Notification for Chats",e.CustomNotificationForCalls="Custom Notification for Calls"}(S||(S={})),function(e){e.callingEnableUnifiedJoinFlowForPlaceCalls="Enable Unified Join Flow For Place Calls"}(v||(v={})),function(e){e.Requested="Requested",e.Success="Success",e.Failure="Failure"}(M||(M={})),function(e){e.TimedOut="TimedOut",e.Unknown="Unknown",e.ApiFailure="ApiFailure",e.NetworkError="NetworkError"}(I||(I={}));const K=e=>{let n=[];const{enableFeedbackSubMenuInMoreOptionsMenu:t,enableBrbHeapSnapshotCheckbox:i,enableVideoVbssBrbSplitCategories:o,enableDetectSensitiveContentCategory:r,isUserUsingM365Calendar:s}=e;return i||n.push(g),r||n.push("120"),s?n.push("18"):n.push("132"),n=t&&o?n.concat([h,"50"]):n.concat([m,f]),n},Q=e=>e.split("_")[0],Y={source:"brb"},Z=async(e,n,t)=>{let i="";try{const{enableSTMigration:r}=e.get(o.w.Brb)??b.Skype,s=r?b.AAD:b.Skype,a=s===b.Skype?void 0:Y;return s===b.Skype&&(i=await n.validateSkypeToken({correlation:(0,d.$q)(t)})),{tokenType:s,authOptions:a,skypeToken:i}}catch(e){return{tokenType:b.Skype,skypeToken:i}}}},9012:(e,n,t)=>{t.d(n,{IN:()=>i,sP:()=>o,VQ:()=>r});const i=Symbol("ForEachAsyncIteratorContinue"),o=Symbol("ForEachAsyncIteratorBreak");function r(e,n){let t,r=!1,a=e=>Promise.reject(e);"function"==typeof e.return&&(t=e.return,a=n=>{const i=()=>Promise.reject(n);return t.call(e).then(i,i)});const l=function(e,n){return function(t){return t.done?Promise.resolve(t):function(e,n){return new Promise((t=>t(n(e))))}(t.value,e).then(s,n)}}(n,a);return{async next(){if(r)return this.return();{let n=await e.next(),t=await l(n);for(;!t.done&&t.value===i;)n=await e.next(),t=await l(n);return t.value===o||t.value===i?this.return():t}},return:()=>(r=!0,t?t.call(e).then(l):Promise.resolve({value:void 0,done:!0})),throw:n=>(r=!0,"function"==typeof e.throw?e.throw(n).then(l):Promise.reject(n).catch(a)),[Symbol.asyncIterator](){return this}}}function s(e){return{value:e,done:!1}}},430426:(e,n,t)=>{var i;t.d(n,{V:()=>a,C:()=>l}),function(e){e[e.Value=0]="Value",e[e.Error=1]="Error"}(i||(i={}));var o=t(702183),r=t(480354);class s{constructor(e=100,n,t,i,o){if(this.newScenario=n,this.logger=i,this.getDroppedEventMetadataFn=o,e<0)throw new TypeError(`BufferLimit has to be > 0. OperationName ${this._operationName}`);this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e,this._overflowScenario=null,this._droppedEvents=0,this._operationName=t,this._droppedEventMetadataToCount=new Map}next(e){this._push({type:i.Value,value:e})}error(e){this._push({type:i.Error,error:e})}complete(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;)this._promiseResolutionFunctions.shift().resolve({done:!0})}onUnsubscribe(){this.complete(),this._promiseResolutionFunctions=[],this._values=[]}nextPromise(){if(this._overflowScenario&&this._values.length<this._bufferLimit){let e=`AsyncIterableObserver buffer is no longer full for operation ${this._operationName}. Dropped ${this._droppedEvents} events.`;if(this.getDroppedEventMetadataFn){const n=(0,r.maxBy)(Array.from(this._droppedEventMetadataToCount.keys()),(e=>this._droppedEventMetadataToCount.get(e)));e=`${e} Max dropped event metadata: ${n}.`,this._overflowScenario.appendEventData({context:JSON.stringify(Array.from(this._droppedEventMetadataToCount.entries())),reason:n})}this.logger&&this.logger.warn(e),this._overflowScenario.stop({size:this._droppedEvents}),this._overflowScenario=null,this._droppedEvents=0,this._droppedEventMetadataToCount=new Map}if(this._values.length>0){const{type:e,value:n,error:t}=this._values.shift();return e===i.Error?Promise.reject(t):Promise.resolve({done:!1,value:n})}return this._isComplete?Promise.resolve({done:!0}):new Promise(((e,n)=>{this._promiseResolutionFunctions.push({resolve:e,reject:n})}))}_push(e){if(this._promiseResolutionFunctions.length>0){const{resolve:n,reject:t}=this._promiseResolutionFunctions.shift();e.type===i.Error?t(e.error):n({done:!1,value:e.value})}else{if(this._values.length>this._bufferLimit-1){if(this._droppedEvents+=1,this.getDroppedEventMetadataFn&&e.value){const n=this.getDroppedEventMetadataFn(e.value),t=this._droppedEventMetadataToCount.get(n);this._droppedEventMetadataToCount.set(n,t?t+1:1)}throw!this._overflowScenario&&this.newScenario&&(this._overflowScenario=this.newScenario(o.Cu.OnAsyncIterableObserverOverflow),this._overflowScenario.appendEventData({operationName:this._operationName})),new Error(`AsyncIterableObserver buffer is full, all future events will be dropped for OperationName: ${this._operationName}`)}this._values.push(e)}}}function a(e,n,t,i,o,r,s){return new c(e,i,s,o,n,t,r)}function l(e,n,t,i,o,r,s){return new c(e,n,t,i,o,r,s)}class c{constructor(e,n,t,i,o,r,a){this.error=null;try{this.observer=new s(o,r,n,i,a),this.subscription=e.subscribe(this.observer),this.running=!0,this.cancellationListenerSubscription=t?.subscribe((()=>{this.onCancelledSubscription()}))}catch(e){this.running=!1,this.error=e}}[Symbol.asyncIterator](){return this}async next(){if(this.running&&this.observer)try{const e=await this.observer.nextPromise();if(this.running&&!e.done)return e}catch(e){return this.throw(e)}return this.error?this.throw(this.error):this.return()}return(e){return this.onCancelledSubscription(),Promise.resolve({done:!0,value:void 0})}throw(e){return this.onCancelledSubscription(),Promise.reject(e)}onCancelledSubscription(){this.running=!1,this.subscription?.unsubscribe(),this.observer?.onUnsubscribe(),this.cancellationListenerSubscription?.unsubscribe()}}},304550:(e,n,t)=>{t.d(n,{Gm:()=>o,UR:()=>r,bu:()=>m});var i=t(700135);const o=(e,n,t)=>e?h(e,n,t):void 0;var r,s,a,l,c;!function(e){e.none="none",e.webrtc="webrtc",e.slimcore="slimcore"}(r||(r={})),function(e){e.none="none",e.windows365="Windows365"}(s||(s={})),function(e){e[e.Optimizing=0]="Optimizing",e[e.SwitchingStack=1]="SwitchingStack",e[e.VDIModeConfirmed=2]="VDIModeConfirmed",e[e.Disconnected=3]="Disconnected"}(a||(a={})),function(e){e.none="None",e.citrix="Citrix",e.vmware="VMware",e.avd="AVD",e.aws="AWS",e.citrixSlimCore="CitrixSlimCore",e.vmwareSlimCore="VMwareSlimCore",e.avdSlimCore="AVDSlimCore",e.awsSlimCore="AWSSlimcore"}(l||(l={})),function(e){e.none="none",e.windows365="Windows365",e.windows365SlimCore="Windows365SlimCore"}(c||(c={}));const u={[l.none]:"None",[l.citrix]:"Citrix HDX",[l.vmware]:"Omnissa Media",[l.avd]:"AVD Media",[l.aws]:"Amazon WorkSpaces Media",[l.citrixSlimCore]:"Citrix SlimCore Media",[l.vmwareSlimCore]:"Omnissa SlimCore Media",[l.avdSlimCore]:"AVD SlimCore Media",[l.awsSlimCore]:"Amazon WorkSpaces SlimCore Media"},d={[c.windows365]:"Windows 365 Media",[c.windows365SlimCore]:"Windows 365 SlimCore Media"},p={None:l.none,CitrixXenDesktop:l.citrixSlimCore,CitrixXenApp:l.citrixSlimCore,VMWare:l.vmwareSlimCore,WVD:l.avdSlimCore,AWS:l.awsSlimCore},g={None:l.none,CitrixXenDesktop:l.citrix,CitrixXenApp:l.citrix,VMWare:l.vmware,WVD:l.avd,AWS:l.aws},h=(e,n,t)=>{const i=t===s.windows365;return n?i?d[c.windows365SlimCore]??l.none:u[p[e]]??l.none:i?d[c.windows365]??l.none:u[g[e]]??l.none},m=(e,n,t,i,r,s,a)=>{const l=o(r,t,s);return f(n,t,i,a)?e.stringTranslate("framework","vdi_about_optimized_information_t",{providerName:l}):e.stringTranslate("framework","vdi_about_optimized_notconnected_information_t",{providerName:l})},f=(e,n,t,o)=>n?o===i.c.Connected:!!t&&e===i.c.Connected}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/917134-cd4f04c239a6cfd4.js.map