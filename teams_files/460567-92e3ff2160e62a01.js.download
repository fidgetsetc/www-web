(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[460567],{586550:(t,e,n)=>{"use strict";n.d(e,{w:()=>s});var r=n(700331);class s{constructor(t,e){this.value=t,this.piiKind=e}static isPIIValue(t){return!!t&&"string"!=typeof t&&void 0!==t.scrub}scrub(){return(0,r.sha256)(JSON.stringify(this.value))}}},141102:(t,e,n)=>{"use strict";n.d(e,{$:()=>s});var r=n(850434);function s(t){if(!t||"object"!=typeof t)return!1;if("RegionGtmNotFoundInRespone"===t.errorCode)return!0;const e=t;return e.code===r.O4.InvalidResponse&&"Discover"===e.context&&"regionGtm"===e.subContext}},759570:(t,e,n)=>{"use strict";var r,s;n.d(e,{I:()=>r}),function(t){t[t.BT_STOP=0]="BT_STOP",t[t.BT_STOP_BASE=1]="BT_STOP_BASE",t[t.BT_BOOL=2]="BT_BOOL",t[t.BT_UINT8=3]="BT_UINT8",t[t.BT_UINT16=4]="BT_UINT16",t[t.BT_UINT32=5]="BT_UINT32",t[t.BT_UINT64=6]="BT_UINT64",t[t.BT_FLOAT=7]="BT_FLOAT",t[t.BT_DOUBLE=8]="BT_DOUBLE",t[t.BT_STRING=9]="BT_STRING",t[t.BT_STRUCT=10]="BT_STRUCT",t[t.BT_LIST=11]="BT_LIST",t[t.BT_SET=12]="BT_SET",t[t.BT_MAP=13]="BT_MAP",t[t.BT_INT8=14]="BT_INT8",t[t.BT_INT16=15]="BT_INT16",t[t.BT_INT32=16]="BT_INT32",t[t.BT_INT64=17]="BT_INT64",t[t.BT_WSTRING=18]="BT_WSTRING",t[t.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(r||(r={})),function(t){t[t.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",t[t.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",t[t.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",t[t.JSON_PROTOCOL=21322]="JSON_PROTOCOL",t[t.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",t[t.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(s||(s={}))},966131:(t,e,n)=>{"use strict";n.d(e,{YE:()=>s,o4:()=>i,Hs:()=>a,NO:()=>o,nt:()=>c,__:()=>u,bD:()=>h,bc:()=>d,DG:()=>l});var r=n(573886);class s{static GetBytes(t){for(var e=[],n=0;n<t.length;++n){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}}class i{static GetString(t){var e,n,r,s,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=[],o=t.length%3;for(e=0,r=t.length-o;e<r;e+=3)n=(t[e]<<16)+(t[e+1]<<8)+t[e+2],a.push([i.charAt((s=n)>>18&63),i.charAt(s>>12&63),i.charAt(s>>6&63),i.charAt(63&s)].join(""));switch(o){case 1:n=t[t.length-1],a.push(i.charAt(n>>2)),a.push(i.charAt(n<<4&63)),a.push("==");break;case 2:n=(t[t.length-2]<<8)+t[t.length-1],a.push(i.charAt(n>>10)),a.push(i.charAt(n>>4&63)),a.push(i.charAt(n<<2&63)),a.push("=")}return a.join("")}}class a{static GetBytes(t){for(var e=[];4294967168&t;)e.push(127&t|128),t>>>=7;return e.push(127&t),e}}class o{static GetBytes(t){for(var e=t.low,n=t.high,r=[];n||4294967168&e;)r.push(127&e|128),e=(127&n)<<25|e>>>7,n>>>=7;return r.push(127&e),r}}class c{static GetBytes(t){if(r.Aw.IsDataViewSupport()){var e=new DataView(new ArrayBuffer(4));e.setFloat32(0,t,!0);for(var n=[],s=0;s<4;++s)n.push(e.getUint8(s));return n}return f.ConvertNumberToArray(t,!1)}}class u{static GetBytes(t){if(r.Aw.IsDataViewSupport()){var e=new DataView(new ArrayBuffer(8));e.setFloat64(0,t,!0);for(var n=[],s=0;s<8;++s)n.push(e.getUint8(s));return n}return f.ConvertNumberToArray(t,!0)}}class h{static EncodeZigzag16(t){return(t=r.wN.ToInt16(t))<<1^t>>15}static EncodeZigzag32(t){return(t=r.wN.ToInt32(t))<<1^t>>31}static EncodeZigzag64(t){var e=t.low,n=t.high,s=n<<1|e>>>31,i=e<<1;2147483648&n&&(s=~s,i=~i);var a=new r.DA("0");return a.low=i,a.high=s,a}}class d{static GetString(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];if(r<=191)e.push(String.fromCharCode(r));else if(r<=223){var s=t[++n];e.push(String.fromCharCode((31&r)<<6|63&s))}else if(r<=239){s=t[++n];var i=t[++n];e.push(String.fromCharCode((15&r)<<12|(63&s)<<6|63&i))}else{r=(7&r)<<18|(63&(s=t[++n]))<<12|(63&(i=t[++n]))<<6|63&t[++n],r-=65536,e.push(String.fromCharCode(55296|r>>10&1023)),e.push(String.fromCharCode(56320|1023&r))}}return e.join("")}}class l{static GetBytes(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<t.length;++r){var s=e.indexOf(t.charAt(r++)),i=e.indexOf(t.charAt(r++)),a=e.indexOf(t.charAt(r++)),o=e.indexOf(t.charAt(r));n.push(s<<2|i>>4),a>=0&&(n.push(i<<4&240|a>>2),o>=0&&n.push(a<<6&192|o))}return n}}class f{static ConvertNumberToArray(t,e){if(!t)return e?this._doubleZero:this._floatZero;var n=e?52:23,r=(1<<(e?11:8)-1)-1,s=1-r,i=r,a=t<0?1:0;t=Math.abs(t);for(var o=Math.floor(t),c=t-o,u=2*(r+2)+n,h=new Array(u),d=0;d<u;)h[d++]=0;for(d=r+2;d&&o;)h[--d]=o%2,o=Math.floor(o/2);for(d=r+1;d<u-1&&c>0;)(c*=2)>=1?(h[++d]=1,--c):h[++d]=0;for(var l=0;l<u&&!h[l];++l);var f=r+1-l,g=l+n;if(h[g+1]){for(d=g;d>l&&!(h[d]=1-h[d]);--d);d==l&&++f}if(f>i||o)return a?e?this._doubleNegInifinity:this._floatNegInifinity:e?this._doubleInifinity:this._floatInifinity;if(f<s)return e?this._doubleZero:this._floatZero;if(e){var m=0;for(d=0;d<20;++d)m=m<<1|h[++l];for(var p=0;d<52;++d)p=p<<1|h[++l];return[255&p,p>>8&255,p>>16&255,p>>>24,255&(m=a<<31|2147483647&(m|=f+r<<20)),m>>8&255,m>>16&255,m>>>24]}var S=0;for(d=0;d<23;++d)S=S<<1|h[++l];return[255&(S=a<<31|2147483647&(S|=f+r<<23)),S>>8&255,S>>16&255,S>>>24]}static ConvertArrayToNumber(t,e){var n=(1<<(e?11:8)-1)-1,s=0!=(128&t[e?7:3]),i=e?(127&t[7])<<4|(240&t[6])>>4:(127&t[3])<<1|(128&t[2])>>7;if(255==i)throw new r.WJ("Not a valid float/double buffer.");var a=1,o=1;if(e){var c=(15&t[6])<<28|(255&t[5])<<20|(255&t[4])<<12,u=t[3]<<24|(255&t[2])<<16|(255&t[1])<<8|255&t[0];if(!i&&!c&&!u)return 0;for(var h=0;h<20;++h)o/=2,c<0&&(a+=o),c<<=1;for(h=0;h<32;++h)o/=2,u<0&&(a+=o),u<<=1}else{var d=(127&t[2])<<25|(255&t[1])<<17|(255&t[0])<<9;if(!i&&!d)return 0;for(h=0;h<23;++h)o/=2,d<0&&(a+=o),d<<=1}return a*=Math.pow(2,i-n),s?0-a:a}}f._floatZero=[0,0,0,0],f._doubleZero=[0,0,0,0,0,0,0,0],f._floatInifinity=[0,0,128,127],f._floatNegInifinity=[0,0,128,255],f._doubleInifinity=[0,0,0,0,0,0,240,127],f._doubleNegInifinity=[0,0,0,0,0,0,240,255]},573886:(t,e,n)=>{"use strict";n.d(e,{CG:()=>i,DA:()=>a,wN:()=>o,WJ:()=>c,Aw:()=>u,E1:()=>h});var r=n(759570),s=n(966131);class i{constructor(t){this.low=0,this.high=0,this.low=parseInt(t),this.low<0&&(this.high=-1)}Equals(t){var e=new i(t);return this.low==e.low&&this.high==e.high}}class a{constructor(t){this.low=0,this.high=0,this.low=parseInt(t)}Equals(t){var e=new a(t);return this.low==e.low&&this.high==e.high}}class o{static ToByte(t){return this.ToUInt8(t)}static ToInt8(t){return 127&t|(128&t)<<24>>24}static ToInt16(t){return 32767&t|(32768&t)<<16>>16}static ToInt32(t){return 2147483647&t|2147483648&t}static ToUInt8(t){return 255&t}static ToUInt16(t){return 65535&t}static ToUInt32(t){return 4294967295&t}}class c{constructor(t){this.Message=t}}class u{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class h{constructor(t){this._stream=t}WriteBlob(t){this._stream.Write(t,0,t.length)}WriteBool(t){this._stream.WriteByte(t?1:0)}WriteContainerBegin(t,e){this.WriteUInt8(e),this.WriteUInt32(t)}WriteMapContainerBegin(t,e,n){this.WriteUInt8(e),this.WriteUInt8(n),this.WriteUInt32(t)}WriteContainerEnd(){}WriteDouble(t){var e=s.__.GetBytes(t);this._stream.Write(e,0,e.length)}WriteFloat(t){var e=s.nt.GetBytes(t);this._stream.Write(e,0,e.length)}WriteFieldBegin(t,e,n){e<=5?this._stream.WriteByte(t|e<<5):e<=255?(this._stream.WriteByte(192|t),this._stream.WriteByte(e)):(this._stream.WriteByte(224|t),this._stream.WriteByte(e),this._stream.WriteByte(e>>8))}WriteFieldEnd(){}WriteFieldOmitted(t,e,n){}WriteInt16(t){t=s.bD.EncodeZigzag16(t),this.WriteUInt16(t)}WriteInt32(t){t=s.bD.EncodeZigzag32(t),this.WriteUInt32(t)}WriteInt64(t){this.WriteUInt64(s.bD.EncodeZigzag64(t))}WriteInt8(t){this._stream.WriteByte(o.ToInt8(t))}WriteString(t){if(""==t)this.WriteUInt32(0);else{var e=s.YE.GetBytes(t);this.WriteUInt32(e.length),this._stream.Write(e,0,e.length)}}WriteStructBegin(t,e){}WriteStructEnd(t){this.WriteUInt8(t?r.I.BT_STOP_BASE:r.I.BT_STOP)}WriteUInt16(t){var e=s.Hs.GetBytes(o.ToUInt16(t));this._stream.Write(e,0,e.length)}WriteUInt32(t){var e=s.Hs.GetBytes(o.ToUInt32(t));this._stream.Write(e,0,e.length)}WriteUInt64(t){var e=s.NO.GetBytes(t);this._stream.Write(e,0,e.length)}WriteUInt8(t){this._stream.WriteByte(o.ToUInt8(t))}WriteWString(t){this.WriteUInt32(t.length);for(var e=0;e<t.length;++e){var n=t.charCodeAt(e);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}}}},387037:(t,e,n)=>{"use strict";n.d(e,{Wp:()=>c,f0:()=>i,LY:()=>u,D2:()=>h});var r,s,i,a=n(573886),o=n(759570);class c{static GetGuid(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[t(),t(),"-",t(),"-",t(),"-",t(),"-",t(),t(),t()].join("")}static GetTimeStamp(){var t=(new Date).getTime(),e=new a.CG("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e}static GetTimeStampWithValue(t){var e=new a.CG("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e}}!function(t){t[t.NotSet=0]="NotSet",t[t.Event=1]="Event",t[t.PerformanceCounter=2]="PerformanceCounter",t[t.Anomaly=3]="Anomaly",t[t.Prediction=4]="Prediction",t[t.TraceLog=5]="TraceLog",t[t.EventSourceLog=6]="EventSourceLog",t[t.HttpLog=7]="HttpLog",t[t.PerformanceCounterAzure=8]="PerformanceCounterAzure",t[t.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(r||(r={})),function(t){t[t.NotSet=0]="NotSet",t[t.O365=1]="O365",t[t.SkypeBI=2]="SkypeBI",t[t.SkypeData=3]="SkypeData"}(s||(s={})),function(t){t[t.NotSet=0]="NotSet",t[t.DistinguishedName=1]="DistinguishedName",t[t.GenericData=2]="GenericData",t[t.IPV4Address=3]="IPV4Address",t[t.IPv6Address=4]="IPv6Address",t[t.MailSubject=5]="MailSubject",t[t.PhoneNumber=6]="PhoneNumber",t[t.QueryString=7]="QueryString",t[t.SipAddress=8]="SipAddress",t[t.SmtpAddress=9]="SmtpAddress",t[t.Identity=10]="Identity",t[t.Uri=11]="Uri",t[t.Fqdn=12]="Fqdn",t[t.IPV4AddressLegacy=13]="IPV4AddressLegacy",t[t.FilePath=14]="FilePath"}(i||(i={}));class u{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new a.CG("0"),this.Records=[]}Write(t){this.WriteImpl(t,!1)}WriteImpl(t,e){if(t.WriteStructBegin(null,e),""!=this.Source?(t.WriteFieldBegin(o.I.BT_STRING,2,null),t.WriteString(this.Source),t.WriteFieldEnd()):t.WriteFieldOmitted(o.I.BT_STRING,2,null),""!=this.DataPackageId?(t.WriteFieldBegin(o.I.BT_STRING,5,null),t.WriteString(this.DataPackageId),t.WriteFieldEnd()):t.WriteFieldOmitted(o.I.BT_STRING,5,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(o.I.BT_INT64,6,null):(t.WriteFieldBegin(o.I.BT_INT64,6,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),this.Records.length){t.WriteFieldBegin(o.I.BT_LIST,8,null),t.WriteContainerBegin(this.Records.length,o.I.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.I.BT_LIST,8,null);t.WriteStructEnd(e)}Read(t){this.ReadImpl(t,!1)}ReadImpl(t,e){}}class h{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(t){this.WriteImpl(t,!1)}WriteImpl(t,e){if(t.WriteStructBegin(null,e),this.DataPackages.length){t.WriteFieldBegin(o.I.BT_LIST,1,null),t.WriteContainerBegin(this.DataPackages.length,o.I.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.I.BT_LIST,1,null);0!=this.RequestRetryCount?(t.WriteFieldBegin(o.I.BT_INT32,2,null),t.WriteInt32(this.RequestRetryCount),t.WriteFieldEnd()):t.WriteFieldOmitted(o.I.BT_INT32,2,null),t.WriteStructEnd(e)}Read(t){this.ReadImpl(t,!1)}ReadImpl(t,e){}}},574566:(t,e,n)=>{"use strict";var r;n.d(e,{b:()=>r}),function(t){t.Chat="chat",t.Community="community",t.EngageCommunity="engagecommunity",t.Meeting="meeting",t.OneOnOne="1on1",t.PhoneChat="phonechat",t.Phonelink1on1Chat="phonelink1on1chat",t.PhonelinkGroupChat="phonelinkgroupchat",t.SfbInteropChat="sfbinteropchat",t.Team="space",t.Topic="topic",t.StreamOfNotifications="streamofnotifications",t.StreamOfCalllogs="streamofcalllogs",t.StreamOfSharedCalllogs="streamofsharedcalllogs",t.StreamOfBookmarks="streamofbookmarks",t.StreamOfNotes="streamofnotes",t.StreamOfDrafts="streamofdrafts",t.StreamOfAnnotations="streamofannotations",t.SubCommunity="subcommunity"}(r||(r={}))},806658:(t,e,n)=>{"use strict";n.d(e,{vg:()=>M,M8:()=>R,Nh:()=>F,ye:()=>D,JO:()=>L,EV:()=>k,lQ:()=>G,Mg:()=>x,Tu:()=>V,fT:()=>H,W4:()=>J,$l:()=>$,T1:()=>z,LN:()=>q,rR:()=>Y,m9:()=>j,AF:()=>Z,fl:()=>Q,Bv:()=>X,LW:()=>K,Pi:()=>tt,iq:()=>et,lm:()=>nt,aR:()=>rt,FL:()=>st,Xb:()=>it,dk:()=>at,Mq:()=>ot,Ku:()=>ut,PS:()=>ht,mD:()=>dt,Tg:()=>lt,aH:()=>ft,q2:()=>gt,Hv:()=>mt,no:()=>pt,gB:()=>St,e6:()=>Tt,in:()=>Ct,VW:()=>It,W5:()=>vt,Yo:()=>Wt,tC:()=>Nt,VU:()=>bt,bw:()=>Pt,gv:()=>Bt,Iz:()=>wt,MX:()=>_t,QC:()=>Ot,Te:()=>At,uD:()=>Ut,a3:()=>Mt,WY:()=>Rt,GX:()=>Et,rV:()=>Ft,aL:()=>Dt,vd:()=>Lt,gZ:()=>kt,eu:()=>Gt,DR:()=>xt,l0:()=>Vt,_S:()=>Ht,Y$:()=>Jt,v3:()=>$t,oG:()=>zt,BG:()=>qt,zh:()=>Yt,my:()=>jt,m7:()=>Zt,hT:()=>Xt,o2:()=>Kt,o3:()=>te,bf:()=>ee,N$:()=>ne,fY:()=>re,H1:()=>se,$w:()=>ie,p3:()=>ae,_5:()=>oe,jB:()=>ce,m5:()=>ue,HT:()=>he,N1:()=>de,Qi:()=>le,dU:()=>fe,Gu:()=>ge,bH:()=>me,Xd:()=>pe,A$:()=>Te,oZ:()=>ye,si:()=>Ce,wD:()=>Ie,Ay:()=>ve,sW:()=>We,CM:()=>Ne,nH:()=>Pe});var r=n(680499),s=n(387037),i=n(586550),a=n(480354),o=n(431779),c=n(84646),u=n(574566),h=n(645095),d=n(754255),l=n(473107);const f=400,g=500,m=3,p="unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com",S=c.gN.SkypeSpacesUser+c.LE,T=c.gN.SkypeSpacesUser+c.K,y=c.gN.SkypeSpacesUser+c.QX,C=c.gN.SkypeSpacesUser+c.zl,I=c.gN.SkypeSpacesUser+c.uM,v=c.gN.SkypeSpacesUser+c.Nk,W=c.gN.SkypeSpacesUser+c.Sq,N=c.gN.SkypeSpacesUser+c.cA,b=c.gN.SkypeSpacesUser+c.Ne,P=c.gN.SkypeSpacesUser+c.Bh,B=c.gN.SkypeSpacesUser+c.gI,w=c.gN.SkypeSpacesUser+c.m2,_="tfl:",O=c.gN.SkypeSpacesUser+_,A="sfc:",U=c.gN.SkypeSpacesUser+A,M="receiverSfB",R="Text";function E(t,e){return!!t&&t.startsWith(e)}function F(t){return t>=f&&t<g}function D(t,e){return E(t,c.gN.SkypeSpacesThread)||E(t,c.gN.PhonelinkSmsPrefix)||k(t,e)}function L(t){return E(t,c.gN.PrivateFeed)}function k(t,e){return L(t)||E(e,c.SU)}function G(t=""){const e=/syncState=([^&]+)/;let n;return t&&e.test(t)&&(n=t.match(e)[1]),n}function x(t){return-1!==c.wX.indexOf(t)}function V(t){const{teamsUserPhoneNumbers:e}=t.get(d.w.Messaging);return!!e?.phoneNumbers?.find((t=>"Primary"===t?.assignmentCategory&&t?.acquiredCapabilities?.includes("InboundA2PSms")&&t?.acquiredCapabilities?.includes("OutboundA2PSms")))}function H(t,e,n){const{userLocale:r,phoneNumberUtil:s}=e,i=s.getInstance(),a=i.parseAndKeepRawInput(t,r),o=i.getRegionCodeForNumber(a);return n?.includes(o)}function J(t){if(!t||!t.startsWith(c.zD))return!1;const e=t.split(":");return!!(2===e.length||3===e.length&&x(e[1]))}function $(t){return!!t&&t.startsWith(O)}function z(t){return!!t&&t.startsWith(U)}function q(t){return t&&$(t)?t.replace(_,""):t}function Y(t){return t&&z(t)?t.replace(A,""):t}function j(t){if(!Z(t)&&!wt(t))return"";if(!t.includes(":"))return"";const e=t.match(/^8:[\w-]+:[\w-]+_([\w-]+)$/);if(e)return e[1];const n=new RegExp(`^8:[\\w-]+:(?:${c.hB})?([\\w-]+)$`),r=t.match(n);if(r)return r[1];const s=t.match(/^28:([\w-]+)$/);return s?s[1]:""}function Z(t){return!!t&&(X(t)||st(t)||J(t)||t.startsWith(O)||K(t)||tt(t)||et(t)||nt(t)||rt(t))}function Q(t){return!!t&&t.startsWith(T)}function X(t){return!!t&&(t.startsWith(S)||t.startsWith(T))}function K(t){return!!t&&(t.startsWith(y)||t.startsWith(C))}function tt(t){return!!t&&(t.startsWith(I)||t.startsWith(v))}function et(t){return!!t&&(t.startsWith(W)||t.startsWith(N))}function nt(t){return!!t&&(t.startsWith(b)||t.startsWith(P))}function rt(t){return!!t&&(t.startsWith(B)||t.startsWith(w))}function st(t){return!!t&&(t.startsWith(c.nd)||t.startsWith(c.og)||t.startsWith(c.r3))}function it(t){return t?X(t)?"":K(t)?c.Fq:tt(t)?c.xW:et(t)?c.ar:nt(t)?c.JP:rt(t)?c._I:"":""}function at(t){return!!t&&(X(t)||K(t)||tt(t)||et(t)||nt(t)||rt(t))}function ot(t){if((0,a.isString)(t)&&!(0,a.isEmpty)(t)){if(ut(t))return ct("PSTN",t,s.f0.PhoneNumber);if(J(t)||dt(t))return ct("SfC",t,s.f0.Identity)}return t}const ct=(t,e,n)=>`${t}-${new i.w(e,n).scrub()}`;function ut(t){return!!t&&0===t.indexOf(c.gN.Pstn)}function ht(t){return!!t&&(t.startsWith(c.OH)||t.startsWith(c.VP)||t.startsWith(c.b6))}function dt(t){return!!t&&t.startsWith(c.SF)}function lt(t){return Boolean(t===p||t===c._7)}function ft(t,e){let n=t;return e&&(n=[t,c.fE,e].join("")),n}function gt(t){if(!t.threadProperties)return!1;const e=t.threadProperties[c.iy.LastJoinAt],n=t.threadProperties[c.iy.LastLeaveAt];return n&&e?e>n:!!e}function mt(t){return jt((0,o.$)(t.conversationLink)).conversationId}function pt(t){if(!t||!t.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");return St(t.conversationLink,t.id)}function St(t,e){if((0,a.isEmpty)(t))return e;const n=jt((0,a.last)(t.split("/"))||"");return n.isValid?n.itemId:e}function Tt(t){const e=pt(t);return!!e&&e!==t.id}function yt(t){const e=Number(t);return!e||e<c.qc}function Ct(t){const{properties:e}=t;if(!e)return;const n=e[c.rF.EditTime];return n?Number(n):void 0}function It(t){const{properties:e}=t;if(!e)return;const n=e[c.rF.DeleteTime];return n?Number(n):void 0}function vt(t){const{properties:e}=t;if(!e)return;const n=e[c.rF.HardDeleteTime];return n?Number(n):void 0}function Wt(t,e,n,r,s){const i=t;if(Ne(e)?i&&i.length>2:e?.[c.iy.ExtensionDefinitionContainer]){const{members:e,botMembers:s}=function(t,e,n){const r=2;if(n?.get(d.w.Sync).disableBotSplitForSoloGroupChats?t&&t.length>r:t){const n=(0,a.partition)(t,(t=>!wt(t.id)||e&&e.indexOf(t.id)>-1));return{members:n[0],botMembers:n[1]}}return{members:t,botMembers:[]}}(t,n,r);return{members:e,botMembers:s}}if(s&&r?.get(d.w.Messaging).enableExcludeCopilotFromNewChat){const e=(0,a.partition)(t,(t=>!wt(t.id)||!_t(t.id,r)));return{members:e[0],botMembers:e[1]}}return{members:i,botMembers:[]}}const Nt=t=>!!t&&t.startsWith(c.PD),bt=t=>!!t&&(t.startsWith(c.nd)||t.startsWith(c.og)||t.startsWith(c.PD)||t.startsWith(c.z3)||t.startsWith(c.VP)||t.startsWith(c.OH)||t.startsWith(c.b6)),Pt=(t,e)=>{if(!t)return!1;const n=st(t);if(n)return n;const r=t.startsWith(c.r3);return!e&&r};function Bt(t){return t.startsWith(c.gN.BotPrefix)}function wt(t){return!!t&&(!t.startsWith(c.kA.VoiceAppPrefix)&&(t.startsWith(c.gN.BotPrefix)||t.startsWith(c.kA.BotPrefixOld)))}const _t=(t,e)=>{if(!t)return!1;const{copilotAppsIds:n}=e.get(d.w.Messaging),r=t.replace(new RegExp(`^${c.gN.BotPrefix}`),"");return!!n?.some((t=>t===r))},Ot=(t,e)=>{if(!t)return!1;const{odspCustomCopilotBotIds:n}=e.get(d.w.CustomCopilot),r=t.replace(new RegExp(`^${c.gN.BotPrefix}`),"");return!!n?.some((t=>t===r))},At=(t,e)=>{if(!e)return!1;const{m365ChatBotIds:n}=t.get(d.w.Messaging);return!(!wt(e)||!n?.includes(e))},Ut=(t,e)=>{if(!e)return!1;const{m365ChatBotIds:n}=t.get(d.w.Messaging);return!!e.some((t=>n?.includes(t)))},Mt=(t,e)=>{const{enableM365ChatBot:n}=t.get(d.w.Messaging);return!n&&Ut(t,e)},Rt=t=>{const{m365ChatBotIds:e}=t.get(d.w.Messaging);if(e)return e.find((t=>"28:914d3be7-0ff0-4da7-ac61-4dab62e6e076"===t))},Et=t=>!!t&&t.startsWith(c.Vg),Ft=t=>t&&t.split(":")[3]||"",Dt=t=>t&&t.startsWith(c.I8)||!1,Lt=t=>!!t&&t.startsWith(c.lC),kt=t=>t&&t.startsWith(c._b)||!1,Gt=t=>t&&t.split(":")[2]||"",xt=t=>J(t)&&!t.startsWith(O)?t.replace(c.gN.SkypeSpacesUser,c.gN.SkypeSpacesUser+_):t,Vt=t=>J(t)&&!t.startsWith(U)?t.replace(c.gN.SkypeSpacesUser,c.gN.SkypeSpacesUser+A):t,Ht=(t,e=c.Vb)=>Z(t)||wt(t)||ut(t)||zt(t,e)||Lt(t)||kt(t),Jt=t=>Z(t)&&!bt(t),$t=t=>{const e=Number(t),n=Date.now()+30*l.ND;return 0!==e&&!isNaN(e)&&e<n},zt=(t,e)=>{if(!t)return!1;const n=c.gN.BotPrefix+e;return t.startsWith(n)};function qt(t){return!!wt(t)&&c.Th.InterceptorBotMris.some((e=>e===t))}function Yt(t,e=!1){return e?!!t&&(t.includes(c.br)||t.includes(c.XD)):!!t&&t.includes(c.br)}function jt(t){if(!t)return{isValid:!1,conversationId:"",itemId:""};const e=t.split(";");if(1===e.length)return{isValid:!1,conversationId:e[0],itemId:""};if(2!==e.length||0!==e[1].indexOf(c.br)&&0!==e[1].indexOf(c.XD)||e[1].indexOf(c.j6)>-1)return{isValid:!1,conversationId:"",itemId:""};if(e[1].includes(c.XD)){const t=e[1].slice(c.XD.length);return{isValid:!0,conversationId:e[0],itemId:t}}const n=e[1].substr(c.br.length);return{isValid:!yt(n),conversationId:e[0],itemId:n}}function Zt(t){switch(t){case u.b.Team:case u.b.Community:return c.Cr.Team;case u.b.Topic:case u.b.SubCommunity:return c.Cr.Topic;case u.b.SfbInteropChat:case u.b.Chat:return c.Cr.Chat;case u.b.Meeting:return c.Cr.Meeting;case u.b.PhoneChat:return c.Cr.PhoneChat;case u.b.Phonelink1on1Chat:return c.Cr.Phonelink1on1Chat;case u.b.PhonelinkGroupChat:return c.Cr.PhonelinkGroupChat;case u.b.EngageCommunity:return c.Cr.EngageCommunity;default:return c.Cr.Thread}}function Qt(t){const{properties:e}=t;return e&&e[c.rF.Importance]?e[c.rF.Importance]:c.Al.NORMAL}function Xt(t){return Qt(t)===c.Al.HIGH}function Kt(t){return Qt(t)===c.Al.URGENT}function te(t){return(0,a.includes)(c.KA,t.messagetype)}function ee(t){return(0,a.includes)(c.St,t)}function ne(t){switch(t){case h.b_.Admin:return c.mz.Admin;case h.b_.Guest:return c.mz.Guest;case h.b_.User:return c.mz.User;case h.b_.Shadow:return c.mz.Shadow;case h.b_.Undefined:default:return c.mz.None}}const re=(t,e)=>{if(t){const n=t[c.rF.Emotions],r=n&&(0,a.find)(n,{key:"star"}),s=r&&r.users;if(s)return!!(0,a.some)(s,{mri:e})}return!1},se=({resourceType:t,resource:e})=>{switch(t){case"NewMessage":case"MessageUpdate":case c.Bx.PartialMessageUpdate:return e.conversationid||mt(e);case"ThreadUpdate":case"ConversationUpdate":return e.id;case c.Bx.CommentStreamLie:case c.Bx.NewLiveMessages:case c.Bx.LiveMessageUpdates:return e.conversationId;default:return}},ie=({resourceType:t,resource:e})=>{switch(t){case"NewMessage":case"MessageUpdate":case c.Bx.PartialMessageUpdate:return pt(e);default:return}},ae=t=>t===u.b.StreamOfNotifications,oe=t=>t===u.b.StreamOfCalllogs||t===u.b.StreamOfSharedCalllogs,ce=t=>t===u.b.StreamOfDrafts,ue=t=>t===u.b.StreamOfNotes,he=t=>t===u.b.StreamOfAnnotations,de=t=>{if(!t)return"";if((0,a.isString)(t)){const e=t;return 0===e.lastIndexOf(c.zD,0)||0===e.lastIndexOf(c.gN.BotPrefix,0)||ut(e)||Lt(e)||kt(e)?e:c.zD+e}return(0,a.first)(t.mris)??""},le=t=>t?.startsWith(c.WY)||t?.startsWith(c.u2)||t?.startsWith(c.gD)||t?.startsWith(c.pM)||t?.startsWith(c.fw)||t?.startsWith(c.yP);function fe(t){if(!t)return!1;if(!t.startsWith(c.zD))return!1;return(t.startsWith(S)||t.startsWith(y)||t.startsWith(I)||t.startsWith(b)||t.startsWith(W)||t.startsWith(B))&&t.split(":").length===m}const ge=t=>{const{enableTfwTflFederation:e}=t.get(d.w.Messaging),{enableGuardiansChat:n}=t.get(d.w.Guardians),{licenseType:r}=t.get(d.w.UserResources);return!!(e||n&&Se(r))},me=t=>{const{enablePhonelinkSms:e}=t.get(d.w.PhonelinkSms),{phoneLinkingBlocked:n}=t.get(d.w.HostCapabilities);return!!e&&!n},pe=t=>{let e,n="",r="";const s=t.match(/\/message\/(48|19):([^\/]+)\/([^\/\?]+)/);if(s){n=`${s[1]}:${s[2]}`,r=s[3];try{const n=new URL(t);e=new URLSearchParams(n.search).get("parentMessageId")??void 0}catch{return{conversationId:n,messageId:r}}}return{conversationId:n,messageId:r,parentMessageId:e}},Se=t=>"Teacher"===t,Te=t=>{if(!t?.sendAt)return;const e=Number(t.sendAt);return isNaN(e)?new Date(t.sendAt).getTime():e},ye=t=>!!t&&(t.includes(c.wP)||t.endsWith(c.z7.FederatedGatewayChat)||t.endsWith(c.z7.OnPremFederatedGatewayChat)),Ce=t=>!!t&&t.endsWith(c.z7.OnPremFederatedGatewayChat),Ie=(t,e,n,r,s)=>{const i=t&&t.includes(c.Z),a=s?.some((t=>J(t)));return i||!(e||!n||!r||a)},ve=(t,e)=>e?`${t};messageid=${e}`:t,We=(t,e,n)=>({...n?{draftDetails:{sendAt:new Date(n).getTime().toString()},draftType:r.C.ScheduledDraft}:{draftType:r.C.RoamedDraft},innerThreadId:ve(t,e)}),Ne=t=>!(0,a.isNil)(t)&&("true"===t[c.iy.P2PChatUniqueRosterThread]?.toString()?.toLowerCase()||be(t)),be=t=>t[c.iy.TemplateType]===c.iy.ImmutableRoster||"true"===t[c.iy.IsStickyThread]?.toString()?.toLowerCase();function Pe(t){return!!t&&t.indexOf(c.Ol)>-1}},680499:(t,e,n)=>{"use strict";n.d(e,{C:()=>r,Du:()=>s,gz:()=>i,N4:()=>a,kI:()=>o,oO:()=>c,Xd:()=>u,rI:()=>h,z_:()=>l,To:()=>f,lD:()=>S,Z6:()=>g,gm:()=>T,sQ:()=>y});var r,s,i,a,o,c,u,h,d,l,f,g,m,p=n(84646);!function(t){t.ScheduledDraft="ScheduledDraft",t.RoamedDraft="RegularDraft"}(r||(r={})),function(t){t.TemplateId="basic_forward_message_template",t.ForwardedContentStart='<blockquote itemtype="http://schema.skype.com/Forward">',t.ForwardedContentEnd="</blockquote>"}(s||(s={})),function(t){t.Start="Start",t.Informative="Informative",t.Streaming="Streaming",t.Final="Final"}(i||(i={})),function(t){t.Completed="Completed",t.Expired="Expired",t.Cancelled="Cancelled"}(a||(a={})),function(t){t.Teams="TEAMS",t.Sfl="SFL"}(o||(o={})),function(t){t.PRE_MEETING="PRE_MEETING",t.IN_MEETING="IN_MEETING",t.POST_MEETING="POST_MEETING"}(c||(c={})),function(t){t[t.Sync=1]="Sync",t[t.LongPoll=2]="LongPoll",t[t.SfB=3]="SfB",t[t.SyncRelated=4]="SyncRelated",t[t.Local=5]="Local",t[t.CSAReplyChain=6]="CSAReplyChain",t[t.DeltaSync=7]="DeltaSync",t[t.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",t[t.AdHocPropertyUpdate=9]="AdHocPropertyUpdate",t[t.CSAPost=10]="CSAPost",t[t.CSAThread=11]="CSAThread",t[t.RCMUpdate=12]="RCMUpdate"}(u||(u={})),function(t){t[t.Sending=0]="Sending",t[t.Delivered=1]="Delivered",t[t.Received=2]="Received",t[t.Error=3]="Error",t[t.Deleted=4]="Deleted",t[t.Retrying=5]="Retrying"}(h||(h={})),function(t){t[t.Muted=0]="Muted",t[t.Simple=1]="Simple",t[t.Important=2]="Important",t[t.Mentioned=3]="Mentioned"}(d||(d={})),function(t){t.SFL="SFL",t.TFL="TFL"}(l||(l={})),function(t){t[t.StartupSyncClean=1]="StartupSyncClean",t[t.StartupSyncUpdate=2]="StartupSyncUpdate",t[t.ThreadDetailsSync=3]="ThreadDetailsSync",t[t.LongPoll=4]="LongPoll",t[t.ResolverPutConversation=5]="ResolverPutConversation",t[t.LocalUpdate=6]="LocalUpdate",t[t.PutConversationLie=7]="PutConversationLie",t[t.AddUsersToConversation=8]="AddUsersToConversation",t[t.ConversationFetchJob=9]="ConversationFetchJob",t[t.GroupChatsStartupJob=10]="GroupChatsStartupJob",t[t.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",t[t.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",t[t.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob",t[t.TeamUnjoinedChannelsSyncJob=14]="TeamUnjoinedChannelsSyncJob",t[t.UnjoinedChannelSyncJob=15]="UnjoinedChannelSyncJob",t[t.LocalUpdateForRedDot=16]="LocalUpdateForRedDot",t[t.ChatsAndChannelsSyncJob=17]="ChatsAndChannelsSyncJob",t[t.UnjoinedChannelThreadDetailsUpdate=18]="UnjoinedChannelThreadDetailsUpdate",t[t.FileReferenceSyncJob=19]="FileReferenceSyncJob",t[t.LieEvent=20]="LieEvent",t[t.BotEmptyMessageUpdate=21]="BotEmptyMessageUpdate"}(f||(f={}));class S{}S.NotificationConversationId=`${p.gN.PrivateFeed}notifications`,S.DraftsConversationId=`${p.gN.PrivateFeed}drafts`,S.StarredConversationId=`${p.gN.PrivateFeed}starred`,S.CallLogConversationId=`${p.gN.PrivateFeed}calllogs`,S.SharedCallLogConversationId=`${p.gN.PrivateFeed}sharedcalllogs`,S.AnnotationsConversationId=`${p.gN.PrivateFeed}annotations`,S.ThreadsConversationId=`${p.gN.PrivateFeed}threads`,function(t){t.SIGNER="SIGNER",t.INTERPRETER="INTERPRETER"}(g||(g={})),function(t){t[t.Message=0]="Message"}(m||(m={}));const T="x-ms-request-priority";var y;!function(t){t[t.RealTimeSync=0]="RealTimeSync",t[t.ForegroundSync=10]="ForegroundSync",t[t.BackgroundSync=20]="BackgroundSync"}(y||(y={}))},645095:(t,e,n)=>{"use strict";n.d(e,{Tg:()=>c,H4:()=>u,R8:()=>h,C8:()=>d,OB:()=>l,E:()=>f,_m:()=>g,K5:()=>m,hs:()=>p,aK:()=>S,h3:()=>T,hO:()=>y,f4:()=>C,k6:()=>I,m4:()=>W,uS:()=>N,Wz:()=>b,bh:()=>B,aY:()=>w,gV:()=>_,an:()=>O,Vm:()=>A,Fw:()=>U,YV:()=>M,Yp:()=>R,S5:()=>E,QU:()=>D,sB:()=>L,fU:()=>k,uT:()=>G,Mb:()=>x,b_:()=>V,Q8:()=>H,ef:()=>J,N1:()=>$,nP:()=>z,Cu:()=>q,YY:()=>Y,Wf:()=>j,nC:()=>Z,$3:()=>Q,fF:()=>X,ob:()=>K,l8:()=>tt,iF:()=>et,vW:()=>nt,Uf:()=>rt,IN:()=>st,p7:()=>it,jZ:()=>at,lp:()=>ut,ne:()=>ht,uf:()=>dt});var r=n(754255),s=n(141102),i=n(762322),a=n(780952),o=n(193406);const c=1,u=200,h=1,d=2,l=0;var f,g,m;!function(t){t.HighlightOverview1Day="HighlightOverview1Day",t.HighlightOverview7days="HighlightOverview7Days",t.HighlightOverview30Days="HighlightOverview30Days",t.HighlightCatchUp="HighlightCatchUp",t.ActionItems="ActionItems",t.Decision="Decision",t.OpenItems="OpenItems",t.MainTopics="MainTopics",t.SuggestedQuestions="SuggestedQuestions",t.FreeText="Q&A",t.Questions="Questions",t.Summary="Summary"}(f||(f={})),function(t){t[t.UserFilter=0]="UserFilter",t[t.ActionItems=4]="ActionItems",t[t.Decision=5]="Decision",t[t.OpenItems=6]="OpenItems",t[t.MainTopics=7]="MainTopics",t[t.SuggestedQuestions=8]="SuggestedQuestions"}(g||(g={})),function(t){t[t.OneDay=1]="OneDay",t[t.SevenDays=7]="SevenDays",t[t.ThirtyDays=30]="ThirtyDays"}(m||(m={}));const p="api/v1/",S="api/v2/",T="api/v3/",y=12e4,C=12e4,I="https://chatsvcagg.teams.microsoft.com",v="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation",W="https://teams.microsoft.com/api/csa",N={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupgroupchats:"teams/users/me/groupchats",startupnonrecentchats:"teams/users/me/nonrecentchats",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"},b="xx",P=12e4,B=100,w=50,_=50,O=50,A=6e5,U=12e4;var M,R;!function(t){t[t.Standard=0]="Standard",t[t.Edu=1]="Edu",t[t.Class=2]="Class",t[t.Plc=3]="Plc",t[t.Staff=4]="Staff",t[t.HealthcareCareCoordination=5]="HealthcareCareCoordination",t[t.Community=6]="Community"}(M||(M={})),function(t){t.None="none",t.Owners="owners",t.Members="members",t.OwnersAndMembers="ownersAndMembers"}(R||(R={}));const E={None:0,0:"None",Private:1,1:"Private",Secret:2,2:"Secret",Public:3,3:"Public",HiddenMembership:4,4:"HiddenMembership",Unknown:5,5:"Unknown",All:6,6:"All"};var F,D,L,k,G,x,V,H,J,$,z,q;!function(t){t[t.InProgress=0]="InProgress",t[t.Success=1]="Success",t[t.Error=2]="Error"}(F||(F={})),function(t){t[t.None=0]="None",t[t.Private=1]="Private",t[t.TenantWide=2]="TenantWide",t[t.Shared=4]="Shared",t[t.Standalone=9]="Standalone"}(D||(D={})),function(t){t[t.Everyone=0]="Everyone",t[t.Moderators=1]="Moderators"}(L||(L={})),function(t){t[t.Everyone=0]="Everyone",t[t.Moderators=1]="Moderators"}(k||(k={})),function(t){t[t.NotAllowed=0]="NotAllowed",t[t.Allowed=1]="Allowed"}(G||(G={})),function(t){t[t.NotAllowed=0]="NotAllowed",t[t.Allowed=1]="Allowed"}(x||(x={})),function(t){t[t.Undefined=0]="Undefined",t[t.User=1]="User",t[t.Admin=2]="Admin",t[t.Guest=3]="Guest",t[t.Shadow=4]="Shadow"}(V||(V={})),function(t){t[t.Everyone=0]="Everyone",t[t.Moderators=1]="Moderators",t[t.EveryoneButGuests=2]="EveryoneButGuests"}(H||(H={})),function(t){t[t.Unknown=-1]="Unknown",t[t.Private=1]="Private",t[t.Channel=2]="Channel"}(J||(J={})),function(t){t[t.AnyonePost=0]="AnyonePost",t[t.AnyoneWithWarning=1]="AnyoneWithWarning",t[t.OwnersPost=2]="OwnersPost"}($||($={})),function(t){t[t.Strict=0]="Strict",t[t.Moderate=1]="Moderate",t[t.NoRestriction=2]="NoRestriction"}(z||(z={})),function(t){t[t.Standard=0]="Standard",t[t.Private=1]="Private",t[t.Shared=4]="Shared",t[t.Standalone=9]="Standalone"}(q||(q={}));const Y={Single:0,0:"Single",Occurrence:1,1:"Occurrence",Exception:2,2:"Exception",RecurringMaster:3,3:"RecurringMaster"};var j,Z,Q,X,K,tt,et;!function(t){t[t.None=0]="None",t[t.Adhoc=1]="Adhoc",t[t.Scheduled=2]="Scheduled",t[t.Recurring=3]="Recurring",t[t.Broadcast=4]="Broadcast",t[t.MeetNow=5]="MeetNow"}(j||(j={})),function(t){t[t.None=0]="None",t[t.Daily=1]="Daily",t[t.Weekly=2]="Weekly",t[t.Monthly=3]="Monthly",t[t.RelativeMonthly=4]="RelativeMonthly",t[t.Yearly=5]="Yearly",t[t.RelativeYearly=6]="RelativeYearly"}(Z||(Z={})),function(t){t[t.First=0]="First",t[t.Second=1]="Second",t[t.Third=2]="Third",t[t.Fourth=3]="Fourth",t[t.Last=4]="Last"}(Q||(Q={})),function(t){t[t.January=1]="January",t[t.February=2]="February",t[t.March=3]="March",t[t.April=4]="April",t[t.May=5]="May",t[t.June=6]="June",t[t.July=7]="July",t[t.August=8]="August",t[t.September=9]="September",t[t.October=10]="October",t[t.November=11]="November",t[t.December=12]="December"}(X||(X={})),function(t){t[t.Sunday=0]="Sunday",t[t.Monday=1]="Monday",t[t.Tuesday=2]="Tuesday",t[t.Wednesday=3]="Wednesday",t[t.Thursday=4]="Thursday",t[t.Friday=5]="Friday",t[t.Saturday=6]="Saturday"}(K||(K={})),function(t){t[t.First=0]="First",t[t.Second=1]="Second",t[t.Third=2]="Third",t[t.Fourth=3]="Fourth",t[t.Last=4]="Last"}(tt||(tt={})),function(t){t[t.None=0]="None",t[t.Sfb=1]="Sfb"}(et||(et={}));const nt={Meeting:1,1:"Meeting",None:0,0:"None",Channel:2,2:"Channel"};var rt,st,it,at,ot;!function(t){t[t.Success=0]="Success",t[t.TranslationFailed=1]="TranslationFailed",t[t.MessageNotFound=2]="MessageNotFound",t[t.VersionNotFound=3]="VersionNotFound",t[t.SkipTranslation=4]="SkipTranslation",t[t.ContentIsEmpty=5]="ContentIsEmpty",t[t.LanguageDetectionFailed=6]="LanguageDetectionFailed",t[t.UnsupportedSourceLanguage=7]="UnsupportedSourceLanguage",t[t.UnknownError=10]="UnknownError"}(rt||(rt={})),function(t){t.Chat="chat",t.ChatMessages="chatmessages",t.ChatMessage="chatmessage",t.Chats="chats",t.ChatsV2="chats_v2",t.ChatsV3="chats_v3",t.ChatsByTitle="chatsByTitle",t.ChatSummarization="chatSummarization",t.ChatSummarizationV2="chatSummarizationV2",t.ChatSmartNavigator="chatSmartNavigator",t.ChatWithUser="chatwithuser",t.ChatsAndChannelsByIds="chatsAndChannelsByIds",t.ConversationFolders="conversationFolders",t.CrossPost="crosspost",t.GetPost="getPost",t.GetSupportedTranslationLanguages="getSupportedTranslationLanguages",t.PostAuthors="postAuthors",t.ReplyChain="replychain",t.ReplyChains="replychains",t.ReplyChainsV2="replychains_v2",t.RecentPosts="recentposts",t.RecentThreads="recentthreads",t.RepliesInChain="repliesInChain",t.StartupGroupChats="startupgroupchats",t.StartupNonRecentChats="startupnonrecentchats",t.ScheduleMessage="schedulemessage",t.SystemMessages="systemmessages",t.Teams="teams",t.TranslateMessages="translatemessages",t.Phonelink="phonelink",t.PinnedChannels="pinnedChannels",t.PinnedPost="pins",t.PinPost="pinPost",t.UnpinPost="unpinPost",t.Parents="parents",t.TeamChannels="teamChannels",t.Channel="channel",t.PivotMessagesPosts="pivotMessagesPost",t.DeeplinkPosts="deeplinkPosts"}(st||(st={})),function(t){t.ContentType="content-type",t.XChatserviceEndpoint="x-csendpoint",t.XClientUiLanguage="x-client-ui-language",t.XDbFastFailed="x-ms-db-fast-failed"}(it||(it={})),function(t){t.SharedChannel="sharedchannel",t.PrivateChannel="privatechannel",t.Unknown=""}(at||(at={})),function(t){t[t.Embed=4]="Embed"}(ot||(ot={}));const ct=async(t,e,n)=>{const r=t.regionGtm("chatSvcAggAfd");return(0,a.a)(r,e,i.B.BaseUrlTimeout).catch((t=>{const e=(0,s.$)(t),r=(0,a.W)(t),i=n.newLogger("getCSAHostFromGtm","core-cdl-worker-services");i.errorToTelemetry?.(`Failed to resolve CSA host from Gtm. isMissingFromGtm:${e}, isTimedOut:${r}. message:'${t?.message}'`,"cdl_sync_csa_host_resolution_failed_from_gtm",void 0,!0)}))};function ut(t){const{apiConstants:e}=t.get(r.w.CsaService),{resource:n=I,version:s=p,endpoints:i=N}=e||{};return{resource:n,version:s,endpoints:i}}function ht(t){const{phonelinkSmsApiResource:e}=t.get(r.w.CsaService);return{resource:e||v}}async function dt(t,e,n){const{csaHostOverrideUrl:s}=t.get(r.w.Test),i=`${W}/`;if(s)return(0,o.M4)(s)||i;const{host:a}=t.get(r.w.CsaService).apiConstants||{},{host:c}=t.get(r.w.CsaService).apiConstantsGCC||{};let u=!!t.get(r.w.CsaService).useHostFromGtmTable;if(a?.includes("csa-int")&&(u=!1),u){const s=t.get(r.w.Core).endpointsManagerBaseUrlResolutionTimeoutInMs||P,u=await ct(e,s,n)||c||a||i;return(0,o.M4)(u)}{const t=c||a||i;return(0,o.M4)(t)}}},431779:(t,e,n)=>{"use strict";n.d(e,{$:()=>s});var r=n(193406);function s(t){const e=(0,r.mH)(t,(t=>t.pathname),t,"https://example.com");return decodeURIComponent(e.slice(e.lastIndexOf("/")+1))}},780952:(t,e,n)=>{"use strict";n.d(e,{a:()=>o,W:()=>c});var r=n(446320),s=n(850434),i=n(199448);const a=20;function o(t,e,n,s){return Promise.race([t,(0,r.y)(e).then((()=>{throw s?.abort(),u(e,n)}))]).catch((t=>{if(t instanceof DOMException&&"AbortError"===t.name&&t.code===a)throw u(e,n);throw t}))}const c=t=>t&&t.context===s.Ir.Timed&&t.code===s.O4.TimedOut,u=(t,e)=>(0,i.$5)(s.Ir.Timed,s.O4.TimedOut,s.Ir.Timed,{ms:t},e)},917753:()=>{},612552:()=>{}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/460567-92e3ff2160e62a01.js.map