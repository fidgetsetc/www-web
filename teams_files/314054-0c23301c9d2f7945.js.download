(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[314054],{78727:(e,t,n)=>{e.exports=n.p+"133bf0a0b104ec3dfc5b9ab207e54873.svg"},960935:(e,t,n)=>{e.exports=n.p+"c52bdfa460d7b878541ff0d9833e3c7b.svg"},870586:(e,t,n)=>{e.exports=n.p+"93bf1cc8b8b8092aab2c385d85d22c8d.svg"},834818:(e,t,n)=>{e.exports=n.p+"79f07ba26ed583574678b31546848509.svg"},603313:(e,t,n)=>{e.exports=n.p+"33c8b3e3c8d71273ed9abc4d1bec9bcc.svg"},567322:(e,t,n)=>{e.exports=n.p+"5d07fdf28991f39897b8734021141a6f.svg"},604322:(e,t,n)=>{e.exports=n.p+"0d10d16cedc7b8262d0863ae455bb683.svg"},791542:(e,t,n)=>{e.exports=n.p+"774888c01ebff051c2cad178c17079b3.svg"},118356:(e,t,n)=>{e.exports=n.p+"36fd037c0c6525c9044c5c8ef757c740.svg"},952388:(e,t,n)=>{e.exports=n.p+"5066e146579e847ea9f2d818aab586bb.svg"},152248:(e,t,n)=>{e.exports=n.p+"7aa4c2455abe8a0c8cfa1e8e4b93494c.svg"},444257:(e,t,n)=>{e.exports=n.p+"e0420569cdac40ed7e659a1dae697de8.svg"},25916:(e,t,n)=>{"use strict";n.d(t,{hT:()=>i});n(480354);const i={chat:0,channel:0}},648260:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={Chat:"Chat",EduEmptyState:"EduEmptyState",Meeting:"Meeting",Channel:"Channel",ChannelMeeting:"ChannelMeeting",PrivateMeetingSchedulingForm:"PrivateMeetingSchedulingForm",ChannelMeetingSchedulingForm:"ChannelMeetingSchedulingForm",SingleTeamGridView:"SingleTeamGridView",MeetingChat:"MeetingChat",SelectAppEntity:"SelectAppEntity",ChatMakeAsATab:"ChatMakeAsATab",ChannelMakeAsATab:"ChannelMakeAsATab",TabSdkAPI:"TabSdkAPI",ChatUnifiedApps:"ChatUnifiedApps",ChannelUnifiedApps:"ChannelUnifiedApps"}},380322:(e,t,n)=>{"use strict";var i,r,a,s;n.d(t,{NS:()=>i,AR:()=>a,ld:()=>s}),function(e){e[e.Legacy=1]="Legacy",e[e.Store=2]="Store",e[e.InContextGalleryDialogFromChannel=3]="InContextGalleryDialogFromChannel",e[e.InContextGalleryDialogFromGroupChat=4]="InContextGalleryDialogFromGroupChat",e[e.InContextGalleryDialogMoreAppsFromChannel=5]="InContextGalleryDialogMoreAppsFromChannel",e[e.InContextGalleryDialogMoreAppsFromGroupChat=6]="InContextGalleryDialogMoreAppsFromGroupChat",e[e.Flyout=7]="Flyout",e[e.AppsManagementTabView=8]="AppsManagementTabView",e[e.GroupChatAppsManagementView=9]="GroupChatAppsManagementView",e[e.MoreAppFromSamePublisher=10]="MoreAppFromSamePublisher",e[e.MessagingExtensionFlyoutFromChannel=11]="MessagingExtensionFlyoutFromChannel",e[e.MessagingExtensionFlyoutFromChat=12]="MessagingExtensionFlyoutFromChat",e[e.StoreSideload=13]="StoreSideload",e[e.DeepLink=14]="DeepLink",e[e.ConnectorManagementDialog=15]="ConnectorManagementDialog",e[e.AppsManagementTabUpgrade=16]="AppsManagementTabUpgrade",e[e.GroupChatAppsManagementUpgrade=17]="GroupChatAppsManagementUpgrade",e[e.AppsList=18]="AppsList",e[e.TabSdkSideload=19]="TabSdkSideload",e[e.AppsManagementTabFromTeam=20]="AppsManagementTabFromTeam",e[e.AppsManagementTabFromGroupChat=21]="AppsManagementTabFromGroupChat",e[e.AppSuggestionInEmptyChannel=22]="AppSuggestionInEmptyChannel",e[e.MeetingFromGroupchat=23]="MeetingFromGroupchat",e[e.MeetingFromTeam=24]="MeetingFromTeam",e[e.MessagingExtensionFeaturedItem=25]="MessagingExtensionFeaturedItem",e[e.NewMessageUpgrade=26]="NewMessageUpgrade",e[e.AtMentionDirectInstallationFromTeam=27]="AtMentionDirectInstallationFromTeam",e[e.AtMentionDirectInstallationFromGroupChat=28]="AtMentionDirectInstallationFromGroupChat",e[e.PersonalAppBannerUpgrade=29]="PersonalAppBannerUpgrade",e[e.AppBarNew=30]="AppBarNew",e[e.AppsListNew=31]="AppsListNew",e[e.MessagingExtensionFlyoutV2=34]="MessagingExtensionFlyoutV2",e[e.AppsManagementTabFromTeamSideload=35]="AppsManagementTabFromTeamSideload",e[e.AppsManagementTabFromGroupChatSideload=36]="AppsManagementTabFromGroupChatSideload",e[e.PersonalFlyoutAppSearch=37]="PersonalFlyoutAppSearch",e[e.PersonalAppAbout=38]="PersonalAppAbout",e[e.PersonalFlyoutAppSuggestions=39]="PersonalFlyoutAppSuggestions",e[e.ChannelInfoPaneAppWidgetView=40]="ChannelInfoPaneAppWidgetView",e[e.ChannelInfoPaneAppWidgetUpgrade=41]="ChannelInfoPaneAppWidgetUpgrade",e[e.MoreAppsUsedTogether=42]="MoreAppsUsedTogether",e[e.PowerBar=43]="PowerBar",e[e.StageDeepLink=44]="StageDeepLink",e[e.ManageAppsInstalledApp=45]="ManageAppsInstalledApp",e[e.ManageAppsInstalledAppUpgrade=46]="ManageAppsInstalledAppUpgrade",e[e.LobNotifications=47]="LobNotifications",e[e.OnboardingNotifications=48]="OnboardingNotifications",e[e.StoreEditorialArticles=49]="StoreEditorialArticles",e[e.DiscoverAppsNotifications=50]="DiscoverAppsNotifications",e[e.StoreWorkflows=51]="StoreWorkflows",e[e.JITInstallFromPersonalFlyout=52]="JITInstallFromPersonalFlyout",e[e.AutoInstallAppsNotification=53]="AutoInstallAppsNotification",e[e.DeepLinkSideLoad=54]="DeepLinkSideLoad",e[e.DeepLinkTrustedSideLoad=55]="DeepLinkTrustedSideLoad",e[e.ChatListAbout=56]="ChatListAbout",e[e.MessageExtensionFlyout=100]="MessageExtensionFlyout",e[e.Meeting=101]="Meeting",e[e.JITInstallCardAction=102]="JITInstallCardAction",e[e.CardHeaderInstallAction=103]="CardHeaderInstallAction",e[e.ScenePicker=104]="ScenePicker",e[e.MeetingFromChannel=105]="MeetingFromChannel",e[e.Url=106]="Url",e[e.JITInstallConsentOnCard=107]="JITInstallConsentOnCard",e[e.StoreFREDialog=108]="StoreFREDialog",e[e.AdaptiveCard=109]="AdaptiveCard",e[e.MessageExtensionFlyoutSuggestedCollection=110]="MessageExtensionFlyoutSuggestedCollection",e[e.ProactiveMessageForBots=111]="ProactiveMessageForBots",e[e.JITInstallTaskModule=112]="JITInstallTaskModule",e[e.ExposeBotActions=113]="ExposeBotActions",e[e.MessageExtensionCard=114]="MessageExtensionCard",e[e.MeetingFromDeepLink=115]="MeetingFromDeepLink",e[e.UrlPersonalUpgrade=116]="UrlPersonalUpgrade",e[e.MeetingAppsFlyout=117]="MeetingAppsFlyout",e[e.MeetingAppsFlyoutFromChannel=118]="MeetingAppsFlyoutFromChannel",e[e.ReactMessageExtensionFlyoutFromChannel=119]="ReactMessageExtensionFlyoutFromChannel",e[e.ShareFormDialog=120]="ShareFormDialog",e[e.PlatformAppConsentDialog=121]="PlatformAppConsentDialog",e[e.PlatformTabButtonGroupChat=122]="PlatformTabButtonGroupChat",e[e.PlatformTabButtonTeam=123]="PlatformTabButtonTeam",e[e.CopilotInContextGroupChat=124]="CopilotInContextGroupChat",e[e.CopilotInContextMeeting=125]="CopilotInContextMeeting",e[e.CopilotPluginManagerStoreFront=126]="CopilotPluginManagerStoreFront",e[e.ExtensibilityAppPickerFlyoutGroupChat=127]="ExtensibilityAppPickerFlyoutGroupChat",e[e.ExtensibilityAppPickerFlyoutTeam=128]="ExtensibilityAppPickerFlyoutTeam",e[e.ExtensibilityAppPickerSidePanelGroupChat=129]="ExtensibilityAppPickerSidePanelGroupChat",e[e.ExtensibilityAppPickerSidePanelTeam=130]="ExtensibilityAppPickerSidePanelTeam",e[e.ExtensibilityAppPickerSidePanelPersonal=131]="ExtensibilityAppPickerSidePanelPersonal",e[e.ExtensibilityAppPickerFlyoutPersonal=132]="ExtensibilityAppPickerFlyoutPersonal",e[e.ChannelAppManagementTabView=133]="ChannelAppManagementTabView",e[e.MetaOSHubSDKStoreService=134]="MetaOSHubSDKStoreService",e[e.InContextStorePersonal=150]="InContextStorePersonal",e[e.MEInContextStoreGroupChat=151]="MEInContextStoreGroupChat",e[e.MEInContextStoreTeam=152]="MEInContextStoreTeam",e[e.TabsInContextStoreGroupChat=153]="TabsInContextStoreGroupChat",e[e.TabsInContextStoreTeam=154]="TabsInContextStoreTeam",e[e.BotsInContextStoreGroupChat=155]="BotsInContextStoreGroupChat",e[e.BotsInContextStoreTeam=156]="BotsInContextStoreTeam",e[e.PlatformAppScopeInstall=157]="PlatformAppScopeInstall",e[e.AppRatingCoachmark=158]="AppRatingCoachmark",e[e.PowerbarMessageExtension=159]="PowerbarMessageExtension",e[e.TeamAppBannerUpgrade=160]="TeamAppBannerUpgrade",e[e.GroupChatAppBannerUpgrade=161]="GroupChatAppBannerUpgrade",e[e.DeeplinkBotChat=162]="DeeplinkBotChat",e[e.HostedInContextStore=163]="HostedInContextStore"}(i||(i={})),function(e){e.MeetingAddTab="meeting-add-tab",e.MessageExtensionFlyout="message-extension-flyout",e.UnifiedApps="unified-apps",e.InContextStore="in-context-store",e.PersonalAppFlyout="personal-app-flyout",e.InContextStoreBotMention="in-context-store-bot-mention"}(r||(r={})),function(e){e.AppDetails="AppDetails",e.TCPicker="TCPicker",e.ViewReviews="ViewReviews",e.PostReview="PostReview",e.ReportReview="ReportReview",e.ContextlessConfigPicker="ContextlessConfigPicker"}(a||(a={})),function(e){e.InContext="InContext",e.Update="Update",e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meeting="Meeting",e.RequestAccess="RequestAccess"}(s||(s={}))},43372:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab",e[e.powerbar=3]="powerbar"}(i||(i={}))},845768:(e,t,n)=>{"use strict";var i,r,a,s;n.d(t,{$E:()=>i,lO:()=>r,KN:()=>a,CG:()=>s}),function(e){e.Bot="Bot",e.Connector="Connector",e.MessagingExtension="MessagingExtension",e.Tab="Tab"}(i||(i={})),function(e){e.None="None",e.Files="Files",e.Links="Links",e.Location="Location",e.People="People",e.PinnedMessages="PinnedMessages",e.Photos="Photos",e.Pinned="Pinned",e.Search="Search",e.Tasks="Tasks",e.TimeZone="TimeZone",e.Highlights="Highlights"}(r||(r={})),function(e){e.ORG="org",e.PROJECT="project"}(a||(a={})),function(e){e.ThreadListPane="ThreadListPane",e.L1Pane="L1Pane"}(s||(s={}))},693973:(e,t,n)=>{"use strict";var i,r;n.d(t,{sk:()=>i,$n:()=>r,I6:()=>a,Vt:()=>s,UU:()=>o,EJ:()=>l,Rm:()=>d,_U:()=>c,x_:()=>u,Ko:()=>p}),function(e){e.CONFIGURATIONS="configurations",e.CONTEXTUAL_NOTIFICATIONS="contextual-notifications",e.END="end",e.HEADER="header",e.IN_APP_NOTIFICATIONS="in-app-notifications",e.MAIN="main",e.MID_NAV="mid-nav",e.MODAL="modal",e.MONITOR="monitor",e.NAV="nav",e.NAV_CONTROLS="nav-controls",e.NOTIFICATIONS="notifications",e.PRE_CACHE="pre-cache",e.START="start",e.SUBNAV="sub-nav",e.TITLE_BAR="title-bar",e.TOASTS="toasts"}(i||(i={})),function(e){e.configurations="configurations",e.contextualNotifications="contextualNotifications",e.end="end",e.header="header",e.inAppNotifications="inAppNotifications",e.main="main",e.midNav="midNav",e.modal="modal",e.monitor="monitor",e.nav="nav",e.navControls="navControls",e.notifications="notifications",e.preCache="preCache",e.start="start",e.subNav="subNav",e.titleBar="titleBar",e.toasts="toasts"}(r||(r={}));const a={[i.CONFIGURATIONS]:r.configurations,[i.CONTEXTUAL_NOTIFICATIONS]:r.contextualNotifications,[i.END]:r.end,[i.HEADER]:r.header,[i.IN_APP_NOTIFICATIONS]:r.inAppNotifications,[i.MAIN]:r.main,[i.MID_NAV]:r.midNav,[i.MODAL]:r.modal,[i.MONITOR]:r.monitor,[i.NAV_CONTROLS]:r.navControls,[i.NAV]:r.nav,[i.NOTIFICATIONS]:r.notifications,[i.PRE_CACHE]:r.preCache,[i.START]:r.start,[i.SUBNAV]:r.subNav,[i.TITLE_BAR]:r.titleBar,[i.TOASTS]:r.toasts};var s,o,l;!function(e){e.DEFAULT="default",e.FOLDED="folded",e.UNFOLDED="unfolded"}(s||(s={})),function(e){e.INLINE="inline",e.OVERLAY="overlay"}(o||(o={})),function(e){e.DISPLAY_MODE="displayMode",e.FOLD_STATE="foldState",e.LEGACY_FOLD_STATE="legacyFoldState",e.HEIGHT="height",e.IS_HIDDEN="isHidden",e.WIDTH="width"}(l||(l={}));const d={minimal:"minimal",focus:"focus",standard:"standard",minimode:"minimode",immersive:"IMMERSIVE"},c=360,u=360,p=250},115100:(e,t,n)=>{"use strict";n.d(t,{Jj:()=>i,SN:()=>r,Oe:()=>a,As:()=>o,OJ:()=>l});var i,r,a,s=n(693973);!function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(i||(i={})),function(e){e.LINE_LOADER="line-loader"}(r||(r={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.PHASE_STATE_MACHINE_DISPOSED="phase-state-machine-disposed",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(a||(a={}));const o={[s.sk.HEADER]:{height:{collapsed:"6.1rem",expanded:"30rem",expandedSmall:"22rem"}},[s.sk.TITLE_BAR]:{height:{standard:"4.8rem",focus:"3.2rem"}}},l="resize-divider-focused"},678937:(e,t,n)=>{"use strict";var i;n.d(t,{B:()=>i}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod",e.fr="fr",e.de="de"}(i||(i={}))},932873:(e,t,n)=>{"use strict";var i,r,a;n.d(t,{pG:()=>i,Ly:()=>r,Mv:()=>a}),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter",e.ChannelListSearchFilter="channelListSearchFilter",e.CallingPerf="callingPerf",e.TeamsAndChannelsTable="teamsAndChannelsTable",e.DiscoverSurfaceFeedList="discoverSurfaceFeedList",e.AllChannelSystemMessages="channelInfoPaneAllSystemMessages",e.AllPinnedPosts="channelInfoPaneAllPinnedPosts",e.UnifiedFunPicker="unifiedFunPicker",e.CreateTeamGallery="createTeamGallery",e.AddMember="addMember",e.MeetForWorkList="meetForWorkList",e.MeetForWorkSearchFilter="meetForWorkSearchFilter",e.PeopleAppContactList="peopleAppContactList",e.SimpleCollabLeftRail="simpleCollabLeftRail",e.UserOnboardingToTeam="UserOnboardingToTeam",e.TrinityChannelsTab="TrinityChannelsTab",e.SliceViewMessgeList="SliceViewMessgeList",e.ThreadList="ThreadList"}(i||(i={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChannelInfoPane="channelInfoPane",e.ChannelSettings="channelSettings",e.ChatList="chatList",e.Communities="communitites",e.ConvUxChannelL1="convUxChannelL1",e.ConvUxChannelL2="convUxChannelL2",e.ConvUxChannelL1RightPane="convUxChannelL1RightPane",e.ConvUxChannelL2RightPane="convUxChannelL2RightPane",e.ThreadedChatL1="threadedChatL1",e.ThreadedChatL2="threadedChatlL2",e.ThreadedChatL1RightPane="threadedChatL1RightPane",e.ThreadedChatL2RightPane="threadedChatL2RightPane",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.FlyoutPeopleL2="flyoutPeopleL2",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate",e.ChannelList="ChannelList",e.ManageThreadMembers="manageThreadMembers",e.ManageChannelThreadMembers="manageChannelThreadMembers",e.ManagePrivateChannelThreadMembers="managePrivateChannelThreadMembers",e.ManageSharedChannelThreadMembers="manageSharedChannelThreadMembers",e.ManageTeams="manageTeams",e.ChannelInvitationsTab="channelInvitationsTab",e.DiscoverSurface="discoverSurface",e.ThreadMembersSearch="threadMembersSearch",e.SharedChannelPendingInvites="sharedChannelPendingInvites",e.PendingJoinRequests="pendingJoinRequests",e.SelectPeoplePickerExtensibility="selectPeoplePickerExtensibility",e.ChannelsTable="channelsTable",e.SpeedDial="SpeedDial",e.CommunitiesJoinRequests="communitiesJoinRequests",e.PeopleApp="peopleApp",e.CommentStreamChatPane="commentStreamChatPane",e.FollowPresenceSettings="followPresenceSettings",e.MentionSliceList="MentionSliceList",e.ActivitiesMentionsSliceList="ActivitiesMentionsSliceList",e.ActivitiesMentionsTagSliceList="ActivitiesMentionsTagSliceList",e.ActivitiesRepliesSliceList="ActivitiesRepliesSliceList"}(r||(r={})),function(e){e.HeartbeatMonitor="HeartbeatMonitor",e.CallingPerfMonitor="CallingPerfMonitor"}(a||(a={}))},712839:(e,t,n)=>{"use strict";var i,r,a,s,o,l;n.d(t,{bY:()=>i,gG:()=>r,n3:()=>a,f4:()=>s,r$:()=>o,BN:()=>l}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(i||(i={})),function(e){e.installed="installed",e.notInstalled="notInstalled",e.preconsented="preconsented"}(r||(r={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(a||(a={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig",e[e.storeapp=9]="storeapp",e[e.workflows=10]="workflows",e[e.virtualEvent=11]="virtualEvent",e[e.personalApp=12]="personalApp",e[e.stageViewOpenSDKApi=13]="stageViewOpenSDKApi",e[e.personalAppsFlyout=14]="personalAppsFlyout",e[e.personalAppsFlyoutSearch=15]="personalAppsFlyoutSearch",e[e.botFeedback=16]="botFeedback",e[e.chatRosterItem=17]="chatRosterItem"}(s||(s={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(o||(o={})),function(e){e.carousel="carousel",e.list="list"}(l||(l={}))},339953:(e,t,n)=>{"use strict";var i;n.d(t,{k:()=>i}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary",e.minimode="minimode",e.immersive="immersive"}(i||(i={}))},622229:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>i}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(i||(i={}))},867491:(e,t,n)=>{"use strict";var i,r,a,s;n.d(t,{GM:()=>i,zl:()=>r,bG:()=>s}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(i||(i={})),function(e){e.flyout="flyout",e.main="main",e.minimode="mini",e.notifications="notifications"}(r||(r={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsBlackBoard="BlackBoard",e.lmsCanvas="Canvas",e.lmsMoodle="Moodle",e.lmsBrightspace="Brightspace",e.lmsOther="OtherLMS",e.lmsOpenLMS="OpenLMS",e.lmsSchoology="Schoology",e.unknown="unknown",e.thirdParty="ThirdParty",e.dynamics="Dynamics",e.onePlayer="OnePlayer",e.devHost="DevHost",e.edge="Edge",e.purview="Purview",e.mesh="Mesh"}(a||(a={})),function(e){e.userInitiated="userInitiated"}(s||(s={}))},883970:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("mutation DataClientPlatformUpdateInContextStoreLaunchInstalledAppResultMutation($input:InContextStoreLaunchInstalledAppInput!) {updateInContextStoreLaunchInstalledAppResult(input:$input) @client}");return delete this.definitions,this.definitions=e.definitions}}},983168:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment consumptionHorizonBookmarkFields on ConsumptionHorizonBookmark {id,originalArrivalTime,timeStamp,clientMessageId}");return delete this.definitions,this.definitions=e.definitions}}},410703:(e,t,n)=>{"use strict";n.d(t,{U:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment consumptionHorizonFields on ConsumptionHorizon {id,originalArrivalTime,timeStamp,clientMessageId}");return delete this.definitions,this.definitions=e.definitions}}},2986:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonActiveCallFragment on ActiveCallOfConversation {id,callType}");return delete this.definitions,this.definitions=e.definitions}}},358809:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatAddMembersFragment on Conversation {id,cfet,chatSubType,guardianChatInfo,hasFederatedUser,hasTflConsumerUser,hasTflSmsUnverifiedUser,hasTflSmsVerifiedUser,isMeeting,isOneOnOne,isOneOnOneBotChat,isUserMember,memberIds,tflOffNetworkUserLength,tenantId,title,interopConversationStatus,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant},membersLimited {id,isFederated},botMembers {id},meetingChatType}");return delete this.definitions,this.definitions=e.definitions}}},69886:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatMtoTelemetryFragment on Conversation {id,hasFederatedMTOUser}");return delete this.definitions,this.definitions=e.definitions}}},731687:(e,t,n)=>{"use strict";n.d(t,{F:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatPaneLayoutFragment on Conversation {id,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant}}");return delete this.definitions,this.definitions=e.definitions}}},239082:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatPinnedMessageFragment on Message {id,content,from,imDisplayName,messageType,originalArrivalTime,deleteTime,isSkypeMessage,files {id,itemId,type,title},cards {name,content,contentType,appId}}");return delete this.definitions,this.definitions=e.definitions}}},733043:(e,t,n)=>{"use strict";n.d(t,{W:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatRecapFragment on Conversation {id,hasRecap}");return delete this.definitions,this.definitions=e.definitions}}},540281:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatSmartCardInfoFragment on Conversation {id,smartCardInfo {id,summaryStartTime,unreadMessageCount,unreadMessagesContentLength},notes {id,isSynthesisAvailable,showConvergedUx},isMeeting,meetingInformation {id,iCalUid,meetingType,endTime,organizerId,tenantId},activeCall {id}}");return delete this.definitions,this.definitions=e.definitions}}},819972:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatWithMtoUserBannerFragment on Conversation {id,firstMtoMember {id,homeMri,displayName},mtoHomeUserInfo {shouldChatWithFederatedIdentities,areAllChatMembersReachableInTheirHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}}},741357:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonRecordingMessageMiFragment on MeetingInformation {id,meetingType,startTime,templateDetails {id}}");return delete this.definitions,this.definitions=e.definitions}}},930427:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonUseExternalTagFragment on Conversation {id,cfet,creator,hasFederatedUser,hasTflConsumerUser,isFederated,isExternal,isMeeting,isOneOnOne,tflOffNetworkUserLength,memberIds,membersLimited {id,displayName,givenName,isFederated}}");return delete this.definitions,this.definitions=e.definitions}}},366554:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonUseMtoUserBannerFragment on Conversation {id,shortTitle,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}}},160606:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment lastMessageFields on LastMessage {content,originalArrivalTime,imDisplayName,id,clientMessageId,from,messageType,deleteTime,mentions {id,itemId,userId,displayName,mentionType},importance,files {id},cards {appIcon,appId,appName,cardClientId,content,contentType,locale,sourceType}}");return delete this.definitions,this.definitions=e.definitions}}},875094:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment pinnedMessageItemFields on Message {id}");return delete this.definitions,this.definitions=e.definitions}}},109587:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment userPresenceData on Presence {id,availability,activity,isOutOfOffice,statusNote {message,publishTime,expiry},flwPresence,flwShifts {previousShift {teamId,teamName,startTime,endTime,scheduleGroupDisplayName,teamOlsonCode},currentShift {teamId,teamName,startTime,endTime,scheduleGroupDisplayName,teamOlsonCode},nextShift {teamId,teamName,startTime,endTime,scheduleGroupDisplayName,teamOlsonCode}},isFocus,workLocation {location,locationSource,approximateDetails {id,name,idType}},isBlocked,isDisabled}");return delete this.definitions,this.definitions=e.definitions}}},969037:(e,t,n)=>{"use strict";n.d(t,{z:()=>r,x:()=>a});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment featureSettingsFields on UserFeatureSettingsInfo {coExistenceMode,isPrivateChatEnabled}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("fragment userFields on User {id,objectId,displayName,decoratedDisplayName,givenName,surname,email,emailsInfo {address,isPrimary},tenantId,tenantName,isFederated,jobTitle,department,featureSettings {...featureSettingsFields},type,profileType,userType,trustworthy {trustLevel,trustReason,trustLabel}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions]}}},264345:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment userProperties on ConversationUserProperties {isMutedInChannel,role,maskId}");return delete this.definitions,this.definitions=e.definitions}}},92001:(e,t,n)=>{"use strict";n.d(t,{lu:()=>i,fO:()=>r});const i=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},r=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e))},347590:(e,t,n)=>{"use strict";n.d(t,{NX:()=>W,Lm:()=>_,PN:()=>X,qd:()=>G,Kj:()=>J,Uv:()=>Z,oq:()=>H,Dc:()=>At,vc:()=>Ve,Lv:()=>Fe,f4:()=>Se,jI:()=>Te,qU:()=>Ae,KH:()=>ct,BO:()=>me,QM:()=>Ie,UL:()=>Pe,Wk:()=>Oe,of:()=>ht,Sd:()=>It,PH:()=>gt,__:()=>dt,Fz:()=>ut,ic:()=>Et,gj:()=>ft,l7:()=>mt,wD:()=>st,fc:()=>pt,zX:()=>Mt,Rx:()=>Dt,S3:()=>he,XO:()=>De,Xq:()=>Ne,OB:()=>He,FC:()=>Ze,hE:()=>Je,FQ:()=>be,fO:()=>Le,jp:()=>fe,qQ:()=>Ye,dM:()=>ue,fi:()=>$,bo:()=>re,nT:()=>Xe,RE:()=>qe,_u:()=>Me,TH:()=>ye,Ox:()=>lt});var i=n(754255),r=n(726723),a=n(572909),s=n(878336),o=n(343468),l=n(719816),d=n(806658),c=n(84646),u=n(504856),p=n(580458),g=n(851433),m=n(645095),h=n(797922),I=n(680499),M=n(737915),f=n(431779),A=n(193406),T=n(668625),N=n(639884),y=n(280683),C=n(480354),S=n(832901),b=n(810886),D=n(717828),E=n(800079),U=n(199448),w=n(850434);const v=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let n=x(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:i,eventRecurrencePattern:r}=e;return n=[...n,...L(i,t),...k(r,t)],n},L=(e,t)=>x(e,["startDate"],`${t}.eventRecurrenceRange`),k=(e,t)=>{let n=[];if(e){const{daily:i,weekly:r,monthly:a,yearly:s,relativeMonthly:o,relativeYearly:l}=e;n=[...x(e,["patternType"],`${t}.eventRecurrencePattern`),...x(i,["interval"],`${t}.eventRecurrencePattern.daily`),...x(r,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...x(a,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...x(s,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...x(o,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...x(l,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],r&&r.daysOfTheWeek&&r.daysOfTheWeek.some((e=>(0,C.isNil)(e)))&&n.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return n},x=(e,t,n)=>{const i=[];return(0,C.isNil)(e)||t.forEach((t=>{(0,C.isNil)(e[t])&&i.push(`${n}.${String(t)}`)})),i};var F=n(435793),O=n(906166),P=n(92001),j=n(921987);const R=e=>e&&e.vivaTopicsAnnotations?(e=>{try{return(e=>{const{ApiVersion:t,EntityAnnotation:n,TraceId:i,ClientRequestId:r}=e,{SectionMatches:a}=n;return{apiVersion:t,entityAnnotation:{sectionMatches:a.map((e=>{const{EntityMatches:t,SectionId:n}=e;return{entityMatches:t.map((e=>{const{Entities:t,HighlightedName:n,Length:i,StartPos:r,OccurrenceIndex:a,TotalOccurrences:s,Relevance:o}=e;return{entities:t.map((e=>{const{DisplayName:t,Id:n,RelevanceScore:i,Source:r,Type:a}=e;return{displayName:t,id:n,relevanceScore:i,source:r,type:a}})),highlightedName:n,length:i,startPos:r,occurrenceIndex:a,totalOccurrences:s,relevance:{annotationScore:o.AnnotationScore}}})),sectionId:n}}))},traceId:i,clientRequestId:r}})((0,j.n)(e))}catch(e){return}})(e.vivaTopicsAnnotations)??null:null;var z=n(37321);const B="http://schema.skype.com",V=`${B}/Mention`,_=`${B}/File`,W=2,Q=f.$,Y=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]),G="preview-",Z="newchat",H="welcomePage",J="bizChatMetaOSChatListEntryPoint",X="holisticRecapChatListEntryPoint",q=(e,t,n,i=!1)=>{if(!e?.emotions)return null;const r=e.emotions.map((({key:e,users:n})=>({key:e,users:n.map((({mri:n,time:i,value:r})=>({id:(0,y.z)(Q(n),t,e),time:i,value:r,userId:Q(n)}))).sort(((e,t)=>e.time-t.time))})));return i&&r.sort(((e,t)=>(n?.emotions?.[t.key]??t.users.length??0)-(n?.emotions?.[e.key]??e.users.length??0))),r},K=e=>{if(!e||!e.emotions)return null;const t=e.emotions;return Object.keys(t).map((e=>({key:e,count:t[e]})))},$=(e,t,n)=>e&&e.mentions?ne(e.mentions,t,n):null,ee=(e,t,n)=>e&&e.onbehalfof?ne(e.onbehalfof,t,n):null,te=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},ne=(e,t,n)=>{try{if("string"==typeof e&&(0,d.AF)(e))return null;const n="string"==typeof e?JSON.parse(e):e;return n?.length?n.map((({itemid:e,mri:n,displayName:i,mentionType:r})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,displayName:i,mentionType:r}))):null}catch(e){const i=n?.newLogger("Chat Helper","data-resolvers-common");return i?.errorToTelemetry?.(`UnhandledException in messageId: ${t}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},ie=(e,t,n,i)=>{if(!t||!t.files)return null;const r=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(t?.files),a=0;return e=e.filter((e=>"deeplink"===e.type)),a=e.length,e=e.filter((e=>e)),a!==e.length&&(r?.errorToTelemetry?.(`toDeepLinks::Files contains falsy value. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),a=e.length),e=e.filter((e=>e.id)),a!==e.length&&r?.errorToTelemetry?.(`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),e.map((({id:e,title:t,fileInfo:n,channelId:r,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:r||i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return r?.errorToTelemetry?.(`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),null}},re=e=>e&&JSON.stringify((0,C.map)(e,(({content:e,...t})=>({...t,content:JSON.parse(e)})))),ae=(e,t,n,i)=>{const r=i||!!e?.urlpreviews;if(!e||!e.links&&!e.urlpreviews)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],i=r?JSON.parse(e.urlpreviews):JSON.parse(e.links),a=[],s=[];return i.forEach((e=>{se(e,a,t),r?le(e,s,t):oe(e,s,[...t,"blob"],n)})),{urlPreview:s.length>0?s[0]:null,embeddedLinks:a}}catch(e){return t.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},se=(e,t,n)=>{const{url:i,fileShareUrlMeta:r,title:a,description:s}=e,o=(0,A.Jf)(i,n);r&&t.push({objectUrl:o,title:a,description:s,fileShareUrlMeta:r})},oe=(e,t,n,i)=>{const{url:r,preview:a,previewenabled:s}=e,{previewurl:o,previewmeta:l,title:d,description:c}=a||{},u=(0,A.Jf)(r,n,i);t.push({url:u,thumbnail:(0,A.Jf)(o,n,i),title:d,description:c,previewEnabled:s,thumbnailMeta:l?{width:l.width,height:l.height}:null})},le=(e,t,n)=>{const{url:i="",title:r,description:a,thumbnail:s="",thumbnail_meta:o}=e.value||{},l=(0,A.Jf)(i,n);t.push({url:l,thumbnail:(0,A.Jf)(s,n),title:r,description:a,previewEnabled:!!s,thumbnailMeta:o?{width:o.width||0,height:o.height||0}:null})},de=(e,t,n,i)=>{let r=i&&i.policyViolation;const a=i&&i.genericStreamMetadata;if(!r&&!a)return null;const s={};if("string"==typeof r)try{r=JSON.parse(r)}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}r&&(s.policyViolation=r);let o=a&&a.policyTip;if("string"==typeof a)try{o=JSON.parse(a).policyTip}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}if(o){const e=i&&i.subject;s.dlpData={id:t,content:n,policyTip:o,subject:e}}return s},ce=e=>{if(!e.scheduledmeetinginfo||(0,C.isNil)(e.scheduledmeetinginfo.eventType))return null;const{iCalUid:t,...n}=e.scheduledmeetinginfo;return{iCalUID:t,...n}},ue=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:r,location:a,itemid:s,meetingtitle:o,rsvpTo:l,body:d}=e;return(e=>{const{scheduledMeetingInfo:t}=e,n=v(t);if(n.length)throw(0,U.$5)(w.Ir.DataLayerClient,w.O4.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${n.join(", ")}`);return e})({meetingActionType:e[c.rF.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:r,location:a,itemId:s,meetingTitle:o,rsvpTo:l,body:d,scheduledMeetingInfo:ce(e)})}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${t}`),null}},pe=(e,t,n,i)=>{const r=t||n;if(r)return r;if(i&&Y.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},ge=(e,t)=>"-1"===e?t??"":e,me=(0,l.A)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),he=(e,t)=>{if(e.length<=1)return e;const n=me(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},Ie=(e,t,n)=>{const i=he(e,n),r=[],a=[];return(0,C.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!E.af.isTFLOffNetworkUser(n)&&i){if(a.push(i),20===a.length)return!1;r.length<3&&r.push(e)}return!0})),{membersLimited:r,memberDisplayNamesLimited:a}},Me=(e,t,n,i,r,a,o,l,c,p,g,m)=>{if(!e?.id)return;const{id:h,messagetype:I,properties:M,callId:f,skypeguid:A,composetime:T,content:N,contentHash:y,conversationid:C,crossPostData:S}=e,b=(0,u.io)(M,e.originalarrivaltime,(0,d.Hv)({conversationLink:e.conversationLink}),n),D=fe(e,t,r,a,i,!!o,m,b),E=(0,O.UM)(t,M?.languageStamp,l?.targetLanguageCode,N,p),U=(0,O.qt)(l,E,D.translatedContent,D.translationStatus),w=R(M),v=(0,O.rl)(h,E?.code,c);return{...D,__typename:"Message",__model:e,contentHash:y,interopDeliveryState:Ct(M?.deliveryState),smsDeliveryReports:M&&M.smsDeliveryReports?M.smsDeliveryReports:null,announcement:De(M),notification:Tt(t,M),notifications:yt(t,M),meeting:ue(t,M),onBehalfOf:ee(M,h,t),callId:pe(I,f,A||M&&M.skypeguid,N),skypeguid:A,composeTime:T,isCallStartedMessage:(0,s.dG)(N,I),replyPermission:M?.replyPermission??null,atpSharepointData:te(t,M),isDeletedByAdmin:M?.adminDelete||!1,conversationId:C,vivaTopicsAnnotations:w,crossPostStatus:S?(0,P.lu)(S.status):void 0,crossPostFailedChannels:S?.failedChannels,isWrittenInPreferredLanguage:!U,languageSeenBefore:v,sourceLanguageCode:E?.code??null,repliesSummary:g,parentMessageId:(0,d.gB)(e.conversationLink,D.id||"")}},fe=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:r,annotationsSummary:a,userHasStarred:s,properties:o,clientmessageid:l,version:c,prioritizeimdisplayname:u,imdisplayname:g,translation:m,conversationid:h,conversationLink:I,sendPipelineStatus:M,draftDetails:f},A,T,N,y,C=!1,b,D=!1)=>{let E=t;T&&(E=T);const U=(0,z.LA)(A,o,N),w=(0,O.eQ)(m),v="Done"===w?.translationStatus?(0,F.yT)()[0].toString():c,L=(0,O.UM)(A,o?.languageStamp),k=(0,d.A$)(f);return{id:ge(e,l),content:E,originalArrivalTime:n,from:Q(i),messageType:(0,p.h)(A,r,o),isImportant:(0,S.IA)(o?.importance),importance:(0,S.mJ)(o?.importance),emotionsSummary:K(a),emotions:q(o,e,a,C),mentions:$(o,e,A),cards:U,files:(0,z.Fx)(A,o),deeplinks:ie(A,o,e,h||I),...ae(o,A,b,D),deleteTime:o?.deletetime,editTime:o?.edittime,scheduledSendTime:k?new Date(k).toISOString():null,draftId:o?.draftId||(k?e:null),version:v,userHasSaved:s,renamedDisplayName:u?g:null,imDisplayName:g,clientMessageId:l,dlpContext:de(A,e,t,o),atpSharepointData:te(A,o),status:y||"Delivered",hardDeleteReason:o?.hardDeleteReason,hardDeleteTime:o?.hardDeleteTime,onBehalfOf:ee(o,e,A),sourceLanguageCode:L?.code??null,...w,sendPipelineStatus:M}};function Ae(e,t){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,importance:null,mentions:null,clientMessageId:e,isSystemMessage:!1,isStreamOngoing:!1,canShowEveryoneMentionBadge:!1,formattedArrivalTime:null,hasMention:null}}function Te(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,D.sN)()}}function Ne(e){const t=new Date,n=t.toISOString();return{__typename:"Conversation",id:e,activeCall:null,ariaLabelledBy:null,arrivalTimeAriaLabel:null,avatarUrl:null,cfet:!1,chatHistoryHiddenTime:null,clearHistoryTime:null,clientArrivalTime:null,creator:null,extendedDirectoryRedemptionRequired:null,guardianChatInfo:null,hasFederatedUser:!1,hasGuestUser:!1,hasMissedCall:null,hasMissedMention:null,hasMissedReaction:null,hasTflConsumerUser:!1,hasTflSmsUser:null,hasTflSmsVerifiedUser:!1,hasTypingUsers:null,hasUnknownEnterpriseUser:!1,interopConversationStatus:null,isBotBlocked:null,isBotMember:null,isDisabled:!1,isExternal:null,isFederated:!1,isHidden:null,isMeeting:!1,isMuted:null,isOneOnOne:!1,isOneOnOneBotChat:!1,isPhonelinkSmsChat:null,isRead:!0,isSfB:!1,isSmsOnly:null,isTFWSmsChat:null,isUserMember:!0,lastContentMessageTime:null,lastMessage:Ae(t.getTime().toString(),n),lastUpdate:null,localClientId:null,me:null,meetingChatType:null,memberCount:null,membersLimited:[],oneOnOneOtherMemberId:null,picture:null,quarantineCounter:null,sensitivityLabel:null,shortTitle:null,tenantId:null,tflOffNetworkUser:null,tflOffNetworkUserLength:null,title:"",userConsumptionHorizon:null}}const ye=(e,t,n,i,r=!1,a)=>{const{annotationsSummary:s,id:o,from:l,messageType:d,properties:c,version:g,...m}=e;if(!o)return null;const h=(0,u.io)(c,m.originalArrivalTime,t,i);try{const e=R(c);return{__typename:"Message",__model:null,id:o,from:l,messageType:(0,p.h)(n,d,c),version:(0,C.isNumber)(g)?g.toString():void 0,isImportant:(0,S.IA)(c&&c.importance),importance:(0,S.mJ)(c&&c.importance),interopDeliveryState:Ct(c?.deliveryState),smsDeliveryReports:c?.smsDeliveryReports||null,emotions:q(c,o,s,r),emotionsSummary:K(s),announcement:De(c),mentions:$(c,o,n),onBehalfOf:ee(c,o,n),cards:(0,z.LA)(n,c),files:(0,z.Fx)(n,c),deeplinks:ie(n,c,o,t),...ae(c,n,a,h),deleteTime:c&&c.deletetime,editTime:c&&c.edittime,isDeletedByAdmin:c&&c.adminDelete,scheduledSendTime:c?.sendAt||null,draftId:c?.draftId||null,hardDeleteTime:c&&c.hardDeleteTime,hardDeleteReason:c&&c.hardDeleteReason,status:"Delivered",dlpContext:de(n,o,m.content,c),meeting:ue(n,c),callId:c&&c.skypeguid,sourceLanguageCode:(0,O.UM)(n,c?.languageStamp)?.code??null,vivaTopicsAnnotations:e,...m}}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{__model:null,id:o,from:l,messageType:(0,p.h)(n,d,c),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null,...m}}},Ce=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),Se=(e,t,n,i)=>be({id:e,properties:{[c.H0.ConsumptionHorizon]:(0,g.cc)(i)},threadProperties:n,type:t}),be=e=>({id:e.id,...Ce((0,g.Yg)(e))}),De=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e?.cards)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const r=Ee(i);return{title:e.title?e.title:"",originalImageUrl:r.originalImageUrl,croppedImageUrl:r.croppedImageUrl,colorTheme:r.colorTheme,croppedImageHeight:r.croppedImageHeight,croppedImageWidth:r.croppedImageWidth,croppedImageAltText:r.croppedImageAltText,isTeamsIllustration:r.isTeamsIllustration}},Ee=e=>{let t=(0,C.get)(e,"content.imageData.origImage.src",null),n=(0,C.get)(e,"content.imageData.croppedImage.src",null);const i=(0,C.get)(e,"content.imageData.croppedImage.imageHeight",null),r=(0,C.get)(e,"content.imageData.croppedImage.imageWidth",null),a=(0,C.get)(e,"content.imageData.croppedImage.imageAltText",null),s=(0,C.get)(e,"content.imageData.isTeamsIllustration",null);let o=(0,C.get)(e,"content.imageData.colorTheme",null)||(0,C.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,o=void 0===o?null:o,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:r,croppedImageAltText:a,colorTheme:o,isTeamsIllustration:s}},Ue=(e,t,n)=>{try{const n=we(t),i=n?.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>e?.channelData?.id&&e?.channelData?.utcTime)).map((e=>{const n={targetMessageId:e?.channelData?.targetMessageId||t.replyToId,type:e?.channelData?.type||"reply"};return{suggestionChannelData:{...e?.channelData,...n},value:e.value||e.title,title:e.title,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},we=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>e?.type===c.jQ&&e?.from?.id===c.OD&&e?.timestamp&&e?.suggestedActions?.actions?.some((e=>e.type===c.m8||e.type===c.Wg))));return t&&0!==t.length?t:null},ve=e=>{switch(e){case m.Wf.None:return"Unknown";case m.Wf.Adhoc:return"Adhoc";case m.Wf.Scheduled:return"Scheduled";case m.Wf.Recurring:return"Recurring";case m.Wf.Broadcast:return"Broadcast";case m.Wf.MeetNow:return"MeetNow"}},Le=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function ke(e,t){if(!e||!t)return!1;return(0,h.CF)(e,t,!t.get(i.w.Messaging).disableIgnoreRetentionHorizon)>0}function xe(e,t,n,i,r,a=!1,s=!1,o,l,c=!1){const u=(0,z.vu)(e,n),p=e.find((({id:e})=>e===t))||null,g=ot(e),m=(0,d.Yo)(e,r,[],o).members||[];return{memberIds:m.map((({id:e})=>e)),...Ie(m,t,i),...Fe(u),...Ve(t,m),me:p,isUserMember:!!p,tflOffNetworkUser:(0,C.first)(g),tflOffNetworkUserLength:g.length,hasBotMember:m.some((({id:e})=>(0,d.Iz)(e))),hasFederatedUser:!!u.length||a,hasTflConsumerUser:Pe(m)||s,hasEnterpriseUser:Be(m),hasUnknownEnterpriseUser:ze(m),hasUnknownConsumerUser:Re(m),hasUnresolvedFederatedUser:u.some(E.af.isUnknownUser),hasTflSmsUnverifiedUser:Oe(m),hasTflSmsVerifiedUser:je(m),isRetentionHorizonSet:ke(l,o),hasExtendedDirectoryUsers:St(m),pendingBots:bt(l),hasGuestUser:c}}const Fe=e=>{const t=e.filter((e=>!E.af.isUnknownUser(e)&&e.featureSettings?.coExistenceMode!==o.bi.TeamsOnly&&!!e.displayName));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},Oe=e=>e.some((({id:e})=>(0,d.gZ)(e))),Pe=e=>e.some((e=>E.af.isTFLConsumerUser(e))),je=e=>e.some((e=>E.af.isTFLSmsVerifiedMri(e?.id))),Re=e=>e.some((e=>(0,d.W4)(e.id)&&E.af.isUnknownUser(e))),ze=e=>e.some((e=>E.af.isEnterpriseUserMri(e.id)&&E.af.isUnknownUser(e))),Be=e=>e.some((e=>E.af.isEnterpriseUserMri(e.id))),Ve=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&!(0,d.oG)(t.id,c.LE)&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},_e={opted_out:"OptedOut",claimed:"Claimed",deprovisioned:"Deprovisioned"},We=e=>{if(!e)return;const t=(0,T.j)(e);return{newlyCreatedUserId:t.userId,code:_e[t.code]}},Qe=e=>{if(e)return(0,N.K)()("Importing","Completed").find((t=>t===e))},Ye=(e,t)=>({...t,preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__model:e||null,__typename:"LastMessage"}),Ge=e=>e?`${e}`:null,Ze=({id:e,members:t,consumptionHorizon:n,userConsumptionHorizon:i,lastMessage:r,creator:a,meetingInformation:s,isDisabled:o,disabledReason:l,importState:d,isMuted:u,isLastMessageFromMe:p,isRead:g,isOneOnOne:m,isOneOnOneBotChat:h,isSticky:I,isExternal:M,consumerGroupId:f,templateType:A,chatType:T,historyHiddenTime:N,createdAt:y,interopConversationStatus:S,quickReplyAugmentation:D,meetingPolicy:E,addedBy:U,addedByTenantId:w,sensitivityLabel:v,meetingChatType:L,lastL2MessageIdNFS:k,...x},F,O,P,j,R)=>{try{const N=(0,C.map)(t,(e=>(0,b.qK)(e))),y=r&&Ye(r,ye(r,e,F,P)),z=s&&{id:e,subject:s.subject,startTime:s.startTime,scenario:s.scenario,endTime:s.endTime,iCalUid:s.iCalUid,location:s.location,exchangeId:s.exchangeId,meetingType:s.meetingType?ve(s.meetingType):"Unknown",resolvedSensitivityLabelId:s.resolvedSensitivityLabelId,isCopyRestrictionEnforced:s.isCopyRestrictionEnforced,templateDetails:s.templateDetails,meetingJoinUrl:s.meetingJoinUrl,messagingPolicy:s.messagingPolicy,exchangeDetails:s.exchangeDetails,lobbyThreadId:s.lobbyThreadId},B=!(!m&&!I&&A!==c.iy.ImmutableRoster),V=v&&v.id?{id:v.id,isCopyBlocked:v.protectTeamsLabelAction?.isCopyRestrictionEnforced||!1}:void 0,_=Ge(k);return{__typename:"Conversation",...xe(N,j?.id||"",O,R),...x,id:e,consumptionHorizon:n&&{__typename:"ConsumptionHorizon",...Se(e,c.Cr.Chat,{lastjoinat:x.lastJoinAt},n)},consumptionHorizonBookmark:i&&{__typename:"ConsumptionHorizonBookmark",...Se(e,c.Cr.Chat,{lastjoinat:x.lastJoinAt},i)},userConsumptionHorizon:i&&{__typename:"ConsumptionHorizonBookmark",...Se(e,c.Cr.Chat,{lastjoinat:x.lastJoinAt},i)},lastL2MessageIdNotFromSelf:_,lastMessage:y,members:[],creator:a,meetingInformation:z,isDisabled:!!o,disabledReason:We(l),importState:Qe(d),isMuted:u,isLastMessageFromMe:!!p,isRead:g,isOneOnOne:B,cfet:M,consumerGroupId:f,isOneOnOneBotChat:!!h,chatType:$e(T),interopConversationStatus:tt(S),quickReplyAugmentation:D&&Ue(e,D,F),addedBy:U,addedByTenantId:w,meetingChatPolicy:it(E),sensitivityLabel:V,meetingChatType:at(L)}}catch(t){F.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{...x,id:e,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:N,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null}}},He=({id:e,members:t,tenantId:n,meetingInformation:i},r)=>{try{const r=(0,C.map)(t,(e=>(0,b.qK)(e)));return{__typename:"ConversationMembers",id:e,tenantId:n=n??"",meetingJoinUrl:i?.meetingJoinUrl??"",members:r}}catch(t){r.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},Je=(e,t,n,i,r,a)=>({node:Ze(e,t,n,i,r,a),cursor:e.createdAt||e.id});function Xe(e){return JSON.stringify((0,C.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":V,itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}function qe(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const t=e.mentionType,n=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const Ke=new Map([["chat","Chat"],["phonechat","PhoneChat"],["phonelink1on1chat","Phonelink1on1Chat"],["phonelinkgroupchat","PhonelinkGroupChat"],["meeting","Meeting"],["sfbinteropchat","SfBInteropChat"]]),$e=e=>{let t=null;return null==e||(t=Ke.get(e),void 0===t&&(t=null)),t},et=new Map([["AcceptPending","AcceptPending"],["ExtendedDirectoryAcceptPending","ExtendedDirectoryAcceptPending"],["Accepted","Accepted"],["Blocked","Blocked"],["Quarantined","Quarantined"],["AcceptPendingRecipient","AcceptPending"]]),tt=e=>e&&et.get(e)||null,nt=new Map([["ChatEnabled","ChatEnabled"],["ChatDisabled","ChatDisabled"],["InMeeting","InMeeting"],["ChatEnabledAnonymousDisabled","ChatEnabledAnonymousDisabled"],["InMeetingAnonymousDisabled","InMeetingAnonymousDisabled"],["InMeetingRestrictOrganizer","InMeetingRestrictOrganizer"],["InMeetingAnonymousDisabledRestrictOrganizer","InMeetingAnonymousDisabledRestrictOrganizer"]]),it=e=>e&&nt.get(e)||null,rt=new Map([["backroom","Backroom"],["lobby","Lobby"]]),at=e=>e&&rt.get(e)||null,st=e=>!!e&&"PhoneChat"===e,ot=e=>e.filter((e=>E.af.isTFLOffNetworkUser(e.id))),lt=e=>{let t;switch(e){case I.rI.Error:t="Error";break;case I.rI.Sending:t="Sending";break;case I.rI.Retrying:t="Retrying";break;default:t="Delivered"}return t},dt=e=>(0,M.t0)(e)||(0,d.oZ)(e)||(0,h.xl)(e),ct=(e,t)=>(0,C.filter)(e,(0,C.omit)(t,"__typename")),ut=e=>!!e&&-1!==e.indexOf(G),pt=e=>!!e?.startsWith("tfl:preview-"),gt=e=>!!e&&(-1!==e.indexOf(c.iB)||-1!==e.indexOf(c.hd)),mt=e=>e===Z,ht=e=>"AcceptPending"===e,It=e=>mt(e)||ut(e),Mt=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),ft=e=>!!e&&e.includes("meeting"),At=(e,t,n,i,a,s,o,l,d)=>{if(!e)return;const c="Phonelink1on1Chat"===t,u="PhonelinkGroupChat"===t,p=n?r.bF.Meeting:i?a?r.bF.Botchat:st(t)?r.bF.SMSOneOnOneChat:(0,h.xl)(e)?r.bF.SfcInteropChat:(0,M.t0)(e)?r.bF.SfbInteropChat:s?r.bF.NativeFederatedChat:o?r.bF.FederatedChat:(0,h.qL)(e)&&c?r.bF.Phonelink1on1Chat:r.bF.OneOnOneChat:(0,h.L5)(e)?r.bF.StreamOfNotes:(0,h.qL)(e)&&u?r.bF.PhonelinkGroupChat:d||(e=>!!e&&e===m.vW.Channel)(l)?r.bF.Channel:r.bF.GroupChat;return p},Tt=(e,t)=>{if(!t||!t.notification)return null;try{const e=t.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in chat message notification transformation: ${t}`),null}},Nt=e=>{if((0,C.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,C.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},yt=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>({surface:e,contentType:t,content:{value:{height:Nt(n.value?.height)??void 0,width:Nt(n.value?.width)??void 0,title:n.value?.title??"",url:n.value?.url??""},actions:n.actions??[]}})))}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${t}`),null}};function Ct(e){if(e)return"string"==typeof e?e:e.state}const St=e=>e.some((e=>E.af.isExtendedDirectoryUser(e))),bt=e=>{if(e&&ut(e.id)){const t=e.properties.pendingBotMembers;if(t){return(0,T.j)(t)}}},Dt=e=>{const t=e.split(";");return{conversationId:t[0],replyChainId:t.find((e=>e.startsWith("replyChainId=")))?.split("=")[1]||null,messageId:t.find((e=>e.startsWith("messageId=")))?.split("=")[1]||null}},Et=e=>{const{replyChainId:t}=Dt(e.id||"");return e.type===a.ck.chats&&!!t}},37321:(e,t,n)=>{"use strict";n.d(t,{LA:()=>l,Fx:()=>p,vu:()=>g});var i=n(480354),r=n(639884),a=n(193406),s=n(199448),o=n(850434);const l=(e,t,n)=>{if(!t||!t.cards||"string"!=typeof t.cards&&!n)return null;try{let e=String(t.cards);n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:r,contentType:a,locale:s,userSpecificContent:o})=>({appIcon:e,appId:t||"",appName:n,cardClientId:i,content:JSON.stringify(r),contentType:a,locale:s,...!!o&&{userSpecificContent:o}})))}catch(t){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}};var d;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(d||(d={}));const c=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const n=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(t.code);return{code:n,type:(e=>{switch(e){case d.Sharepoint:return"Sharepoint";case d.WOPI:return"WOPI";case d.Google:return"Google";case d.OneDrive:return"OneDrive";case d.Recent:return"Recent";case d.Aggregate:return"Aggregate";case d.FileSystem:return"FileSystem";case d.Search:return"Search";case d.AllFiles:return"AllFiles";case d.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}})(parseInt(t.type,10))}}catch(e){return void t.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},u=(e,t)=>{{const n=2,l=["http","https"],{filePreview:d,chicletBreadcrumbs:u,fileInfo:p,anchorFileId:g,progressComplete:m,isUploadError:h,fileChicletState:I,providerData:M}=e,{shareUrl:f,shareId:A,itemId:T}=p,N=(e=>{if(!e)return{};const t=e=>void 0!==e&&(0,i.isNumber)(e)&&isFinite(e)?Math.min(Math.max(e,0),2147483647):void 0,{previewUrl:n,previewHeight:r,previewWidth:a}=e;return{previewUrl:n,previewHeight:t(r),previewWidth:t(a)}})(d),y=I?.serviceName,{id:C,baseUrl:S,objectUrl:b,type:D,title:E,state:U}=((e,t)=>{const{version:n}=e;let{id:i,baseUrl:r,objectUrl:a,type:l,title:d,state:c}=e;if(n!==t&&(({itemid:i,fileName:d,fileType:l,fileInfo:{fileUrl:a,siteUrl:r}}=e),c=e.fileChicletState?.state),"string"!=typeof i)throw(0,s.$5)("ChatHelpers",o.O4.Undefined,"toFiles",{id:i,version:n,type:l},"File id is missing");return{id:i,baseUrl:r,objectUrl:a,type:l,title:d,state:c}})(e,n),w="active"!==U&&"hidden"!==U,v=c(M,t),L=(0,r.K)()("aggregatefiles","customspo","downloads","p2p","personal","recent","teams","teamsSdk","skype"),k=(0,r.K)()("active","deleted","reference","hidden");return{id:C,itemId:T,chicletBreadcrumbs:u,baseUrl:(0,a.Jf)(S,l),objectUrl:(0,a.Jf)(b,l),shareId:A,shareUrl:f,type:D,title:E,fileId:C,isReferencedFile:w,anchorFileId:g,progressComplete:m&&parseInt(m,10)||null,serviceName:y&&L.find((e=>e===y)),state:U&&k.find((e=>e===U)),hasUploadFailed:h,providerDataV2:v,...N}}},p=(e,t)=>{if(!t||!t.files||"string"!=typeof t.files)return null;try{let n=JSON.parse(t.files);n=n.filter((e=>"deeplink"!==e.type));return(0,i.map)(n,(t=>u(t,e)))}catch(e){return null}},g=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t))},717828:(e,t,n)=>{"use strict";n.d(t,{Pf:()=>l,sN:()=>d,ZI:()=>c});var i=n(480354),r=n(435793),a=n(199448),s=n(850434),o=n(806658);const l=(e,t,n)=>{let r=[];if((0,i.isEmpty)(e)||(0,i.isEmpty)(t)){const i=`Invalid user ids when generating chat id from members: userId1=${e}, userId2=${t}`;throw n.error(i),(0,a.$5)(i,s.O4.InvalidInput,"chatIdFromMembers")}r=(0,o.Iz)(e)&&!(0,o.Iz)(t)?[(0,o.m9)(t),(0,o.m9)(e)]:!(0,o.Iz)(e)&&(0,o.Iz)(t)?[(0,o.m9)(e),(0,o.m9)(t)]:[(0,o.m9)(e),(0,o.m9)(t)].sort();const l=(0,o.Xb)(e),d=(0,o.Xb)(t);if(l||d){if(l===d)return`19:${l}:${r[0]}_${r[1]}@unq.gbl.spaces`;n.warn(`Both users are in different clouds: ${l} and ${d}. This should be a federated chat, falling back to default chat ID generation.`)}return`19:${r[0]}_${r[1]}@unq.gbl.spaces`};function d(){const[e,t]=(0,r.yT)(2);return`${e}${t}`.substr(0,19)}const c=e=>void 0!==e?.pinnedTime&&e.pinnedTime>0},832901:(e,t,n)=>{"use strict";var i,r;n.d(t,{aY:()=>r,IA:()=>a,zS:()=>s,mJ:()=>o}),function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(i||(i={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(r||(r={}));const a=e=>"Important"===o(e),s=e=>r[e]||r.Standard,o=e=>{switch(e){case r.Important:case i.Important:return"Important";case r.Urgent:case i.Urgent:return"Urgent";case r.Standard:case i.Standard:default:return"Standard"}}},73466:(e,t,n)=>{"use strict";n.d(t,{i2:()=>i,j8:()=>r,Fo:()=>s});const i="suggested-org-group-chat",r="suggested-project-group-chat",a=[i,r];function s(e){return a.includes(e)}},73087:(e,t,n)=>{"use strict";n.d(t,{SU:()=>r,Qr:()=>a,UB:()=>s});var i=n(480354);const r=(e,t,n,i)=>s(t,e.threadProperties.spaceThreadTopic,e.threadProperties.pictureETag,e.threadProperties.groupId,n,i),a=(e,t,n,i,r)=>s(n,e.threadProperties.topicThreadTopic,t?.threadProperties.pictureETag,t?.threadProperties.groupId,i,r),s=(e,t,n,r,a,s)=>{const o=encodeURIComponent(t);return a&&s&&!(0,i.isEmpty)(s)?e+"beta/users/{objectId}/profilepicturev2/teams/{teamGroupId}?etag={etag}&displayName={displayName}&voidCache=true".replace("{objectId}",s).replace("{teamGroupId}",r||"").replace("{etag}",n||"").replace("{displayName}",o):e+"beta/teams/{teamGroupId}/profilepicturev2?etag={etag}&displayName={displayName}&voidCache=true".replace("{teamGroupId}",r||"").replace("{etag}",n||"").replace("{displayName}",o)}},906166:(e,t,n)=>{"use strict";n.d(t,{wJ:()=>l,KN:()=>c,bX:()=>u,W3:()=>m,fj:()=>h,UM:()=>I,qt:()=>f,eQ:()=>T,rl:()=>N});var i,r=n(28430),a=n(845097),s=n(645095),o=n(809391);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(i||(i={}));const l=new RegExp("https?://[^\\s]+","i"),d="-",c=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let t=e.indexOf(d,1);if(-1===t)return e;let n=e.indexOf(d,t+1);return-1===n&&(n=e.length),n-t==5&&(t=n),e.substring(0,t)},u=e=>{const t=e?c(e):"",n=(0,r.get)("tcurlang")||t;return{targetLanguage:n,knownLanguages:[n]}},p=(e,t)=>(e=>{switch(e){case s.Uf.Success:return"Done";case s.Uf.MessageNotFound:return"MessageNotFound";case s.Uf.VersionNotFound:return"VersionNotFound";case s.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case s.Uf.SkipTranslation:case s.Uf.ContentIsEmpty:return"TranslationNotNeeded";default:return"UnknownError"}})(((e,t)=>{const n=s.Uf[e];return void 0!==n?n:(t?.error(`Unable to parse translation result code: ${e}`),s.Uf.UnknownError)})(e,t)),g=async(e,t,n,i,r,a,o,l,d)=>{try{return await e.translateMessages(t,n,i,r,a,o,d)}catch(e){return l.error(`Failed to translate ${o}: ${e}`),a.map((({id:e,version:t})=>({id:e,version:t||"",detectedLanguage:{languageId:"",score:0},resultCode:s.Uf[s.Uf.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}},m=async(e,t,n,i,r,s,o)=>{const{targetLanguage:l,knownLanguages:d}=n,c=(0,a.v4)(),u=r.map((({messageId:e,version:t})=>t?{id:e,version:t}:{id:e}));return{convId:i,targetLangCode:l,correlationId:c,translations:(await g(e,i,t,l,d,u,c,s,o)).map((e=>({messageId:e.id,content:e.translatedContent||"",sourceLangCode:e.detectedLanguage?.languageId||"",resultCode:p(e.resultCode,s),version:e.version})))}},h=async(e,t,n)=>{try{return(await e.getSupportedTranslationLanguages(t)).map((({languageTag:e,languageName:t})=>({languageCode:e,languageName:t})))}catch(e){return n.error(`Unable to retrieve languages: ${e}`),[]}},I=(e,t,n,r,a)=>{if("string"!=typeof t)return null;try{const e=(0,o.J)(t),s=e.languages?.split(";")?.map((e=>{const[t,n]=e.split(":");return{code:t,score:parseInt(n,10)}})),l=s[0].code;if("null"===l)return null;let d=s.length;d>0&&""===s[d-1].code&&(s.pop(),d--);const c=void 0!==e.length,u=d>0&&"length"===s[d-1].code;if(!(c||u))return{code:l,confidenceLevel:i.LOW};const p=JSON.parse(a??"{}").settingsData,g=p?.find((t=>t.detector===e.detector));if(!(g&&n&&r&&g.minConfidence))return{code:l,confidenceLevel:i.LOW};const m=((e,t)=>{const n=e.minCharMap,i=e.minCharMapOverrides,r=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return i?.[t]??n?.[r.get(t)??""]??n?.others??5})(g,l),h=g.minConfidence??70,I=s.find((e=>e.code===n))?.score;if(n!==l){let t=0;if(c&&(t=parseInt(e.length,10)||0),u&&(t=M(s)),t<m)return{code:l,confidenceLevel:i.LOW};if(I&&I>=h)return{code:n,confidenceLevel:i.LOW}}return{code:l,confidenceLevel:i.HIGH}}catch(n){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${t}.`),null}},M=e=>{const t=e.pop();return t?.score||0},f=(e,t,n,r)=>{const a=t?.code;if(!e||!a||t?.confidenceLevel===i.LOW)return!1;const s=e.knownLanguages;if(a===e.targetLanguageCode||s.includes(a))return!1;switch(e.translationMode){case"SUGGEST_TRANSLATION":return!0;case"ALWAYS_TRANSLATE":if(n&&"ShowOriginalMessage"===r)return!0}return!1},A=(e,t)=>{if(!e)return"ShowOriginalMessage";if(!t)return"Done";switch(t){case s.Uf.Success:return"Done";case s.Uf.SkipTranslation:return"TranslationNotNeeded";case s.Uf.MessageNotFound:return"MessageNotFound";case s.Uf.VersionNotFound:return"VersionNotFound";case s.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case s.Uf.UnsupportedSourceLanguage:return"UnsupportedSourceLanguage";default:return"UnknownError"}},T=e=>{const{body:t,subject:n,title:i,toggled:r,detectedLanguageName:a,sourceLanguageCode:s,targetLanguageCode:o,isOnDemandTranslation:l,isInProgress:d,error:c}=e||{};if(d)return{translationStatus:"InProcess"};return(void 0!==t||void 0!==c)&&a&&s&&o?{translationStatus:A(!!r,c),translatedSubject:n,translatedContent:t,translatedTitle:i,isOnDemandTranslation:l,sourceLanguageName:a,sourceLanguageCode:s}:void 0},N=(e,t,n)=>{if(!n)return!1;let i=null;return n&&(i=n.find((e=>e.languageCode===t))),!(!i||i.messageId===e)}},810886:(e,t,n)=>{"use strict";n.d(t,{qK:()=>d,N4:()=>c,p_:()=>M});var i=n(189888),r=n(800079),a=n(98073),s=n(969013),o=n(806658),l=n(480354);const d=(e,t,n,i)=>{const a=r.af.getRequestCount(e),{accountEnabled:s,mri:o,objectId:l,displayName:d,givenName:c,surname:h,type:M,consumerProfileType:A,jobTitle:T,userPrincipalName:N,email:y,tenantId:C,sipProxyAddress:S,mobile:b,telephoneNumber:D,tenantName:E,decoratedDisplayName:U,cid:w,description:v,externalCalendarEmailAddress:L,homeMri:k,homeTenantId:x,mtoLabel:F,profileType:O,avatarETag:P,avatarUrl:j,searchableByProfile:R}=e,z={__typename:"User",accountEnabled:s,id:f(e),objectId:l,mri:o,displayName:d,givenName:c,surname:h,type:M,consumerProfileType:A,jobTitle:T,userPrincipalName:N,email:y,tenantId:n||C||null,sipProxyAddress:S,mobile:b,telephoneNumber:D,requestCount:a,preferredUserName:t,tenantName:E||null,decoratedDisplayName:U||null,cid:w,description:v,externalCalendarEmailAddress:L,emailForQuery:i,homeMri:k,homeTenantId:x,mtoLabel:F,profileType:O,avatarETag:P,avatarUrl:j,searchableByProfile:R};return function(e,t){const n=e.department;n&&(t.department=n)}(e,z),m(e,z),g(e,z),u(e,z),p(e,z),I(z),z},c=e=>{const{id:t,displayName:n,description:i,email:r,phone:a,mri:s,requestCount:o,syncSource:l}=e;return{__typename:"User",id:t,mri:s,objectId:s,displayName:n,userPrincipalName:s,givenName:n,surname:n,description:i,email:r,mobile:a,telephoneNumber:a,requestCount:o,syncSource:l}},u=(e,t)=>{if(function(e){const t=e;return void 0!==t.isFederated||void 0!==t.isAnonymousB2bUser||"federated"===t.type?.toLowerCase()}(e)){const{isFederated:n,fetchErrorCode:i,isAnonymousB2bUser:s}=e;t.isFederated=n||"federated"===e.type?.toLowerCase(),t.fetchErrorCode=i,t.isAnonymousB2bUser=s,e.trustReason===a.Ed.SharedChannelXTAPEnabled?t.trustworthy=r.af.getFamiliarTrustworthy("SHARED_CHANNEL"):e.trustReason===a.Ed.HighTrustFederation&&(t.trustworthy=r.af.getFamiliarTrustworthy("FEDERATED"))}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},p=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,l.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,l.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(t.avatarUrl=e.avatarUrl),t.isShortProfile=e.isShortProfile},g=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.Pk.botType:(0,o.Iz)(e.mri)}(e)||function(e){return"aduser"===e.type?.toLowerCase()||"aduser"===e.$$subType?.toLowerCase()}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},m=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>h(e))))},h=e=>({number:e.number,type:e.type}),I=e=>{const{mri:t}=e;if((0,s.Ku)(t)&&!e.displayName){const n=(0,s.IK)(t);e.displayName=n,e.givenName=n}else if(t&&(0,o.gZ)(t)&&!e.displayName){const n=(0,o.eu)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},M=e=>!!e&&!("string"!=typeof e||!r.af.isTFLSmsVerifiedMri(e)),f=e=>e.mri||e.objectId||e.concatenatedId},697673:(e,t,n)=>{"use strict";n.d(t,{mu:()=>r,AZ:()=>a});const i="EntityMoreInfo",r={requestPersonMoreInfo:"requestPersonMoreInfo",requestPersonMoreOrgInfo:"requestPersonMoreOrgInfo",requestTopicMoreInfo:"requestTopicMoreInfo"},a={requestPersonMoreInfo:e=>({originator:i,type:r.requestPersonMoreInfo,data:()=>({...e})}),requestPersonMoreOrgInfo:e=>({originator:i,type:r.requestPersonMoreOrgInfo,data:()=>({...e})}),requestTopicMoreInfo:e=>({originator:i,type:r.requestTopicMoreInfo,data:()=>({...e})})}},523861:(e,t,n)=>{"use strict";n.d(t,{J:()=>i,C:()=>a});var i,r=n(45530);!function(e){e.UnsupportedOS="unsupported_os"}(i||(i={}));class a extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:n,originSlotName:i,originAppId:r,prevError:a,userContextId:s}){super(n),this.type=e,this.code=t,this.originSlotName=i,this.originAppId=r,this.prevError=a,this.userContextId=s;const o=(l=a?.stack??this.stack,l?.split("\n").slice(1)??[]);var l;this.stack=[`${t} Error: ${n}`,...o].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){let e=this.toTelemetryCode(),t=this.prevError;for(;t;)t instanceof a&&a.isFunction(t.toTelemetryEntry)?(e+=t.toTelemetryEntry(),t=void 0):(0,r.C)(t)?(e+=`[IError::${t.code}]`,t=t.innerError??t.reason?.innerError):(e+=`[Error::${t.message}]`,t=void 0);return e}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},747587:(e,t,n)=>{"use strict";n.d(t,{D:()=>i,a:()=>d});var i,r=n(523861),a=n(878665),s=n(45530);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TAB_DISABLED="TAB_DISABLED",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED",e.REDUCED_CAPABILITIES_CHATS="REDUCED_CAPABILITIES_CHATS",e.REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS="REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS",e.REDUCED_CAPABILITIES_COMMUNITIES="REDUCED_CAPABILITIES_COMMUNITIES",e.MAGLEV_UPDATE_REQUIRED_WIN="MAGLEV_UPDATE_REQUIRED_WIN",e.MAGLEV_UPDATE_REQUIRED_WIN_VDI="MAGLEV_UPDATE_REQUIRED_WIN_VDI",e.MAGLEV_UPDATE_REQUIRED_MAC="MAGLEV_UPDATE_REQUIRED_MAC",e.UNSUPPORTED_OS_VERSION_WIN="UNSUPPORTED_OS_VERSION_WIN",e.UNSUPPORTED_OS_VERSION_MAC="UNSUPPORTED_OS_VERSION_MAC",e.PERSISTED_APP_CONTENT_ALREADY_EXISTS="PERSISTED_APP_CONTENT_ALREADY_EXISTS",e.PERSISTED_APP_CONTENT_ID_MISSING="PERSISTED_APP_CONTENT_ID_MISSING",e.PERSISTED_APP_CONTENT_NOT_FOUND="PERSISTED_APP_CONTENT_NOT_FOUND",e.PERSISTED_APP_CONTENT_IS_NULL="PERSISTED_APP_CONTENT_IS_NULL",e.PERSISTED_APP_CONTENT_INVALID_PROPS="PERSISTED_APP_CONTENT_INVALID_PROPS"}(i||(i={}));const o={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TAB_DISABLED:"You’ve reached the limit of open tabs running Teams.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker",REDUCED_CAPABILITIES_CHATS:"Chats are temporarily unavailable. You should still be able to use other parts of Teams.",REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS:"Teams and channels are temporarily unavailable. You should still be able to use other parts of Teams.",REDUCED_CAPABILITIES_COMMUNITIES:"Communities are temporarily unavailable. You should still be able to use other parts of Teams.",MAGLEV_UPDATE_REQUIRED_WIN:"You are using an old version of Teams. Update Teams for a secure and reliable experience.",MAGLEV_UPDATE_REQUIRED_MAC:"You are using an old version of Teams. Update Teams for a secure and reliable experience.",UNSUPPORTED_OS_VERSION_WIN:"Teams is no longer supported on this version of OS. Update your OS, or contact your IT department. For now, you could try using Teams on the web.",UNSUPPORTED_OS_VERSION_MAC:"Teams is no longer supported on this version of OS. Update your OS, or contact your IT department. For now, you could try using Teams on the web."},l={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:a.I.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:a.I.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},TAB_DISABLED:{title:"default_tab_disabled_title",description:"default_tab_disabled_description",actions:["RESTART"],icon:a.I.FullNoSpace,hideDownloadLogs:!0,hideDetailsOnErrorPage:!0,showDownloadDesktopApp:!0},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},REDUCED_CAPABILITIES_CHATS:{title:"reduced_capabilities_chats_error_title",description:"reduced_capabilities_chats_error_description",hideDownloadLogs:!0,icon:a.I.ReducedCapabilities,actions:[]},REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS:{title:"reduced_capabilities_teams_and_channels_error_title",description:"reduced_capabilities_teams_and_channels_error_description",hideDownloadLogs:!0,icon:a.I.ReducedCapabilities,actions:[]},REDUCED_CAPABILITIES_COMMUNITIES:{title:"reduced_capabilities_communities_error_title",description:"reduced_capabilities_communities_error_description",hideDownloadLogs:!0,icon:a.I.ReducedCapabilities,actions:[]},MAGLEV_UPDATE_REQUIRED_WIN:{title:"desktopapp_update_requried_page_title",description:"desktopapp_update_requried_page_description",hideDownloadLogs:!0,icon:a.I.AppUpdateRequired,actions:["DOWNLOAD_AND_REINSTALL_WIN"],showUseWebApp:!0,hideDetailsOnErrorPage:!0},MAGLEV_UPDATE_REQUIRED_WIN_VDI:{title:"desktopapp_update_requried_page_title",description:"desktopapp_update_requried_page_description",hideDownloadLogs:!0,icon:a.I.AppUpdateRequired,showUseWebApp:!0,hideDetailsOnErrorPage:!0},MAGLEV_UPDATE_REQUIRED_MAC:{title:"desktopapp_update_requried_page_title",description:"desktopapp_update_requried_page_description",hideDownloadLogs:!0,icon:a.I.AppUpdateRequired,actions:["DOWNLOAD_AND_REINSTALL_MAC"],showUseWebApp:!0,hideDetailsOnErrorPage:!0},UNSUPPORTED_OS_VERSION_WIN:{title:"unsupported_os_blocking_page_title_win",description:"unsupported_os_blocking_page_description_win",hideDownloadLogs:!0,icon:a.I.UnsupportedOs,actions:["USE_TEAMS_ON_WEB"],linkText:"unsupported_os_blocking_page_view_minimum_requirements",linkType:r.J.UnsupportedOS},UNSUPPORTED_OS_VERSION_MAC:{title:"unsupported_os_blocking_page_title_mac",description:"unsupported_os_blocking_page_description_mac",hideDownloadLogs:!0,icon:a.I.UnsupportedOs,actions:["USE_TEAMS_ON_WEB"],linkText:"unsupported_os_blocking_page_view_minimum_requirements",linkType:r.J.UnsupportedOS}};class d extends r.C{constructor(e,t,n,i){super({type:"CoreError",code:e,message:o[e]??((0,s.C)(t)?t.innerError?.message??t.reason?.innerError?.message:t?.message),originSlotName:i,prevError:t,userContextId:n})}getBoundaryProps(){return l[this.code]??{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==e?.type)return null;const t=new d(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},551038:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(523861);class r extends i.C{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},878665:(e,t,n)=>{"use strict";var i;n.d(t,{I:()=>i,t:()=>r}),function(e){e.DefaultDark="defaultDark",e.Default="default",e.FullNoSpace="fullNoSpace",e.NoLongerAllowed="noLongerAllowed",e.ReducedCapabilities="reducedCapabilities",e.UnsupportedOs="unsupportedOs",e.AppUpdateRequired="appUpdateRequired"}(i||(i={}));const r={[i.DefaultDark]:"/evergreen-assets/illustrations/error/something-went-wrong-v2-dark.svg",[i.Default]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[i.FullNoSpace]:"/evergreen-assets/illustrations/error/full-no-space.svg  ",[i.NoLongerAllowed]:"/evergreen-assets/illustrations/error/license-error-no-longer-allowed-hero.svg",[i.ReducedCapabilities]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[i.UnsupportedOs]:"/evergreen-assets/illustrations/error/webpage-authentication.svg",[i.AppUpdateRequired]:"/evergreen-assets/illustrations/error/webpage-authentication.svg"}},45530:(e,t,n)=>{"use strict";function i(e){return!(!e||"object"!=typeof e)&&("code"in e&&"string"==typeof e.code)}n.d(t,{C:()=>i})},359676:(e,t,n)=>{"use strict";n.d(t,{SS:()=>i,p2:()=>r,r2:()=>a,SY:()=>s,We:()=>o,Ut:()=>l,Xo:()=>d,P9:()=>c,JQ:()=>u,sM:()=>p,h5:()=>g,sE:()=>m,f0:()=>h,hW:()=>I,qB:()=>M,ie:()=>f,sP:()=>A,TJ:()=>T,Ay:()=>N,GW:()=>y,UH:()=>C,ll:()=>S,IT:()=>b,Sj:()=>D,sm:()=>E,I4:()=>U,AX:()=>w,Ze:()=>v,A7:()=>L,jY:()=>k,Ry:()=>x,O:()=>F,fZ:()=>O,Y2:()=>P});const i="v1/objects/",r={desktop:"imgpsh_mobile_save_anim",mobile:"imgpsh_fullsize_anim"},a="v1/objects/{objectId}/forward",s="v1/objects/{objectId}/views/imgo",o="v1/objects/{objectId}/views/imgpsh_mobile_save_anim",l="?v=1",d="&v=1",c="retry-after",u="/views/video",p="/views/thumbnail",g="/status",m=4194304,h=524288,I=2,M=3e5,f=1048576,A=3e4,T=144e3,N="/views/original",y="RejectedByPolicy",C=10004,S=403,b="retry-after",D=2,E=4,U=.5,w="transcript_info",v=3,L={IMAGE:"pish/image",DOCUMENT:"sharing/file",VIDEO:"sharing/videototranscode"},k={IMAGE:"imgpsh",DOCUMENT:"original",VIDEO:"video",THUMBNAIL:"thumbnail",TRANSCRIPT_INFO:"transcript_info"},x={IMAGE:"imgpsh",ORIGINAL:"original",VIDEO:"video"},F={downloadMedia:"downloadMedia",getViewStatus:"getViewStatus",postMedia:"postMedia",putMedia:"putMedia",forwardMediaContent:"forwardMediaContent"},O={"x-ms-client-version":"1415/1.0.0.2018090100"},P={AmsImage:"AmsImage",AmsImageDownload:"AmsImageDownload",CustomEmoji:"CustomEmoji",Branding:"Branding",AppsPlatform:"AppsPlatform",FileDownload:"FileDownload",DownloadFileActions:"DownloadFileActions",CommunitiesDetailsByJoinLink:"CommunitiesDetailsByJoinLink",CommunitiesFetchThreadProperties:"CommunitiesFetchThreadProperties",SubscribeCommunitiesUpdate:"SubscribeCommunitiesUpdate",FetchCommunitiesDetails:"FetchCommunitiesDetails",CommunitiesLoader:"CommunitiesLoader",FileUploadPreviewService:"FileUploadPreviewService",InlineImageSerializer:"InlineImageSerializer",CustomEmojiService:"CustomEmojiService",ChatResolvers:"ChatResolvers",AmsResolvers:"AmsResolvers",UploadCachedAssetsJob:"UploadCachedAssetsJob",CodeSnippetsSerializer:"CodeSnippetsSerializer",VideoMessageUploadService:"VideoMessageUploadService",InlineVideoSerializer:"InlineVideoSerializer",DownloadSkypeFiles:"DownloadSkypeFiles",AnnouncementPostMessage:"AnnouncementPostMessage",CustomVideoBackgroundsService:"CustomVideoBackgroundsService",OperatorCobranding:"OperatorCobranding"}},363678:(e,t,n)=>{"use strict";n.d(t,{hQ:()=>r,E2:()=>a,YV:()=>s,h1:()=>o,Cu:()=>l,hB:()=>d,hV:()=>c});var i,r,a,s,o,l,d,c;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(i||(i={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(r||(r={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(a||(a={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(s||(s={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(o||(o={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(l||(l={})),function(e){e.activityFeed="activityFeed",e.card="card",e.connectorConfiguration="connectorConfiguration",e.deepLink="deepLink",e.deepLinkStageView="deepLinkStageView",e.deepLinkQuickAccess="deepLinkQuickAccess",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.adaptiveCardStageModal="adaptiveCardStageModal",e.platformAppView="platformAppView",e.chatTab="chatTab",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig",e.storeApp="storeApp",e.stageViewOpenSDKApi="stageViewOpenSDKApi",e.workflows="workflows",e.virtualEvent="virtualEvent",e.botChat="botChat",e.fileChiclet="fileChiclet",e.precache="precache",e.botFeedback="botFeedback"}(d||(d={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB",e.teamsMaglev="TEAMS-MAGLEV"}(c||(c={}))},849213:(e,t,n)=>{"use strict";n.d(t,{y:()=>P});var i=n(622229),r=n(867491),a=n(339953),s=n(845097),o=n(199448),l=n(850434);class d{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const n={eventId:e,payload:t,correlationId:(0,s.v4)()};this.shellComms.postMessage(n)}requestMessage(e,t,n=this.defaultRequestTimeoutMs){let i;const r=(0,s.v4)(),a=(t?.timeout||n)+this.bufferInTimeout;return new Promise(((n,s)=>{const d=t=>{this.globalWindow.clearTimeout(i),t&&!t.error?n(t.payload):s((0,o.$5)(l.Ir.ShellService,l.O4.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:r},"Received an error from IPC"))};i=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,d),s((0,o.$5)(l.Ir.ShellService,l.O4.TimedOut,"requestMessage",{eventName:e,correlationId:r}))}),a),this.shellComms.once(e,d,r);const c={eventId:e,correlationId:r,payload:t};this.shellComms.postMessage(c)}))}addEventListener(e,t,n){n&&n.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,n){const i={openType:e,openHandler:t,handlerParams:n};this.postMessage("requestShellToOpen",i)}}class c{constructor(e,t,n){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:i,isInIframe:s}=n;let o=r.GM.standAlone;if(this.viewportContext=a.k.primary,s&&!i)o=r.GM.iframe,this.viewportContext=a.k.iFrame;else if(null!==this._globalWindow.opener)try{this._globalWindow.opener.location?.host===this._globalWindow.location.host&&(o=r.GM.secondary,this.viewportContext=a.k.secondary)}catch(e){o=r.GM.standAlone,this.viewportContext=a.k.primary}this._hostedWindowContext={...n,panelContext:o,startReason:r.bG.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__},this.opener=new d(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var u=n(744115),p=n(911293);var g=n(349545);class m{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,n=t.get(e);if(n)return n;const i=new g.B;return t.set(e,i),i},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,n=this.observableCache.get(t);n&&n.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const h="multi-window-manager-channel";var I=n(931328),M=n(853116),f=n(480354);const A=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function T(e,t){return t.some((t=>{if(t.startsWith("regex:")){const n=t.replace("regex:","");return new RegExp(n).test(e)}return t===e}))}function N(e){return"null"!==e&&A.test(new URL(e).origin)}const y=(e,t,n,i)=>{const r=I.c.create((r=>{e.addEventListener("message",(e=>{const{eventId:a,channel:s}=e.data;e&&a&&s===h&&function(e,t,n){const i=n.newLogger("PostMessage origin validation","services-io-browser-shell-message-passing-browser"),r=e.origin;return t?!("*"!==t&&!N(r)&&((0,f.isArray)(t)?0===t.length?(i.errorToTelemetry?.(`PostMessage is disabled for this experience. (case 5) ${r}`,"core_origin_validation_failed",void 0,!0),1):!T(r,t)&&(i.errorToTelemetry?.(`Event origin is not in allow-list. Event was dropped. (case 4) ${r}`,"core_origin_validation_failed",void 0,!0),1):(i.errorToTelemetry?.(`Could not match the event origin. Event was dropped. (case 6) ${r}`,"core_origin_validation_failed",void 0,!0),1))):(i.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,n.postMessageConfig,i)&&(t.debug("Incoming message from post messages"),r.next(e.data))}))})).pipe((0,M.u)());return r};class C{constructor(e,t,n,i){this.opt=i,this.postMessage=e=>{if((0,f.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void this.logger.errorToTelemetry?.("postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0);this.logger.log("Sending targeted message to host browser only");const t=null!==e.payload&&"object"==typeof e.payload?{...e.payload}:{payload:e.payload};this.windowReference.parent.postMessage({channel:h,payload:{...t,channel:e.channel}},((e,t,n)=>{const i=new URL(e.location.href).origin;let r;if(!t||"*"===t)return"*";if(e.document.referrer)try{r=new URL(e.document.referrer).origin}catch(t){n.error(`Invalid referrer: ${e.document.referrer}`)}return!r&&t.includes("null")?"*":r?r===i||N(r)||T(r,t)?r:(n.error(`Invalid target origin (${r}). Source origin (${i}) was returned as target origin.`),i):(n.log(`Could not determine target origin. Falling back to source origin: ${i}`),i)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,p.T)((e=>(e=>({channel:e.metaData.destination.channel,payload:"object"==typeof e.payload?{correlationId:e.metaData.correlationId,...e.payload}:e.payload}))(e)))),this.createShellChannelCache=(e,t,n,i)=>{t.debug("Creating Shell Channel cache");const r=y(e,t,n,i);return new m(r,t)},this.logger=n.newLogger("RndrShComm","services-io-browser-shell-message-passing-browser"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,n)}}const S="main_process";var b=n(654290);class D{constructor(e,t,n){if(3!==arguments.length||e.trim().length<=0)throw(0,o.$5)("Invalid constructor arguments",l.O4.InvalidInput,typeof D);this.logger=n,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const n=this.metaData,i=this.messagePassingService,r=t&&t.length>0?t:this.messagePassingService.processId!==S?[S]:["main_renderer"],a={channel:n.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(r)}.`),i.postMessage(a,r)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,p.T)((e=>e.payload)),(0,b.M)((()=>{this.logger.debug("Handling stream event.")})))}}class E{constructor(e,t){if(this.getStream=e=>new D(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`,"services-io-browser-shell-communication-provider")),!e||!t)throw(0,o.$5)(`sc: ${e}, lf: ${t}`,l.O4.Undefined,typeof E);this.messagePassingService=e,this.loggerFactory=t}}var U=n(660548),w=n(59650),v=n(787313);class L{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,o.$5)(l.Ir.ShellService,l.O4.Undefined,"constructor");const n={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},i={newLogger:()=>n},r=new C("browserWindow",this.windowReference,i,this.opt);this.shellComms=new E(r,i),this.subscriptionManager=new g.B}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,n=""){this.createSubscription(e,t,!1,n)}once(e,t,n=""){this.createSubscription(e,t,!0,n)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,n,i){const r=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{const t=e?.correlationId||e?.payload?.correlationId;return!e||!t||t===i}))),a=this.registerForUnsubscription(e,t);(n?r.pipe((0,U.s)(1),(0,w.Q)(a)):r.pipe((0,w.Q)(a))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,o.$5)(l.Ir.ShellService,l.O4.RemoteOperationFailed,"createSubscription",{errorMsg:(0,o.BA)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((n=>n.channel===e&&(void 0===n.listener||n.listener===t))))}filterWrapper(e){return(0,v.p)(e)}}class k{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,n=this.createShellCommService(this.globalWindow,this.opt),i=new c(this.globalWindow,n,e);return{hostedWindowContext:i.getHostedWindowContext(),window:(0,u.rz)(t,i,!1)}}createShellCommService(e,t){return new L(e,t)}}class x{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:F(this.windowEnvironment),isInIframe:O(this.windowEnvironment)};return new k(this.windowEnvironment,e).configureShell(t)}}function F(e){try{let t=!!e.Cypress;if(!t){const n=e.top||e.parent;t=!!n?.Cypress}return t}catch(e){return!1}}function O(e){try{return e.self!==e.top}catch(e){return!0}}class P{constructor(){this._opt={};const e=new x(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(i.z.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return P.instance||(P.instance=new P),P.instance}get window(){return this.config.window}}},744115:(e,t,n)=>{"use strict";n.d(t,{$6:()=>C,Q7:()=>N,W3:()=>A,rz:()=>f});var i=n(754255),r=n(693973),a=n(339953),s=n(747587);function o(e){return e.ResizeObserver?e.ResizeObserver:function(t){const n=new Map;let i,r=!1;function a(){if(r||!n.size)return void(i=void 0);const s=[];n.forEach(((e,t)=>{const i=t.getBoundingClientRect();e.height!==i.height&&(n.set(t,i),s.push({target:t,contentRect:i,borderBoxSize:[{inlineSize:i.width,blockSize:i.height}],contentBoxSize:[{inlineSize:i.width,blockSize:i.height}],devicePixelContentBoxSize:[]}))})),s.length&&t(s),i=e.requestAnimationFrame(a)}return{observe(t){n.has(t)||(n.set(t,t.getBoundingClientRect()),i||(i=e.requestAnimationFrame(a)))},unobserve(e){n.has(e)&&n.delete(e)},disconnect(){n.clear(),i=void 0,r=!0}}}}var l=n(551038),d=n(113901);class c{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,d.Z)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const r=this._document.createElement("script");if(r.onload=()=>n(),r.onerror=i,r.async=!0,r.id=`${t}-script`,r.charset="utf-8",!this._coreSecurityService)throw new l.a("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,r.baseURI);r.src=t}catch(e){throw e}this._document.body.appendChild(r)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,d.Z)(((e,t)=>new Promise(((n,i)=>{if(!e)return n();const r=this._document.createElement("link");r.onload=()=>n(),r.onerror=i,r.type="text/css",r.rel="stylesheet",r.id=`${t}-style`,r.charset="utf-8",r.href=e,this._document.head.appendChild(r)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=async(e,t=!1)=>{if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const n=e.reduce(((e,n)=>{const i=this._chunkConfig&&this._chunkConfig[n];if(!i)return e.push(Promise.reject(new Error(`No chunk information found for ${i}.`))),e;const r=i.endsWith(".css")?this._loadStyle:this._loadScript,a=this._loadedItems.get(i)||r(i,n).catch((e=>{throw t&&this._loadedItems.delete(i),e}));return this._loadedItems.has(i)||this._loadedItems.set(i,a),e.push(a),e}),[]);await Promise.all(n)}}configureCoreSecurityService(e){if(this._coreSecurityService)throw new l.a("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}var u=n(415171),p=n(844462),g=n(888591),m=n(607401);const h=(e,t,n)=>{const{coreSettings:r}=n;if(r.get(i.w.Core,["enableHostFullscreenSubscription"]).enableHostFullscreenSubscription)return t.pipe((0,g.F)());const a=e,s=new u.t(I(a)),o=new a.ResizeObserver((()=>{a.requestAnimationFrame((()=>{s.next(I(a))}))}));return o.observe(a.document.documentElement),s.pipe((0,m.j)((()=>o.disconnect())),(0,g.F)())},I=e=>!!(e.matchMedia("(display-mode: fullscreen)").matches||e.document.fullscreenElement||e.document.mozFullScreenElement||e.document.webkitFullscreenElement);class M{constructor(e){this.isEnabled=!1,e.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.installEvent=e,this.installEvent?.prompt&&(this.isEnabled=!0)}))}prompt(){this.installEvent?.prompt?.()}}const f=(e,t,n)=>{let i;try{i={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,get caches(){return e.caches},crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:o(e),WeakRef:e.WeakRef,chunkLoader:new c(e.document,e.__experienceWindowChunks__),screen:e.screen?.orientation?e.screen:{...e.screen,orientation:{type:"landscape-primary"}},viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),getLoadingWindow:e.loader?.getLoadingWindow&&e.loader.getLoadingWindow.bind(e.loader),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),scheduler:e.scheduler,setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:e.onpagehide?.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,pwaInstallTrigger:y(e)?void 0:new M(e),proxyPostMessage:(t,n,i,r)=>{e.proxyPostMessage&&e.proxyPostMessage(t,n,i,r)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>e.navigator?.mediaDevices?.getUserMedia?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available")),enumerateDevices:()=>t.navigator?.mediaDevices?.enumerateDevices?t.navigator.mediaDevices.enumerateDevices():Promise.reject(new Error("Not available")),AudioContext:e.AudioContext,handleGlobalWindowError:e.handleGlobalWindowError?.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get SlimCore(){return e.SlimCore},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,n=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!n)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new u.t(!1),unsubscribeFullscreenEvents:()=>{},exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>e.clearCache?.(),getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:e.zoomFactors??p.w,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve(),destroy:async r=>(i.unsubscribeFullscreenEvents?.(),n?new Promise(((n,a)=>{const s=t.setTimeout((()=>{try{t.clearTimeout(s);for(const e of Reflect.ownKeys(i)){if("windowLeakInfo"===e||"isDestroyed"===e)continue;let t,n=!1;try{n="function"==typeof i[e]}catch(e){}delete i[e];const r=(...n)=>{try{t=n.map((e=>`${e}`)).join(", ")}catch(e){}t&&(t=` with args: (${t})`);const i=new Error(`wrapWindow: Accessing window.${e} after destroy${t}`);throw i.message=`${i.message} at\n${i.stack}`,i};Reflect.defineProperty(i,e,{get:n?()=>r:r,set:r})}e.document.documentElement.innerText="",n()}catch(e){a(e)}finally{e=void 0,t=void 0,i.isDestroyed=!0}}),r+1)})):void 0),isDestroyed:!1}}catch(e){throw new s.a(s.D.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||t?.getHostedWindowContext()?.__webpack_public_path__||""}ckeditor/4.15.1-msft-11/`||"";const r=new Proxy(i,{deleteProperty:(t,n)=>delete e[n]});return i.__lpcWindowProxy=r,i};function A(e,t,n,r,a){const{coreSecurityService:s,hostCommunicationService:o,windowProvider:l,coreSettings:d,loggerFactory:p}=t,g=e,{enableDisconnectWindowWrapper:m,enableHostFullscreenSubscription:I}=d.get(i.w.Core),M=p.newLogger("WindowUtilities","services-io-browser-shell"),A=f(g,l,m??!1),y=N(r,a),C=new c(g.document,l.__experienceWindowChunks__);let S,b;C.configureCoreSecurityService(s);const D={chunkLoader:C,parent:l,viewportContext:y,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>T("exitFullscreen",e,M),focus:()=>T("focus",e,M),maximize:()=>T("maximize",e,M),minimize:()=>T("minimize",e,M),requestFullscreen:()=>T("requestFullscreen",e,M),windowTitleDblClick:()=>T("windowTitleDblClick",e,M),onFullscreen:()=>(S||(S=new u.t(!1),I&&o.loadModule("windowcontrols").then((e=>{M.log(`Subscribing to hostComms fullscreen events for window: ${n}`),b=e?.registerForWindowFullScreenChanged?.((e=>{e.windowId===n&&S?.next(e.fullscreen)}))}))),h(e,S,t)),unsubscribeFullscreenEvents:()=>b?.()};return Object.assign(A,D)}function T(e,t,n){n.log(`Performing action ${e}`);const i=t;switch(e){case"exitFullscreen":i.document.exitFullscreen().catch((t=>{n.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":i.document.documentElement.requestFullscreen().catch((t=>{n.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{i[e]()}catch(t){n.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}function N(e,t){let n;if(e)switch(t){case r.Rm.minimal:n=a.k.flyout;break;case r.Rm.minimode:n=a.k.minimode;break;default:n=a.k.primary}else if(t===r.Rm.immersive)n=a.k.immersive;else n=a.k.secondary;return n}const y=e=>{const t=e.loader?.getProperties();return!!t?.isMaglev};function C(e,t){const{heightToWidthRatio:n,minHeight:i=0,minWidth:r=0,widthToScreenWidthRatio:a}=t||{};if(!e||!n||!a)return{};const s=a*e.screen.availWidth;return{height:Math.max(s*n,i),width:Math.max(s,r)}}},675190:(e,t,n)=>{"use strict";n.d(t,{Xh:()=>g,kV:()=>u,fP:()=>p});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment ServicesIoDataBotConfigAppDefinitionsFragment on AppDefinition {id,largeImageUrl,version,name}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("query ServicesIoDataBotConfigAppDefinitionsQuery($botId:String!,$scope:AppInstallScope!,$conversationId:String) {appDefinitions(conversationId:$conversationId,scope:$scope,options:{botId:$botId}) {id,...ServicesIoDataBotConfigAppDefinitionsFragment},installedAppsV2(installedContext:{scope:$scope,conversationId:$conversationId},options:{botId:$botId}) {id,definition {id,...ServicesIoDataBotConfigAppDefinitionsFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions]}},s={kind:"Document",get definitions(){const e=(0,i.G)("fragment ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope on BotConfigurationScope {fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}}");return delete this.definitions,this.definitions=e.definitions}},o={kind:"Document",get definitions(){const e=(0,i.G)("fragment ServicesIoDataBotConfigProfileAppDefinitionsFragment on AppDefinition {id,name,bots {id,scopes,capabilities {isNotificationOnly,supportsFiles,supportsCalling,supportsVideo},configuration {team {...ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope},groupChat {...ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope}}},developerName,developerUrl,longDescription,shortDescription,connectors {connectorId,scopes,configurationUrl},privacyUrl,largeImageUrl,termsOfUseUrl,meetingExtensionDefinition {supportsStreaming,scenes {id,name,file,preview,maxAudience,seatsReservedForOrganizersOrPresenters},filters {id,name,thumbnail}},galleryTabs {configurationUrl,canUpdateConfiguration,canHaveTabConversation,scopes,meetingSurfaces,context},staticTabs {entityId,name,scopes},messageExtensions {botId,scopes,commands {id,title,context,description}},isFullScreenApp,isFullTrustApp,validDomains,tenantId,isMicrosoftOwned,externalId,version,webApplicationInfo {id,applicationPermissions},authorization {permissions {resourceSpecific {name,type}}},devicePermissions}");return delete this.definitions,this.definitions=[...e.definitions,...s.definitions]}},l={kind:"Document",get definitions(){const e=(0,i.G)("query ServicesIoDataBotConfigProfileAppDefinitionsQuery($botId:String!,$scope:AppInstallScope!,$conversationId:String) {appDefinitions(conversationId:$conversationId,scope:$scope,options:{botId:$botId}) {id,...ServicesIoDataBotConfigProfileAppDefinitionsFragment},installedAppsV2(installedContext:{scope:$scope,conversationId:$conversationId},options:{botId:$botId}) {id,definition {id,...ServicesIoDataBotConfigProfileAppDefinitionsFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...o.definitions]}};var d=n(294613),c=n(878336);async function u(e,t,n,i,r){if(i&&["Team","GroupChat"].includes(i)&&!n)return;const{data:s}=await e.query({query:a,variables:{botId:(0,c.Uf)(t),conversationId:n,scope:i||"Personal"},context:{callerInfo:r||"botUtils-getTopAppDefinitionForBot"}});let o;return s?.installedAppsV2&&s.installedAppsV2.length>0&&(o=g(s.installedAppsV2.map((e=>e?.definition)))),o&&o.length>0||!s?.appDefinitions||(o=g([...s.appDefinitions])),o?.[0]}async function p(e,t,n,i,r){if(i&&["Team","GroupChat"].includes(i)&&!n)return;const{data:a}=await e.query({query:l,variables:{botId:(0,c.Uf)(t),conversationId:n,scope:i||"Personal"},context:{callerInfo:r||"botUtils-getTopAppDefinitionForBotProfile"}});let s;return a?.installedAppsV2&&a.installedAppsV2.length>0&&(s=g(a.installedAppsV2.map((e=>e?.definition)))),s&&s.length>0||!a?.appDefinitions||(s=g([...a.appDefinitions])),s?.[0]}const g=e=>e?.sort(((e,t)=>(0,d.Z)(t?.version??"0",e?.version??"0")))},242519:(e,t,n)=>{"use strict";n.d(t,{OV:()=>l,I4:()=>d,$G:()=>c,T8:()=>u,rE:()=>p,bM:()=>g,Ak:()=>h,Bd:()=>I,qI:()=>M,il:()=>f,M7:()=>A,qJ:()=>N,B7:()=>C});var i=n(84646),r=n(797922),a=n(480354),s=n(806658),o=n(473107);function l(e){const[t,n,r]=function(e){const t=3,n=e.split(";");return n&&n.length===t&&n[0]&&!isNaN(Number(n[0]))&&n[1]&&!isNaN(Number(n[1]))&&n[2]&&!(0,a.isNil)(Number(n[2]))?n:i.S0.split(";")}(e),s=Number(n)||0;return{originalArrivalTime:Number(t)||0,timeStamp:s,clientMessageId:r}}const d=(e,t)=>(0,r.r0)(t.type,t.id)?e.chat:(0,r.Mn)(t.type)?e.channel:void 0;function c(e,t){const n=l(e.properties&&e.properties[i.H0.ConsumptionHorizon]||i.S0);if(t){const i=d(t,e)||-1;if(S(e,n.originalArrivalTime,i)||b(e,n.originalArrivalTime,i))return n;n.originalArrivalTime=Math.max(n.originalArrivalTime,i)}return n}function u(e,t,n){const i=t.consumptionHorizon,r=i?.split(";")?.[0]||0,a=Number(r)||0;let s=a;if(n){const i=d(n,e)||-1,r=Number(t.replyChainId);if(S(e,a,i)||!isNaN(r)&&r>i)return{originalArrivalTime:a,timeStamp:0,clientMessageId:""};s=Math.max(a,i)}return{originalArrivalTime:s,timeStamp:0,clientMessageId:""}}function p(e,t){let n=l(m(e.properties)||i.S0);if(t){(d(t,e)||-1)>=n.timeStamp&&(n={originalArrivalTime:0,timeStamp:0,clientMessageId:"0"})}return n}function g(e,t,n){const i=Number(t.consumptionHorizonBookmark),r=t.consumptionHorizonBookmarkVersion??0;if(isNaN(i))return{originalArrivalTime:0,timeStamp:0,clientMessageId:""};let a={originalArrivalTime:i,timeStamp:r,clientMessageId:""};if(n){(d(n,e)||-1)>=r&&(a={originalArrivalTime:0,timeStamp:0,clientMessageId:""})}return a}const m=e=>e?.userConsumptionHorizon||e?.consumptionHorizonBookmark||null;function h(e,t){const n=l(e.properties&&e.properties[i.H0.ReplyChainListConsumptionHorizon]||i.S0);if(t){const i=d(t,e)||-1;if(S(e,n.originalArrivalTime,i))return n;n.originalArrivalTime=Math.max(n.originalArrivalTime,i),n.timeStamp=Math.max(n.timeStamp,i)}return n}function I(e){let t=e.lastMessageTimeUtc;if((0,a.isNil)(t)){const n=e.lastMessage?.originalarrivaltime;t=n&&new Date(n).getTime()||0}return t}const M=(e,t)=>{const n=c(e,t),i=p(e,t);return I(e)<=n.originalArrivalTime&&0===i.originalArrivalTime},f=(e,t,n,r=!1)=>{if("newchat"===e.id||(e=>!!e&&-1!==e.indexOf("preview-"))(e.id))return!0;let a=A(e,t,n,r);if(!a&&(e=>!!e&&e.includes(i.nu))(e.id)&&e.lastContentMessageTime&&e.lastMessage&&((0,s.o3)(e.lastMessage)||(0,s.bf)(e.lastMessage.messagetype))){const t=new Date(e.lastContentMessageTime).getTime(),i=c(e,n),r=p(e,n);a=t<=i.originalArrivalTime&&0===r.originalArrivalTime}return a},A=(e,t,n,r=!1)=>{let o="";e.lastMessage&&((0,s.o3)(e.lastMessage)?o=T(e.lastMessage)||"":e.lastMessage.from&&(o=(0,a.last)(e.lastMessage.from.split("/"))||""));const l=M(e,n),d=0===p(e,n).originalArrivalTime,c=-1!==o.indexOf(t);return!!r&&c&&!!e.lastMessage?.properties?.[i.rF.OriginalMessageContext]?l:l||c&&d},T=e=>{let t="";if((0,s.o3)(e)&&e.content){const n=e.content.match(/<initiator>(.*?)<\/initiator>/i);n&&n[1]&&(t=n[1].trim())}return t},N=(e,t)=>{const{clientMessageId:n,originalArrivalTime:i}=p(e,t),r=0!==i?new Date(i).toISOString():o.EJ;return!!n&&"0"!==n&&y(r)},y=e=>{e=e?.toString();return 0!==new Date(e&&"0"!==e?e:o.EJ).valueOf()},C=(e,t,n)=>{const r=N(e,n);let a=!1;if(e.lastMessage?.messagetype===i.Go.CallRecording){const t=new Date(e.lastContentMessageTime||o.EJ),{originalArrivalTime:i}=c(e,n);a=t>new Date(i||o.EJ)}else a=!M(e,n);const s=e.lastMessage?.from,l=!!(s&&t&&s?.indexOf(t)>-1);return r||a&&!l},S=(e,t,n)=>(0,r.r0)(e.type,e.id)&&e.threadProperties?.lastjoinat>n&&!y(t),b=(e,t,n)=>{const a=parseInt(e.threadProperties?.[i.iy.CreatedAt]||"0",10);return(0,r.Mn)(e.type)&&a>n&&!y(t)}},851433:(e,t,n)=>{"use strict";n.d(t,{GE:()=>L,cc:()=>w,Yg:()=>N,qb:()=>y,PS:()=>v,iL:()=>S,Wb:()=>b,zk:()=>C,Su:()=>D,XC:()=>U,IH:()=>m,YW:()=>h,H9:()=>p,Pr:()=>E,Dj:()=>g,Fq:()=>M,X2:()=>I});var i=n(480354),r=n(25916),a=n(634664);const s=()=>o.instance;class o{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:r.hT,timestamp:void 0}}static get instance(){return o._instance||(o._instance=new o),o._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:t}){this._enabled=e,t.infoToTelemetry?.("Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:r.hT}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:t}){this.isEnabled?(this._currentAppConsumptionHorizon=(0,i.clone)(e),t.infoToTelemetry?.(`AppConsumptionHorizon updated to '${(0,a.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)):t.warnToTelemetry?.(`Tried updating appConsumptionHorizon while singleton was disabled '${(0,a.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var l=n(850434),d=n(242519),c=n(84646),u=n(797922);const p=e=>(0,d.qI)(e,T()?s().currentAppConsumptionHorizon:void 0),g=(e,t)=>(0,d.M7)(e,t,T()?s().currentAppConsumptionHorizon:void 0),m=e=>function(e){if(!e.properties)return!1;const t=e.properties[c.H0.LastImportantImTime];return A(t)>Number(f(e).originalArrivalTime)}(e),h=e=>{if(!e.properties)return!1;const t=A(e.properties[c.H0.LastImportantImTime]),n=N(e)?.originalArrivalTime,i=y(e)?.originalArrivalTime;return!!t&&!!n&&(t>n||!!i&&t>i)},I=e=>{if(!e.properties)return!1;const t=A(e.properties[c.H0.LastUrgentImTime]),n=N(e)?.originalArrivalTime,i=y(e)?.originalArrivalTime;return!!t&&!!n&&(t>n||!!i&&t>i)},M=e=>{const t=e.threadProperties[c.iy.SharedInSpaces];return!!t&&t.includes(e.parentId)},f=e=>(0,i.isEmpty)(e.properties&&e.properties[c.H0.ConsumptionHorizonBookmark])?N(e):y(e);function A(e){if(!e)return 0;const t=new Date(e);return t?t.getTime():0}function T(){return o.instance.isEnabled}const N=e=>(0,d.$G)(e,T()?s().currentAppConsumptionHorizon:void 0),y=e=>(0,d.rE)(e,T()?s().currentAppConsumptionHorizon:void 0),C=e=>(0,d.Ak)(e,T()?s().currentAppConsumptionHorizon:void 0),S=(e,t)=>(0,d.T8)(e,t,T()?s().currentAppConsumptionHorizon:void 0),b=(e,t)=>(0,d.bM)(e,t,T()?s().currentAppConsumptionHorizon:void 0),D=(e,t)=>(0,d.B7)(e,t,T()?s().currentAppConsumptionHorizon:void 0),E=(e,t,n=!1)=>(0,d.il)(e,t,T()?s().currentAppConsumptionHorizon:void 0,n),U=e=>(0,d.qJ)(e,T()?s().currentAppConsumptionHorizon:void 0),w=e=>{let t="";return e&&(t=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),t};function v(e,t){if((0,u.Z9)(e)&&(0,d.il)(e,t,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};if((0,u.IV)(e)&&!(0,d.B7)(e,t,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};const n=(0,d.I4)(s().currentAppConsumptionHorizon,e),i=(0,d.rE)(e,void 0),r=(0,d.Bd)(e),a=w({originalArrivalTime:r,timeStamp:Date.now().valueOf(),clientMessageId:e.lastMessage?.clientmessageid||"0"});let o;return n&&(0,d.qJ)(e,void 0)&&n>=i.timeStamp&&(o=c.S0),{updatedConsumptionHorizon:a,updatedConsumptionHorizonBookmark:o}}const L=({incomingCH:e,existingCH:t,loggingProps:n})=>{if(e===t)return!1;n&&n.logger.log(`Attempting to update the L2CH for rcid:{${n.replyChainId}}, convid:{${n.conversationId}}. Existing:${t}, Incoming:${e}`,n.loggingContext);const i=Number(e),r=Number(t);return!(isNaN(i)||!(isNaN(r)||i>r))||(n&&n.logger.error(`Rejected updating the L2CH for rcid:{${n.replyChainId}}, convid:{${n.conversationId}}. Existing:${t}, Incoming:${e}`,n.loggingContext,l.O4.InvalidInput),!1)}},737915:(e,t,n)=>{"use strict";n.d(t,{Jy:()=>Y,Ph:()=>p,rf:()=>g,CA:()=>k,IB:()=>W,FV:()=>Q,oB:()=>R,BV:()=>L,IG:()=>z,_5:()=>x,oQ:()=>V,Ns:()=>j,qX:()=>E,y$:()=>M,aY:()=>h,Wq:()=>y,vQ:()=>D,GW:()=>w,n2:()=>v,RY:()=>Z,CR:()=>F,j7:()=>O,Cy:()=>U,oI:()=>m,Z:()=>C,FF:()=>S,t0:()=>b,SL:()=>_,nK:()=>N,kO:()=>P,cR:()=>B,tH:()=>f});var i=n(754255),r=n(84646),a=n(574566),s=n(480354),o=n(680499),l=n(806658),d=n(473107);var c=n(645095);var u=n(504856);const p=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:n,quarantineCounter:a,creator:s,currentUserMri:o},l)=>{let d=r.$y.Accepted;if(e){if(t){const e=s===o,{maxInviteFreeQuarantineCounter:t}=l.get(i.w.People),c=a>=(t||0);n&&!e?d=r.$y.AcceptPending:e&&c&&(d=r.$y.Quarantined)}}else d=r.$y.Blocked;return d},g=(e,t)=>e===r.j5.Accept?r.$y.Accepted:e===r.j5.Block?r.$y.Blocked:e===r.j5.Unblock&&t?r.$y.Accepted:r.$y.AcceptPending,m=e=>!!e?.startsWith(r.gN.PhonelinkSmsPrefix),h=(e,t)=>M(e.id,t)&&y(e,t)&&!I(e,t),I=(e,t)=>{const{enableMessagingGoldenGateCSV1:n}=t.get(i.w.Messaging);return!(!n||!(0,u.tK)(e.id)||"true"!==e?.properties?.conversationblocked?.toString().toLowerCase()&&e?.properties?.interopconversationstatus!==r.$y.Blocked)},M=(e,t)=>{if(!T(e))return!1;const{overrideThreadTypeForPrivateFeeds:n}=t.get(i.w.Sync);return(!(0,l.JO)(e)||!n)&&!m(e)},f=(e,t,n)=>{if(!e)return"";if((0,l.zh)(e,!0)){n.errorToTelemetry?.(`Reply chain ID found in conversation ID: ${e}. CallerInfo: ${t}`,"cdl_conversations_fetch",{reason:t,conversationId:e},!0);const{isValid:i,conversationId:r}=(0,l.my)(e);if(i)return r}return e},A=/^\d+[:]{1}.+/,T=e=>!(0,s.isUndefined)(e)&&e!==r.bY&&!m(e)&&!e.includes(r.pK)&&!e.includes(r.LH)&&A.test(e),N=e=>e.startsWith(r.zD)?"MRI conv id":e,y=(e,t)=>!(S(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(i.w.Messaging),{isSfbCloud:n,isSipEnabled:r,isSfbCloudInBVD:a,isSipEnabledInBVD:s}=e.get(i.w.UserResources);return!!(t?s&&a:r&&n)}(t));function C(e){return((0,s.isString)(e)?e:e.id).endsWith(r.L)}function S(e){return((0,s.isString)(e)?e:e.id).endsWith(r.lo)}const b=e=>!!e&&S(e),D=e=>{const t=e.memberProperties?.[r.UO.RelationshipState];return!!t?.edRedemptionRequired},E=(e,t)=>{const n=e.memberProperties?.[r.UO.RelationshipState],i=!!t&&!!(0,u.tK)(e.id)&&"true"===e?.properties?.conversationblocked?.toString().toLowerCase();return!!n?.blockTime||i};const U=e=>!!e.memberProperties?.[r.UO.IsModerator],w=e=>e.threadProperties&&!!e.threadProperties[r.iy.ParentSpaces],v=e=>e.threadProperties&&e.threadProperties[r.iy.ThreadType]===a.b.Team&&w(e),L=e=>{if(e.threadProperties&&e.threadProperties?.[r.iy.ParentSpaces])try{const t=JSON.parse(e.threadProperties?.[r.iy.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},k=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,n=t?JSON.parse(t):void 0;return n?n.meetingType:void 0}catch{return}},x=(e,t,n)=>{if(t){const{enableStreamChatFeature:e,forceCommentStreamForConversations:r}=t.get(i.w.Calling);if(!e)return!1;if(n&&(r??[]).includes(n))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const t=e.toLowerCase();return"true"===t||"on"===t||"1"===t}return!1}(e.isLiveChatEnabled)},F=e=>O(e.type),O=e=>!!e&&e.toLowerCase&&e.toLowerCase()===r.Cr.Meeting.toLowerCase(),P=e=>{let t;if(F(e)&&e.threadProperties.meeting)try{const n=JSON.parse(e.threadProperties.meeting);n.subject&&(t=n.subject)}catch{return t}return t},j=e=>e===r.Go.Text||e===r.Go.RichText||e===r.Go.HTML,R=e=>!!e.members?.some((e=>(0,l.W4)(e.id))),z=e=>e.id===o.lD.CallLogConversationId||e.id===o.lD.SharedCallLogConversationId||(0,l._5)(e?.threadProperties?.threadType),B=e=>{if(e===r.uN)return!1;const t=1209600*d.om*.5;if(!e||isNaN(e))return!0;return e-Date.now()<t},V=e=>e?.threadProperties&&(e?.threadProperties[r.iy.ThreadType]===a.b.Community||e?.threadProperties[r.iy.SpaceType]===r.iy.SpaceType_Community),_=e=>e?.threadProperties&&e?.threadProperties[r.iy.ThreadType]===a.b.SubCommunity,W=e=>e.threadProperties&&e.threadProperties[r.iy.SubstrateGroupId]||"",Q=e=>{const t=e.threadProperties?.[r.iy.ThreadSubType]?.toLowerCase();return t||c.jZ.Unknown},Y=e=>{const t=e.threadProperties&&e.threadProperties[r.iy.ThreadType];return G(t)},G=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"},Z=e=>O(e.type)&&"lobby"===e.threadProperties?.meetingChatType?.toLowerCase()},797922:(e,t,n)=>{"use strict";n.d(t,{UZ:()=>m,kp:()=>h,xL:()=>I,CT:()=>M,oy:()=>f,bI:()=>A,I_:()=>T,bJ:()=>N,kW:()=>y,lz:()=>C,xH:()=>S,GK:()=>b,Yt:()=>D,FA:()=>E,PP:()=>w,j8:()=>v,E0:()=>L,IJ:()=>k,bl:()=>x,yT:()=>F,Rt:()=>O,BA:()=>j,s8:()=>R,nX:()=>z,Z9:()=>B,r0:()=>V,pB:()=>_,lE:()=>W,as:()=>Q,_Y:()=>Y,tf:()=>G,DQ:()=>Z,IV:()=>H,Mn:()=>J,Zl:()=>X,xt:()=>q,SG:()=>K,Zp:()=>$,mT:()=>ee,Vj:()=>te,HV:()=>ne,yW:()=>ie,CF:()=>re,ZV:()=>ae,uF:()=>se,vz:()=>oe,B6:()=>le,oh:()=>de,LK:()=>ce,Y5:()=>ue,Gw:()=>pe,mz:()=>ge,aJ:()=>me,iF:()=>he,h1:()=>Ie,NX:()=>Me,K$:()=>fe,CN:()=>Ae,LN:()=>Te,qL:()=>ye,je:()=>Ce,mv:()=>Se,sx:()=>be,bP:()=>De,Cy:()=>Ee,wI:()=>we,$i:()=>ke,kE:()=>xe,d2:()=>Fe,__:()=>Oe,CE:()=>Pe,Yp:()=>je,XS:()=>Re,Ce:()=>ze,rD:()=>Be,xl:()=>Ve,L5:()=>_e,nv:()=>We,cQ:()=>Qe,Am:()=>Ye,Xv:()=>Ge,UC:()=>Ze,Dt:()=>He,kA:()=>Je,V8:()=>Xe,$T:()=>qe,W:()=>Ke,Ps:()=>$e,Vb:()=>et,Gy:()=>tt,ZT:()=>nt,WH:()=>it,rq:()=>rt,OW:()=>at,EO:()=>lt,F$:()=>dt,T4:()=>ct,MO:()=>ut,Nb:()=>pt,OK:()=>gt,n_:()=>mt,$x:()=>ht,ze:()=>It,bX:()=>Mt,Zn:()=>ft,nG:()=>At,OA:()=>Tt,AJ:()=>Nt,ME:()=>yt,mb:()=>Ct,f9:()=>St,S9:()=>bt,QP:()=>Dt,Bt:()=>Et,mp:()=>Ut});var i=n(680499),r=n(480354),a=n(754255),s=n(806658),o=n(84646),l=n(574566),d=n(645095),c=n(737915),u=n(404603),p=n(694296),g=n(504856);var m;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(m||(m={}));const h=e=>{const t=E(e);return(0,c.FF)(e)?t:t||(0,c.t0)(e)},I=(e,t)=>{const n=e.threadProperties?.[o.iy.Creator]||null;return t&&(0,g.x_)(e.id)&&n?n.split(";")[0]:n},M=e=>e.threadProperties&&e.threadProperties[o.iy.CreatedAt]?e.threadProperties[o.iy.CreatedAt]:null,f=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[o.iy.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},A=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[o.H0.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},T=e=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const t=oe(e);return 0!==t&&(!(0,r.isNil)(e.lastMessageTimeUtc)&&t>=e.lastMessageTimeUtc)},N=e=>!(!e.properties||!e.properties[o.H0.Followed])&&"true"===e.properties[o.H0.Followed]?.toLowerCase(),y=e=>!(!e.properties||!e.properties[o.H0.Collapsed])&&"true"===e.properties[o.H0.Collapsed]?.toLowerCase(),C=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,S=e=>-1===e.detailsVersion&&-1===e.threadVersion,b=e=>C(e)||!pe(e);function D(e=""){return e.includes(o.pK)||e.includes(o.LH)||e===o.bY}const E=e=>(0,s.ye)(e.id,e?.threadProperties?.threadType)&&D(e.id),U="lwgChannelLie-",w=e=>`${U}${e}`,v=e=>e.startsWith(U),L=e=>H(e)&&e.properties&&!!e.properties.isLie,k=e=>e.threadProperties&&(e.threadProperties[o.iy.ThreadType]===l.b.Team||e.threadProperties[o.iy.ThreadType]===l.b.Community)&&!(0,c.GW)(e),x=e=>!(e.threadProperties[o.iy.ParentSpaces]||!e.threadProperties[o.iy.SubstrateGroupId]||!e.threadProperties[o.iy.GroupId]||e.threadProperties[o.iy.ThreadSubType]),F=e=>k(e)&&!x(e),O=e=>$(e)?$e(e)||"":Me(e)||"";function P(e){return!!e.threadProperties&&e.threadProperties[o.iy.ThreadType]===l.b.Team}const j=e=>{if(e.properties){if(e.properties[o.H0.Favorite])return"true"===e.properties[o.H0.Favorite]?.toLowerCase();if(P(e))return!0}return!1},R=e=>!e.properties||void 0===e.properties[o.H0.GeneralChannelFavorite]||null===e.properties[o.H0.GeneralChannelFavorite]||"true"===e.properties[o.H0.GeneralChannelFavorite]?.toLowerCase(),z=e=>{const t=k(e);return t&&R(e)||!t&&j(e)},B=(e,t=!1)=>V(e.type,e.id,t),V=(e,t,n=!1)=>!(0,r.isNil)(e)&&(e.toLowerCase()===o.Cr.Thread.toLowerCase()&&(0,g.x_)(t)||e.toLowerCase()===o.Cr.Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhoneChat.toLowerCase()||e.toLowerCase()===o.Cr.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===o.Cr.OneOnOne.toLowerCase()||e.toLowerCase()===o.Cr.StreamOfNotes.toLowerCase()||!n&&(0,c.j7)(e)),_=e=>e.type===o.Cr.RCC,W=e=>e.id===i.lD.NotificationConversationId||(0,s.p3)(e?.threadProperties?.threadType),Q=e=>e===i.lD.AnnotationsConversationId,Y=e=>e.id===i.lD.DraftsConversationId,G=e=>Z(e.type),Z=e=>e===o.Cr.EngageCommunity,H=e=>J(e.type),J=e=>e===o.Cr.Team||e===o.Cr.Topic,X=e=>ge(e)===d.Cu.Shared,q=e=>ge(e)===d.Cu.Standard,K=e=>[o.SG,o.Vn].includes(e.id),$=e=>(0,c.n2)(e)&&(0,c.BV)(e)&&ge(e)===d.Cu.Private,ee=e=>k(e)&&!!e.memberProperties&&!!e.memberProperties[o.UO.ChannelOnlyMember],te=e=>{if(!(0,c.CR)(e))return!1;const t=(0,c.CA)(e);return!!t&&t===o.Wf.MeetNow},ne=e=>{if(!(0,c.CR)(e))return!1;const t=(0,c.CA)(e);return!!t&&t===o.Wf.Scheduled},ie=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(o.kv)?o.kv+t:t),re=(e,t,n=!1)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=t.get(a.w.Sync),r=i||X(e)||n?e.threadProperties.retentionHorizonV2:0;return r&&isFinite(Number(r))?Number(r):0},ae=(e,t)=>e?.members?.find((e=>e.id===t))?.shareHistoryTime??0,se=e=>e?.members?.some((e=>!isNaN(Number(e.shareHistoryTime))&&0!==Number(e.shareHistoryTime)))??!1,oe=e=>{if(!e.properties)return 0;if(A(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const t=B(e)?e.properties.clearHistoryTime:0;return t&&isFinite(Number(t))?Number(t):0},le=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,de=(e,t,n)=>{const i=re(t,n,!n.get(a.w.Sync).disableForceRetentionHorizonInSyncValidation);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},ce=(e,t)=>{const n=oe(t),i=Number(e);return!isNaN(i)&&!isNaN(n)&&i<n},ue=(e,t,n=!1,i=!1)=>{if((0,s.ye)(e.id,e?.threadProperties?.threadType)&&!C(e)){if(e.memberProperties&&!(0,r.isEmpty)(e.memberProperties)&&n)return e.memberProperties[o.UO.ExpirationTime];if(e.memberProperties&&!(0,r.isEmpty)(e.memberProperties)||!n||!i){if(e.members&&t){const n=(0,r.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[o.UO.ExpirationTime]}}},pe=(e,t)=>!(0,s.ye)(e.id,e?.threadProperties?.threadType)||!C(e)&&!f(e)&&((0,r.isArray)(e.members)&&t?(0,r.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&H(e)&&!e.threadProperties[o.iy.LastLeaveAt]&&!e.threadProperties[o.iy.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[o.iy.LastLeaveAt]&&(!e.threadProperties[o.iy.LastJoinAt]||e.threadProperties[o.iy.LastJoinAt]<e.threadProperties[o.iy.LastLeaveAt])));function ge(e){if(!e||!H(e))return;const t=e.threadProperties[o.iy.SpaceTypes],n=t?parseInt(t,10):0,i=!!e.threadProperties[o.iy.SubstrateGroupId],r=(0,c.FV)(e);return x(e)?d.Cu.Standalone:i?r===d.jZ.PrivateChannel?d.Cu.Private:d.Cu.Shared:(n&d.QU.Private)===d.QU.Private?d.Cu.Private:d.Cu.Standard}const me=(e,t)=>{if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=e.lastMessage?.from;if(!n)return!1;return t===(0,r.last)(n.split("/"))},he=(e,t)=>(0,r.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),Ie=(e,t,n)=>{let i;const a=!e.members||!!e.members&&(0,r.some)(e.members,(e=>!e));if(n&&!a){const r=he(e,t);i=E(e)&&1===r.length?n[r[0]]:n[e.id]}return i},Me=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(B(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,c.CR)(e)){const n=(0,c.kO)(e);n&&(t=n)}return t}if(P(e)&&ke(e)){const t=$e(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,n=e.threadProperties[o.iy.TopicThreadTopic];if(n&&n.trim())return n;if(t&&t.trim())return t}}return""},fe=(e,t=!1)=>B(e,!0)&&!_e(e.id)&&!Ae(e,t),Ae=(e,t=!1)=>{const n=e.members&&e.members.length<=2;return B(e,!0)&&n&&(Ee(e)||E(e)||Le(e)||!t&&ve(e)||Ne(e))&&!e.members?.some((e=>(0,s.mD)(e.id)))},Te=e=>Ae(e)&&e.members?.some((({id:e})=>(0,s.Iz)(e))),Ne=e=>e.members&&e.members.length<=2&&Ue(e)&&(e.type===o.Cr.PhoneChat||e.threadProperties&&e.threadProperties[o.iy.ThreadType]===l.b.PhoneChat),ye=e=>(0,c.oI)(e),Ce=e=>ye(e.id),Se=e=>!!e&&((0,s.Ku)(e)||(0,s.gZ)(e)||(0,s.aL)(e)||(0,s.vd)(e)),be=e=>e.type===o.Cr.PhonelinkGroupChat,De=e=>e.threadProperties?.productContext===i.z_.SFL,Ee=e=>e.type===o.Cr.Phonelink1on1Chat,Ue=e=>(0,r.some)(e.members,(e=>!!e.id&&e.id.startsWith(o.gN.Pstn))),we=(e,t)=>{const n=e?.get(a.w.Messaging)?.enableSkypeMessagesInTFL;return!!n&&(!!t&&(De(t)||(0,g.x_)(t.id)))},ve=e=>B(e,!0)&&e.members&&2===e.members.length&&!(0,r.isNil)(e.threadProperties)&&parseInt(e.threadProperties[o.iy.CreatedAt],10)<o.If,Le=e=>!!e.id&&e.id.indexOf(o.W0)>-1||(0,s.CM)(e.threadProperties)||!!e?.id&&(0,g.tK)(e?.id),ke=e=>e.threadProperties&&e.threadProperties[o.iy.ThreadType]===l.b.Topic||$(e)||X(e)||(0,c.SL)(e)||L(e),xe=e=>(0,c.t0)(e),Fe=e=>Ve(e&&e.id),Oe=e=>xe(e)||(e=>je(e))(e)||Fe(e),Pe=e=>je(e)||(0,c.t0)(e),je=e=>{const t=(0,r.isString)(e)?e:e.id;return(0,r.endsWith)(t,o.L)||(0,r.endsWith)(t,o.s8)||(0,r.startsWith)(t,o.iB)},Re=e=>je(e)||at(e),ze=e=>je(e)||st(e),Be=(e,t)=>lt(e)!==t,Ve=e=>!!e&&((0,r.endsWith)(e,o.wx)||(0,r.startsWith)(e,o.Rq)),_e=e=>e===o.cB,We=e=>{const t=e.members||[];return e.members&&e.members.length<=2&&t.some((e=>e.id===o.xv))&&(De(e)||(0,g.tK)(e.id))},Qe=(e,t)=>!!t.get(a.w.Messaging).hideBlockedOneOnOneChat&&Ae(e)&&((0,c.qX)(e,!!t.get(a.w.Messaging).enableMessagingGoldenGateCSV1)||e?.properties?.interopconversationstatus===o.$y.Blocked),Ye=(e,t)=>{const n=(e.members||[]).some((e=>t?.includes(e.id))),i=Ae(e)&&(De(e)||(0,g.tK)(e.id));return n&&i},Ge=e=>!(e.id!==o.cB||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),Ze=e=>{const t=(0,r.endsWith)(e,o.L)||(0,r.endsWith)(e,o.s8)||(0,r.startsWith)(e,o.iB),n=e.endsWith(o.lo),i=Ve(e);return t||n||i},He=e=>{const t=ue(e),n=t&&t<Date.now();return pe(e)&&!n},Je=e=>{if(e.threadProperties&&e.threadProperties[o.iy.Topics]){const t=e.threadProperties[o.iy.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch{return[]}}return[]},Xe=(e,t)=>{const n=Je(e);for(const e of n)if(e.id===t)return e.isShared??!1;return!1},qe=(e,t)=>{const n=Je(e);for(const e of n)if(e.id===t)return e.archivalLevel?.trim().toLowerCase()},Ke=e=>!!e?.some((e=>(0,s.Iz)(e))),$e=e=>{if(e.threadProperties){if(e.threadProperties[o.iy.XTeamName])return e.threadProperties[o.iy.XTeamName];if(e.type===o.Cr.Team&&e.threadProperties.topic)return e.threadProperties.topic}},et=e=>{const t=Je(e),n=$e(e);return t.map((t=>{const i={},r=t.name;return i[o.iy.CreatedAt]=parseInt(t.createdat,10),i[o.iy.Picture]=t.picture,i[o.iy.IsDeleted]=t.isdeleted,i[o.iy.XTeamName]=t.isShared?r:n,i.topic=r,i[o.iy.TopicThreadTopic]=r,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:o.Cr.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},tt=e=>{if(e.parentId)return e.parentId;if((0,c.GW)(e))try{const t=JSON.parse(e.threadProperties[o.iy.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,r.isEmpty)(n))return n}catch{return}},nt=e=>{const t=e.threadProperties&&e.threadProperties[o.iy.SpaceId];return(k(e)?e.id:(0,c.GW)(e)?tt(e):t)||e.teamId},it=e=>{const t=e?e.trim().toLowerCase():void 0;return"true"!==t&&("false"===t||void 0)},rt=e=>e.threadProperties&&((0,r.isBoolean)(e.threadProperties[o.iy.GapDetectionEnabled])?e.threadProperties[o.iy.GapDetectionEnabled]:"true"===(0,r.lowerCase)(e.threadProperties[o.iy.GapDetectionEnabled])),at=e=>!!Ae(e)&&st(e),st=e=>{const t=lt(e);return t&&!je(e)&&(0,r.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||ot(e.id)||ot(e.localClientId||"")},ot=e=>(0,r.startsWith)(e,o.hd),lt=e=>e.threadProperties&&e.threadProperties[o.iy.TenantId],dt=e=>{const t=e.threadProperties[o.iy.ArchivalLevel],n=k(e)&&!!t&&t.toLowerCase()===o.L6.Space.toLowerCase(),i=H(e)&&!!t&&(t.toLowerCase()===o.L6.Topic.toLowerCase()||t.toLowerCase()===o.L6.Space.toLowerCase());return n||i},ct=e=>{if(!e||!e.properties)return!1;const t=e.properties[o.H0.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},ut=e=>{const t=e.memberProperties?.[o.UO.RelationshipState],n=e.properties?.conversationstatus;return!!t?.inQuarantine||n===o.YH.AcceptPendingRecipient},pt=e=>{const t=e.memberProperties?.[o.UO.RelationshipState];return"number"==typeof t?.quarantineCounter?t?.quarantineCounter:0},gt=e=>!!e.memberProperties?.[o.UO.ExplicitlyAdded],mt=e=>e?.properties?.suppressLastMessageUpdate===o.XR.Sender,ht=e=>Ae(e)&&!e.usersProps?.hasFederatedUser&&(0,r.every)(e.members,(e=>e.id?.startsWith(o.kv)))||!1,It=e=>!(!k(e)||parseInt(e.threadProperties?.[o.iy.SpaceTypes],10)!==d.QU.TenantWide),Mt=(e,t)=>ft(e.threadProperties&&e.threadProperties[o.iy.TenantId]||"",t),ft=(e,t)=>!(!t||""===t||!e||e===t),At=(e,t)=>!(!k(e)||Mt(e,t)||It(e)||f(e)||!pe(e)||ee(e)),Tt=e=>{if(e?.meetingInfo)try{const t=["Accepted","Declined","Follow","Tentative","None"],n=JSON.parse(e.meetingInfo)?.rsvpStatus;return n&&t.includes(n)?n:"None"}catch(e){return"None"}return"None"},Nt=(e,t,n,i)=>{if(i&&n?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications&&i===e.threadProperties[o.iy.Creator])return!1;const{meetingChatNotification:r=u.AP.MeetingsUserParticipatesIn,meetingChatNotificationForAcceptedMeetings:s=u.AP.MeetingsUserIsInvitedTo,meetingChatNotificationForTentativeMeetings:l=u.AP.MeetingsUserParticipatesIn}={...t},d=u.AP.MeetingsUserIsInvitedTo,c=r!==d;if(!n?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications)return c||!1;const p=s!==d,g=l!==d;try{const t=e?.properties;switch(Tt(t)){case"Declined":case"Follow":return!0;case"Accepted":return p||!1;default:return g||!1}}catch(e){return g||!1}},yt=(e,t,n,i)=>{const r=it(e?.properties?.alerts);return void 0!==r?r:!!(0,s.Qi)(e.id)&&Nt(e,t,n,i)};function Ct(e){if(!H(e)||F(e)||$(e))return!1;const t=ue(e);return t!==o.uN&&(!t||t<Date.now())}const St=e=>bt(e)&&X(e),bt=e=>H(e)&&!f(e)&&!dt(e)&&z(e)&&pe(e),Dt=(e,t)=>{const n=e.threadProperties[o.iy.CreatedAt]||"0";return wt(n)<t},Et=(e,t)=>e.threadProperties[o.iy.Creator]===t,Ut=e=>k(e)&&"General"!==e.threadProperties[o.iy.TopicThreadTopic],wt=e=>(0,p.Ql)(parseInt(e,10),Date.now(),"seconds")},504856:(e,t,n)=>{"use strict";n.d(t,{tK:()=>c,x_:()=>u,W:()=>p,EQ:()=>g,io:()=>m,B5:()=>h,uu:()=>I,FH:()=>f,Bh:()=>A});var i=n(754255),r=n(84646),a=n(680499);const s="@oneToOne.skype",o=/^8:(.+?):8:(.+)$/,l=1738368e6,d=1751328e6,c=e=>e?.startsWith(r.gN.SkypeSpacesThread)&&e?.endsWith(s),u=e=>e?.startsWith(r.gN.SkypeSpacesThread)&&(e?.includes(s)||e?.includes("@thread.skype")||e?.includes("@p2p.thread.skype")),p=e=>!!e&&o.test(e),g=e=>!!e&&!!c(e.id)&&!!e.threadProperties?.onetoonev2threadid?.includes("@thread.v2");function m(e,t,n,r,s,o){const c=r?.get(i.w.Messaging)?.enableSkypeMessagesInTFL;if(!c)return!1;const p=new Date(r?.get(i.w.Messaging).goldenGateCutOffDate||l),g=new Date(r?.get(i.w.Messaging)?.csv2MigrationCutOffDate||d),m=t?new Date(t):null;return e?.formatVariant?e?.formatVariant===a.kI.Sfl:!!(M(o)||m&&m<p&&s===a.z_.SFL||m&&u(n)&&m<g)}function h(e){return!!e?.endsWith(r.Ih)}function I(e){return e.members?.some((e=>e.id?.startsWith(r.gN.Lync)))||!1}const M=e=>{const t=new Set([r.Go.URIAudioObject,r.Go.MediaGenericFile,r.Go.UriVideoObject]);return!!e&&t.has(e)},f=(e,t)=>{const{enableSkypeMessagesInTFL:n,skypeBotIds:a}=t?.get(i.w.Messaging)??{};if(!n)return!1;return new Set([r.Go.SkypeTranslation,r.Go.SkypeCopilotToggle,r.Go.SkypeTranslationSettings]).has(e.type)||a?.some((t=>e.from?.includes(t)))||e.type===r.Go.AddMember&&a?.some((t=>e.content?.includes(t)))},A=(e,t)=>!!u(e?.id)&&!e.members?.some((({id:e})=>e===t))},580458:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var i=n(84646);const r=(e,t,n)=>{if(t===i.Go.HTML){if(a(e,n))return i.Go.Collaborate;if(s(e,n))return i.Go.Embed}return t},a=(e,t)=>{const n=o(e,t);if(!n)return!1;const i=n.find((e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!i&&!!i.content.componentUrl},s=(e,t)=>{const n=o(e,t);if(!n)return!1;const i=n.find((e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!i&&!!i.content.componentUrl},o=(e,t)=>{if(t?.cards)try{return JSON.parse(t.cards)}catch(t){e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards.")}return null}},404603:(e,t,n)=>{"use strict";n.d(t,{AP:()=>i,nM:()=>r,$Q:()=>a,KO:()=>s,I_:()=>o,vn:()=>l});const i={MeetingsUserIsInvitedTo:"MeetingsUserIsInvitedTo",MeetingsUserParticipatesIn:"MeetingsUserParticipatesIn",MeetingsManuallyUnmuted:"MeetingsManuallyUnmuted"},r={VOICE_CALL:"VOICE_CALL",VIDEO_CALL:"VIDEO_CALL"},a={aggregatedLikeInChatAndChannel:"AggregatedLikeInChatAndChannel",aggregatedMentionsInTeamAndChannel:"AggregatedMentionsInTeamAndChannel",aggregatedPersonalMention:"AggregatedPersonalMention",aggregatedReplyAndReplyToReply:"AggregatedReplyAndReplyToReply",alertSound:"alertSound",alertSoundType:"alertSoundType",alertUrgentSoundType:"alertUrgentSoundType",allowUrgentNotifications:"allowUrgentNotifications",appNotificationEnabled:"appNotificationEnabled",callTransferFailed:"CallTransferFailed",chat:"Chat",dLPNotifySender:"DLP_NotifySender",downloaded:"Download_Downloaded",downloadFailed:"Download_DownloadFailed",downloadStarted:"Download_DownloadStarted",emailDigestDelay:"EmailDigestDelay",emailNotificationDelay:"EmailNotificationDelay",error:"Error",followChannelNewMessage:"Follow_ChannelNewMessage",followChannelReplyMessage:" Follow_ChannelReplyMessage",globalMention:"Global_Mention",globalSoundAndPreview:"GlobalSoundAndPreview",hideNotificationDuringCallsAndMeetings:"HideNotificationDuringCallsAndMeetings",huddleStartedNotification:"HuddleStartedNotification",liveMeetingStatusBanner:"liveMeetingStatusBanner",incomingCallsAndMeetingStartSound:"IncomingCallsAndMeetingStartSound",inferred:"Inferred",like:"Like",likeInChat:"LikeInChat_v2",newContactOnTeamsNotification:"newContactOnTeamsNotification",meetingChatNotification:"MeetingChatNotification",meetingChatNotificationForAcceptedMeetings:"MeetingChatNotification_AcceptedMeeting",meetingChatNotificationForTentativeMeetings:"MeetingChatNotification_TentativeMeeting",meetingWentLiveNotification:"MeetingWentLiveNotification",mentionChannel:"Mention_Channel",mentionInChat_Everyone:"MentionInChat_Everyone",mentionInChat_Nearby:"MentionInChat_Nearby",mentionInChat_Person:"MentionInChat_Person_v2",mentionPerson:"Mention_Person",mentionTag:"Mention_Tag",mentionTeam:"Mention_Team",messageSendFailed:"MessageSendFailed",msGraphChannelMeetingCanceled:"channelMeetingCanceled",msGraphChannelMeetingCreated:"channelMeetingCreated",msGraphChannelMeetingForwarded:"channelMeetingForwarded",msGraphChannelMeetingForwardedWithoutOrganizer:"channelMeetingForwardedWithoutOrganizer",msGraphChannelMeetingUpdated:"channelMeetingUpdated",msGraphDelegateMeetingCanceled:"delegateMeetingCanceled",msGraphDelegateMeetingCreated:"delegateMeetingCreated",msGraphDelegateMeetingUpdated:"delegateMeetingUpdated",msGraphMeetingOrganisedByMe:"privateMeetingForwardedNotification",msGraphMeetingSentToMe:"privateMeetingCreated",msGraphPrivateMeetingCanceled:"privateMeetingCanceled",msGraphPrivateMeetingForwarded:"privateMeetingForwarded",msGraphPrivateMeetingForwardedNotificationWithAttendee:"privateMeetingForwardedNotificationWithAttendee",msGraphPrivateMeetingForwardedNotificationWithAttendeeAndTotal:"privateMeetingForwardedNotificationWithAttendeeAndTotal",msGraphPrivateMeetingForwardedNotificationWithTwoAttendee:"privateMeetingForwardedNotificationWithTwoAttendee",msGraphPrivateMeetingUpdated:"privateMeetingUpdated",muteGenericNotifications:"muteGenericNotifications",notificationStyleList:"NotificationStyleList",playNotificationSoundsForUrgentAndPriority:"PlayNotificationSoundsForUrgentAndPriority",playNotificationSoundsWhenBusyOrInMeetings:"PlayNotificationSoundsWhenBusyOrInMeetings",presenceStatus:"PresenceStatus",priority:"Priority",projectBoardAssignments:"ProjectBoardAssignments",repliesInFollowedThreads:"RepliesInFollowedThreads",reply:"Reply",replyToPolls:"ReplyToPolls",replyToReply:"ReplyToReply",resetTeamsAndChannelsSettings:"Reset_Teams_And_Channels_Settings",respectOsDnDForCustomToasts:"RespectOsDnDForCustomToasts",selectedPreset:"selectedPreset",showNotificationDuringCallsAndMeetings:"ShowNotificationDuringCallsAndMeetings",showPreviewInToasts:"ShowPreviewInToasts",showUnreadChatsRemindersInToasts:"showUnreadChatsRemindersInToasts",staffHub:"StaffHub",teamMembershipChangeAddedToSharedChannel:"TeamMembershipChange_AddedToSharedChannel",teamMembershipChangeAddedToTeam:"TeamMembershipChange_AddedToTeam",teamMembershipChangePendingOnBehalfOfJoinRequest:"TeamMembershipChange_PendingOnBehalfOfJoinRequest",teamMembershipChangePendingOnBehalfOfJoinRequestMultiple:"TeamMembershipChange_PendingOnBehalfOfJoinRequestMultiple",teamMembershipChangePendingSelfJoinRequest:"TeamMembershipChange_PendingSelfJoinRequest",teamMembershipChangePromotedToSharedChannelOwner:"TeamMembershipChange_PromotedToSharedChannelOwner",teamMembershipChangePromotedToTeamAdmin:"TeamMembershipChange_PromotedToTeamAdmin",teamMembershipChannelOwnerUnshareTeamOwnerNotify:"TeamMembershipChange_ChannelOwnerUnshareTeamOwnerNotify",teamMembershipTeamOwnerUnshareChannelOwnerNotify:"TeamMembershipChange_TeamOwnerUnshareChannelOwnerNotify",teamMembershipTeamShareTeamOwnerNotify:"TeamMembershipChange_TeamShareTeamOwnerNotify",teamsTasks:"TeamsTasks",thirdParty_Bot:"ThirdParty_Bot",trending:"Trending",useTeamsChimeForToasts:"useTeamsChimeForToasts",visibleChannelMention_v2:"Visible_ChannelMention_v2",visibleChannelNewMessage_v2:"Visible_ChannelNewMessage_v2",visibleChannelReplyMessage_v2:"Visible_ChannelReplyMessage_v2"};var s,o;!function(e){e[e.AllActivity=1]="AllActivity",e[e.MyAtMentions=2]="MyAtMentions",e[e.Custom=3]="Custom"}(s||(s={})),function(e){e.MainPage="notification_settings_text",e.GraphPage="notification_settings_graph_apps_subheader_text",e.ChatPage="notification_settings_details_chat_subheader_text",e.MeetingsPage="notification_settings_details_only_meetings_subheader_text",e.TeamsChannelCustomisedPage="notification_settings_details_teams_channel_button_custom_label",e.CallGroupPage="group_call_forwarding_notification_setting"}(o||(o={}));const l="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"},846026:(e,t,n)=>{"use strict";var i,r,a;n.d(t,{d1:()=>i,gI:()=>r,f_:()=>a,Kq:()=>s,wf:()=>o,Hh:()=>l,ui:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.callTransferV2SubsequentFilters="callTransferV2SubsequentFilters",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.followPresence="followPresence",e.statusNote="statusNote",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.externalSuggestedContacts="externalSuggestedContacts",e.forwardMessage="forwardMessage",e.virtualEvent="virtualEvent",e.flyout="flyout",e.fluidAtMention="fluidAtMention",e.chatNotesAtMention="chatNotesAtMention",e.signersList="signersList",e.addToCommunities="addToCommunities",e.copyTags="copyTags",e.adaptiveCard="adaptiveCard",e.selectPeopleFilter="selectPeopleFilter",e.addToMeetingRegularChannel="addToMeetingRegularChannel",e.tflDefault="tflDefault",e.tflZeroStateFallback="tflFilterFallback",e.powerbar="powerbar",e.forwardMessageSingleSelection="forwardMessageSingleSelection",e.callForwardNoUserSelection="callForwardNoUserSelection",e.pickerFilterFallback="pickerFilterFallback",e.callingDefault="callingDefault",e.powerbarSearchV2Filter="powerbarSearchV2Filter"}(i||(i={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.Copilots="Copilots",e.CallQandAA="CallQandAA",e.Channels="Channels",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.ExpandedPersonalContact="ExpandedPersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.SkypeConsumer="SkypeConsumer",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers",e.NonEmailSecurityGroupsWithDLs="NonEmailSecurityGroupsWithDLs",e.UnNamedGroupChats="UnNamedGroupChats",e.Teams="Teams",e.ChannelsWithPostPermissions="ChannelsWithPostPermissions"}(r||(r={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(a||(a={}));const s={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},o={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},l={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},8720:(e,t,n)=>{"use strict";n.d(t,{H:()=>l,G:()=>o});var i=n(846026);const r={[i.d1.callForwardGroupSelection]:[i.gI.AADTenant,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Pstn,i.gI.CallQandAA],[i.d1.meetingRoomCall]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.DisabledUser,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.PersonalContact,i.gI.CallQandAA,i.gI.Federated,i.gI.FederatedConsumer,i.gI.ImplicitContacts,i.gI.SkypeConsumer,i.gI.TflConsumer],[i.d1.searchSuggestions]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.GroupChats,i.gI.Xtap,i.gI.Meetings,i.gI.TflSmsName,i.gI.SkypeConsumer],[i.d1.addToMeetingForSharedChannel]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.TeamTags,i.gI.GroupChats,i.gI.Xtap,i.gI.TflOffNetworkEmails,i.gI.TflOffNetworkPhones,i.gI.TflConsumer,i.gI.SkypeConsumer,i.gI.ImplicitContacts],[i.d1.calendarPeoplePicker]:[i.gI.AADTenant,i.gI.Guest,i.gI.Federated,i.gI.DisabledUser,i.gI.PersonalContact,i.gI.ModernGroup,i.gI.DL,i.gI.SkypeConsumer],[i.d1.searchResults]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.SkypeConsumer],[i.d1.addToTeam]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.DisabledUser,i.gI.SkypeConsumer,i.gI.NonEmailSecurityGroupsWithDLs,i.gI.TeamTags],[i.d1.newChat]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.TeamTags,i.gI.TflSmsName,i.gI.ExtendedDirectoryUsers,i.gI.SkypeConsumer,i.gI.UnNamedGroupChats],[i.d1.transfer]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.DisabledUser,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.SkypeConsumer,i.gI.Federated],[i.d1.callTransferV2SubsequentFilters]:[],[i.d1.addToCall]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.DisabledUser,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.PersonalContact,i.gI.CallQandAA,i.gI.Federated,i.gI.FederatedConsumer,i.gI.ImplicitContacts,i.gI.SkypeConsumer,i.gI.TflConsumer,i.gI.Xtap,i.gI.Room],[i.d1.addToChat]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.DisabledUser,i.gI.TeamTags,i.gI.ExtendedDirectoryUsers,i.gI.UnNamedGroupChats],[i.d1.searchPeopleFilter]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.callRouting]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.SkypeConsumer],[i.d1.delegationSelection]:[i.gI.AADTenant,i.gI.B2BMembers,i.gI.SkypeConsumer],[i.d1.presenceSettings]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.addToMeeting]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.UnNamedGroupChats],[i.d1.meetingSchedule]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.DL,i.gI.ModernGroup,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.addToSpeedDialOrContacts]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.CallQandAA,i.gI.SkypeConsumer],[i.d1.addContacts]:[i.gI.AADTenant,i.gI.Guest,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.CallQandAA,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.atMention]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.orgChart]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.shareContact]:[i.gI.AADTenant,i.gI.SkypeConsumer],[i.d1.priorityContactsSelection]:[i.gI.AADTenant,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Pstn,i.gI.SkypeConsumer,i.gI.Guest],[i.d1.taggedContactsSelection]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.DL,i.gI.SkypeConsumer],[i.d1.shareToTeams]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.DisabledUser,i.gI.UserDefinedGroup,i.gI.SkypeConsumer],[i.d1.escalateMessage]:[i.gI.AADTenant,i.gI.SkypeConsumer],[i.d1.voicemailTransferTarget]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.DisabledUser,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.SkypeConsumer],[i.d1.addToSharedChannel]:[i.gI.AADTenant,i.gI.Xtap,i.gI.SkypeConsumer],[i.d1.externalSuggestedContacts]:[i.gI.ImplicitContactsForSMBSuggestions,i.gI.SkypeConsumer],[i.d1.exceptionHandlingPerson]:[i.gI.AADTenant],[i.d1.exceptionHandlingVoiceapp]:[i.gI.CallQandAA],[i.d1.forwardMessage]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.UserDefinedGroup,i.gI.TeamTags,i.gI.TflSmsName,i.gI.ExtendedDirectoryUsers,i.gI.SkypeConsumer,i.gI.GroupChats,i.gI.Meetings,i.gI.UnNamedGroupChats],[i.d1.statusNote]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.UserDefinedGroup,i.gI.ModernGroup,i.gI.TflSmsName,i.gI.ExtendedDirectoryUsers,i.gI.SkypeConsumer],[i.d1.virtualEvent]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.flyout]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.DisabledUser,i.gI.TeamTags,i.gI.ExtendedDirectoryUsers,i.gI.SkypeConsumer],[i.d1.fluidAtMention]:[i.gI.AADTenant,i.gI.Room,i.gI.Guest,i.gI.B2BMembers,i.gI.Bot,i.gI.Pstn,i.gI.SkypeConsumer],[i.d1.chatNotesAtMention]:[i.gI.AADTenant],[i.d1.signersList]:[i.gI.AADTenant,i.gI.Federated,i.gI.Guest,i.gI.B2BMembers],[i.d1.addToCommunities]:[i.gI.FederatedConsumer,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.PersonalContact,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.TeamTags,i.gI.GroupChats,i.gI.Xtap,i.gI.TflOffNetworkEmails,i.gI.TflOffNetworkPhones,i.gI.TflConsumer,i.gI.SkypeConsumer,i.gI.ImplicitContacts],[i.d1.adaptiveCard]:[i.gI.AADTenant],[i.d1.selectPeopleFilter]:[i.gI.AADTenant,i.gI.Guest],[i.d1.copyTags]:[i.gI.TeamTags],[i.d1.followPresence]:[i.gI.AADTenant],[i.d1.addToMeetingRegularChannel]:[i.gI.AADTenant,i.gI.Federated,i.gI.Guest,i.gI.B2BMembers,i.gI.Room],[i.d1.tflDefault]:[i.gI.AADTenant,i.gI.B2BMembers,i.gI.Guest,i.gI.Federated],[i.d1.powerbar]:[],[i.d1.forwardMessageSingleSelection]:[],[i.d1.callForwardNoUserSelection]:[],[i.d1.pickerFilterFallback]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.PersonalContact,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.TeamTags,i.gI.GroupChats,i.gI.Xtap,i.gI.TflOffNetworkEmails,i.gI.TflOffNetworkPhones,i.gI.TflConsumer,i.gI.SkypeConsumer,i.gI.ImplicitContacts],[i.d1.callingDefault]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.PersonalContact,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.TeamTags,i.gI.GroupChats,i.gI.Xtap,i.gI.TflOffNetworkEmails,i.gI.TflOffNetworkPhones,i.gI.TflConsumer,i.gI.SkypeConsumer,i.gI.ImplicitContacts],[i.d1.tflZeroStateFallback]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.PersonalContact,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.TeamTags,i.gI.GroupChats,i.gI.Xtap,i.gI.TflOffNetworkEmails,i.gI.TflOffNetworkPhones,i.gI.TflConsumer,i.gI.SkypeConsumer,i.gI.ImplicitContacts],[i.d1.powerbarSearchV2Filter]:[i.gI.AADTenant,i.gI.Guest,i.gI.B2BMembers,i.gI.Federated,i.gI.FederatedConsumer,i.gI.Bot,i.gI.DisabledUser,i.gI.DL,i.gI.ModernGroup,i.gI.PersonalContact,i.gI.UserDefinedGroup,i.gI.Pstn,i.gI.CallQandAA,i.gI.Room,i.gI.TeamTags,i.gI.GroupChats,i.gI.Xtap,i.gI.TflOffNetworkEmails,i.gI.TflOffNetworkPhones,i.gI.TflConsumer,i.gI.SkypeConsumer,i.gI.ImplicitContacts]};var a=n(480354);const s=(e,t)=>(0,a.flatten)(e.filter((([e,n])=>e===t)).map((([e,t])=>t))),o={[i.f_.Substrate]:[i.gI.AADTenant,i.gI.Guest,i.gI.GroupChats,i.gI.DL,i.gI.ModernGroup,i.gI.Room,i.gI.ExtendedDirectoryUsers,i.gI.PersonalContact,i.gI.MTOUsers,i.gI.CallQandAA],[i.f_.AAD]:[i.gI.Guest],[i.f_.IndexedDb]:[i.gI.Federated,i.gI.FederatedConsumer,i.gI.SkypeConsumer,i.gI.TflConsumer,i.gI.Bot,i.gI.Pstn],[i.f_.MiddleTier]:[],[i.f_.TopNCache]:[],[i.f_.Memory]:[],[i.f_.TFLZeroState]:[]};class l{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeExpandedPersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeSkypeConsumer=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeNonEmailSecurityGroupsWithDLs=!1,this.includeUnNamedGroupChats=!1,this.includeChannels=!1,this.includeChannelsWithPostPermissions=!1,this.includeTeams=!1,this.includeCopilots=!1,this.includeAADTenant=(0,a.includes)(e,i.gI.AADTenant),this.includeGuest=(0,a.includes)(e,i.gI.Guest),this.includeFederated=(0,a.includes)(e,i.gI.Federated),this.includeFederatedConsumer=(0,a.includes)(e,i.gI.FederatedConsumer),this.includeBot=(0,a.includes)(e,i.gI.Bot),this.includeCopilots=(0,a.includes)(e,i.gI.Copilots),this.includeDisabledUser=(0,a.includes)(e,i.gI.DisabledUser),this.includeDL=(0,a.includes)(e,i.gI.DL),this.includeModernGroup=(0,a.includes)(e,i.gI.ModernGroup),this.includePersonalContact=(0,a.includes)(e,i.gI.PersonalContact),this.includeExpandedPersonalContact=(0,a.includes)(e,i.gI.ExpandedPersonalContact),this.includeUserDefinedGroup=(0,a.includes)(e,i.gI.UserDefinedGroup),this.includePstn=(0,a.includes)(e,i.gI.Pstn),this.includeCallQandAA=(0,a.includes)(e,i.gI.CallQandAA),this.includeRoom=(0,a.includes)(e,i.gI.Room),this.includeTeamTags=(0,a.includes)(e,i.gI.TeamTags),this.includeGroupChats=(0,a.includes)(e,i.gI.GroupChats),this.includeMeetingChats=(0,a.includes)(e,i.gI.Meetings),this.includeXtap=(0,a.includes)(e,i.gI.Xtap),this.includeOffNetworkEmails=(0,a.includes)(e,i.gI.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,a.includes)(e,i.gI.TflOffNetworkPhones),this.includeSkypeConsumer=(0,a.includes)(e,i.gI.SkypeConsumer),this.includeTflConsumer=(0,a.includes)(e,i.gI.TflConsumer),this.includeTflSmsName=(0,a.includes)(e,i.gI.TflSmsName),this.includeImplicitContacts=(0,a.includes)(e,i.gI.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,a.includes)(e,i.gI.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,a.includes)(e,i.gI.ExtendedDirectoryUsers),this.includeMTOUsers=(0,a.includes)(e,i.gI.MTOUsers),this.includeTfl2WaySmsUsers=(0,a.includes)(e,i.gI.Tfl2WaySmsUsers),this.includeB2BMembers=(0,a.includes)(e,i.gI.B2BMembers),this.includeNonEmailSecurityGroupsWithDLs=(0,a.includes)(e,i.gI.NonEmailSecurityGroupsWithDLs),this.includeUnNamedGroupChats=(0,a.includes)(e,i.gI.UnNamedGroupChats),this.includeChannels=(0,a.includes)(e,i.gI.Channels),this.includeChannelsWithPostPermissions=(0,a.includes)(e,i.gI.ChannelsWithPostPermissions),this.includeTeams=(0,a.includes)(e,i.gI.Teams)}}l.fromName=(e,t=[])=>{if(!(e in r))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const n=s(t,!0),i=s(t,!1),o=a.without.apply(null,[(0,a.concat)(r[e],n),...i]);return new l(o,e)},l.createFrom=(e,t,n)=>new l(t||e.includeFeatures,n||e.name),l.includesAll=(e,t)=>(0,a.every)(t,(t=>(0,a.includes)(e.includeFeatures,t))),l.includesAny=(e,t)=>(0,a.some)(t,(t=>(0,a.includes)(e.includeFeatures,t)))},98073:(e,t,n)=>{"use strict";var i,r,a;n.d(t,{SV:()=>i,Yw:()=>r,xi:()=>a,Xz:()=>s,Ed:()=>o,L:()=>l,X3:()=>d,s9:()=>c,GA:()=>u,FL:()=>p,gm:()=>g}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(i||(i={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(r||(r={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(a||(a={}));const s=["Large","XMedium","Medium","Small","XSmall"];var o,l;!function(e){e[e.HighTrustFederation=1]="HighTrustFederation",e[e.SharedChannelXTAPEnabled=2]="SharedChannelXTAPEnabled"}(o||(o={})),function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Pager="Pager",e.Organization="Organization",e.HomeFax="HomeFax",e.BusinessFax="BusinessFax",e.Other="Other",e.Unknown="Unknown",e.Assistant="Assistant",e.OtherFax="OtherFax",e.Radio="Radio"}(l||(l={}));const d={Private:"Private",Public:"Public"};var c,u,p;!function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed",e.forbidden="forbidden"}(c||(c={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.UpdateNameAndSkypeAvatar="updateNameAndSkypeAvatar",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateProfileAvatar="update_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl",e.GetProfilePicturePolicy="getProfilePicturePolicy",e.GetExternalProfilesByAliases="getExternalProfilesByAliases"}(u||(u={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(p||(p={}));const g=["displayName","imageUri","selfAvatarLastupdatedTime","profileType","avatarETag"]},189888:(e,t,n)=>{"use strict";n.d(t,{qQ:()=>i,Pk:()=>r,$o:()=>a,V5:()=>s,PC:()=>o});const i={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},r={botType:"BOT"},a={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",PublicDistributionList:"PublicDistributionList",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",skypeUser:"SkypeUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser",room:"Room",nonFederated:"nonFederated",emailVerified:"emailverifiedanonuser",teamTag:"TeamTag"},s={MTOUser:64,B2BMember:32},o={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},800079:(e,t,n)=>{"use strict";n.d(t,{OJ:()=>g,Oc:()=>m,iB:()=>T,mc:()=>N,et:()=>y,F:()=>C,X7:()=>D,fV:()=>E,lT:()=>w,jP:()=>v,SG:()=>L,af:()=>k});var i,r=n(98073),a=n(846026),s=n(754255),o=n(678937),l=n(189888),d=n(480354),c=n(8720),u=n(791129),p=n(969013);const g="unknown_email_address@invalid.teams.ms",m="4:",h="8:tfloffnetwork:",I=`${h}email:`,M=`${h}phone:`,f="19:",A="50:sms:",T="50:smsunverified:",N="unknown user",y="8:teamsvisitor:",C="8:guest:",S="8:acs:",b="8:gcch-acs:",D=4,E="28:orgid:",U=["live","sip_profile","myspace","c2c","sms"];var w;!function(e){e.peoplePickerMTSelection="people_picker_mt_selection",e.peoplePickerGroupConversation="people_picker_group_conversation_selection",e.peoplePickerCachedPeople="people_picker_is_cached_people_selection",e.peoplePickerTeamTags="people_picker_team_tags",e.peoplePickerScheduledTags="people_picker_scheduled_tags",e.peoplePickerSubstrateSelection="people_picker_substrate_selection",e.peoplePickerDistributionList="people_picker_distribution_list",e.peoplePickerImplicitContact="people_picker_implicit_contact",e.peoplePickerPSTNSelection="people_picker_pstn_selection",e.peoplePickerChannelConversation="people_picker_channel_conversation_selection",e.peoplePickerTeamConversation="people_picker_team_conversation_selection"}(w||(w={}));const v="TflContacts";var L;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(L||(L={}));class k{static isUnknownUser(e){return e.email===g||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return g}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplayNameWithPostfixAndSecurityLabel(e,t,n,r,a,l){const{id:d}=e;let{displayName:c}=e,u=null;const{enableExternalTagForPSTNUsers:p,enableLabelingUsersByTrustLevel:g,enableMTOLabel:m}=t.get(s.w.People),h=t.get(s.w.Metadata).environment===o.B.life;if(!c)return{displayName:null,securityLabel:u};if(e.isRenamed&&(c=this.checkAndAddEditedTag(c,n),u=this.getEditedUserTag(n)),h)return this.isAnonymousUser(d)&&(c=this.checkAndAddGuestTag(c,n),u=this.getGuestUserTag(n)),{displayName:c,securityLabel:u};if(this.isAnonymousTfwUser(r)&&g){const t="type"in e&&"intenant"===e.type;r===d||t||(c=this.checkAndAddUnverifiedTag(c,n),u=this.getUnverifiedTag(n))}else{if(this.isMTOUser(e))return this.getMTOUserDisplayNamePostfixHelperAndSecurityLabel(!!m,!!l,"mtoLabel"in e?e.mtoLabel:null,c,n);if(this.isAnonymousUser(d)){const t=this.getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,c,!!g,n);c=t.displayName,u=t.securityLabel}else if(this.isFederatedUser(e)||this.isExtendedDirectoryUser(e)||this.isTFLConsumerUser(e)||this.isSfcUser(e))c=i.checkAndAddExternalTag(c,n),u=this.getExternalTag(n);else if(g&&("isAnonymousB2bUser"in e&&e.isAnonymousB2bUser||this.isAcsUserMri(d)))c=this.checkAndAddUnverifiedTag(c,n),u=this.getUnverifiedTag(n);else if(this.isGuestUser(e))c=this.checkAndAddGuestTag(c,n),u=this.getGuestUserTag(n);else if(p&&this.isPSTNUser({mri:e.id})){const r=i.getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e.id,c,t,!!a,n);c=r.displayName,u=r.securityLabel}}return{displayName:c,securityLabel:u}}static getUserDisplayNameWithPostfix(e,t,n,i,r,a){return this.getUserDisplayNameWithPostfixAndSecurityLabel(e,t,n,i,r,a).displayName}static getUserSecurityLabel(e,t,n,i,r,a){const s=this.getUserDisplayNameWithPostfixAndSecurityLabel(e,t,n,i,r,a).securityLabel;if(!s)return null;const o=s.match(/\(([^)]+)\)/g);return o&&o.length?o[o.length-1].slice(1,-1):null}static checkAndAddEditedTag(e,t){const n=this.getDefaultEditedDisplayName(t),i=this.getEditedUserTag(t);let r=e;return e.includes(i)||e===n||(r+=` ${i}`),r}static checkAndAddGuestTag(e,t){const n=this.getDefaultGuestDisplayName(t),i=this.getGuestUserTag(t);let r=e;return e.includes(i)||e===n||(r+=` ${i}`),r}static checkAndAddExternalTag(e,t){const n=this.getDefaultExternalDisplayname(t),i=this.getExternalTag(t);let r=e;return e.includes(i)||e===n||(r+=` ${i}`),r}static checkAndAddUnverifiedTag(e,t){const n=this.getDefaultUnverifiedDisplayname(t),i=this.getUnverifiedTag(t);let r=e;return e.includes(i)||e===n||(r+=` ${i}`),r}static isSecurityLabel(e,t){switch(e){case this.getExternalTag(t):case this.getUnverifiedTag(t):case this.getGuestUserTag(t):return!0;default:return!1}}static checkAndAddEmailVerifiedTag(e,t){const n=this.getDefaultEmailVerifiedDisplayname(t),i=this.getEmailVerifiedTag(t);let r=e;return e.includes(i)||e===n||(r+=` ${i}`),r}static getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e,t,n,r,a){const{enableLabelingUsersByTrustLevel:o,disableUnverifiedLabelForPSTNUsers:l}=n.get(s.w.People),{emergencySmsNumbers:d,hotlineSMSNumbers:c}=n.get(s.w.Messaging);return o?l||r||this.isEmergencyOrHotlinePhoneNumber(e,d||[],c||[])?{displayName:i.checkAndAddExternalTag(t,a),securityLabel:this.getExternalTag(a)}:{displayName:i.checkAndAddUnverifiedTag(t,a),securityLabel:this.getUnverifiedTag(a)}:{displayName:i.checkAndAddExternalTag(t,a),securityLabel:this.getExternalTag(a)}}static getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,t,n,i){let r;return this.isEmailVerifiedAnonUser(e)?(t=this.checkAndAddEmailVerifiedTag(t,i),r=this.getEmailVerifiedTag(i)):"isCcmUser"in e&&e.isCcmUser?(t=this.checkAndAddExternalTag(t,i),r=this.getExternalTag(i)):n?(t=this.checkAndAddUnverifiedTag(t,i),r=this.getUnverifiedTag(i)):(t=this.checkAndAddGuestTag(t,i),r=this.getGuestUserTag(i)),{displayName:t,securityLabel:r}}static getMTOUserDisplayNamePostfixHelperAndSecurityLabel(e,t,n,r,a){return e&&t&&n?{displayName:`${r} (${n})`,securityLabel:`(${n})`}:e?{displayName:r,securityLabel:null}:{displayName:i.checkAndAddExternalTag(r,a),securityLabel:this.getExternalTag(a)}}static getDefaultEditedDisplayName(e){return e.stringTranslate("calling","default_edited_displayname",{defaultValue:"Edited"})}static getEditedUserTag(e){return e.stringTranslate("calling","edited_user_postfix",{defaultValue:"(Edited)"})}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getDefaultEmailVerifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_email_verified_displayname",{defaultValue:"Email-verified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static getEmailVerifiedTag(e){return e.stringTranslate("peoplePicker","email_verified_user_postfix",{defaultValue:"(Email verified)"})}static applyFeatureFlagSettings(e,t){let n=e.includeFeatures;const i=Boolean(t.get(s.w.Messaging).enableConsumerConversations);switch(e.name){case a.d1.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:r}=t.get(s.w.Federated);r||(n=(0,d.difference)(n,[a.gI.Federated])),e&&(n=(0,d.difference)(n,[a.gI.Bot])),n=i?(0,d.difference)(n,[a.gI.Federated]):(0,d.difference)(n,[a.gI.TflConsumer]);break}case a.d1.pickerFilterFallback:{const{enableTflTfwFederation:e,enableTfwTflFederation:r}=t.get(s.w.Host);i?e&&(n=(0,d.difference)(n,[a.gI.Federated])):r&&(n=(0,d.difference)(n,[a.gI.TflConsumer]));break}case a.d1.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:r}=t.get(s.w.Federated);r||(n=(0,d.difference)(n,[a.gI.Federated])),e&&(n=(0,d.difference)(n,[a.gI.Bot]));break;case a.d1.addToChat:const{enableFederatedUsersInAddToChat:o}=t.get(s.w.Federated),{enableTfwFederationOnTfl:l,enableTfwTflFederation:c}=t.get(s.w.Host);i?l||(n=(0,d.difference)(n,[a.gI.Federated])):(o||(n=(0,d.difference)(n,[a.gI.Federated])),c||(n=(0,d.difference)(n,[a.gI.TflConsumer])));const{enableDLsInAddToChat:u}=t.get(s.w.DistributionLists);u||(n=(0,d.difference)(n,[a.gI.DL]));break;case a.d1.addToTeam:const{enableFederatedUsersInAddToTeam:p}=t.get(s.w.Federated);p||(n=(0,d.difference)(n,[a.gI.Federated]));break;case a.d1.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:g}=t.get(s.w.Federated);g||(n=(0,d.difference)(n,[a.gI.Federated]))}return c.H.createFrom(e,n)}static filterSearchResults(e,t,n){let r=t;return(e=i.applyFeatureFlagSettings(e,n)).includeFederated||(r=r.filter((e=>!(i.isFederatedUser(e)||i.isSfcUser(e)||i.isTFLConsumerUser(e))))),e.includeGuest||(r=r.filter((e=>!i.isGuestUser(e)))),e.includeBot||(r=r.filter((e=>!i.isBot(e)))),e.includeDL||(r=r.filter((e=>!i.isDistributionList(e)))),e.includePstn||(r=r.filter((e=>!i.isPSTNUser(e)))),e.includeAADTenant||(r=r.filter((e=>!i.isInTenantUser(e)))),e.includeCallQandAA||(r=r.filter((e=>!i.isCallQorAAUser(e)))),e.includeSkypeConsumer||(r=r.filter((e=>!i.isSfcUser(e)))),e.includeTflConsumer||(r=r.filter((e=>!i.isTFLConsumerUser(e)))),e.includeTflSmsName||(r=r.filter((e=>!i.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(r=r.filter((e=>!i.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(r=r.filter((e=>!i.isTFLSmsVerifiedMri(e?.mri||"")))),e.includeB2BMembers||(r=r.filter((e=>!i.isB2BMember(e)))),e.includeRoom||(r=r.filter((e=>!i.isConfRoom(e)))),e.includeCopilots||(r=r.filter((e=>!i.isCopilotBot(e.mri,n)))),r}static isMixedChatUser(e,t){const n=!e&&i.isFederatedUser({type:t})||e&&i.isTFLConsumerUser({type:t})||e&&i.isSfcUser({type:t});return Boolean(n)}static isCopilotBot(e,t){const{copilotAppsIds:n}=t.get(s.w.Messaging)??{};return!(!e||!n?.some((t=>`28:${t}`===e)))}static isSfCUserPrefix(e){return-1!==U.indexOf(e)}static matchEmailAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e.toLowerCase()===t.address?.toLowerCase()))}static matchPhoneAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t,n,r,a,o,c){let g;const{enableExternalTagForPSTNUsers:h,enableLabelingUsersByTrustLevel:I,disableUnverifiedLabelForPSTNUsers:M}=o?.get(s.w.People)??{},{emergencySmsNumbers:f,hotlineSMSNumbers:A,enablePaidSmsChat:T}=o?.get(s.w.Messaging)??{},N=e.slice(m.length),y=i.getHotlineNumberMapping(N,o);if(r&&n){const i=(0,p.kZ)(N),a=(0,u.n4)(i,n,r,!0);g={mri:e,displayName:(0,d.isEmpty)(t)?T&&y?.shortCode||a.display:t,givenName:a.display,description:T&&y?a.display:void 0,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.$o.pstn,telephoneNumber:a.display}}else g={mri:e,displayName:T&&y?.shortCode||t,description:T&&y?.phoneNumber||void 0,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.$o.pstn,telephoneNumber:y?.phoneNumber||N};return h&&a?.stringTranslate&&(!I||M||c||this.isEmergencyOrHotlinePhoneNumber(e,f||[],A||[])?g.decoratedDisplayName=i.checkAndAddExternalTag(g.displayName||t,a):g.decoratedDisplayName=i.checkAndAddUnverifiedTag(g.displayName||t,a)),g}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,d.isEmpty)(t))return;const n=atob(t),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(n.length),a=new Uint8Array(r);for(let e=0;e<n.length;e++)a[e]=n.charCodeAt(e);return new Blob([a],{type:i})}static getPhoneNumbers(e){let t=[];return e?.telephoneNumber&&t.push(e.telephoneNumber),e?.phones&&e.phones.length>0&&(t=t.concat(e.phones.map((e=>e.number)))),t}static getExtendedDirectoryPhoneNumber(e){return i.getPhoneNumbers(e)[0]}static isPartialSCContext(e,t){return!!(e&&!t||!e&&t)}static getFederationType(e,t){let n;const r={type:t};return e?i.isTFLUser(r)?n="tflWithTfl":i.isFederatedUser(r)&&(n="tflWithTfw"):i.isSfcUser(r)?n="tfwWithSfc":i.isTFLConsumerUser(r)?n="tfwWithTfl":i.isFederatedUser(r)&&(n="tfwWithTfw"),n}static getTfwExtendedDirectoryMembership(e,t={}){const{mri:n,userType:i}=e,{excludeOffNetwork:r=!0}=t;return!r&&this.isTFLOffNetworkUser(n)?"offNetwork":this.isPEUPUser(i)?"pending":this.isEUPUser(i)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return L.NotResolved;const{type:t,userType:n}=e;if(!t)return L.NotResolved;switch(t){case"Federated":case"TflConsumer":case"SkypeConsumer":case l.$o.pstn:return L.External;case"person":case"ADUser":return n&&"Guest"===n?L.NotResolved:L.User;case"Group":return L.DistributionList;default:return L.User}}static isValidNameForInitialsAvatarForPstnUser(e,t){return!!(i.isPSTNUser({mri:e})&&i.isValidNameForInitialsAvatar(t))}static isValidNameForInitialsAvatar(e){const t=new RegExp("(^\\p{L})","iu");return!!(!!e&&t.test(e))}static getDescriptionForPstnContact(e,t,n,r,a){let o;const{mri:l,displayName:c}=e,u=l.split(m)[1],{enablePaidSmsChat:p}=a.get(s.w.Messaging)??{};return p&&i.isPSTNUser({mri:l})&&r&&(i.isTextSameAsPhoneNumber(c,u,t)||(0,d.forEach)(r,(e=>{i.isTextSameAsPhoneNumber(u,e.number,t)&&(o=n.stringTranslate("people",i.getPhoneTypePeopleKey(e.type),{phoneNumber:e.number}))}))),o}static isSearchV2EnabledForPicker(e,t,n){return!!n&&(!(!e||!t)&&!t.includes(e))}static areUnNamedGroupChatsEnabledForPicker(e,t,n){return!!n&&(!(!e||!t)&&t.includes(e))}static areChannelsEnabledForPicker(e,t,n){return!!n&&(!(!e||!t)&&t.includes(e))}static areTeamsEnabledForPicker(e,t,n){return!!n&&(!(!e||!t)&&t.includes(e))}static getTeamPickerItemIdForTeam(e){return`${e}_team`}static getTeamIdFromTeamPickerItemId(e){return e.replace("_team","")}static isTextSameAsPhoneNumber(e,t,n){if(!e||!t)return!1;if(e.toLocaleLowerCase()===t.toLocaleLowerCase())return!0;const i=(0,p.kZ)(e),r=(0,u.n4)(i,"peopleUtilities_isTextSameAsPhoneNumber_Name",n),a=(0,u.n4)(t,"peopleUtilities_isTextSameAsPhoneNumber_Phone",n);return r?.diallable===a?.diallable}static getPhoneTypePeopleKey(e){switch(e){case r.L.Mobile:return`phone_type_${r.L.Mobile}`;case r.L.Business:return`phone_type_${r.L.Business}`;case r.L.Home:return`phone_type_${r.L.Home}`;case r.L.Pager:return`phone_type_${r.L.Pager}`;case r.L.Organization:return`phone_type_${r.L.Organization}`;case r.L.HomeFax:return`phone_type_${r.L.HomeFax}`;case r.L.BusinessFax:return`phone_type_${r.L.BusinessFax}`;case r.L.Assistant:return`phone_type_${r.L.Assistant}`;case r.L.OtherFax:return`phone_type_${r.L.OtherFax}`;case r.L.Radio:return`phone_type_${r.L.Radio}`;default:return`phone_type_${r.L.Other}`}}static isEmergencyOrHotlinePhoneNumber(e,t,n){const i=e.slice(m.length);return t.includes(i)||n.includes(i)}static getHotlineNumberMapping(e,t){const n=t?.get(s.w.People)?.hotlineNumbersMapping||[{shortCode:"988",phoneNumber:"+18002738255"}];for(const t of n)if(e===t?.shortCode||e===t?.phoneNumber)return t}}i=k,k.getTrustIndicatorLabel=(e,t)=>{if(e.trustLabel)return e.trustLabel;switch(e.trustLevel){case"FAMILIAR":case"UNFAMILIAR":return t.stringTranslate("people","external_label");case"GUEST":return t.stringTranslate("people","guest_label");case"UNVERIFIED":return t.stringTranslate("people","unverified_label");case"EMAIL_VERIFIED":return t.stringTranslate("people","email_verified_label");default:return""}},k.getDisplayNameWithTrustLabelForAria=(e,t,n)=>{if(!t)return e;return`${e} ${i.getTrustIndicatorLabel(t,n)}`},k.getFamiliarTrustworthy=(e,t)=>({trustLevel:"FAMILIAR",trustReason:e,trustLabel:t}),k.getUnfamiliarTrustworthy=e=>({trustLevel:"UNFAMILIAR",trustReason:e}),k.getGuestTrustworthy=()=>({trustLevel:"GUEST",trustReason:"GUEST"}),k.getUnverifiedTrustworthy=e=>({trustLevel:"UNVERIFIED",trustReason:e}),k.getEmailVerifiedTrustworthy=()=>({trustLevel:"EMAIL_VERIFIED",trustReason:"EMAIL_VERIFIED"}),k.getUserTrustworthy=(e,t)=>{const{enableTrustIndicator:n}=t.get(s.w.People),a=i.isInTenantUser(e)&&!i.isB2BMemberMTOUser(e);if(!n||a||i.isUnknownUser(e)||i.isAnonymousUser(e.currentUserMri))return null;switch(!0){case e.isContact:return i.getFamiliarTrustworthy("CONTACT");case i.isPSTNUser(e):return i.getUnfamiliarTrustworthy("PSTN");case i.isMTOUser(e):return e.mtoLabel?i.getFamiliarTrustworthy("MTO",e.mtoLabel):null;case i.isFederatedUser(e):return e.trustworthy?e.trustworthy:e.trustReason===r.Ed.SharedChannelXTAPEnabled?i.getFamiliarTrustworthy("SHARED_CHANNEL"):e.trustReason===r.Ed.HighTrustFederation?i.getFamiliarTrustworthy("FEDERATED"):i.getUnfamiliarTrustworthy("FEDERATED");case i.isTFLConsumerUser(e):return i.getUnfamiliarTrustworthy("TFL_CONSUMER");case i.isSfcUser(e):return i.getUnfamiliarTrustworthy("SFC");case i.isGuestUser(e):return i.getGuestTrustworthy();case i.isAnonymousUser(e.mri):return i.isEmailVerifiedAnonUser(e)?i.getEmailVerifiedTrustworthy():e.isCcmUser?i.getFamiliarTrustworthy("CCM"):i.getUnverifiedTrustworthy("ANONYMOUS_B2C");case i.isAcsUserMri(e.mri):return i.getUnverifiedTrustworthy("ACS");case i.isAnonymousB2bUser(e):return i.getUnfamiliarTrustworthy("ANONYMOUS_B2B");default:return null}},k.isEmailVerifiedAnonUser=e=>"type"in e&&e.type?.toLowerCase()===l.$o.emailVerified,k.isFederatedUser=e=>!!e.isFederated||e.type?.toLowerCase()===l.$o.federated.toLowerCase(),k.isGuestUser=e=>e.type===l.$o.guest||e.userType===l.$o.guest||e.peopleSubType===l.$o.guest,k.isPersonalContactUser=e=>e.type===l.$o.personalContactUser||e.userType===a.gI.PersonalContact,k.isTFLUser=e=>e.type===l.$o.tflUser,k.isSkypeUser=e=>e.type===l.$o.skypeUser,k.isTFLConsumerUser=e=>e.type===l.$o.tflConsumer,k.isTFLSmsUser=e=>e.id&&i.isTFLSmsMri(e.id),k.isTFLSmsFriendlyNameUser=e=>e.id&&i.isTFLSmsMri(e.id)&&e.friendlyName,k.isInTenantUser=e=>!(e.type?.toLowerCase()!==l.PC.type.person.toLowerCase()&&e.type!==l.$o.ADUser||i.isGuestUser(e)||e.isFederated),k.isBot=e=>e.type?.toUpperCase()===l.Pk.botType,k.isDistributionList=e=>e.type===l.$o.DistributionList&&(!e.objectType||e.objectType===l.$o.DistributionList),k.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(m),k.isSfcUser=e=>e.type===l.$o.skypeConsumer,k.isTflOrSkypeConsumerUser=e=>i.isTFLConsumerUser(e)||i.isSfcUser(e),k.isMTOUser=e=>e.profileType===l.V5.MTOUser||e.userType===l.$o.MTOUser||e.peopleSubType===l.$o.MTOUser,k.isB2BMemberMTOUser=e=>i.isMTOUser(e)&&(e.type===l.$o.ADUser||e.type===l.$o.person),k.isFederatedMTOUser=e=>i.isMTOUser(e)&&i.isFederatedUser(e),k.isB2BMember=e=>e.profileType===l.V5.B2BMember||e.userType===l.$o.B2BMember,k.isRoom=e=>e.peopleSubType===l.$o.room,k.isB2BGuest=e=>e.userType===l.$o.guest,k.isSharedChannelUser=e=>i.isFederatedUser(e)&&e.xtapUser,k.isExtendedDirectoryUser=e=>i.isPEUPUser(e.userType)||i.isEUPUser(e.userType)||e.type===l.$o.extendedDirectoryUser,k.isConfRoom=e=>e.userType===l.$o.room,k.isPEUPUser=e=>e===l.$o.PendingOrgContact,k.isEUPUser=e=>e===l.$o.OrgContact,k.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),k.isCallQorAAUser=e=>e.type===l.$o.voiceApp,k.isAnonymousB2bUser=e=>e.type===l.$o.nonFederated||e.isAnonymousB2bUser,k.isAnonymousUser=e=>i.isAnonymousTfwUser(e)||i.isAnonymousTflUser(e),k.isAnonymousTfwUser=e=>e?.startsWith(y),k.isAnonymousTflUser=e=>e?.startsWith(C),k.isAnonymousPstn=e=>e?.startsWith("4:anonymous"),k.isAcsUserMri=e=>!(!e||![S,b].some((t=>e.startsWith(t)))),k.isTFLOffNetworkUser=e=>0===e?.indexOf(h),k.isTFLOffNetworkPhoneUser=e=>0===e?.indexOf(M),k.isTFLOffNetworkEmailUser=e=>0===e?.indexOf(I),k.isTFLSmsUnVerifiedMri=e=>0===e?.indexOf(T),k.isTFLSmsVerifiedMri=e=>0===e?.indexOf(A),k.isTFLSmsMri=e=>0===e?.indexOf(A)||0===e?.indexOf(T),k.isTFLSmsOrOffNetworkPhoneMri=e=>i.isTFLOffNetworkPhoneUser(e)||i.isTFLSmsMri(e),k.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>i.isTFLSmsUnVerifiedMri(e)||i.isTFLOffNetworkPhoneUser(e),k.isTFLOffNetworkOrSmsUnVerifiedMri=e=>i.isTFLOffNetworkUser(e)||i.isTFLSmsUnVerifiedMri(e),k.isEnterpriseUserMri=e=>0===e?.indexOf("8:orgid:"),k.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const t=e.split(":");return!!(2===t.length||3===t.length&&i.isSfCUserPrefix(t[1]))},k.isDisplayNameUnknownUser=e=>e?.toLowerCase()===N||"unknown"===e?.toLowerCase(),k.isConversationItem=e=>0===e.id?.indexOf(f),k.isUnNamedConversationItem=e=>void 0!==e.groupChatName&&(null===e.groupChatName||0===e.groupChatName.length),k.isChannelPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===w.peoplePickerChannelConversation&&0===e.id?.indexOf(f),k.isTeamPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===w.peoplePickerTeamConversation&&0===e.id?.indexOf(f),k.isTag=e=>"Tag"===e.type,k.getPhoneNumberFromMri=e=>e&&i.isTFLSmsUnVerifiedMri(e)?e.slice(T.length):""},809391:(e,t,n)=>{"use strict";function i(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const n={};return e.split("&").forEach((e=>{const[t,i]=e.split("=");n[t]=decodeURIComponent((i||"").replace(/^.+?(=)/,""))})),n}n.d(t,{J:()=>i})},912146:(e,t,n)=>{"use strict";n.d(t,{c:()=>m,nD:()=>M,$j:()=>f,ix:()=>A,wf:()=>T,d$:()=>N});var i=n(329633),r=n(193406),a=n(779898),s=n(944297);const o=new RegExp("media.*\\.giphy\\.com$","i"),l=new RegExp("media.*\\.tenor\\.com$","i"),d=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.eaglex\\.ic\\.gov$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.eaglex\\.ic\\.gov$","statics\\.teams\\.microsoft\\.scloud$","media.*\\.giphy\\.com$","media.*\\.tenor\\.com$","local\\.teams\\.(?:office|live)\\.com$","static-asm\\.secure\\.skypeassets\\.com$"].join("|"),"i"),c=new RegExp([".*\\logout*"].join("|"),"i"),u=/^\/asm\/[a-z]+/i,p="/urlp/v1/url/content",g="/urlp/v1/url/image/Favicon",m=e=>`data:${h(e)};base64,${e}`,h=e=>{const t=(0,i.F)(e);let n;return n=255===t[0]&&216===t[1]?"image/jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?"image/png":71===t[0]&&73===t[1]&&70===t[2]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":"image/unknown",n},I=e=>{const t=(0,a.z)().location.origin;if((0,r.nA)(e,t))return!0;const n=(0,r.yz)(e).toLowerCase(),i=(0,r.Yn)(e).toLowerCase();return d.test(n)||"teams.microsoft.com"===n&&u.test(i)},M=e=>I(e)&&(e=>{const t=(0,r.Yn)(e).toLowerCase();return!c.test(t)})(e)||e.startsWith("data:image"),f=e=>{const t=(0,r.yz)(e).toLowerCase();return o.test(t)},A=e=>f(e)||(e=>{const t=(0,r.yz)(e).toLowerCase();return l.test(t)})(e);function T(e){return e.endsWith("/middletier/getGif/giphy.gif")}function N(e,t){try{const n=new URL(e);return I(e)&&!(0,s.D$)(e)&&!(0,r.nA)(e,t)&&(n.pathname===p||n.pathname===g)}catch(e){return!1}}},643074:(e,t,n)=>{"use strict";n.d(t,{Z2:()=>i,zg:()=>r,Fi:()=>a,Jy:()=>s,Y0:()=>o,D$:()=>l,Bv:()=>d,V6:()=>c,n6:()=>u,kW:()=>p,gQ:()=>g});const i=180,r=2,a=.5,s=10,o=48,l=62,d=87.8,c=20,u=250,p=1e4,g=20971520},973893:(e,t,n)=>{"use strict";n.d(t,{Y5:()=>i,yh:()=>a,AJ:()=>s,cD:()=>o});var i,r=n(643074);!function(e){e.ULTRA_WIDE="ultra-wide",e.SUPER_SMALL="super-small",e.THIN="thin",e.TALL="tall",e.STANDARD="standard",e.ONE_PIXEL_IMAGE="one-pixel-image",e.NONE="none"}(i||(i={}));const a=(e,t,n=r.n6)=>{let i=e,a=t;return t>n&&(i=n*i/a,a=n),{width:i,height:a}},s=(e,t)=>{if(1===t&&1===e)return i.ONE_PIXEL_IMAGE;if(t/e>=r.zg)return i.TALL;const n=t<r.Z2;return e/t>=r.zg?n?i.THIN:i.ULTRA_WIDE:n?i.SUPER_SMALL:i.STANDARD},o=(e,t,n)=>{if(n===i.THIN||n===i.ULTRA_WIDE){const n=e/r.Jy,i=t/r.Jy;let a=n;if(n>r.D$||i>r.Y0){const e=2,t=r.Z2/r.Jy,s=r.D$/n,o=t/i;a=Number((n*Math.min(s,o)).toFixed(e))}return{"--calculatedWideImageWidth":`${a}rem`}}return{}}},944297:(e,t,n)=>{"use strict";n.d(t,{IC:()=>N,FF:()=>y,vB:()=>C,Ap:()=>S,D$:()=>b,N7:()=>D,Xd:()=>E,MC:()=>U,Mw:()=>k,lo:()=>x,fq:()=>F,qD:()=>O,QK:()=>P});var i=n(193406),r=n(643074);const a="asm.skype.com",s="api.ams.gcc.teams.microsoft.com",o="urlp.ams.gcc.teams.microsoft.com",l="api.ams.gov.teams.microsoft.us",d="api.ams.dod.teams.microsoft.us",c="api.asyncgw.teams.microsoft.scloud",u="api.asyncgw.teams.microsoftonline.cn",p="api.asyncgw.teams.eaglex.ic.gov",g="asyncgw.teams.microsoft.com",m="/v1/objects",h="/views/video",I="/ams",M="teams.microsoft.com",f=/^\/asm\/[a-z]+/i,A=/^\/asm\/[a-z]+\/v1\/objects/i,T=/v1\/objects\/([^/]{1,300})/i;var N,y;function C(e){if(e&&b(e)){const t=e.match(T);return t&&t[1]||""}return""}function S(e){const t=(0,i.yz)(e).toLowerCase(),n=(0,i.Yn)(e);return t.endsWith(a)||t===s||t===l||t===d||t===c||t===u||t===p||t===o||t.endsWith(g)||t===M&&f.test(n)}function b(e){if(x(e))return!0;const t=(0,i.Yn)(e);return S(e)&&(t.startsWith(m)||A.test(t))}function D(e){if(!e)return!1;const t=(0,i.Yn)(e);return!(!x(e)||!t.endsWith(h))||S(e)&&t.endsWith(h)}function E(e){return D(e)?y.Video:b(e)?y.Image:y.None}async function U(e){const t=e instanceof Blob?new Uint8Array(await(e.arrayBuffer?.())):e;if(!t||t.length<6)return!1;if(71!==t[0]||73!==t[1]||70!==t[2])return function(e){if(!e)return!1;let t=-1,n=-1;for(let i=0;i<e.length-4;i++)if(97===e[i]&&99===e[i+1]&&84===e[i+2]&&76===e[i+3]&&(n=i),73===e[i]&&68===e[i+1]&&65===e[i+2]&&84===e[i+3]){t=i;break}return n>=0&&t>n}(t);let n=0;for(let e=0;e<t.length-9&&!(w(t,e)&&(v(t,e+8)||L(t,e+8))&&(n++,n>1));e++);return n>1}function w(e,t){return 33===e[t]&&249===e[t+1]&&4===e[t+2]}function v(e,t){return 44===e[t]}function L(e,t){return 33===e[t]&&255===e[t+1]&&11===e[t+2]}function k(e,t){if(!e||!b(e)||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")}function x(e){return(0,i.Yn)(e).toLowerCase().startsWith(I+m)}function F(e){return e>r.gQ}function O(e){if(!e||"image/*"===e)return"";const t=e.match(/^image\/([^*]+)$/);return t?t[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(N||(N={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(y||(y={}));const P=async e=>{const{src:t,logger:n,size:i,type:a}=e,s=document.createElement("canvas"),o=s.getContext("2d");if(o)return new Promise((e=>{const l=new Image;l.onload=()=>{try{const{height:n,width:d}=l;let c=1;if(void 0!==i&&F(i)&&(c=r.gQ/i,"image/jpeg"===a&&(c+=.9*(1-c))),(d>r.kW||n>r.kW)&&(c=Math.min(c,r.kW/Math.max(n,d))),1===c)return void e(void 0);const u=c*d,p=c*n;s.width=u,s.height=p,o.drawImage(l,0,0,u,p),s.toBlob((n=>{const i=n?URL.createObjectURL(n):null;if(i)return URL.revokeObjectURL(t),void e(i);e(t)}),a??"image/png")}catch(i){n.error(`Error resizing image, error: ${i}`),e(t)}finally{s.remove()}},l.src=t}));s.remove()}},779898:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var i=n(849213);function r(){return i.y.getInstance().window}},294613:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(e,t)=>{if(e===t)return 0;const n=[e,t].map((e=>e.split("."))),[i,r]=n.map((e=>e.length)),a=Math.min(i,r);for(let e=0;e<a;e++){const[t,i]=n.map((t=>parseInt(t[e],10)||0));if(t!==i)return t>i?1:-1}return i>r?1:i<r?-1:0}},329633:(e,t,n)=>{"use strict";function i(e){if(!e)return new Uint8Array(0);return r(e.split(",")[1])}function r(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.d(t,{a:()=>i,F:()=>r})},113901:(e,t,n)=>{"use strict";n.d(t,{L:()=>l,Z:()=>d});var i=n(551038),r=n(306183),a=n(199448),s=n(850434),o=n(446320);const l=(e,t)=>async(...n)=>{for(;;)try{return await e(...n)}catch(e){await t(e,...n)}},d=(e,t)=>{const{maxRetries:n,retryWindow:l,backoffTime:d,shouldRetry:c}=t,u=e=>l-(Date.now()-e);return async(...t)=>{const l=Date.now();let p=0,g=u(l);for(;p++<=n&&g>0;)try{return await Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof i.a)throw e;const t=await(0,r.Fg)(e);if(c&&!c(t))throw t?(0,a.$5)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,a.$5)("RetryWithBackoff",s.O4.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${p}, RemainingTime: ${g}`);if(p>=n||u(l)<=0)break;await(0,o.y)(d),g=u(l)}throw(0,a.$5)("RetryWithBackoff",s.O4.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${p}, RemainingTime: ${g}`)}}},639884:(e,t,n)=>{"use strict";function i(){return(...e)=>e}n.d(t,{K:()=>i})},794171:(e,t,n)=>{"use strict";var i,r,a,s,o,l;n.d(t,{SA:()=>i,Sx:()=>r,SV:()=>a,wX:()=>s,Sq:()=>o,S6:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(i||(i={})),function(e){e.Default="default",e.DefaultV2="defaultV2",e.DefaultTfl="tfl-default",e.Dark="dark",e.DarkV2="darkV2",e.DarkTfl="tfl-dark",e.HighContrast="contrast"}(r||(r={})),function(e){e.Dark="dark",e.Light="light",e.Contrast="contrast"}(a||(a={})),function(e){e.Light="0",e.Dark="1",e.Contrast="2",e.DefaultV2="3",e.DarkV2="4",e.DefaultTfl="5",e.DarkTfl="6"}(s||(s={})),function(e){e.HighContrast="#FFFFFF_#000000_#FFFF00"}(o||(o={})),function(e){e.ColorContrastOverride="(forced-colors: active)",e.Light="(prefers-color-scheme: light)",e.Dark="(prefers-color-scheme: dark)"}(l||(l={}))},454007:(e,t,n)=>{"use strict";var i;n.d(t,{C:()=>i}),function(e){e.AcsUser="8:acs:",e.AcsGcchUser="8:gcch-acs:",e.Bot="28:",e.DodUser="8:dod:",e.GcchUser="8:gcch:",e.Pstn="4:",e.PstnExtension=";ext=",e.User="8:orgid:"}(i||(i={}))},694296:(e,t,n)=>{"use strict";n.d(t,{zL:()=>H,O5:()=>J,b4:()=>X,kq:()=>q,$I:()=>K,o9:()=>$,XU:()=>ee,Xd:()=>te,K1:()=>ne,a$:()=>ie,JJ:()=>re,WB:()=>ae,Oh:()=>se,Ql:()=>oe,qi:()=>le,oB:()=>de,PA:()=>ce,Ft:()=>ue,tj:()=>pe,sn:()=>ge,g5:()=>me,ci:()=>he,ol:()=>Ie,D0:()=>Me,dS:()=>fe,Y8:()=>Ae,ro:()=>Te,tF:()=>Ne,s0:()=>ye,cK:()=>Ce,xc:()=>Se,es:()=>be,ef:()=>De,U_:()=>Ee,D:()=>Ue,q7:()=>we,r6:()=>ve,zx:()=>Le,y:()=>ke,En:()=>xe,m8:()=>Fe,LW:()=>Oe});var i=n(473107),r=n(356477),a=n(682712),s=n(645033),o=n(431944),l=n(538790),d=n(619322),c=n(987803),u=n(107741),p=n(956879),g=n(685847),m=n(24193),h=n(420632),I=n(330705),M=n(179356),f=n(779826),A=n(677654),T=n(496344),N=n(994576),y=n(202628),C=n(298224),S=n(323708),b=n(305005),D=n(922464),E=n(48946),U=n(336085),w=n(225805),v=n(127448),L=n(122928),k=n(290684),x=n(445042),F=n(236233),O=n(439275),P=n(27824),j=n(261097),R=n(673745),z=n(112744),B=n(185264),V=n(269803),_=n(861590),W=n(521944),Q=n(210828),Y=n(766077),G=n(841825),Z=n(2161);const H=e=>e instanceof Date?e:new Date(e),J=(e,t)=>H(e).getTime()<=H(t).getTime(),X=e=>(0,r.A)(Ie(H(e)),1),q=(e,t=i.ZD.Sunday)=>(0,a.A)(H(e),{weekStartsOn:t}),K=(e,t=i.ZD.Sunday)=>Ie((0,s.A)(H(e),{weekStartsOn:t})),$=e=>0-H(e).getTimezoneOffset(),ee=(e,{hours:t,minutes:n,seconds:i,milliseconds:r})=>{let a=new Date(e);return void 0===t||isNaN(t)||(a=(0,o.A)(a,t)),void 0===n||isNaN(n)||(a=(0,l.A)(a,n)),void 0===i||isNaN(i)||(a=(0,d.A)(a,i)),void 0===r||isNaN(r)||(a=(0,c.A)(a,r)),a},te=(e,{hours:t,months:n,minutes:i,days:a,seconds:s})=>{let o=new Date(e);return void 0===t||isNaN(t)||(o=(0,u.A)(o,t)),void 0===i||isNaN(i)||(o=(0,p.A)(o,i)),void 0===s||isNaN(s)||(o=(0,g.A)(o,s)),void 0===a||isNaN(a)||(o=(0,r.A)(o,a)),void 0===n||isNaN(n)||(o=(0,m.A)(o,n)),o},ne=(e,t)=>te(e,{days:t}),ie=(e,t)=>(0,h.A)(H(H(e)),t),re=(e,t)=>(0,I.A)(H(e),t),ae=e=>e&&e.getTime(),se=e=>(0,M.A)(H(e))*i.XP+(0,f.A)(H(e)),oe=(e,t,n)=>{const i=H(t),r=H(e);switch(n){case"hours":return(0,A.A)(i,r);case"minutes":return(0,T.A)(i,r);case"seconds":return(0,N.A)(i,r);case"days":return(0,y.A)(i,r);case"weeks":return(0,C.A)(i,r);case"months":return(0,S.A)(i,r);case"milliseconds":return(0,b.A)(i,r);case"years":return(0,D.A)(i,r);case"calendarDays":return(0,E.A)(i,r)}},le=()=>{try{const e=Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions();return e&&e.timeZone}catch{return""}},de=(e,t)=>!(!t||t.length<1)&&t.indexOf(H(e).getDay())>-1,ce=e=>{const t=ie(new Date(Date.now()),1);return Te(H(e),t)},ue=(e,t)=>(0,U.A)(H(e),H(t)),pe=e=>(0,w.A)(H(e)),ge=e=>(0,v.A)(H(e)),me=e=>(0,L.A)(H(e)),he=e=>(0,k.A)(H(e)),Ie=e=>(0,x.A)(H(e)),Me=e=>(0,F.A)(H(e)),fe=(e,t)=>(0,O.A)(H(e),H(t)),Ae=(e,t)=>(0,P.A)(H(e),H(t)),Te=(e,t)=>(0,j.A)(H(e),H(t)),Ne=(e,t)=>(0,R.A)(H(e),H(t)),ye=(e,t)=>(0,z.A)(H(e),H(t)),Ce=e=>(0,B.A)(H(e)),Se=e=>(0,V.A)(H(e)),be=e=>(0,_.A)(H(e)),De=e=>(0,W.A)(H(e)),Ee=e=>(0,Q.A)(H(e)),Ue=e=>(0,Y.A)(H(e)),we=(e,t="extended",n="complete")=>(0,G.A)(H(e),{format:t,representation:n}),ve=(e,t)=>(0,Z.A)(H(e),t),Le=(e,t)=>((e=new Date(e)).setMilliseconds(0),t?e.toISOString():we(e)),ke=(e,t=0,n=!1)=>{const i=te(new Date(e),{minutes:new Date(e).getTimezoneOffset()+t});return t>0&&n?Ie(i):i},xe=e=>{const t=e.indexOf("T");if(t<=0)throw new Error(`Invalid date ${e}`);return`${e.substr(0,t)}T00:00:00.000Z`},Fe=(e,t)=>{const n=oe(e,t,"minutes"),r=Math.floor(n/i.XV),a=n%i.XV;return{durationDays:r,durationHours:Math.floor(a/i.XP),durationMinutes:a%i.XP}},Oe=e=>{if(!e)return null;switch(typeof e){case"string":try{return new Date(e).toISOString()}catch(t){if(t instanceof RangeError)return new Date(parseInt(e,10)).toISOString()}case"number":return new Date(e).toISOString();default:return null}}},280683:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i=(e,t,n)=>`${e}__${t}_${n}`},306183:(e,t,n)=>{"use strict";n.d(t,{qD:()=>a,b_:()=>s,oz:()=>o,b4:()=>l,Fg:()=>d});var i=n(850434),r=n(199448);const a=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,r.J4)(t[0].originalError,i.Ir.Apollo,i.O4.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},s=e=>{const t=e.graphQLErrors?.[0]?.extensions;return t?t.prevError&&"UNKNOWN"===t.code?(0,r.J4)(new Error(e.graphQLErrors[0].message),t.prevError.context,t.prevError.code,t.prevError.subContext,t.prevError.reason):(0,r.J4)(new Error(e.graphQLErrors[0].message),t.context,t.code,t.subContext,t.reason):null},o=e=>{const t=l(e);return!!t&&!(!(0,r.WZ)(t)&&!(0,r.ej)(t.reason,t.context))},l=e=>e?.graphQLErrors?.[0]?.extensions?.prevError,d=async e=>{if(!e)return null;let t=null;const{graphQLErrors:n,networkError:a}=e;return a&&(t=c(a)),!t&&n&&n.length>0&&n[0].originalError&&(t=await(async e=>{let t=null;try{if(t=e.originalError,!t?.serverResponse?.body)return t;const n=t?.serverResponse?.status,i=await(t?.serverResponse?.body.json());if(!m(i))return t;t.reason={status:n,errorCode:i.errorCode,errorSubCode:i.errorSubCode}}catch(e){}return t})(n[0])),t||(t=n&&n.length>0&&n[0]&&n[0].originalError?(0,r.J4)(n[0].originalError,i.Ir.Apollo,i.O4.ApolloError,"getOriginalError",{status:n[0].originalError.code}):null),t},c=e=>{let t=null;try{const n=JSON.parse(e.message);if(n){const i=JSON.parse(n.message);if(i){const n=JSON.parse(i.reason);n&&(t={...e,reason:{status:g(n)?n.status:void 0,errorCode:m(n)?n.errorCode:void 0}})}}}catch(n){t=u(e)}return t},u=e=>{if(!e.serverResponse)return null;const t={...e?.reason};return(0,r.$5)(e.context,e.code,e.subContext?e.subContext:"",{status:e.serverResponse.status,errorCode:t.errorCode??void 0,reason:e.reason,...t},e.message,e.serverResponse)},p=e=>"number"==typeof e,g=e=>!!e&&void 0!==e.status&&p(e.status),m=e=>!!e&&void 0!==e.errorCode&&p(e.errorCode)},878336:(e,t,n)=>{"use strict";n.d(t,{F6:()=>s,Q2:()=>l,a9:()=>d,Uf:()=>c,l7:()=>u,dG:()=>p,sZ:()=>g,XU:()=>m,qh:()=>h});var i=n(480354),r=n(572909),a=n(84646);function s(e,t){try{const n=o(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,i.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const i=e.split(".");for(let e=0;e<i.length;e++)t+=(e>0?"[.]":"")+i[e].replace(/\*/g,"[^/^.]+");const r=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(n.match(r))return!0}}catch{return!1}return!1}const o=e=>new URL(e).href,l=e=>e?.replace(/;messageid=.*/,""),d=(e,t,n,i)=>{let a="";if(!e.id||u(e.id))return a;switch(e.type){case r.ck.extensions:try{a=JSON.parse(e.id).threadId||n}catch(t){a=e.id||n||""}break;case r.ck.chats:case r.ck.chatthread:case r.ck.callingchats:a=e.id.replace("replyChainId","messageid");break;case r.ck.communities:case r.ck.channels:t=t??i;case r.ck.channelthread:let s;try{s=JSON.parse(e.id).channelId}catch{s=e.id}a=t?`${s};messageid=${t}`:s;break;case r.ck.shareformdialog:break;case r.ck.meetingcollaboration:default:a=e.id}return a},c=e=>e&&e.replace(new RegExp(`^${a.gN.BotPrefix}`),""),u=e=>"newchat"===e||e?.includes("preview"),p=(e,t=a.Go.Call)=>t===a.Go.Call&&/<partlist/.test(e)&&!h(e,t),g=(e,t)=>!!m(e,t)&&h(e),m=(e,t)=>t===a.Go.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>'),h=(e,t=a.Go.Call)=>t===a.Go.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},220192:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>i}),function(e){e.mention="http://schema.skype.com/Mention",e.inputExtension="http://schema.skype.com/InputExtension",e.amsVideo="http://schema.skype.com/AMSVideo",e.amsImage="http://schema.skype.com/AMSImage",e.emoji="http://schema.skype.com/Emoji",e.customEmoji="http://schema.skype.com/CustomEmoji",e.live="http://schema.skype.com/Live",e.giphy="http://schema.skype.com/Giphy",e.filesHyperlink="http://schema.skype.com/HyperLink/Files",e.hyperLink="http://schema.skype.com/HyperLink",e.reply="http://schema.skype.com/Reply",e.fluidLink="http://schema.skype.com/FluidLink",e.fluidEmbedLink="http://schema.skype.com/FluidEmbedLink",e.fluidEmbedCard="http://schema.skype.com/FluidEmbedCard",e.forward="http://schema.skype.com/Forward",e.cachedImage="http://schema.skype.com/CachedImage",e.scheduledMeetingCreated="http://schema.skype.com/ScheduledMeetingCreated",e.scheduledMeetingUpdated="http://schema.skype.com/ScheduledMeetingUpdated",e.scheduledMeetingCancelled="http://schema.skype.com/ScheduledMeetingCancelled",e.topic="http://schema.skype.com/Topic",e.sticker="http://schema.skype.com/Sticker",e.inlineImageCard="http://schema.skype.com/InlineImageCard",e.inlineImage="http://schema.skype.com/InlineImage",e.virtualEventsPersonalizationToken="http://schema.skype.com/VirtualEventsPersonalizationToken",e.editorCiqFile="http://schema.skype.com/EditorCiqFile",e.editorCiqPeople="http://schema.skype.com/EditorCiqPeople",e.editorCiqMeeting="http://schema.skype.com/EditorCiqMeeting",e.editorCiqEmail="http://schema.skype.com/EditorCiqEmail",e.editorCiqChat="http://schema.skype.com/EditorCiqChat",e.codeBlockEditor="http://schema.skype.com/CodeBlockEditor",e.citation="http://schema.skype.com/Citation"}(i||(i={}))},102029:(e,t,n)=>{"use strict";n.d(t,{L:()=>o});var i=n(520250);const r={getAttributeValue:(e,t)=>i.DomUtils.getAttributeValue(e,t),findOne:(e,t,n)=>i.DomUtils.findOne(e,t,n),findAll:(e,t)=>i.DomUtils.findAll(e,t),hasAttrib:(e,t)=>i.DomUtils.hasAttrib(e,t),getText:e=>i.DomUtils.getText(e),getChildren:e=>i.DomUtils.getChildren(e),getName:e=>i.DomUtils.getName(e),getOuterHTML:e=>i.DomUtils.getOuterHTML(e,{decodeEntities:!1}),getInnerHTML:(e,t)=>i.DomUtils.getInnerHTML(e,{decodeEntities:t??!1}),getElementsByTagName:(e,t,n,r)=>i.DomUtils.getElementsByTagName(e,t,n,r),append:(e,t)=>i.DomUtils.append(e,t),prepend:(e,t)=>i.DomUtils.prepend(e,t),appendChild:(e,t)=>i.DomUtils.appendChild(e,t),replaceElement:(e,t)=>i.DomUtils.replaceElement(e,t),removeElement:e=>i.DomUtils.removeElement(e),getElements:(e,t,n)=>i.DomUtils.getElements(e,t,!0,n)},a={_DomUtils:i.DomUtils,...r},s=(e,t={})=>(0,i.parseDOM)(e,{decodeEntities:!1,...t});var o;!function(e){e.DomHandler=i.DomHandler,e.Parser=i.Parser,e.DomUtils=a,e.ElementType=i.ElementType,e.parseDOM=s}(o||(o={}))},791129:(e,t,n)=>{"use strict";n.d(t,{n4:()=>d,UZ:()=>I,zj:()=>N});var i=n(480354),r=n(454007),a=n(112850),s=n(754255),o=n(969013),l=n(933678);const d=(e,t,n,i)=>{let r={normalized:e,diallable:e,display:e};const{logger:a,userLocale:s,isDialPlansEnabled:l,allowNonE164Mri:d,phoneNumberUtil:u,phoneNumberFormat:m}=n;if(!u||!m)return a.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!u}, isPhoneNumberFormatDefined=${!!m}`),r;if(!e)return a.warn(`[formatPhoneNumber] No phone number provided from: ${t}`),r;if(a.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${t}`),!i){const t=(0,o.tv)(e),i=c(t,n);if(a.log(`[formatPhoneNumber] cleaned_formatting, Phone number without alpha: ${i}`),l){if(r=A(i,n),a.log(`[formatPhoneNumber] isInternalExtension? ${r.isInternalExtension}`),r.isInternalExtension)return r}else a.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),r.normalized=i;d||(r.normalized=p(r.normalized,m.E164,n,!0),a.log("[formatPhoneNumber] NonE164 mri are not allowed"))}r={...r,...g(r.normalized,n)};try{const e=u.getInstance().parseAndKeepRawInput(r.normalized,s);r.display=u.getInstance().formatInOriginalFormat(e,m.INTERNATIONAL),r.isValid=u.getInstance().isPossibleNumber(e)&&u.getInstance().isValidNumber(e)}catch(e){a.error(`[formatPhoneNumber] ${e}`),r.display=r.normalized,r.isValid=!1}return a.log(`[formatPhoneNumber] isValid? ${r.isValid}`),r},c=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=u(e,t),i=e.substring(n.length);return t.phoneNumberUtil.convertAlphaCharactersInNumber(n)+i},u=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=t.phoneNumberUtil.EXTN_PATTERN_,i=e.search(n);return i>=0?e.substring(0,i):e},p=(e,t,n,i,r)=>{const{userLocale:a,logger:s,phoneNumberUtil:o,phoneNumberFormat:l}=n;if(!o||!l)return s.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}, isPhoneNumberFormatDefined=${!!l}`),e;const d=t||l.INTERNATIONAL,c=f(e,n,"parseAndFormatNumber");if(!M(c,n,r))return c;try{if(i){const e=o.getInstance().parse(c,a);return o.getInstance().format(e,d)}{const e=o.getInstance().parseAndKeepRawInput(c,a);return o.getInstance().formatInOriginalFormat(e,d)}}catch(e){return s.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),c}},g=(e,t)=>{const{enableFormattingFixForExtension:n}=t;return{diallable:u(e,t),extension:n?h(e,t):m(e,t)}},m=(e,t)=>{const n=f(e,t,"getExtension");return h(n,t)},h=(e,t)=>{const{enablePstnWithExtnFix:n,enableFixForDtmfTone:i,logger:r,userLocale:a,phoneNumberUtil:s}=t;if(!s)return r.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!s}`),"";if(!n&&!i&&!M(e,t))return r.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return s.getInstance().parse(e,a).getExtension()||""}catch(e){return r.error("Failed to parse and format a phone number",e),""}},I=(e,t,n,i)=>{const{logger:a}=t;let s=`${r.C.Pstn}${e}`;return n&&(s+=`${r.C.PstnExtension}${n}`),a.log(`[generateMriForPstn] context: ${i} Generated MRI: ${s} for dialOutNumber: ${e} ${n?`and extension: ${n}`:""}`),s},M=(e,t,n)=>{const{userLocale:i,logger:r,phoneNumberUtil:a}=t;if(!a)return r.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!a}`),!1;if(!e)return!1;try{const r=f(e,t,"isStandardFormatNormalized"),s=a.getInstance().parse(r,i),o=a.getInstance().isPossibleNumber(s);return n?o:o&&a.getInstance().isValidNumber(s)}catch(e){return r.error("[isStandardFormatNormalized] error:",e),!1}},f=(e,t,n)=>{const{isDialPlansEnabled:i,logger:r}=t;r.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${n}`);const a=(0,o.tv)(e);return i?A(a,t).normalized:a},A=(e,t)=>{const{normalizationRules:n,logger:i,coreSettings:r,ituCountryPrefix:s}=t,o={normalized:e,diallable:e,display:e};if(!n.length)return o;const l=new a.g(n,s,i,r).normalize(e);return o.normalized=l.phoneNumber,o.diallable=l?.phoneNumber,o.display=l?.phoneNumber,o.isInternalExtension=l?.isInternalExtension,o.isValid=l.isNormalized,o},T=(e,t,n,r,a)=>{let s;if(!(0,i.isEmpty)(e)){const t=r?.getInstance().getRegionCodeForCountryCode(Number(e));if(t)return s=t.toLowerCase(),n.log(`Setting locale based on dial plan to ${s}`),s}const o=a?.()||t||"en-US";return o?(s=o.substring(o.indexOf("-")+1).toLowerCase(),n.log(`Setting locale based on teams locale to ${s}`),s):(n.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},N=async(e,t,i,r)=>{const a=e.get(s.w.Calling);let o;try{o=await(async(e,t)=>{let i;try{const r=()=>n.e(725236).then(n.t.bind(n,787838,23));i=await(0,l.wg)(r,"libphonenumber-bundle",t),e.log("[getLibPhoneNumber] Loaded @microsoft/google-libphonenumber.")}catch(t){return e.errorToTelemetry?.(`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. Name: ${t?.name}, Message: ${t?.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${t?.message}`)}return i})(i,r)}catch(e){return i.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!a.allowNonE164Mri,isDialPlansEnabled:!!a.enableDialPlans,enablePstnWithExtnFix:!!a.enablePstnWithExtnFix,normalizationRules:a.dialPlanPolicy?.normalizationRules||[],ituCountryPrefix:a.dialPlanPolicy?.ituCountryPrefix||"",enableFormattingFixForExtension:!!a.enableFormattingFixForExtension,userLocale:T(a.dialPlanPolicy?.ituCountryPrefix||"",t,i,o.PhoneNumberUtil),enableFixForDtmfTone:!!a.enableFixForDtmfTone,logger:i,phoneNumberUtil:o.PhoneNumberUtil,phoneNumberFormat:o.PhoneNumberFormat,coreSettings:e}}},112850:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});var i=n(754255),r=n(969013);class a{constructor(e,t,n,i){this.iTUCountryPrefix=t,this.logger=n,this.coreSettings=i,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){let t=a.removeFormatCharacters(e);t=a.removeGuid(t);const n=this.coreSettings?.get(i.w.Calling);if(this.logger?.log(`[normalize] Feature flag: stopNormalizationOnPlus=${n?.stopNormalizationOnPlus}`),n?.stopNormalizationOnPlus&&t.startsWith("+"))return this.logger?.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:t,isNormalized:!0};let s=1;for(const n of this.normalizeRules){const{pattern:i,translation:r,isInternalExtension:a}=n;if(i.test(t)){const n=t.replace(i,r);return this.logger?.log(`[normalize] [${e}] was normalized into [${n}] using rule ${s} of ${this.normalizeRules.length}: ruleExpression=[${i}] translation=[${r}] isInternalExtension=[${a}].`),{phoneNumber:n,isInternalExtension:a,isNormalized:!0}}s++}if(this.logger?.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${n?.addCountryCodeDuringNormalization}].`),n?.addCountryCodeDuringNormalization&&!t.startsWith("+")&&(0,r.wk)(t)){const i=this.iTUCountryPrefix||n.dialPlanPolicy?.ituCountryPrefix,r=i?`+${i}`:"",a=`${r}${t}`;return this.logger?.log(`[normalize] [${e}] was normalized into [${a}] by adding country code [${r}].`),{phoneNumber:a,isNormalized:!!r}}return{phoneNumber:t}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const t of e)try{this.normalizeRules.push({pattern:new RegExp(t.pattern),translation:t.translation,isInternalExtension:t.isInternalExtension})}catch(e){this.invalidRules.push(t.pattern)}}}},969013:(e,t,n)=>{"use strict";n.d(t,{Ku:()=>r,QA:()=>a,h4:()=>s,vk:()=>c,Iy:()=>u,IK:()=>p,KM:()=>g,kZ:()=>m,tv:()=>h,wk:()=>I});var i=n(454007);const r=e=>Boolean(e&&e.startsWith(i.C.Pstn)),a=e=>e.some((e=>r(e))),s=e=>!(!e||![i.C.AcsUser,i.C.AcsGcchUser].some((t=>e.startsWith(t)))),o=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,l=/^\+?\d*[ ]*(\([ ]*\d+[ ]*\))?[0-9 -]+((?:;ext=([0-9]{1,7})|[  \t,]*(?:e?xt(?:ensi(?:ó?|ó))?n?|ｅ?ｘｔｎ?|[,xｘ#＃~～]|int|anexo|ｉｎｔ)[:\.．]?[  \t,-]*([0-9]{1,7})#?|[- ]+([0-9]{1,5})#))?$/i,d=e=>e.indexOf("_"),c=e=>{if(!r(e))return!1;const t=e.slice(i.C.Pstn.length);return-1!==d(t)},u=(e,t)=>o.test(e)&&t,p=e=>{let t=e.slice(i.C.Pstn.length);const n=d(t);return-1!==n&&(t=t.slice(0,n)),t},g=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:"",m=e=>e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,""),h=e=>{const t=(e=>e.replace(/[ \(\)\-_\/]+/g,""))(m(e));return t},I=e=>l.test(e?.trim())},435793:(e,t,n)=>{"use strict";function i(e=1){const t=new Uint32Array(e),i=n.g;if(i.msCrypto)i.msCrypto.getRandomValues(t);else if(i.crypto)i.crypto.getRandomValues(t);else{let n=e;for(;n--;){const e=4294967296;t[n]=Math.floor(Math.random()*e)}}return Array.from(t)}function r(e){return 0===(t=1/e,Math.floor(Math.random()*t));var t}n.d(t,{yT:()=>i,Dz:()=>r})},343468:(e,t,n)=>{"use strict";n.d(t,{bi:()=>i,M5:()=>a,XO:()=>c,kr:()=>h,qU:()=>M,zs:()=>f,fs:()=>A,TY:()=>T,zU:()=>N,wG:()=>y,fV:()=>C,aJ:()=>S,yD:()=>D,T5:()=>E,pc:()=>v});var i,r,a,s=n(84646),o=n(806658),l=n(480354),d=n(189888);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(i||(i={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(r||(r={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(a||(a={}));const c=e=>!!(e&&e.coExistenceMode&&i[e.coExistenceMode]),u=e=>!(e!==i.TeamsOnly),p=e=>!(-1===[i.Islands,i.IslandsWithTempInterop,i.IslandsWithVoipDeepLinking].indexOf(e)),g=e=>!(-1===[i.SfBOnly,i.SfBWithTeamsCollab,i.SfBWithTeamsCollabAndMeetings].indexOf(e)),m=(e,t,n=!1)=>{const i=[s.Vb,s.uM,s.QX,s.Sq,s.Ne,s.gI,s.cA,s.Bh,s.m2,s.Nk,s.zl],r=e.split(":");return i.some((e=>{const i=r.findIndex((t=>t===e.slice(0,-1)));return i>=0&&(n?r.splice(i+1,1):r.splice(i+1,0,t.slice(0,-1)),!0)})),r.join(":")},h=e=>!!e&&(0,l.startsWith)(e,s.gN.SkypeSpacesUser+s.K),I=e=>!!e&&e.includes(s.K)&&!(0,l.startsWith)(e,s.gN.SkypeSpacesUser+s.K),M=e=>!e||I(e)?e:e.includes(s.gN.SkypeSpacesUser)?m(e,s.K):void 0,f=e=>!!e&&!(0,l.startsWith)(s.gN.SkypeSpacesUser+s.hh,e)&&e.includes(s.hh),A=e=>!!e&&!(0,l.startsWith)(s.gN.SkypeSpacesUser+s.O,e)&&e.includes(`:${s.O}`),T=e=>!e||A(e)?e:e.includes(s.gN.SkypeSpacesUser)?m(e,s.O):void 0,N=e=>!e||f(e)?e:e.includes(s.gN.SkypeSpacesUser)?m(e,s.hh):void 0,y=e=>!e||(e=>!!e&&!e.startsWith(s.gN.SkypeSpacesUser+s.OE)&&e.includes(s.OE))(e)?e:e.includes(s.gN.SkypeSpacesUser)?m(e,s.OE):void 0,C=e=>{if(e){if(I(e))return m(e,s.K,!0);if(f(e))return m(e,s.hh,!0)}return e},S=e=>e?A(e)?m(e,s.O,!0):void 0:e,b={isAllowed:!1},D=(e,t,n,i,r,a,s,o)=>{const l=s&&s.coExistenceMode,d=a&&a.coExistenceMode;if(!l||!d)return{isAllowed:!0};if(i){const i=((e,t,n,i,r,a,s)=>{const o=s.newLogger("sfb-interop","services-utilities-sfb-interop");return a.isFederated?!i&&n?(o.log("Chat Disabled: current user is not provisioned on Sfb online"),b):a.coExistenceMode&&r.coExistenceMode?e&&n&&u(r.coExistenceMode)&&u(a.coExistenceMode)?{isAllowed:!1,mri:N(a.mri||"")}:n||t||!p(r.coExistenceMode)&&!p(a.coExistenceMode)?!n&&g(a.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:a.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:a.mri}:(o.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(o.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(a))})(e,t,n,r,a,s,o);if(!i.isAllowed)return i}else{const e=((e,t)=>t.coExistenceMode?e&&u(t.coExistenceMode)?{isAllowed:!1,mri:C(t.mri||"")}:!e&&g(t.coExistenceMode)?{isAllowed:!1,mri:M(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(n,s);if(!e.isAllowed)return e}return{isAllowed:!0}},E=e=>{const t=f(e);return U(e)||I(e)||t?(n=e)&&((0,l.startsWith)(n,s.gN.SkypeSpacesUser+s.cA)||(0,l.startsWith)(n,s.gN.SkypeSpacesUser+s.Bh)||(0,l.startsWith)(n,s.gN.SkypeSpacesUser+s.m2)||(0,l.startsWith)(n,s.gN.SkypeSpacesUser+s.Nk)||(0,l.startsWith)(n,s.gN.SkypeSpacesUser+s.zl))?e:t?e.replace(s.hh,""):e.replace(s.K,"").replace(s.v,""):e;var n},U=e=>!!e&&!(0,l.startsWith)(s.gN.SkypeSpacesUser+s.v,e)&&e.includes(s.v),w=(e,t,n,i)=>{const a=e.isFederated,s=(o=e.mri||"",(0,l.endsWith)(o,"@sfbonprem.unq.gbl.spaces"));var o;if(t&&a&&!s&&e.coExistenceMode){const t=r[e.coExistenceMode],a=n===r.TeamsOnly&&t===r.TeamsOnly;return a||i.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${r[n]} recipientCoexistenceMode:${r[t]}`),a}return i.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${a} isOnPremFederated:${s} coExistenceMode:${e.coExistenceMode}`),!1},v=(e,t,n,i,s,l)=>{if(!(e&&e.mri&&e.userType!==d.$o.guest&&e.type!==d.$o.skypeConsumer&&e.type!==d.$o.tflUser&&(0,o.Y$)(e.mri)))return n.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),a.Teams;if(e.isFederated)return n.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),w(e,s,l,n)?a.NativeFederated:a.Federated;const c=((e,t,n)=>{const i=e.coExistenceMode,s=r[i];if(n.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${r[s]}, MT coExistenceMode: ${i}`),r[s]!==i&&n.error(`getUserChatMode - Mapping error - coExistenceMode : ${r[s]}, MT coExistenceMode: ${i}`),s){const e=[r.SfBOnly,r.SfBWithTeamsCollab,r.SfBWithTeamsCollabAndMeetings],t=[r.TeamsOnly,r.Islands,r.IslandsWithVoipDeepLinking];if(e.includes(s))return a.SfB;if(t.includes(s))return a.Teams;n.warn(`getUserChatMode - unknown coExistenceMode ${r[s]}`)}else e.isShortProfile||n.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,n);if(c)return c;const u=h(e.mri),p=e.isSkypeTeamsUser,g=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return n.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${u}, isTeamsChatEnabled: ${g}, hasLoggedInToTeams: ${p}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${i}`),!u&&p&&g||e.isSipDisabled||!i?a.Teams:a.SfB}},288451:(e,t,n)=>{"use strict";n.d(t,{z:()=>s,I:()=>o});var i=n(108557),r=n(67309);const a={kind:"Document",get definitions(){const e=(0,r.G)("query downloadAmsItem($urlOrObjectId:String!,$type:BlobType!,$applyRetry:Boolean!,$networkCorrelationId:String) {downloadAmsItem(urlOrObjectId:$urlOrObjectId,type:$type,applyRetry:$applyRetry,networkCorrelationId:$networkCorrelationId) {blob,fullSizeHeight,fullSizeWidth,size}}");return delete this.definitions,this.definitions=e.definitions}},s=async(e,t,n,r,s)=>{try{const{data:i}=await e.query({query:a,variables:{urlOrObjectId:t,type:n,applyRetry:!0,networkCorrelationId:r},context:{callerInfo:s},fetchPolicy:"network-only"});return{result:i?.downloadAmsItem??void 0,loading:!1,error:void 0}}catch(e){if(e instanceof i.K){const t=e.graphQLErrors.find((e=>o(e.extensions)))?.extensions;return{result:void 0,loading:!1,error:{...t,message:e.message,name:e.name}}}return{result:void 0,loading:!1,error:e}}},o=e=>"string"==typeof e?.cv},723599:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var i=n(550497),r=n(400051),a=n(737561),s=n(480354);const o=(e,t,n)=>{const i=h(e),r=(0,a.qJ)(e)||(0,a.TJ)(e);let o=r?[]:l(i,e),d=[],p=[];const g=[];return e.webApplicationInfo?.applicationPermissions?.forEach((e=>{e&&g.push(e)})),e.authorization?.permissions?.resourceSpecific?.forEach((e=>{e?.name&&g.push(e.name)})),d=u(g,n,r),p=c(e,i),o=[...o,...d,...p],e.meetingExtensionDefinition?.supportsStreaming&&o.push("app_details_permission_meeting_streaming_access"),t&&(o.push("extension_addAppDialog_meetings_info_permissions"),o.push("extension_addAppDialog_meetings_mute_unmute_permissions")),(0,s.uniq)(o)},l=(e,t)=>{const n=[],a=d(e,n);for(const e of[a])e(r.o3),(0,i.Z1)("Team",t)&&(0,i.Z1)("GroupChat",t)?e(r.SO):(0,i.Z1)("Team",t)?e(r.NZ):(0,i.Z1)("GroupChat",t)&&e(r.QO);return n},d=(e,t)=>n=>{n.forEach(((n,i)=>{n.extendedCapability.some((t=>e.includes(t)))&&t.push(n.permissionKey)}))},c=(e,t)=>t.includes("staticTabs")||t.includes("galleryTabs")?[]:(e.devicePermissions??[])?.map((e=>r.NY[e])),u=(e,t,n)=>{if(!e.length)return[];const i=new Set(e),a=[...m(r.pb,i,t,p),...m(r.kO,i,t,g)];return i.forEach((e=>a.push(e))),!n&&e?.length&&a.push("app_details_permission_teams_access"),a},p=(e,t,n)=>`app_details_permission_${e}_${t}_${n}`.toLocaleLowerCase(),g=(e,t,n)=>`app_details_permission_${e}_${t}_${n}`.toLocaleLowerCase(),m=(e,t,n,i)=>e.reduce(((e,a)=>(r.Lu.forEach((s=>{const o=[];if(r.VF.forEach((e=>{const n=`${a}.${e}.${s}`;t.has(n)&&(o.push(e),t.delete(n))})),!o.length)return;const l=o.join("_"),d=i(a,l,s);n.translate("extensibility",d)!==d?e.push(d):o.forEach((t=>{const n=i(a,t,s);e.push(n)}))})),e)),[]),h=e=>[...r.VJ.filter((t=>!!e[t]?.length)),...r.U8.filter((t=>!!e.metaCapabilities?.[t])),...r.iz.filter((t=>!!e[t]))]},400051:(e,t,n)=>{"use strict";n.d(t,{pb:()=>a,kO:()=>s,VF:()=>o,Lu:()=>l,Ew:()=>d,Wo:()=>c,B7:()=>u,NY:()=>g,VJ:()=>m,U8:()=>h,iz:()=>I,o3:()=>M,NZ:()=>f,QO:()=>A,SO:()=>T});var i=n(230080),r=n(213507);const a=["TeamSettings","ChannelSettings","Channel","ChannelMessage","TeamsTab","Member","Owner","TeamMember","TeamsAppInstallation","File","ChatMember","ChatMessage","ChatSettings","Chat","OnlineMeeting","CameraStream","OutgoingVideoStream","OnlineMeetingParticipant","ChannelMeetingParticipant","InAppPurchase","OnlineMeeting","ChannelMeeting","TeamsActivity","Calls","MeetingStage","ChannelMeetingStage","MicrophoneStream","OnlineMeetingIncomingAudio","ChannelMeetingIncomingAudio","OnlineMeetingActiveSpeaker","ChannelMeetingActiveSpeaker","ChannelMeetingAudioVideo","LiveShareSession","MeetingParticipantReaction","OnlineMeetingNotification","ChannelMeetingNotification","ChatMessageReadReceipt"],s=["Document","MailboxRoamingSettings","MailboxItem","Mailbox","SearchQuery","ChannelMeetingTranscript","OnlineMeetingTranscript","AiEnterpriseInteraction","ChannelMember"],o=["Read","ReadAll","Create","ReadWrite","Delete","Manage","ManageDeletion","ReadBasic","ToggleIncomingAudio","Write","Allow","Send","AccessMedia","JoinGroupCalls","Detect","Stream","AccessSharedFolders","AppendOnSend"],l=["Group","Chat","User"];var d,c;!function(e){e.readAccess="app_details_categories_readaccess",e.performActions="app_details_categories_perform_actions"}(d||(d={})),function(e){e.informationRelatedToYou="app_details_subcategories_information_related_to_you",e.informationChatsChannelsMeetings="app_details_subcategories_information_chatschannelsmeetings",e.otherReadAccess="app_details_subcategories_other_readaccess",e.sendReceiveMessagesNotifications="app_details_subcategories_send_receive_messages_notifications",e.contentSettings="app_details_subcategories_content_settings",e.manageMediaDevices="app_details_subcategories_manage_media_devices",e.otherActions="app_details_subcategories_other"}(c||(c={}));const u={app_details_subcategories_information_related_to_you:i._Au,app_details_subcategories_information_chatschannelsmeetings:i.LOD,app_details_subcategories_other_readaccess:r.B,app_details_subcategories_send_receive_messages_notifications:i.ysm,app_details_subcategories_content_settings:i.wB_,app_details_subcategories_manage_media_devices:i.CeX,app_details_subcategories_other:i.fvR};var p;!function(e){e.media="Media",e.geolocation="Geolocation",e.notifications="Notifications",e.midi="Midi",e.openExternal="OpenExternal"}(p||(p={}));const g={[p.media]:"extension_addAppDialogDeviceConsent",[p.geolocation]:"extension_addAppDialogLocationConsent",[p.notifications]:"extension_addAppDialogNotificationsConsent",[p.openExternal]:"extension_addAppDialogExternalLinkContent",[p.midi]:"extension_addAppDialogMIDIContent"},m=["bots","connectors","galleryTabs","messageExtensions","staticTabs"],h=["copilotExtensions","declarativeCopilots","customEngineCopilots"],I=["isFullScreenApp"],M=[{permissionKey:"app_details_basic_full_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions","copilotExtensions","declarativeCopilots","customEngineCopilots"]},{permissionKey:"app_details_basic_bots_permission",extendedCapability:["bots"]},{permissionKey:"app_details_full_screen_permission",extendedCapability:["isFullScreenApp"]},{permissionKey:"app_details_identity_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions","copilotExtensions","declarativeCopilots","customEngineCopilots"]}],f=[{permissionKey:"extension_addAppDialogTeamAndChatAndMeetingPermission1",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]},{permissionKey:"extension_addAppDialogTeamAndChatAndMeetingPermission2",extendedCapability:["bots","connectors"]},{permissionKey:"extension_addAppDialogIdentityTeamAndChatAndMeetingPermission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]}],A=[{permissionKey:"app_details_chat_galleryTabs_bots_permission",extendedCapability:["galleryTabs","bots"]},{permissionKey:"app_details_chat_bots_permission",extendedCapability:["bots"]},{permissionKey:"app_details_identity_chat_permission",extendedCapability:["galleryTabs","bots"]}],T=[{permissionKey:"app_details_team_and_chat_full_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]},{permissionKey:"app_details_team_and_chat_bots_connectors_permission",extendedCapability:["bots","connectors"]},{permissionKey:"app_details_identity_team_and_chat_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]}]},737561:(e,t,n)=>{"use strict";n.d(t,{yP:()=>c,eO:()=>u,vx:()=>p,$W:()=>g,Tz:()=>m,Cu:()=>h,HY:()=>I,kq:()=>M,mW:()=>f,HL:()=>A,_E:()=>T,Ez:()=>x,G3:()=>F,FJ:()=>O,U5:()=>P,Ob:()=>j,mN:()=>R,qJ:()=>z,TJ:()=>B,y$:()=>V,NE:()=>_,sh:()=>W,ZA:()=>Q,wQ:()=>Y,Dm:()=>G,zA:()=>H,J_:()=>J,W4:()=>X,ml:()=>q,Ho:()=>K,$P:()=>$,q0:()=>ee,gE:()=>te,pb:()=>ne,lj:()=>ie,dL:()=>re,Nq:()=>ae,ND:()=>se,$9:()=>oe,K7:()=>ce,wZ:()=>ue,dn:()=>pe});var i=n(550497),r=n(39696),a=n(380322),s=n(84646),o=n(480354),l=n(557616),d=n(282100);const c=e=>!!e.externalId&&!e.tenantId,u=["bots","connectors","galleryTabs","messageExtensions","staticTabs"],p=(e,t)=>(0,o.some)(t,(t=>(0,o.includes)(t.scopes,e))),g=(e,t)=>!!t[e]?.length,m=(e,t,n)=>{if(!e)return!1;const i=t.toLowerCase();for(const t of e)if((!n||t.scopes?.includes(n))&&t.context?.some((e=>e?.toLowerCase()===i)))return!0;return!1},h=e=>{if(!e)return!1;for(const t of e)if(!t.context||0===t.context.length)return!0;return!1},I=(e,t)=>e.messageExtensions?.some((e=>e.commands?.some((e=>e.context?e.context.some((e=>e===t)):"Commandbox"===t||"Compose"))))??!1,M=e=>{const t=e?.bots?.[0]?.id;if(t){const e=t?.startsWith(s.gN.BotPrefix);return e?t:`${s.gN.BotPrefix}${t}`}},f=e=>e.startsWith(s.gN.BotPrefix)?e.substring(s.gN.BotPrefix.length):e,A=e=>{switch(e?.type){case l.ld.Team:return e.teamId;case l.ld.GroupChat:case l.ld.Meeting:return e.chatId;default:return}};const T=e=>!!e.meetingExtensionDefinition?.scenes&&e.meetingExtensionDefinition.scenes.length>0,N="https://player.vimeo.com/video/{vimeoId}",y="https://www.youtube.com/embed/{youtubeId}?&showinfo=0&rel=0&modestbranding=1",C="youtube.com/",S="youtu.be/",b="vimeo.com/",D=/^https?:\/\/(([0-9a-zA-Z.\-_+%]+\/?)*)(\?([0-9a-zA-Z.\-_+%]+=[0-9a-zA-Z.\-_+%]+)(\&[0-9a-zA-Z.\-_+%]+=[0-9a-zA-Z.\-_+%]+)*)?$/,E=1,U=3,w=/([0-9a-zA-Z.\-_+%]+)\/?$/,v=/\/embed\/([0-9a-zA-Z.\-_+%]+)/,L=/v=([0-9a-zA-Z.\-_+%]+)/,k=1;function x(e){let t="";if(!D.test(e))return t;const n=e.match(D);if(n&&n[E]){const e=n[E];if(v.test(e)){const n=e.match(v);n&&n[k]&&(t=y.replace("{youtubeId}",n[k]))}else if(e.includes(C)&&n[U]&&L.test(n[U])){const e=n[U].match(L);e&&e[k]&&(t=y.replace("{youtubeId}",e[k]))}else if(w.test(e)){const n=e.match(w);n&&n[k]&&(e.includes(S)?t=y.replace("{youtubeId}",n[k]):e.includes(b)&&(t=N.replace("{vimeoId}",n[k])))}}return t}const F=(e,t,n,a,s,d,c)=>async(u,p)=>{if(!u)return[];const m=(r,o,c,u)=>(0,i.Pe)(e,t,n,r,o,a,d,c,s({installType:l.ld.InContext,chatId:c}),void 0,u,!0);return Promise.all((0,o.map)(p,(async n=>{switch(n.installScope){case"Personal":return await(async(e,t,n,a,s)=>{if(!(g("messageExtensions",e)||(0,i.Z1)("Personal",e)||s&&T(e)))return!1;const l=await(0,i.HI)(t,n,a,!0,{shouldFetchPersonalApps:!0,entryPoint:r.gY.AppDetails});return!(0,o.some)(l,(t=>t.id===e.id&&"Personal"===t.installedScope))})(u,e,a,t,c)?m(u.id,"Personal"):null;case"GroupChat":case"Team":return(0,i.Z1)(n.installScope,u)?m(u.id,n.installScope,n.installChatOrTeamId,"app-details-data-context-provider-v1"):null;default:return null}})))},O=e=>d.Ee.includes(e.entryPoint)?e.teamId:e.chatId,P=e=>{const t=e.entryPoint,n=e.isTaosSharedApp,i=e.appSource,r=e,s=e,{icLaunchOptions:o,threadId:d}=e;let c;if(o&&t!==a.NS.InContextStorePersonal){const{teamId:e}=o;c=t===a.NS.MEInContextStoreGroupChat||t===a.NS.TabsInContextStoreGroupChat||t===a.NS.BotsInContextStoreGroupChat?{chatId:d}:s.templatedAppId?{teamId:e,channelId:d}:{teamId:d}}return e.entryPoint===a.NS.DeepLinkSideLoad?{appType:l.uC.DeepLinkSideload,entryPoint:t,appId:e.appId}:e.entryPoint===a.NS.DeepLinkTrustedSideLoad?{appType:l.uC.TrustedSideload,entryPoint:t,templatedAppId:e.appId,templateInstanceId:e.templateInstanceId,environment:e.environment}:r.manifestFile?{appType:l.uC.Sideload,entryPoint:t,manifestURL:r.manifestFile,chatId:e.chatId,teamId:e.teamId,channelId:e.channelId}:s.templatedAppId?{...c,appType:l.uC.TrustedSideload,entryPoint:t,templatedAppId:s.templatedAppId,templateInstanceId:e.appId,environment:s.environment}:e.entryPoint===a.NS.DeepLink&&e.templateInstanceId&&e.appId?{appType:l.uC.TrustedSideload,entryPoint:t,templatedAppId:e.appId,templateInstanceId:e.templateInstanceId,environment:e.environment}:c?{...c,appSource:i,entryPoint:t,appType:l.uC.Normal,appId:e.appId}:{appSource:i,appType:l.uC.Normal,entryPoint:t,appId:e.appId,teamId:e.teamId,chatId:e.chatId,channelId:e.channelId,isTaosSharedApp:n,isAppEnableRequired:e.isAppEnableRequired}},j=()=>{throw new Error("Not implemented")},R=(e,t,n)=>{const i=n===l.ld.Meeting;let r;return r="Team"===t?i?"ChannelMeeting":"Team":"GroupChat"===t?i?"Meeting":"GroupChat":"Personal",e.appDetailsExclusionList?.[r]},z=e=>!!e.exchangeAddInElement,B=e=>!!e.officeAddInElement,V=e=>!(!e||!e.metaCapabilities||!e.metaCapabilities.copilotPlugins&&!e.metaCapabilities.copilotExtensions),_=e=>!!e?.metaCapabilities?.declarativeCopilots,W=e=>!!e?.metaCapabilities?.customEngineCopilots,Q=e=>{if(!e||!e.metaCapabilities)return"";const t=e.metaCapabilities;return Object.keys(t).filter((e=>"__typename"!==e&&null!==t[e])).join(",")},Y=e=>(e=>{const t=!!e&&!!e.metaCapabilities,n=t&&!e.metaCapabilities.copilotPlugins,i=t&&!!e.metaCapabilities.copilotExtensions;return n&&i||_(e)})(e)?"launchcopilotextension":"launchcopilotplugin",G=(e,t)=>(0,i.Z1)("Personal",e,t)||z(e)||B(e)||g("extensions",e),Z=(e,t,n,i)=>{const r=!("Personal"===e.defaultInstallScope||"Team"===e.defaultInstallScope||"GroupChat"===e.defaultInstallScope||"Meetings"===e.defaultInstallScope)&&"BizChat"===i;if((e.metaCapabilities?.copilotPlugins||e.metaCapabilities?.declarativeCopilots)&&n&&r)return!0;if(e.metaCapabilities?.customEngineCopilots){if(r&&("BizChat"===t.customEngineAgentNavigation||n&&"BizChatWhenLicensedElseChatList"===t.customEngineAgentNavigation))return!0;if("ChatList"===i&&(!n&&"BizChatWhenLicensedElseChatList"===t.customEngineAgentNavigation||"ChatList"===t.customEngineAgentNavigation))return!0}else if(e.metaCapabilities?.copilotExtensions&&n&&r)return!0;return!1},H=(e,t,n)=>t.enableUpdatedPostInstallFlowForAgents?Z(e,t,n,"ChatList"):V(e)&&!_(e)&&p("Personal",e.bots)&&!e?.bots?.[0]?.capabilities?.isNotificationOnly,J=(e,t,n)=>t.enableUpdatedPostInstallFlowForAgents?Z(e,t,n,"BizChat"):V(e)&&(!(p("Personal",e.bots)&&!e?.bots?.[0]?.capabilities?.isNotificationOnly)||_(e)),X=(e,t)=>!!(t?.bots&&e?.bots&&t.bots.length>e.bots.length),q=(e,t)=>{if(t.bots&&e.bots){const n=(0,o.difference)(t.bots[0]?.scopes,e.bots[0]?.scopes?e.bots[0]?.scopes:[]);return e.bots[0]?.id!==t.bots[0]?.id||!(0,o.isEmpty)(n)}return!1},K=(e,t)=>!(!t.bots||!e.bots||e.bots[0]?.capabilities?.supportsFiles===t.bots[0]?.capabilities?.supportsFiles)&&!!t.bots[0]?.capabilities?.supportsFiles,$=(e,t)=>!(!t.bots||!e.bots||e.bots[0]?.capabilities?.supportsCalling===t.bots[0]?.capabilities?.supportsCalling)&&!!t.bots[0]?.capabilities?.supportsCalling,ee=(e,t)=>!(!t.bots||!e.bots||e.bots[0]?.capabilities?.supportsVideo===t.bots[0]?.capabilities?.supportsVideo)&&!!t.bots[0]?.capabilities?.supportsVideo,te=(e,t)=>!(e.webApplicationInfo?.id===t.webApplicationInfo?.id),ne=(e,t)=>!!(t.messageExtensions&&e.messageExtensions&&t.messageExtensions.length>e.messageExtensions.length),ie=(e,t,n,i)=>!!i&&"upgradeFlow"===n.type&&(((e,t)=>!(!e||!t)&&(X(t,e)||q(t,e)||$(t,e)||ee(t,e)||K(t,e)||ne(t,e)||te(t,e)))(e,t)||!!n.newKeys.length),re=e=>p("Team",e.galleryTabs)&&(m(e.galleryTabs,"ChannelTab")||h(e.galleryTabs)),ae=e=>p("Team",e.staticTabs)&&(m(e.staticTabs,"ChannelTab")||m(e.staticTabs,"TeamLevelApp")||h(e.staticTabs)),se=e=>p("GroupChat",e.galleryTabs)&&(m(e.galleryTabs,"PrivateChatTab")||h(e.galleryTabs)),oe=e=>p("GroupChat",e.staticTabs)&&(m(e.staticTabs,"PrivateChatTab")||h(e.staticTabs)),le=(e,t)=>{switch(t){case"Team":return re(e);case"GroupChat":return(e=>p("GroupChat",e.galleryTabs)&&(m(e.galleryTabs,"PrivateChatTab")||m(e.galleryTabs,"MeetingStage")||m(e.galleryTabs,"MeetingSidePanel")||h(e.galleryTabs)))(e);default:return p(t,e.galleryTabs)}},de=(e,t)=>{switch(t){case"Team":return ae(e);case"GroupChat":return(e=>p("GroupChat",e.staticTabs))(e);default:return p(t,e.staticTabs)}},ce=(e,t,n)=>{let i=p(t,e.bots)&&!n?.bots||p(t,e.connectors)&&!n?.connectors||le(e,t)&&!n?.galleryTabs||de(e,t)&&!n?.staticTabs;if("Team"===t)return i;if(i||(i=p(t,e.messageExtensions)&&!n?.messageExtensions),"Personal"!==t)return i;const r=(e.meetingExtensionDefinition?.scenes?.length??0)>0,a=(e.meetingExtensionDefinition?.filters?.length??0)>0,s=z(e),o=B(e),l=g("extensions",e),d=V(e);return i||r||a||s||o||l||d},ue=e=>{if(!e)return"";if((0,o.startsWith)(e,"com.microsoft"))return e;return/^([a-zA-Z]_)?[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i.test(e)||/^[w|W][a|A][0-9]+$/i.test(e)?e:`${e[0]}${new Array(e.length).join("*")}`},pe=e=>!!e&&!!e.metaCapabilities&&!!(e.metaCapabilities.copilotPlugins||e.metaCapabilities.copilotExtensions||e.metaCapabilities.customEngineCopilots||e.metaCapabilities.declarativeCopilots)},557616:(e,t,n)=>{"use strict";var i,r,a,s,o,l;n.d(t,{uC:()=>i,Q8:()=>r,ld:()=>a,EU:()=>o,Bp:()=>l}),function(e){e[e.Normal=1]="Normal",e[e.Sideload=2]="Sideload",e[e.TrustedSideload=3]="TrustedSideload",e[e.DeepLinkSideload=4]="DeepLinkSideload"}(i||(i={})),function(e){e.Overview="Overview",e.Features="Features",e.Reviews="Reviews",e.Permissions="Permissions",e.DiscoverMoreApps="DiscoverMoreApps",e.WhatsNew="WhatsNew"}(r||(r={})),function(e){e.InContext="InContext",e.Contextless="Contextless",e.Update="Update",e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meeting="Meeting",e.RequestAccess="RequestAccess"}(a||(a={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning"}(s||(s={})),function(e){e.NoTeamScope="NoTeamScope",e.NoChatScope="NoChatScope",e.NoAccess="NoAccess",e.NoCopilotLicense="NoCopilotLicense",e.NoCopilotLicenseAgent="NoCopilotLicenseAgent",e.NoCopilotLicenseAgentAndOtherCapability="NoCopilotLicenseAgentAndOtherCapability",e.HasPermissionError="HasPermissionError",e.SideLoadNonPreviewAudience="SideLoadNonPreviewAudience",e.SideLoadPublicOffer="SideLoadPublicOffer",e.SideLoadPurchase="SideLoadPurchase",e.NoAccessWithAdminRequestConfig="NoAccessWithAdminRequestConfig",e.RequestedAccessWithAdminRequestConfig="RequestedAccessWithAdminRequestConfig",e.DisabledInstallScopes="DisabledInstallScopes",e.SideloadDebugging="SideloadDebugging"}(o||(o={})),function(e){e[e.NoBuySubscription=1]="NoBuySubscription",e[e.BuySubscriptionWithNoWarning=2]="BuySubscriptionWithNoWarning",e[e.BuySubscriptionWithLoadingIcon=3]="BuySubscriptionWithLoadingIcon",e[e.BuySubscriptionWithWarningPublicOffer=4]="BuySubscriptionWithWarningPublicOffer",e[e.BuySubscriptionWithWarningPreviewOfferNotFound=5]="BuySubscriptionWithWarningPreviewOfferNotFound",e[e.BuySubscriptionWithWarningPurchase=6]="BuySubscriptionWithWarningPurchase"}(l||(l={}))},282100:(e,t,n)=>{"use strict";n.d(t,{PJ:()=>r,Qt:()=>a,em:()=>s,V2:()=>o,Z1:()=>l,Ee:()=>d,mo:()=>c,Of:()=>u,Wb:()=>p,c8:()=>g,$_:()=>m,Q5:()=>h,wP:()=>I,no:()=>M});var i=n(380322);const r="APP_DETAILS_DIALOG_ROOT_ID",a=["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled","RequireConsent"],s=5,o=[[[i.NS.TabsInContextStoreTeam,i.NS.BotsInContextStoreTeam,i.NS.AppSuggestionInEmptyChannel,i.NS.AtMentionDirectInstallationFromTeam,i.NS.ConnectorManagementDialog,i.NS.InContextGalleryDialogFromChannel,i.NS.InContextGalleryDialogMoreAppsFromChannel,i.NS.MeetingFromTeam,i.NS.MeetingFromChannel,i.NS.MeetingAppsFlyoutFromChannel,i.NS.ReactMessageExtensionFlyoutFromChannel,i.NS.PlatformTabButtonTeam,i.NS.ExtensibilityAppPickerFlyoutTeam,i.NS.ExtensibilityAppPickerSidePanelTeam],["Personal","Team"]],[[i.NS.TabsInContextStoreGroupChat,i.NS.BotsInContextStoreGroupChat,i.NS.AtMentionDirectInstallationFromGroupChat,i.NS.InContextGalleryDialogFromGroupChat,i.NS.InContextGalleryDialogMoreAppsFromGroupChat,i.NS.MeetingFromGroupchat,i.NS.Meeting,i.NS.MeetingFromDeepLink,i.NS.MeetingAppsFlyout,i.NS.ExtensibilityAppPickerSidePanelGroupChat,i.NS.ExtensibilityAppPickerFlyoutGroupChat,i.NS.PlatformTabButtonGroupChat],["Personal","GroupChat"]],[[i.NS.InContextStorePersonal,i.NS.MEInContextStoreGroupChat,i.NS.MEInContextStoreTeam,i.NS.MessagingExtensionFlyoutV2,i.NS.MessageExtensionFlyout,i.NS.MessageExtensionFlyoutSuggestedCollection,i.NS.ScenePicker,i.NS.JITInstallCardAction,i.NS.CardHeaderInstallAction,i.NS.JITInstallTaskModule,i.NS.ProactiveMessageForBots,i.NS.PlatformAppConsentDialog,i.NS.CopilotInContextGroupChat,i.NS.CopilotInContextMeeting,i.NS.ExtensibilityAppPickerSidePanelPersonal,i.NS.ExtensibilityAppPickerFlyoutPersonal],["Personal"]]],l=[[[i.NS.AppsManagementTabFromTeamSideload,i.NS.TabsInContextStoreTeam,i.NS.BotsInContextStoreTeam],["Personal","Team"]],[[i.NS.AppsManagementTabFromGroupChatSideload,i.NS.TabsInContextStoreGroupChat,i.NS.BotsInContextStoreGroupChat],["Personal","GroupChat"]],[[i.NS.MessagingExtensionFlyoutV2],["Personal"]]],d=[...o[0][0],...l[0][0]],c=(o[1][0],l[1][0],[[o[0][0],["Team"]],[o[1][0],["GroupChat"]],[o[2][0],["Personal"]]]),u=[[l[0][0],["Team"]],[l[1][0],["GroupChat"]],[l[2][0],["Personal"]]],p=[i.NS.PersonalAppBannerUpgrade,i.NS.NewMessageUpgrade,i.NS.AppsManagementTabUpgrade,i.NS.ChannelInfoPaneAppWidgetUpgrade,i.NS.GroupChatAppsManagementUpgrade,i.NS.ManageAppsInstalledAppUpgrade,i.NS.UrlPersonalUpgrade,i.NS.TeamAppBannerUpgrade,i.NS.GroupChatAppBannerUpgrade],g=[i.NS.AtMentionDirectInstallationFromGroupChat,i.NS.InContextGalleryDialogFromGroupChat],m=[i.NS.AtMentionDirectInstallationFromTeam,i.NS.InContextGalleryDialogFromChannel],h=[i.NS.PersonalAppAbout,i.NS.GroupChatAppsManagementView],I=[i.NS.AppsManagementTabView,i.NS.ChannelInfoPaneAppWidgetView],M=[i.NS.AppsManagementTabView]},283758:(e,t,n)=>{"use strict";n.d(t,{QL:()=>I,dX:()=>f,wM:()=>h});var i=n(513432),r=n(67309);const a={kind:"Document",get definitions(){const e=(0,r.G)("query chatWithUser($userId:ID!) {chatWithUser(userId:$userId) {id,isDisabled,memberIds}}");return delete this.definitions,this.definitions=e.definitions}},s={kind:"Document",get definitions(){const e=(0,r.G)("mutation sendMessage($convId:ID!,$message:SendMessageInput,$action:SendMessageAction) {sendMessage(convId:$convId,message:$message,action:$action) {id}}");return delete this.definitions,this.definitions=e.definitions}},o={kind:"Document",get definitions(){const e=(0,r.G)("mutation fireCallingIntent($callingIntent:CallingIntentInput!) {fireCallingIntent(callingIntent:$callingIntent) {id}}");return delete this.definitions,this.definitions=e.definitions}};var l=n(717828),d=n(754255),c=n(937545),u=n(131647),p=n(735652),g=n(84646),m=n(806658);const h=(e,t,n)=>{const{enableCentralizedCommandingForEV:r}=(0,p.w2)(d.w.Host,["enableCentralizedCommandingForEV"]),{enablePlatformNavigationForBots:a}=(0,p.w2)(d.w.Extensibility,["enablePlatformNavigationForBots"]);return i.useMemo((()=>({sendMessage:M(t,n),startChat:f(e,t,!!a,n),startCall:A(e,t,n,!!r)})),[e,t,n,r,a])},I=async(e,t)=>{const{data:n}=await e.query({query:a,variables:{userId:t},fetchPolicy:"network-only"});return n?.chatWithUser},M=(e,t)=>async(n,i,r)=>{try{const t=await I(e,n);if(!t)throw new Error(`Could not fetch the user conversation using the mri ${n}`);const a={convId:t.id,message:{content:i,clientMessageId:(0,l.sN)(),messageType:g.Go.Text},action:"Create"};await e.mutate({mutation:s,variables:a}),r.stop()}catch{const e=`Error while sending quick message with mri ${n}`;t.error(e),r?.fail({message:e})}},f=(e,t,n,i)=>async(r,a)=>{try{if(!r)throw new Error("No mri provided");const i=await I(t,r);if(i&&i.id){(0,m.Iz)(r)&&n?e.platform.platformTabById(JSON.stringify({appId:r,threadId:i.id,tabEntityId:"conversations"}),{stateTransition:c.Ar.new,visibilityState:c.Rp.show,correlation:{source:u.p.AppProfileCard}}):e.chat.chatById(i.id,{entityCommand:{stateTransition:c.Ar.new,visibilityState:c.Rp.show,correlation:{source:u.p.AppProfileCard}}})}else e.chat.chatWithUsers({userIds:[r],entityCommand:{stateTransition:c.Ar.new,visibilityState:c.Rp.show,correlation:{source:u.p.AppProfileCard}}});a?.stop()}catch{const e=`Error while we execute start chat with mri ${r}`;i?.error(e),a?.fail({message:e})}},A=(e,t,n,i)=>async(r,a,s)=>{try{if(!r)throw new Error(`Could not get the user mri ${r} from the persona identifier `);const n=(async(e,t,n=!1)=>{const i={callingIntent:{type:"OneToOneCall",joinOptions:{outgoingVideo:n,outgoingAudio:!0,oneToOne:{sharingSourceId:void 0}},coordinates:{oneToOne:{mri:t}}}},{data:r}=await e.mutate({mutation:o,variables:i});return r?.fireCallingIntent?.id})(t,r,a),l=I(t,r),[d,p]=await Promise.all([n,l]);if(!d)throw new Error(`Could not fetch the user calling IntentId using the mri ${r}`);const g=p?.id;i||e.call.callById(d,{stateTransition:c.Ar.new,visibilityState:c.Rp.show,correlation:{source:u.p.AppProfileCard}},g),s.stop()}catch{const e=`Error while StartCall using the mri ${r}`;n.error(e),s.fail({message:e})}}},379708:(e,t,n)=>{"use strict";var i,r,a;n.d(t,{It:()=>i,xi:()=>r,wk:()=>a}),function(e){e.User="User",e.Group="Group",e.Team="Team",e.MsaUser="MsaUser",e.MsaGroup="MsaGroup",e.Bot="Bot",e.Unknown="Unknown",e.TFLOffNetwork="TFLOffNetwork",e.TFLSMSUnverified="TFLSMSUnverified",e.Initials="Initials",e.MergedGroup="MergedGroup",e.Connector="Connector",e.OutgoingWebhook="OutgoingWebhook",e.VoiceApp="VoiceApp",e.App="App",e.Mail="Mail",e.Pstn="Pstn",e.SharedChannelInviteeTeam="SharedChannelInviteeTeam",e.Communities="Communities",e.Simple="Simple",e.SubCommunity="SubCommunity"}(i||(i={})),function(e){e.Large="HR196x196",e.Medium="HR96x96",e.Small="HR64x64",e.XMedium="HR120x120",e.XSmall="HR32x32"}(r||(r={})),function(e){e.Icon="icon",e.Url="url",e.Name="name",e.Label="label"}(a||(a={}))},232062:(e,t,n)=>{"use strict";n.d(t,{Ch:()=>S,Qc:()=>Y,vG:()=>R,Dm:()=>k,UI:()=>_,eB:()=>P,fr:()=>O,BY:()=>F,Ng:()=>w,WF:()=>V,C0:()=>L,EO:()=>N,L9:()=>z,Iz:()=>b,uC:()=>U,iU:()=>W,oG:()=>D,X3:()=>v,xG:()=>B,oz:()=>Q});var i=n(480354),r=n(754255),a=n(702183),s=n(810886),o=n(73466),l=n(806658),d=n(84646),c=n(800079),u=n(189888),p=n(379708);class g{static getAvatarLoggingAndTelemetryRef(){return{loggingCount:this.loggingCount,lastThrottleTime:this.lastThrottleTime}}static setAvatarLoggingAndTelemetryRef(e){this.loggingCount=e.loggingCount,this.lastThrottleTime=e.lastThrottleTime}}g.loggingCount=0,g.lastThrottleTime=0;var m=n(147546),h=n(925067);const I=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,M=/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,f=/^[\w.-:]+$/,A=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i,T=/^[^\p{Letter}]/u,N=(e,t,n,i,r,a,s,o,d,u)=>{let g=p.It.Unknown;const m=j(d,e,u);return o&&n?g=p.It.SharedChannelInviteeTeam:!i&&n?g=p.It.Team:a?g=p.It.App:s?g=p.It.Mail:r?g=p.It.MergedGroup:m||e&&(0,l.FL)(e)||(0,l.$l)(e)?g=p.It.Initials:E(e)?g=p.It.Connector:e&&(0,l.BG)(e)?g=p.It.OutgoingWebhook:D(e)?g=p.It.VoiceApp:b(e)?g=p.It.Bot:c.af.isTFLOffNetworkUser(e)?g=p.It.TFLOffNetwork:c.af.isTFLSmsUnVerifiedMri(e)?g=p.It.TFLSMSUnverified:e&&(0,l.Ku)(e)?g=p.It.Pstn:i?g=y(g,e,t,n):i||(g=C(g,e,d)),g},y=(e,t,n,i)=>(t?e=p.It.MsaUser:n?e=p.It.MsaGroup:i&&(e=p.It.Communities),e),C=(e,t,n)=>{const i=((0,l.AF)(t)||t&&I.test(t.toLowerCase()))&&!Array.isArray(n),r=!(0,l.AF)(t)&&Array.isArray(n);return i||r?e=t?p.It.User:p.It.Group:e},S=e=>{const t=e?.type?.toUpperCase(),n=e?.id;return t===u.Pk.botType||b(n)},b=e=>!!e&&e.startsWith(d.gN.BotPrefix),D=e=>!!e&&(0,l.oG)(e,d.LE),E=e=>!!e&&e.startsWith(d.Vg),U=(e,t)=>!!e&&(e===t.audienceBotId||e===t.largeGridBotId),w=(e,t,n)=>{if(t)return n?m.G:m.GX;switch(e){case p.It.Mail:return m.m$;case p.It.App:case p.It.Connector:case p.It.Bot:case p.It.OutgoingWebhook:return m.B9;case p.It.User:case p.It.MsaUser:case p.It.Initials:case p.It.Unknown:return m.Rl;case p.It.Group:case p.It.MsaGroup:case p.It.MergedGroup:case p.It.Team:case p.It.Communities:case p.It.SubCommunity:return m.Mz;case p.It.TFLOffNetwork:case p.It.TFLSMSUnverified:return m.hE;case p.It.VoiceApp:return m.S2;case p.It.Pstn:return m.Yt;default:return m.Rl}},v=e=>-1!==e?.indexOf("profilePictureV2ForSharedChannel"),L=(e,t,n,i)=>{if(!e||e&&(0,s.p_)(e))return;return void 0===t||t?n.getPresenceUserId(i):void 0},k=(e,t,n)=>e&&t?.id===e.id&&n===e.id&&"avatar"===e.updateType?e.updatedTime:void 0,x=new Map([["tiny",16],["smallest",20],["smaller",24],["small",28],["medium",32],["medium-large",36],["large",48],["larger",64],["largest",96]]),F=e=>e&&x.get(e)||32,O=e=>"tiny"===e?"smallest":e,P=(e,t,n)=>{if(n&&e)try{const n=new URL(e);if("https:"!==n.protocol)return e;const i=n.searchParams.get("size"),r=t||p.xi.Small;return null!==i&&i!==r?e.replace(`size=${i}`,`size=${r}`):e}catch(t){return e}return e},j=(e,t,n)=>{const i=n?.get(r.w.People).enableInitialsImageForPstn,a=n?.get(r.w.Messaging).enablePaidSmsChat,s=!!e?.isInitialsImage,o=!!i&&!!a&&!!t&&c.af.isValidNameForInitialsAvatarForPstnUser(t,e?.displayName);return s||o};function R(e,t){const n=t?.stringTranslate("peoplePicker","unknown_user")??"Unknown User",i=encodeURIComponent(n);return e.includes(i)}const z=(e,t)=>{if(!e&&t&&1===t.length&&t[0].id){const e=t[0].id;return e!==o.i2&&e!==o.j8?e:void 0}},B=(e,t,n,i)=>{const r=i&&encodeURIComponent(i);return!!e&&!!r&&!!n&&R(n,t)},V=(e,t)=>{const n=!!((e,t)=>{if(!e&&t&&1===t.length&&t[0].id){const e=t[0].id;return e!==o.i2&&e!==o.j8}return!1})(e,t),i=((e,t,n)=>t||(n?e?n[0]:n:[]))(n,e,t),r=((e,t)=>e?h.y9:t?h.Ul:h._Z)(e,n),a=((e,t)=>e&&t?.[0]?.displayName?t[0]?.displayName:void 0)(n,t);return{entity:i,generator:r,displayName:a}},_=(e,t,n)=>t?m.Rl:n?m.Mz:e,W=async(e,t)=>{try{return await fetch(e,{method:"GET",mode:"same-origin",cache:"only-if-cached",credentials:"include",headers:{"x-ms-client-caller":t||"image-cache-check"}}),!0}catch(e){return!1}},Q=e=>e.some((e=>(0,i.isEmpty)(e.displayName)||!(0,l.AF)(e.userId)||(0,l.FL)(e.userId)||(0,l.Ku)(e.userId))),Y=({callerInfo:e,skipGeneratingUrl:t,propsAvatarUrl:n,cachedUrl:i,generatedUrl:r,baseImageUrl:s,isCookieValid:o,profilePictureType:d,isSelfProfileAvatar:c,forSharedChannel:u,isXtapUserUrl:m,logger:h,scenarioFactory:I})=>{const N=Date.now(),{loggingCount:y,lastThrottleTime:C}=g.getAvatarLoggingAndTelemetryRef();if(C>0&&N-C>36e5&&g.setAvatarLoggingAndTelemetryRef({loggingCount:0,lastThrottleTime:0}),y<=4){const S=n||i||r,{isValidDomain:b,isValidPath:D,isValidOid:E,isValidMri:U,isFirstCharSpecial:w,isValidUserInfo:v,isValidTeamId:L,queryParamsLength:k}=((e,t)=>{if(!e)return null;if(e.startsWith("data:image"))return{isValidDomain:!1,isValidPath:"N/A",isValidOid:!1,isValidMri:"N/A",isFirstCharSpecial:"N/A",isValidUserInfo:"N/A",isValidTeamId:"N/A",isDataUriImageApplied:!0,queryParamsLength:0};const n=new URL(e),i=`${n.protocol}//${n.hostname}`,r=M.test(i),a=n.pathname.split("/").filter((e=>""!==e)),s=a.every((e=>f.test(e))),o=a.some((e=>A.test(e))),d=n.searchParams.get("usersInfo"),c=Array.from(n.searchParams.entries()).length;let u="N/A",g="N/A";if(t===p.It.User){const e=n.pathname.split("/"),t=e.indexOf("profilepicturev2");let i=null;-1!==t&&t+1<e.length&&(i=e.slice(t+1).join("/")),u=i&&(0,l.AF)(i)?"VALID":"INVALID";const r=n.searchParams.get("displayName");g=r?T.test(r)?"YES":"NO":"INVALID"}let m=t===p.It.Group?"INVALID":"N/A";if(d&&t===p.It.Group){const e=decodeURIComponent(d),t=JSON.parse(e);m=Q(t)?"VALID":"INVALID"}let h="N/A";if(t===p.It.Team){const e=a.indexOf("teams");h=-1!==e&&void 0!==a[e+1]&&A.test(a[e+1])?"VALID":"INVALID"}return{isValidDomain:r,isValidPath:s,isValidOid:o,isValidMri:u,isFirstCharSpecial:g,isValidUserInfo:m,isValidTeamId:h,isDataUriImageApplied:!1,queryParamsLength:c}})(S,d)||{},x=`Avatar load failed :: BaseImageUrl: ${s} - CallerInfo: ${e} - IsCookieValid: ${o} - IsFirstCharSpecial: ${w} - IsSharedChannel: ${u} - IsValidDomain: ${b} - IsValidMri: ${U} - IsValidOid: ${E} - IsValidPath: ${D} - IsValidTeamId: ${L} - IsValidUserInfo: ${v} - IsXtapUserUrl: ${m} - ProfilePictureType: ${d} - QueryParamsLength: ${k} - SkipGeneratingUrl: ${t}`;h.error(x);const F={callerInfo:e,profilePictureType:d,isSelfProfileAvatar:!!c,errorMessage:x};I.newScenario(a.Cu.AvatarStatus).stop(F,"failure");const O=y+1;4===O?g.setAvatarLoggingAndTelemetryRef({loggingCount:4,lastThrottleTime:N}):g.setAvatarLoggingAndTelemetryRef({loggingCount:O,lastThrottleTime:C})}}},147546:(e,t,n)=>{"use strict";n.d(t,{Rl:()=>i,Mz:()=>r,$M:()=>a,Yt:()=>s,S2:()=>o,m$:()=>l,GX:()=>d,G:()=>c,hE:()=>u,B9:()=>p,Vd:()=>g,T:()=>m,$Z:()=>h,J:()=>I});const i="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSI+PC9yZWN0PjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi40NzQ3IDguMDE0MzFDMTIuOTg3NiA4LjAxNDMxIDEzLjQxMDIgOC40MDAzNSAxMy40NjggOC44OTc2OUwxMy40NzQ3IDkuMDE0MzFWMTMuMzgxN0MxMy40NzQ3IDE1LjMwNiAxMS45MTQ4IDE2Ljg2NiA5Ljk5MDQ0IDE2Ljg2NkM4LjEzMDI3IDE2Ljg2NiA2LjYxMDU2IDE1LjQwODMgNi41MTEzMSAxMy41NzI4TDYuNTA2MTYgMTMuMzgxN1Y5LjAxNDMxQzYuNTA2MTYgOC41MDE0OCA2Ljg5MjIgOC4wNzg4IDcuMzg5NTQgOC4wMjEwNEw3LjUwNjE2IDguMDE0MzFIMTIuNDc0N1pNMTIuNDc0NyA5LjAxNDMxSDcuNTA2MTZWMTMuMzgxN0M3LjUwNjE2IDE0Ljc1MzcgOC42MTg0MSAxNS44NjYgOS45OTA0NCAxNS44NjZDMTEuMzA3NiAxNS44NjYgMTIuMzg1MyAxNC44NDA5IDEyLjQ2OTQgMTMuNTQ1TDEyLjQ3NDcgMTMuMzgxN1Y5LjAxNDMxWk01Ljc3NDA3IDguMDEzNzJDNS42MzIwOCA4LjI1ODk3IDUuNTQwNjkgOC41MzcxOCA1LjUxNDE3IDguODM0MDZMNS41MDYxNiA5LjAxNDMxSDMuMDE2ODVWMTIuNzUzNEMzLjAxNjg1IDEzLjc3ODYgMy44NDc5MyAxNC42MDk3IDQuODczMTIgMTQuNjA5N0M1LjE0NDMzIDE0LjYwOTcgNS40MDE5NiAxNC41NTE1IDUuNjM0MjEgMTQuNDQ3QzUuNzEzNDcgMTQuNzc1NiA1LjgzMDA1IDE1LjA5MDcgNS45Nzg1IDE1LjM4NzFDNS42Mzg4NyAxNS41MzA3IDUuMjY1MjIgMTUuNjA5NyA0Ljg3MzEyIDE1LjYwOTdDMy4zNTE5OCAxNS42MDk3IDIuMTA4NTcgMTQuNDIwNiAyLjAyMTY5IDEyLjkyMTJMMi4wMTY4NSAxMi43NTM0VjkuMDE0MzFDMi4wMTY4NSA4LjUwMTQ4IDIuNDAyODkgOC4wNzg4IDIuOTAwMjIgOC4wMjEwNEwzLjAxNjg1IDguMDE0MzFMNS43NzQwNyA4LjAxMzcyWk0xNC4yMDY4IDguMDEzNzJMMTYuOTkxMiA4LjAxNDMxQzE3LjUwNCA4LjAxNDMxIDE3LjkyNjcgOC40MDAzNSAxNy45ODQ0IDguODk3NjlMMTcuOTkxMiA5LjAxNDMxVjEyLjc1NDJDMTcuOTkxMiAxNC4zMzEyIDE2LjcxMjcgMTUuNjA5NyAxNS4xMzU3IDE1LjYwOTdDMTQuNzM0OCAxNS42MDk3IDE0LjM1MzIgMTUuNTI3MSAxNC4wMDY5IDE1LjM3NzlDMTQuMTU1MSAxNS4wODAzIDE0LjI3MDkgMTQuNzY0OCAxNC4zNTAzIDE0LjQzNTFDMTQuNTg4NyAxNC41NDczIDE0Ljg1NDkgMTQuNjA5NyAxNS4xMzU3IDE0LjYwOTdDMTYuMTExNiAxNC42MDk3IDE2LjkxMTYgMTMuODU2MiAxNi45ODU2IDEyLjg5OTJMMTYuOTkxMiAxMi43NTQyVjkuMDE0MzFIMTQuNDc0N0wxNC40NjkyIDguODY1MDVDMTQuNDQ2NSA4LjU1NjU0IDE0LjM1MzcgOC4yNjc0OSAxNC4yMDY4IDguMDEzNzJaTTkuOTg4NTcgMi45ODkyNkMxMS4yMTg3IDIuOTg5MjYgMTIuMjE1OSAzLjk4NjQ4IDEyLjIxNTkgNS4yMTY2MkMxMi4yMTU5IDYuNDQ2NzYgMTEuMjE4NyA3LjQ0Mzk4IDkuOTg4NTcgNy40NDM5OEM4Ljc1ODQzIDcuNDQzOTggNy43NjEyMSA2LjQ0Njc2IDcuNzYxMjEgNS4yMTY2MkM3Ljc2MTIxIDMuOTg2NDggOC43NTg0MyAyLjk4OTI2IDkuOTg4NTcgMi45ODkyNlpNMTQuOTc1NyAzLjYxNzM5QzE2LjAzMjQgMy42MTczOSAxNi44ODkgNC40NzQgMTYuODg5IDUuNTMwNjlDMTYuODg5IDYuNTg3MzcgMTYuMDMyNCA3LjQ0Mzk4IDE0Ljk3NTcgNy40NDM5OEMxMy45MTkxIDcuNDQzOTggMTMuMDYyNCA2LjU4NzM3IDEzLjA2MjQgNS41MzA2OUMxMy4wNjI0IDQuNDc0IDEzLjkxOTEgMy42MTczOSAxNC45NzU3IDMuNjE3MzlaTTUuMDE3MTcgMy42MTczOUM2LjA3Mzg2IDMuNjE3MzkgNi45MzA0NyA0LjQ3NCA2LjkzMDQ3IDUuNTMwNjlDNi45MzA0NyA2LjU4NzM3IDYuMDczODYgNy40NDM5OCA1LjAxNzE3IDcuNDQzOThDMy45NjA0OSA3LjQ0Mzk4IDMuMTAzODggNi41ODczNyAzLjEwMzg4IDUuNTMwNjlDMy4xMDM4OCA0LjQ3NCAzLjk2MDQ5IDMuNjE3MzkgNS4wMTcxNyAzLjYxNzM5Wk05Ljk4ODU3IDMuOTg5MjZDOS4zMTA3MiAzLjk4OTI2IDguNzYxMjEgNC41Mzg3NyA4Ljc2MTIxIDUuMjE2NjJDOC43NjEyMSA1Ljg5NDQ3IDkuMzEwNzIgNi40NDM5OCA5Ljk4ODU3IDYuNDQzOThDMTAuNjY2NCA2LjQ0Mzk4IDExLjIxNTkgNS44OTQ0NyAxMS4yMTU5IDUuMjE2NjJDMTEuMjE1OSA0LjUzODc3IDEwLjY2NjQgMy45ODkyNiA5Ljk4ODU3IDMuOTg5MjZaTTE0Ljk3NTcgNC42MTczOUMxNC40NzEzIDQuNjE3MzkgMTQuMDYyNCA1LjAyNjI5IDE0LjA2MjQgNS41MzA2OUMxNC4wNjI0IDYuMDM1MDkgMTQuNDcxMyA2LjQ0Mzk4IDE0Ljk3NTcgNi40NDM5OEMxNS40ODAxIDYuNDQzOTggMTUuODg5IDYuMDM1MDkgMTUuODg5IDUuNTMwNjlDMTUuODg5IDUuMDI2MjkgMTUuNDgwMSA0LjYxNzM5IDE0Ljk3NTcgNC42MTczOVpNNS4wMTcxNyA0LjYxNzM5QzQuNTEyNzcgNC42MTczOSA0LjEwMzg4IDUuMDI2MjkgNC4xMDM4OCA1LjUzMDY5QzQuMTAzODggNi4wMzUwOSA0LjUxMjc3IDYuNDQzOTggNS4wMTcxNyA2LjQ0Mzk4QzUuNTIxNTcgNi40NDM5OCA1LjkzMDQ3IDYuMDM1MDkgNS45MzA0NyA1LjUzMDY5QzUuOTMwNDcgNS4wMjYyOSA1LjUyMTU3IDQuNjE3MzkgNS4wMTcxNyA0LjYxNzM5WiIvPjwvc3ZnPg==",a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0U4RUJGQSIgZD0iTTAgMzJWMGgzMnYzMkgwWiIvPjxwYXRoIGZpbGw9IiM0RjUyQjIiIGQ9Ik0xNS41IDEyLjUwMmEuNS41IDAgMSAxIDEgMHYxLjAwMmEuNS41IDAgMCAxLTEgMHYtMS4wMDJabTMuMzUuOTQxYS41LjUgMCAwIDAtLjcwNyAwbC0uNzA4LjcwOWEuNS41IDAgMCAwIC43MDcuNzA3bC43MDktLjcwOWEuNS41IDAgMCAwIDAtLjcwN1ptLTQuOTk4IDBhLjUuNSAwIDAgMC0uNzA3LjcwN2wuNzA4LjcwOWEuNS41IDAgMSAwIC43MDctLjcwN2wtLjcwOC0uNzA5Wk0xNiA4YzMuMzE0IDAgNiAyLjU5NyA2IDUuOCAwIDEuNjc3LS43NDUgMy4yMTYtMi4yMDQgNC41OTRhLjU5OS41OTkgMCAwIDAtLjE0NS4yMTNsLS4wMjYuMDgxLS45MzYgMy45MTdjLS4xODQuNzcxLS44NjUgMS4zMy0xLjY3IDEuMzlsLS4xNDQuMDA1aC0xLjc1Yy0uODE5IDAtMS41MzUtLjUxNi0xLjc3Ni0xLjI2MmwtLjAzOC0uMTMzLS45MzUtMy45MTZhLjU5Ni41OTYgMCAwIDAtLjE3LS4yOTVjLTEuMzktMS4zMTItMi4xMzMtMi43Ny0yLjItNC4zNTVMMTAgMTMuOGwuMDAzLS4xOTFDMTAuMTA4IDEwLjQ5NCAxMi43NTMgOCAxNiA4Wm0tMi4wNDUgMTMgLjMxOSAxLjMzNC4wMjYuMDk2Yy4wOTcuMy4zNzYuNTIyLjcxMi41NjNsLjExNC4wMDdoMS43MTJsLjEwNi0uMDAzYS44NTYuODU2IDAgMCAwIC43NDEtLjUyNWwuMDMyLS4xLjMyOC0xLjM3MmgtNC4wOVpNMTYgOWMtMi42MzIgMC00Ljc4OCAxLjk1My00Ljk4NSA0LjQxNGwtLjAxMi4yMTItLjAwMy4xNTMuMDA0LjIxN2MuMDU2IDEuMzA0LjY3NCAyLjUyNSAxLjg4OCAzLjY3MS4xODguMTc4LjMzLjM5OC40MTQuNjRsLjA0My4xNS4zNjcgMS41NDNIMTUuNXYtNC41MDNhLjUuNSAwIDEgMSAxIDBWMjBoMS43ODVsLjM4Ny0xLjYxNS4wNTEtLjE1Yy4wODYtLjIxNS4yMTgtLjQwOS4zODYtLjU2OEMyMC4zODIgMTYuNDY1IDIxIDE1LjE4IDIxIDEzLjhjMC0yLjY0My0yLjIzMS00LjgtNS00LjhaIi8+PC9zdmc+",s="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9Im1lZGl1bXR1cnF1b2lzZSIgeD0iLTYiIHk9Ii02IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTAgMkM3Ljc5MDg2IDIgNiAzLjc5MDg2IDYgNkM2IDguMjA5MTQgNy43OTA4NiAxMCAxMCAxMEMxMi4yMDkxIDEwIDE0IDguMjA5MTQgMTQgNkMxNCAzLjc5MDg2IDEyLjIwOTEgMiAxMCAyWk03IDZDNyA0LjM0MzE1IDguMzQzMTUgMyAxMCAzQzExLjY1NjkgMyAxMyA0LjM0MzE1IDEzIDZDMTMgNy42NTY4NSAxMS42NTY5IDkgMTAgOUM4LjM0MzE1IDkgNyA3LjY1Njg1IDcgNlpNNS4wMDg3MyAxMUMzLjkwMzE1IDExIDMgMTEuODg2OSAzIDEzQzMgMTQuNjkxMiAzLjgzMjgxIDE1Ljk2NjMgNS4xMzQ5OSAxNi43OTY2QzYuNDE2OTcgMTcuNjE0IDguMTQ1MjYgMTggMTAgMThDMTEuODU0NyAxOCAxMy41ODMgMTcuNjE0IDE0Ljg2NSAxNi43OTY2QzE2LjE2NzIgMTUuOTY2MyAxNyAxNC42OTEyIDE3IDEzQzE3IDExLjg5NTYgMTYuMTA0NSAxMSAxNSAxMUw1LjAwODczIDExWk00IDEzQzQgMTIuNDQ2NyA0LjQ0Nzg2IDEyIDUuMDA4NzMgMTJMMTUgMTJDMTUuNTUyMiAxMiAxNiAxMi40NDc4IDE2IDEzQzE2IDE0LjMwODggMTUuMzc3NyAxNS4yODM3IDE0LjMyNzQgMTUuOTUzNEMxMy4yNTY4IDE2LjYzNiAxMS43MzUxIDE3IDEwIDE3QzguMjY0ODkgMTcgNi43NDMxOCAxNi42MzYgNS42NzI2MiAxNS45NTM0QzQuNjIyMjYgMTUuMjgzNyA0IDE0LjMwODggNCAxM1oiLz48L3N2Zz4=",o="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAACxKAAAsSgF3enRNAAAEuElEQVR42u2cwUsjVxzHv9tVKZs9uJTEg5cY0JaNI97W4DFpb41eWjbrYVkQ/4bSRSjI9r50T9arG+iyVNNrAr1I0ps467JViLmkkJHSHHakNND2sEzIrskaWzVvZj6fk5igM/M+83vv++a9ufbF3R//EYSWD7gECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAg2bIpIPJpOPKpONKTIwG8mJXj5oqlmoqlmrGHNM1E14WHYkMa/XhfGAbvpsIa4925LotugBJoWp8SUpMjGr14TxjAK/sh6nxOyXIpOMIkLozHtoBGAJI2szvy7aPQ9f4tn2s9e93GQR6WFZUK8uzGotFAt3wDcfV0/xLlSt1UkA3FrKTWsxOKRIZDlzjb+b3VSzVjBj9GyuAFwuXckkj+sgLK/cbu2o4rnHHNnABLCvacwxgWVEt5ZK+TQlnlfv3nftVcT05ffebQR7Ak8ef6datD/Xq19/Vav391meOc6JiqaY/mn/qk48/0sjIdV+V+/WNXVWPml0r3IP7M3pwf0bPnr8a6HEaMRWcSceVmhvXVuFA24XDU58XSzWVK3UtZqe0kJ30dbk3bYxjzLOAzn5/fWP3VGl03VZ7ELWyPCvLivqu3JuYcoZMu4PGYhGtfj3f805qOK7Wvt1Ram5c93K3B35BXbfVs3J552OisMYK0HnHfPf4057RqVypq1ypD7Sklit1Pc2/7FruI5FhZdJxLeWSRndZQzKcpVxSi9mptgjvsl04VKXymxayk1cWG6tHzffOYHoN74e5DOMF8O6mleVZpe6Ma+ung1MXvuG4Wt/YVfmX+qXGxrPKvWVFtfj5lLHl3rcCdF5gy4qqWKppM79/qluw7WN9Zf98Kd1Cr//57gDWbwzJh5wVG7cLhyqWahcSG237WJv5/a553sRYFwoBzhMby5U33cJ5y7JfY11oBOg3NlaPmueKjf3Eunu520rNBWMdw5ACQj+xcc92lEnHe5bs7cKhtgoHPft5P8S60ArQT2x03VY7NnbexcVSTduFw57Tt5l0XAvZyUCuVRj408Af8ouX9rdt+7hrbOws515/343ExOh/Gj+chy9zW1SAQcXGXg0ftPUIoRWg39gYpFiHAH3ERm+eoBNTHi4hwBXExpXlWS3lkqpW30zuJBKjobnjQy9AZ0Xw05z9ZcHuYAQABAAEGBQmrpUP07kPXIAw7gs06dyN2Bxq0lapq8J7XB16AVy3pbVHO6HqChqOa8wbQozZG+g9bg3yNKy31sCkDaJGbg713hqSmhv3vQyu21K5Um+/IMo0jBSgk8TEaHuqdmY6ptjYDWPn6xuOK6dxor0Xjly3pWq12XMtIQJcgBiRm8O6GRlRLHaj/fuZ6dhb3/s/wngN2sneC6f9s+Oc6LX7l9zXLeMbOnACQEBSACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAPwL3XwvzOsJdhMAAAAASUVORK5CYII=",d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB2aWV3Qm94PSIwIDAgMzA2IDMwNiIgeD0iMHB4IiB5PSIwcHgiIHhtbG5zOnhtbD0iaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOnJnYigyMTksIDQxLCA1Myk7fQogICAgLnN0MXtlbmFibGUtYmFja2dyb3VuZDpuZXc7fQogICAgLnN0MntmaWxsOnJnYigyNTUsIDI1NSwgMjU1KTt9CiAgPC9zdHlsZT4KICA8Zz4KICA8Zz4KICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0gMTUzIDAgTCAxNTMgMCBjIDg0LjUgMCAxNTMgNjguNSAxNTMgMTUzIGwgMCAwIGMgMCA4NC41IC02OC41IDE1MyAtMTUzIDE1MyBsIDAgMCBDIDY4LjUgMzA2IDAgMjM3LjUgMCAxNTMgbCAwIDAgQyAwIDY4LjUgNjguNSAwIDE1MyAwIFoiLz4KICAgIDxnIGNsYXNzPSJzdDEiPgogICAgPHBhdGggY2xhc3M9InN0MiIgZD0iTSAxNTQuOCA4My42IGMgMi42IDAgNS4xIDAuNyA3LjUgMi4xIGMgMi4zIDEuNCA0LjEgMy4zIDUuNCA1LjYgbCA1MS45IDk2LjQgYyAxLjIgMi4yIDEuOCA0LjUgMS44IDYuOSBjIDAgMiAtMC40IDMuOSAtMS4yIDUuNiBjIC0wLjggMS44IC0xLjggMy4zIC0zLjIgNC42IGMgLTEuMyAxLjMgLTIuOSAyLjQgLTQuNiAzLjIgYyAtMS44IDAuOCAtMy43IDEuMiAtNS42IDEuMiBIIDEwMi44IGMgLTIgMCAtMy44IC0wLjQgLTUuNiAtMS4yIGMgLTEuOCAtMC44IC0zLjMgLTEuOSAtNC42IC0zLjIgYyAtMS4zIC0xLjMgLTIuNCAtMi45IC0zLjIgLTQuNiBjIC0wLjggLTEuOCAtMS4yIC0zLjYgLTEuMiAtNS42IGMgMCAtMi40IDAuNiAtNC43IDEuOCAtNi45IGwgNTEuOSAtOTYuNCBjIDEuMyAtMi4zIDMuMSAtNC4yIDUuNCAtNS42IEMgMTQ5LjcgODQuMyAxNTIuMiA4My42IDE1NC44IDgzLjYgWiBNIDE1NC44IDkzLjMgYyAtMSAwIC0xLjkgMC4zIC0yLjYgMC44IGMgLTAuNyAwLjYgLTEuNCAxLjIgLTEuOSAyLjEgYyAtMC42IDAuOCAtMSAxLjcgLTEuNCAyLjYgYyAtMC40IDAuOSAtMC44IDEuOCAtMS4yIDIuNSBjIC0wLjggMS41IC0yIDMuOSAtMy44IDcuMiBjIC0xLjggMy40IC0zLjkgNy4zIC02LjQgMTEuNyBjIC0yLjUgNC41IC01LjIgOS4zIC04LjEgMTQuNiBjIC0yLjkgNS4zIC01LjggMTAuNiAtOC43IDE1LjkgcyAtNS43IDEwLjUgLTguNCAxNS41IGMgLTIuNyA1IC01LjEgOS41IC03LjIgMTMuNiBjIC0yLjEgNCAtMy44IDcuMyAtNSA5LjkgYyAtMS4yIDIuNiAtMS45IDQuMiAtMS45IDQuOCBjIDAgMS4zIDAuNSAyLjUgMS40IDMuNCBjIDEgMSAyLjEgMS40IDMuNCAxLjQgaCAxMDMuOSBjIDEuMyAwIDIuNSAtMC41IDMuNCAtMS40IGMgMSAtMSAxLjQgLTIuMSAxLjQgLTMuNCBjIC0xLjUgLTMuNyAtMy4xIC03LjIgLTUgLTEwLjYgYyAtMS45IC0zLjQgLTMuNyAtNi45IC01LjUgLTEwLjQgYyAtMi40IC00LjUgLTQuNyAtOSAtNyAtMTMuNCBjIC0yLjMgLTQuNSAtNC43IC05IC03IC0xMy40IGMgLTIuNCAtNC42IC00LjkgLTkuMiAtNy4zIC0xMy43IGMgLTIuNCAtNC41IC00LjkgLTkuMSAtNy4zIC0xMy43IGMgLTEuOCAtMy4yIC0zLjUgLTYuNSAtNS4zIC05LjcgYyAtMS44IC0zLjIgLTMuNiAtNi40IC01LjQgLTkuNiBjIC0wLjQgLTAuNyAtMC44IC0xLjQgLTEuMiAtMi4xIGMgLTAuNCAtMC43IC0wLjkgLTEuMyAtMS40IC0xLjkgYyAtMC42IC0wLjcgLTEuMiAtMS4zIC0xLjggLTEuOCBDIDE1Ni42IDkzLjYgMTU1LjggOTMuMyAxNTQuOCA5My4zIFogTSAxNTQuOCAxNzcuNiBjIDEgMCAxLjkgMC4yIDIuNyAwLjYgYyAwLjkgMC40IDEuNiAxIDIuMyAxLjYgcyAxLjIgMS41IDEuNiAyLjMgYyAwLjQgMC45IDAuNiAxLjggMC42IDIuNyBjIDAgMSAtMC4yIDEuOSAtMC42IDIuNyBjIC0wLjQgMC45IC0xIDEuNiAtMS42IDIuMyBzIC0xLjUgMS4yIC0yLjMgMS42IGMgLTAuOSAwLjQgLTEuOCAwLjYgLTIuNyAwLjYgYyAtMSAwIC0xLjkgLTAuMiAtMi43IC0wLjYgYyAtMC45IC0wLjQgLTEuNiAtMSAtMi4zIC0xLjYgcyAtMS4yIC0xLjUgLTEuNiAtMi4zIGMgLTAuNCAtMC45IC0wLjYgLTEuOCAtMC42IC0yLjcgYyAwIC0xIDAuMiAtMS45IDAuNiAtMi43IGMgMC40IC0wLjkgMSAtMS42IDEuNiAtMi4zIHMgMS41IC0xLjIgMi4zIC0xLjYgQyAxNTIuOSAxNzcuOCAxNTMuOCAxNzcuNiAxNTQuOCAxNzcuNiBaIE0gMTU5LjcgMTcwLjIgaCAtOS44IHYgLTQ4LjggaCA5LjggViAxNzAuMiBaIi8+CiAgICA8L2c+CiAgPC9nPgogIDwvZz4KPC9zdmc+",c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8Y2lyY2xlIGN4PSI3MiIgY3k9IjcyIiByPSI3MiIgZmlsbD0idXJsKCNwYXR0ZXJuMCkiLz4KPGNpcmNsZSBjeD0iNzIiIGN5PSI3MiIgcj0iNzIiIGZpbGw9IiNEMTM0MzgiLz4KPHBhdGggZD0iTTQ1LjEyMTQgODdDMzkuMTIyIDg3IDM1IDgzLjI5ODcgMzUgNzguMzc3M0g0MC42NzI5QzQwLjcxMzcgODAuMzcwMyA0Mi42NzI3IDgyLjAzNzkgNDUuMjg0NyA4Mi4wMzc5QzQ3LjgxNSA4Mi4wMzc5IDQ5LjQ4ODMgODAuNjU1IDQ5LjQ4ODMgNzguNjYyQzQ5LjQ4ODMgNzcuMTE2NCA0OC4zNDU2IDc2LjAxODIgNDUuOTM3NyA3NS4yODYxTDQyLjUwOTQgNzQuMzFDMzYuMzQ2OCA3Mi42ODMgMzUuMjQ0OSA2OC45ODE4IDM1LjI0NDkgNjYuNDZDMzUuMjQ0OSA2MS40NTcyIDM5LjU3MSA1OCA0NC45NTgyIDU4QzUwLjI2MzggNTggNTQuMzQ1IDYxLjIxMzIgNTQuMzQ1IDY2LjU0MTRINDguNjcyMUM0OC42NzIxIDY0LjU0ODQgNDcuMjg0NSA2My4wMDI4IDQ0LjgzNTcgNjMuMDAyOEM0Mi42MzE5IDYzLjAwMjggNDAuOTU4NiA2NC40NjcgNDAuOTU4NiA2Ni4zMzhDNDAuOTU4NiA2Ny4wMjk1IDQxLjE2MjYgNjguNDUzIDQ0LjEwMTEgNjkuMzA3Mkw0Ny4yNDM3IDcwLjIwMkM1MS40ODgxIDcxLjQ2MjggNTUuMjAyMSA3My42MTg1IDU1LjIwMjEgNzguMzc3M0M1NS4yMDIxIDgzLjk0OTUgNTAuNDI3IDg3IDQ1LjEyMTQgODdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzIuOTE1OCA4N0M2NC45MTY2IDg3IDU4LjYzMTYgODAuNDUxNiA1OC42MzE2IDcyLjUyMDNDNTguNjMxNiA2NC41NDg0IDY0LjkxNjYgNTggNzIuOTE1OCA1OEM4MC44NzQyIDU4IDg3LjI0MDkgNjQuNTQ4NCA4Ny4yNDA5IDcyLjUyMDNDODcuMjQwOSA4MC40NTE2IDgwLjg3NDIgODcgNzIuOTE1OCA4N1pNNzIuOTE1OCA4MS42NzE4Qzc3LjkzNTcgODEuNjcxOCA4MS41MjcyIDc3LjU2MzggODEuNTI3MiA3Mi41MjAzQzgxLjUyNzIgNjcuNDc2OSA3Ny45MzU3IDYzLjMyODIgNzIuOTE1OCA2My4zMjgyQzY3Ljg1NTEgNjMuMzI4MiA2NC4zMDQ0IDY3LjQ3NjkgNjQuMzA0NCA3Mi41MjAzQzY0LjMwNDQgNzcuNTYzOCA2Ny44NTUxIDgxLjY3MTggNzIuOTE1OCA4MS42NzE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwMC45MTkgODdDOTQuOTIgODcgOTAuNzk4IDgzLjI5ODcgOTAuNzk4IDc4LjM3NzNIOTYuNDcwOUM5Ni41MTE3IDgwLjM3MDMgOTguNDcwNyA4Mi4wMzc5IDEwMS4wODMgODIuMDM3OUMxMDMuNjEzIDgyLjAzNzkgMTA1LjI4NiA4MC42NTUgMTA1LjI4NiA3OC42NjJDMTA1LjI4NiA3Ny4xMTY0IDEwNC4xNDQgNzYuMDE4MiAxMDEuNzM2IDc1LjI4NjFMOTguMzA3NCA3NC4zMUM5Mi4xNDQ4IDcyLjY4MyA5MS4wNDI4IDY4Ljk4MTggOTEuMDQyOCA2Ni40NkM5MS4wNDI4IDYxLjQ1NzIgOTUuMzY4OSA1OCAxMDAuNzU2IDU4QzEwNi4wNjIgNTggMTEwLjE0MyA2MS4yMTMyIDExMC4xNDMgNjYuNTQxNEgxMDQuNDdDMTA0LjQ3IDY0LjU0ODQgMTAzLjA4MiA2My4wMDI4IDEwMC42MzQgNjMuMDAyOEM5OC40Mjk4IDYzLjAwMjggOTYuNzU2NSA2NC40NjcgOTYuNzU2NSA2Ni4zMzhDOTYuNzU2NSA2Ny4wMjk1IDk2Ljk2MDYgNjguNDUzIDk5Ljg5OTEgNjkuMzA3MkwxMDMuMDQyIDcwLjIwMkMxMDcuMjg2IDcxLjQ2MjggMTExIDczLjYxODUgMTExIDc4LjM3NzNDMTExIDgzLjk0OTUgMTA2LjIyNSA4NyAxMDAuOTE5IDg3WiIgZmlsbD0id2hpdGUiLz4KPGRlZnM+CjxwYXR0ZXJuIGlkPSJwYXR0ZXJuMCIgcGF0dGVybkNvbnRlbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNpbWFnZTBfODA2N18yMjc5NzkiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMDI1KSIvPgo8L3BhdHRlcm4+CjxpbWFnZSBpZD0iaW1hZ2UwXzgwNjdfMjI3OTc5IiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFaQUFBQUdRQ0FZQUFBQ0F2emJNQUFBQldHbERRMUJKUTBNZ1VISnZabWxzWlFBQUtKRnRrRUZMQWxFVWhjK1laYVJSUkxzYUdGcEV4Q1JsQnUzQ0RDeHlNVTBHRmtHTm8ya3dUcS9uUkFqOWlQYlJyaDhSMHFKZEJPNkNJbWlieXphQkJDWFRmVTZsVmc4dTUrTnczdVZ5QUYrdndaamxCMUMwSGE0bkZwWDA1cFlTcUNFSUdRUHdZY3d3U3l5bWFVbUs0RnM3WC8wZWt0QzdLYkZyNTdsblpsSk5MTnltNWF0YTlXWGtiNzdqOVdWekpaUDBneVpzTXU0QWtrcXNIVHRNOEFueE1LZWppRThGNXoyK0VKengrTEtaU2VseDRpcnhvRmt3c3NSUHhHcW16YyszY2RFNk1yOXVFTmVIY3ZiR091a1F6U2lTU0VEQk1wYWdrMGF4U3YzOG40ODI4M0VjZ0tFTWpuM2tVWUJEdjJMa01GaklFYS9BaG9rd1ZPSUlwbWtpb3VmZi9iVzg4Z013djBhdzNmSlNqMEJGQTRKbkxXOWlIT2pmQlc3bW1NR05uMWFsdXIrME54dnhPTVNCN2pmWGZaV0JRQVZvY05kOVAzZmRCblhZUlR1dkR6OEIwTzloQ0xDY1g0UUFBQUE0WlZoSlprMU5BQ29BQUFBSUFBR0hhUUFFQUFBQUFRQUFBQm9BQUFBQUFBS2dBZ0FFQUFBQUFRQUFBWkNnQXdBRUFBQUFBUUFBQVpBQUFBQUFPUGxOOWdBQVB4MUpSRUZVZUFIdG5WdVFGY2VaNTdPcVc3dGN0SFNmdG9VdE5ERTYzWUIyck81WkkyNStHR1Exc3VCQkY0UTlJZkNUUUx6SURpbFdXRHUyTi9aQmdOL0dudFVsd2hySjh5QkEreUpRaEhXeDVJaXhKdFF0SVQ4c1lJSFgzZkpZWExxSk1DZ0VOdFhJeldWWG5GUDdmVVZYYy9yMHVWUmxaVlZsWmY0ekFrNmRPcFczWCtZNS8vN3l5NHNqRUVEQUlBSmpudGROMWVtK0trVFpwMzljTlg1MVhMZmJkWnl1OEgzdzZ2dGxmZzJETS9WOCtMN1pLNlUzSG41R2NTYUU0MHhNdlovZzkxWGZ2K0JYcTN3OVRzOU91UFNQWDIrZzk3MmxVdmhzbUFSZVFhQ3dCS2lQSTRCQWNRaVFRSlQvbnhETHFPTjJzekIwZEhUY3lxOCtpUUhmbzVyd1A5M0RVUllkRnBoS3BYS0tYL2xmNXpXQkdkZTk4Q2dmQ0lRRXFOOGlnSUJlQk5pSytKeEVnVXExVExqdU1zZHhiaVdCWU5IZ2V6WUVGcGh4cXZNcHNtU0cyWUloY1RrSzY4V0dwaTlXSFNFZ3hXb3Y0MG9iV2hTZHJudHIxWEVHTFJPS3VPMFpDRXUxVXZrdGljb3dSQ1V1UGp5dm1nQUVSRFZScE5lVUFGc1c1SnRZNXJydVZ5RVdUVEhGK29DK3dPTys0eHgxZlgrNFdxMytGcUlTQ3g4ZVRrZ0FBcElRSUtJM0o4Q0NRZjZLUVhKZ0QxSkh1NHVlWE5iOGFYeWlrTUJSOGd1OXg4TmYvNEVzRlF4OUtTU0xwR1lRZ0lETXdJRTNTUWhBTUpMUVN6VXVCQ1ZWdlBZbURnR3h0KzJWMVB5WTV3Mkt6czY3aE84UEJ2K1VwSXBFVWlYZ09NTTA1UFY2cFZwOTc3WlM2V2lxZVNGeG93bEFRSXh1WHZXVkMvMFl2dXR1cE02emhYSW93clJaOVNBTVNaSGFjSnhtZkEzVGRPSTMvbk9wOUxvaDFVSTFNaUlBQWNrSWRKR3pZZEdnYWJVYm5ZNk9MV1Jsc0I4RG9sSGtCbTFWZHNkNW5YNFVYdThnUVlIdnBCVW9mTVlFSUNEb0J3MEoxSW5HWU1PSGNOTnNBbVNaMEEvRUhvaUoyYzJjcEhZUWtDVDBESXNiRGsrSmpvNGRzRFFNYTl5azFTSExoTmFmN01Vd1YxS1Fac1dIZ0pqVm5sSzFZVWM0ZkJwUzZLeUxSRDhZZ2MvRUp6RlpXaW9OV3djQUZaNUJBQUl5QTRjOWJ3SnJvN1B6Q1ZHdGJxUmFzMThEQVFSaUVhRFY4R08waUhFWERYRzlSLzZTOFZpUjhiQVJCQ0FnUmpSajlFb0UwMjZ2RFZFTlJvK0ZKMEdnTlFIYXIyd1BySkxXakV6OEZBSmlZcXZXMVltdGphcnJicWtLc1pVK2dyVlJ4d2R2MVJHQVZhS09aUkZTZ29BVW9aVWt5MGpDVWY3Y2RiZFRJMk85aGlSRFJKTW1NRUZXQ1U4SDNvWGhMV21HMmtlRWdHamZSUEVMaUdHcStNd1FJejBDR041S2oyM2VLVU5BOG00QmhmbERPQlRDUkZKcEVEaENZdkxja2dVTDlxYVJPTkxNbmdBRUpIdm15blA4MlBPMjBoYnBPMmdIMXJMeXhKRWdDQ2dtRVBwSklDU0t3ZWFRSEFRa0IraXFzb1J3cUNLSmRQSWdBQ0hKZzdyYVBDRWdhbmxta2hxRUl4UE15Q1FqQWhDU2pFQ25rQTBFSkFXb2FTVUo0VWlMTE5MVmdRQ0VSSWRXaUZjR0NFZzhYcms4SFRqSFhmY1p5aHhyT0hKcEFXU2FKUUVJU1phMGsrVUZBVW5HTDlYWW1GV1ZLbDRrcmorQkkzUXM3elljZXFWdlEwRkFOR3diWGdCWTZlaDR4dmQ5M3FjS0FRU3NKc0RyU0xBZ1VjOHVBQUhScUYxcU5qamNUc1hxMXFob0tBb0k1RTNBRjY2N2EvTHExZWZ1S0pVbThpNE04cjlHQUFLaVNVOWdCN2x6emM4QjRkQ2tUVkFNL1FqQVA2SlhtMEJBY200UEVvNWxkRlRzTTNTQTAyRE9SVUgySUZBa0FrYzZxOVZ2WVordGZKc01BcElULzZuaHFoMTBIZ2NQVnlHQUFBaklFSENjWnlZcmxSOWhXRXNHWHZJNEVKRGtER09ud0xPcmFMaHFON1llaVkwT0VVQmdGZ0VNYTgxQ2t0a05DRWhtcU9uNE5wcGRkYldqWXplR3F6S0VqcXlzSVlEWld0azNOWWszUWhZRVRreE9QbkhWZFk5QVBMS2dqVHhzSkVEVDNyZlN3V252SHYvc016Ny9CaUVEQXJCQVVvWU1xeU5sd0VnZUJCb1FvTFBhWDd1aFVua1NUdllHY0JUZWdnV2lFR1o5VXJBNjZvbmdQUWhrUThEeC9XL0NHa21mTlN5UUZCZ0hNNnc2T2w3RGNGVUtjSkVrQ01Ra0FOOUlUR0F4SG9lQXhJQVY1ZEdwalE5Zm8yZXhJREFLTUR3REFoa1F3RXl0ZENCRFFCUnh4Ym9PUlNDUkRBaWtTWURXalN4ZHNPREpOTE93S1cwSWlJTFdaa2Q1eFhXSHNLNURBVXdrQVFJcEUyQnJ4SzFXNzRhRFBUbG9PTkVUTWd3ZDVSQ1BoQ0FSSFFReUlsQVZvcGVtMUgvNDc1NkhYU0FTTW9jRklna1FRMWFTNEJBTkJIUWlnSzFRRXJVR0JFUUNINGFzSktBaENnaG9TZ0JEV3ZJTmd5R3NtT3lPVDA1dTRSWGxHTEtLQ1E2UGc0Q21CTUloTGF4Z2o5OUFFSkFZekk3OTVTODcvRXBsRDBYQkZOMFkzUEFvQ0JTQVFJbTJRdG5OMy9FQ2xGV2JJbUlJSzBKVEJQNE9MQXlNUUFxUGdFRHhDV0FibE9odENBRnB3d3IramphQThERUlHRWdBZnBGb2pZb2hyQmFjZUZVNS9CMHRBT0VqRURDVVFPZ1grWVBuYlRTMGlrcXFCUUZwZ3BIWGR3aGFIRWdmdzkvUmhCRnVnNERoQkVxdTYvNGNmcEhtclF3QmFjQ0dPMHkxVW5tMndVZTRCUUlnWUJjQmg0NmQzZ0VSYWR6bzhJSFVjR0ZuK2VjZEhjL1FWdEJiYTI3akVnUkFBQVNFY0p6ZGRQNzZremgvL1hwbmdJQk1zV0JuT2ZrN2VCZmRaZGZ4NEFvRVFBQUVaaEE0MGxtdGZndjdhRjFqQWdFaERwaHBOZU1MZ2pjZ0FBSXRDR0NHMW5VNDFnc0l4T042WjhBVkNJQkFOQUlRa1d1Y3JIYWlmK3g1eXpCTk45b1hCaytCQUFoY0o4RFRmUG5JWFA0TnVYN1h2aXRyTFJCdWVBZlRkTzNyOGFneENLZ2w0UGwwdHNodHBkSlJ0Y2tXSXpVckxSRGVFSkhFNHdnMVVYY3htZ21sQkFFUTBKUkFpWDVMUHJSMUkwYnJMQkFXajZrTkVUWHRqeWdXQ0lCQUFRblFGbHJPSTBzV0xOaGJ3TEpMRjlrcUFZRjRTUGNUUkFRQkVHaFB3RG9Sc1VaQUlCN3RleitlQUFFUVNFekFLaEd4UWtBZ0hvbS9GRWdBQkVBZ09nRnJSTVI0QVlGNFJPLzFlQklFUUVBWkFTdEV4R2dCZ1hnbyt6SWdJUkFBZ2ZnRWpCY1JZd1ZrYXAwSFQ5VkZBQUVRQUlHOENQaTBUbVM1cWV0RWpGd0hVck5JTUs5T2czeEJBQVJBZ0FrNHRFN0UyQlhyeGxrZzJOc0szMW9RQUFFTkNYaTBpKzl5MDNieE5jb0NnWGhvK0xWQmtVQUFCSmhBaWZmTzR0OG9rM0FZWTRGQVBFenFscWdMQ0poSmdQNWlIM05wN3l4VExCRWpMQkFTajI0K0RNb1hvbXhtdDBPdFFBQUVUQ0RBdS9qU2I5WFBqOUJ2bGduMU1VSkErQmhhYWd5cnQxVTJvVE9pRGlCZ0NZRTdidXpvZU5xRXVoWmVRUGl3ZTV4aGJrSlhSQjFBd0NJQ3ZyK1ZmN3VLWHVOQyswQ0NCcWhXZHhhOUVWQitFQUFCS3duNGxXcjF5YjhwbFo0dGF1MExLeUIvOEx5Tkx2azlpZ29lNVFZQkVBQUJJdUFMY3FvdkxaV0dpMGlqa0FMQ002NzRLRm9DYm9RanFvZ2RCMlVHQVJCUVJxQ3dhMFFLNXdNSnArdFMwMEU4bFBWZkpBUUNJSkFqZ1dDTlNCRm5aaFZPUUNvMDR3clRkWFBzNnNnYUJFQkFPUUdlM2tzenMzNnVQT0dVRXl5VWdMRFQzUGY5alNrelFmSWdBQUlna0QwQjN4OHMyc3lzd3ZoQWFJUEVyYlFwMmU3c1d4VTVnZ0FJZ0VCbUJBcTFCWHdoQkFSTzg4dzZMeklDQVJESW4wQmhuT3JhRDJIeE5pVVYxeDJpTm9YVFBQK09qUktBQUFpa1Q2QXdUblh0QmVScVorY09PTTNUNzdISUFRUkFRQjhDVTA3MXAvUXBVZU9TYUMwZ0p5WW5uNkJGTnRzYkZ4MTNRUUFFUU1CZ0FyNi8vZDg5VCt2ZlAyMTlJUEI3R1B6RlFOVkFBQVNpRXREYUg2S3RCUUsvUjlUK2hlZEFBQVFNSnFDMVAwUkxBYUc1MEZnc2FQQTNBbFVEQVJDSVRrQm5mNGgyUTFoWTd4RzlZK0ZKRUFBQmF3aG91ZW1pVmdJUzduT0ZXVmZXZkNsUVVSQUFnZWdFdk1scXRlK09VbWtpZXBSMG45UnFDT3R6MTkwSjhVaTN3WkU2Q0lCQVlRbVVkTnN2U3hzQkNZYXVoTmhTMktaRndVRUFCRUFnYlFLMFg1Wk9VM3UxR01MQzBGWGF2UTdwZ3dBSUdFUkFtNm05V2xnZzJLTGRvSzZOcW9BQUNLUk5vSFMxbytPbHRET0prbjd1QXNKRFY5aWlQVXBUNFJrUUFBRVFtQ0tneVZCV3JrTllHTHJDMXdFRVFBQUVwQW5rUHBTVnF3V0NXVmZTSFFjUlFRQUVRS0QwZVVmSDAzbGl5TTBDd1lMQlBKc2RlWU1BQ0JoQ0lOY0ZocmtJQ0ExZDhSa2ZSN0RtdzVBdWpHcUFBQWprUm9DR2tjWStxMWFYNTdIQU1KY2hMSnp4a1Z0ZlE4WWdBQUtHRWNoenI2ek1MUkIybkY5MTNUSEQyaERWQVFFUUFJRThDZmcrV1NHM2xVcEhzeXhFNWhZSWljZHJXVllRZVlFQUNJQ0FCUVFjSndlSGVxWUN3bzV6YXNobEZqUW1xZ2dDSUFBQzJSS2d0U0hIUC9zczArMmdNaHZDd3BxUGJQc1NjZ01CRUxDU1FLWTc5blptaFpnYzUxdm9mUE55VnZraEh4Qm9SdURpNWN0aTlNUkpjZmI4ZVhITzg4UlorbmZ1dkNmNGZ2RHZ5cFVaVWVmUG1TUG16NTByYnVvcEJmZDdGeTBTTjVWS29uekxJc0hYL0JrQ0NHaENvRFJQQ0Q1SGZXY1c1Y25FQW9IalBJdW1SQjdOQ0xCQUhQemRpQmo3NUJQeDBmRVRnV0EwZTFibS9zSXBNVm5kM3kvNkYvZUpoVDA5TXNrZ0RnaW9JcERaQ3ZWTUJPVGpDeGYyVUVhWmpzMnBhZ21rVTB3Q1kyZk9pSU1qbytJUS9lUHJMQU5iSlN3azk5MjVCbUtTSlhqa05VM0FkNXpYYmx1dzRGdlROMUs2U0YxQXlIRyt6S0ZGZ3ltVkg4bUN3RFFCSG40YU9uUllIQndkRFlhb3BqL0k4WUxGaElWazlVQS9ocnB5YkFjTHM4NWtoWHJxQW5Mc3dnVVdEOHk4c3JBSFoxVmxGbzYzRG53ZzNuNy9nTGhZNTcvSXFnenQ4dUZocnY3Rmk4V205ZmZBS21rSEM1K3JJZUE0UTBzWExMaGJUV0tOVTBsVlFMRGZWV1BvdUt1R1FCR0VvMUZOMTY1Y0NTRnBCQWIzVkJOSTNRcEpWVUNPWDdndzVndFJWazBGNmRsTm9LakNVZHRxYkpFTXJsb3BOcTlmVjNzYjF5Q2dtc0NScFYxZHkxVW5HcWFYbW9EQStnZ1I0MVVsZ1pFVEo4VHpyK3hYUHBOS1pSbmpwTVZDOHNpREQ1Q1BaQ0JPTkR3TEFsRUprRC9kZVdUSmdnVjdvMGFJODF4cUFnTHJJMDR6NE5sMkJOanEyUGVyZDhUYjVPc3dNZkN3RmdzSjFwU1kyTHI1MW9tMkd4bGIzTlhWbDBZcFVoRVFXQjlwTkpXOWFZNmRQaTErdk9kbFk2eU9aaTNKMXNpdTd6NEtKM3N6UUxndlN5QTFLeVFWQVlIMUlkdk9pRmRQNEswREI4VHVOMzVSZjl2bzk1dklMd0xmaU5GTm5IbmwwckpDS0YyMWdhMFBPTTdWTXJVMXRaZmVlTk02OGVDMjNrOURkYnVwN2dnZ29Jb0FuUmxTVG1PalJlVVdDS3dQVlUxdWJ6cVQ1Ty80OFo2OTJpd0d6S3NsK21nUjRrNGEwb0pmSks4V01DdmZOS3dRcFJZSXJBK3pPbHdldGZtVU5qamMrY0xQckJjUFpuK1N0bUQ1aDZlZkRUWjl6S010a0tkWkJOS3dRcFJhSUxBK3pPcHdXZGNtRkEvZS9EQ3J3STVyM2xWM1lhbUhkdGp0bnY1clA5d1E4ZUxsUzdSRDc1WEFnWCtKWHNmT25BNnVlZmZlckFLYzYxbVJOajhmMVZhSU1nSEJ6Q3Z6TzErYU5jeEtQT2JOblNQdVhybUt0aFhwcFg5TFNERG1TRldMUldYMHhISGFzUEVqTVhMeVJMQWR2RlJDRVNOOWlZVHVKMDl1bnhhNGlOSHdHQWpVRTFDNk9sMlpnR0RQcS9wMnd2dW9CQ1l2WFJZN1gveFphcnZtaHFLeGV1RDJZRCtxcU9XSzh4eWZMOEliT2FZcEp2Q0p4R2tSUE51VWdNSTlzcFFJeURIUEd4U3VPOVMwd1BnQUJGb1ErT2tyKzhUUTRkKzBlRUx1SXo0QTZ2NDFhOFRhVmF1a0xRMlpuRmxJOXIzelRpcFd5ZHBWSzhUam16ZkxGQXR4UUNBa29Nd0tVU0lnT084amJCZTh4aVhBVTFaNWhibkt3QmJIdGcwYlNEaFdxa3cyZGxwcENRbldpY1J1Q2tTb0o2RElDa2tzSURodHNMNWw4RDRxZ2Y5Tmh6M3hkRjJWNFg0NmUyUFQrdldaV2h5dHlzOWJzUEQySzZwRmtsZXNEOUQyOEFnZ0lFbkE3NnhXKzNwTHBYSEorRUcweE5ONFAzZmRuVWtLZ0xoMkVtQ24rUjZGaStWNHVPcWZ2cmVkOXBQYW9JMTRjTXZ5R2c2MkdQNzVmL3ozNlRQVlZiVDRUM2hyRjJLSUFBS1NCSnpQaFhoQ011NTB0RVFXeUpUMXdRZEdkVStuaUFzUWFFT0FkaW9RTzE1NFVkbGFEOTJzam1iVloydUVoK3o0OENzVmdZL04vZEYzdjZNaUthUmhKd0Z2a3F5UU8wcWxDZG5xSjdKQVNNRUdLV09JaHl4OVMrTzlUZnRiOGF3bEZXRWJXUnk2V1IzTjZzWFdDSmRWMVQ1WHpGQ1ZHRFVyTSs0YlRhQjdyaEJiazlRd2tZQzRycnNqU2VhSWF4OEJIcnJhLzYvSm5lYnNLUC9oMWkzQmVlTkZvOGhEV2ovWStyRGdPaVFOcjVKRmc2R3NwQlN0amU5MHVPN0RTV292TFNBOGRSZWJKaVpCYjJkYy9zRkxlbTQ1Ly9EKzZEdmZvVU9ZK2dzTDhXdDBnTlF1R241S0tpSzhiOWp1TiszYXJiaXdqYTVud1pjRnl6QWt5eVl0SUw3cmJwWE1FOUVzSmNCN095VmQ3OEZPT3hhUFh0cCtwT2lCRndheWlDUU5CMmsyRzUvVWlBQUNFZ1FjMGRIeGxFUzhJSXFVZ0xEem5MN0lXMlF6UlR6N0NQaGtydkpSdEVuRFk5L2VaSVI0aEJ4WVJCN2Z2Q2w4Sy8zS3pua0VFSkFpNFB1RFJ6eFB5cGN0SlNCVHpuT3BzaUtTblFTR0R4OFc0MlNCSkFuc08rQ2pYMDBMdk9BeHFXT2RIZXF3UWt6ckdablZ4NWtueEhhWjNLUUVCTTV6R2RUMnhpSGpnNGF1RGljQ3NMcS9QL0dQYktJQ3BCejVJUkpIbnBhYkpNQUtTVUxQN3JqMG03NUJoa0JzQVlIelhBYXozWEg0citNazAzWjVrU0JQZnpVNXNHL25CMXVTemN5Q0ZXSnlEMG05YmxMTzlOZ0NBdWQ1NmcxcFhBYkRodzRscXRQbWRldkVRaElSMDhPTjgrWWw5b2ZBQ2pHOWw2UldQNGRHQ2g2TW0zcHNBYUVJZDhYTkJNL2JTNERYZlNTWmVjVStqN3czUmN5eTlWYlQ5TjRrUTFrZmtiWEhLOTRSUUNBdUFjZDF0OFIxcHNjU2tPT2V0NUZVcWh5M1lIamVYZ0w4Z3lZYmVGaUhIZWMyQmE3ell3bG1aYkcvQ2F2VGJlb3hTdXZhZmFNUXkrS2tHRXRBYUw3d2xqaUo0MW03Q2ZEVTNTUS9ab05rZmRnd2RGWGZTNzdVMDVOb3dzQW8xb1RVSThYN2FBUmlyd21KTENDMDlxUGI5LzJOMGNxQnAwQkEwTm5oNTZXbjd0cG9mZFQybVh2WC9KMzBLblcyK3JJOFY3NjIzTGd1T0FIZlh4Wm5HQ3V5Z05EYUQ0aEh3ZnRHMXNVL05Eb3FuYVd0MWtjSWpCM3FYK3NmQ04vR2V1VmhMRjZkamdBQ0VnUzY1OGY0clk4c0lBNkdyeVRhd3Q0b1BId2wreVBtT0k2NDcrdHI3SVUzVmZNa2t3Y09qb3hZenc4QXBBZzQ5RnNmZVlQRlNBTEN3MWVDbHJ0TEZRZVJyQ1J3OGZJbDZiVWY1VVUzaTE3YTRzUDJjRHN0TEpTZGtZWFpXTGIzbmdUMWo3RzFTU1FCd2ZCVmdzYXdOT3I0bVUra2E4N0RWd2hDc0I5STl0aGFIc1lhUzdoMUROckFYZ0pSaDdFaUNZamIwUkY3Z1ltOTZGRnpKakJ5VW03NkxnOWY4YllsQ05jSTNMVnloVFNLSkNJdW5Ta2lta0FnOGpCV0pBSEI3Q3NUK2tTMmRUaDFXbTdqeFBLaUwxczVkYmRaNnl3c2xRVC9rd2xKdG8rUnlROXhEQ0lRY1RaV1d3SGh4WU1HWVVGVk1pREFEblRaYWFTOU45K1NRUW1Ma3dWYlpLc2tEODRhUDMyNk9CVkZTWFVqRUdsUllWc0JxYm91QkVTM3B0VytQTDcwK285VkE3ZHJYN3VzQ3lnN29lQ2M1MkZiazZ3Ynk1ejhJdTJOMVZaQTZJRzd6R0dDbW1SQllFeHkrSXFkeGpmUktteUVtUVI0TnBac1NIcDhzR3kraUZkOEFydzNWcnRhdEJRUW1yNjdqRVlqeXUwU3dlY2dVRXZnMHBVcnRXK2pYOU53amV4ZjI5RXpLZDZUc2o0USt1NEtER01WcjcwMUtuRjN1L1BTV3dySVZTRUdOYW9NaWxJUUFyTCtqL0xOWHk1SURiTXZwcXlJWEx3c0tlYlpWeEU1NmtmQXFiYlJnSllDUXBzbll2cXVmbzJxZllsNDdGMG16Sjg3VnlhYStYSElNdU5EdFdTQ3JKakw1SVU0NWhHZ0pSeGZiMVdycGdLQzFlZXRzT0d6TkFqTW0wc25NeVBNSWdEZjBDd2t1SkVWZ1RhcjBwc0tTS1dONlpKVitaRlA4UWpJSG1nMGIrNmM0bFZXOHhKZnd1RlNtcmVRL3NXN3NhT2o2VVNxcGdMU2J1eEwvMnFqaEhrUndNeWZ2TWpQem5kU2RrTEQ3S1J3eDA0Q2psK3BERGFyZWxNQm9TbGNUVlduV1dLNER3SWdBQUlnWUJpQkZsclFVRURJLzFFbUJNc013NERxWkVSZy9od01SV1dFdW0wMk42SXQyakxDQTYwSmtBK3U2U0ZURFFXRS9COFFqOVpNOFdrTEFwaE4xUUtPNUVlWExsMldpamtQTTl1a3VDSFNUQUxOL0NBTkJRVCtqNW53OEM0YkF1Zk9uODhtbzRMbHdnc0NMMTZSRTVDQ1ZSWEYxWk5BVXo5SVF3R0IvMFBQVml4S3FXUVh2WjA3TDdkK3BDaGNwTXRKQ2lLN0lGQzJMYVRMaW9obUVtamlCNWtsSU1INkR3eGhtZGtKTXFyVmZNbnB1T2NtSmpJcVlkR3lrZCtjVW5ZQll0RUlvYnpwRW1qbUI1a2xJTFI5Q2Z3ZjZiYUY4YW5mS25zY0xlMERqNVhUczd0SGtzMHA0WSthelJOMzVBamMyRUFiWmdrSUpRMEJrZU9MV0ZNRVpHZGg4VmovNlBFVDRGaEg0SnduNlJ2QzVwUjFKUEUyQ1lGR2s2dG1DWWpUWXRWaGtzd1IxeDRDL0ZldjdOajdPTTd4bnRWUkRvMStOT3RlbEJ0OHVpTUNDQ2dpUUgrT3pEN2FZNWFBQ0RyS1VGR0dTTVpTQW55S1hsbHlHT3ZneUtpbDFCcFhtNDZURnJKSDB5NHNmYUZ4b3JnTEFoSUVPbDMzcS9YUlpnZ0lMeUNrWVlSeS9VTjREd0p4Q2ZRdjZZc2JKWGllZC9LRkgrUTZ1ck0wdFZtV3g2MkxicjZlRUs1QUlDRUJXdDVSUHVKNTNiWEp6QkFRY3FDWGF6L0VOUWpJRXVoZEpIZTJPZnRCaGc0ZGxzM1d1SGdIUitVdHN2NEVKeGthQnhJVlVrS2dma0hoREFIQkFrSWxqSkVJRWJnMXdlRlFveWZnU09kT3hNTlh3NGMvbE9wUFBJeUkweDJsMENGU0N3S1ZTcVczOXVNWkF0TFIwVEZyakt2MllWeURRRlFDOCtmTkU3Si9BZk9ZL3doRVJQRDBYZGxKQmYxOXZRSlRlS1AyVmp3WGtjQXNSL29NQWFHL2VNb1JFOEpqSU5DU0FNM1lFS3NIK2xzKzArckQ0VU8vYWZXeDhaL3hVTjdiSDN3Z1hjOVZBd1BTY1JFUkJKb1JxSGVrVHdzSVZxQTNRNGI3c2dSVzljc0x5Q0VhKzVjOW1FcTJ2RHJGTy92blA5UHdsWnlJOHZEVjZnVHNkZUtBc3VoRm9ONlJQaTBnV0lHdVYwT1pVSnFGUFQzU3cxaVRkSkxlV3dmay93SXZNaisyUHZhLzgyL1NWU2pUN0t1RmttZW9TMmVLaU5ZUW1GOHoyV3BhUUdqSVljYjBMR3Rvb0tLcEVlQmhySUhGaTZYVGYvVlg3d2lleG1wYlNHSjlNS3Y3MXF5eERSbnFteTJCNmJXQzB3S0NHVmpadG9BdHVkMjc1dStrcThwL2lmOTAzMzdwK0VXTXlET3ZrbGdmUEh6Vm4wQzBpOGdNWmM2VUFQOWRPRDNaYWxwQTNJNk9Xek10QmpLemdrQ1MyVmdNaUdkazJiUTZuZGZBeVBvK21OZmFsU3N4Zk1VZ0VGSWpRSC9ZbGNQRXB3VUVNN0JDSkhoVlNZRC9YTm04Zm4yaUpKOG5LOFFHaC9xbjVEaC9OWUh2ZzYyUHUxWXVUOFFha1VHZ0hZSGFtVmpUQWtLUnBzZTEyaVdBejBFZ0RvSGJhVVcwN0pvUXpvY2Q2dis0WjIrY0xBdjNMQTlkN1huekxlbHRTN2pDekRpSno2bHcwRkRnWEFqd1RLd3c0MEJBZms5N1lJVTM4QW9DcWdtb3NFSjRLR3NmT2RWTkRJSGZnK3FXWk5zU1pqeTRZb1dKZUZBbkRRbUVtaEVJU0dlTm9taFlWaFRKQUFKSnJSQkdzSjkrWkljT203ZFAxbHNIRGlSeW5ET2IzbHR1RVd0WHJlUkxCQkJJblVEbjFLNGxnWURVT2tWU3p4a1pXRWxBaFJYQzRKNS9aYi8wOWg0NmdqLzV4ejhHUTFkSnlzYStqOGMyUDVRa0NjUUZnVmdFL0VxbHhCRWdJTEd3NGVFa0JIaU1Qc24ySnB3M1QrMTk2b1dmR1NFaUxCNDdYL3lYSkVpRHVEenpTdmI4bGNTWkl3RWJDVGloMFJFSUNCRW8yMGdCZGM2ZXdOWU5HOFM4dVhNU1pjd3pzbGhFaWpxOWwwWHczVU9IQXZHNGVPVktJaFlMdjlBakhscDNUNkkwRUJrRTRoSndIZWV2T1U0Z0lGZ0RFaGNmbnBjbDhDWGFZbVB6dW1UVGVqbHZGaEdlbVZVMHh6bzd6Tjk2LzMzeC9MNVhSVkx4NEdIQkIyalZPYll0a2UyTmlKZUFRSm5qWHJOQWZCL2JtQ1FnaWFqeENOejM5VFdKcHZYVzVzYU85ZDF2dkNrbUwxMnV2YTNsOWVTbFMrSWxLaXRQMTFVUitwY3NGdmZlaVcxTFZMQkVHdkVJa0FWUzVoamhFQmJXZ0RBTmhFd0k4Ri9PajIzZW5IZ29LeXdzYjdyNC9XZWVGWjlxdW04V0QxbXh2K1A3enp3bmZ2bkJyOE5pSjNybG9hdkhObTFLbEFZaWc0QXNBVm9MRWhnZERtL2pmdFYxUGRtRUVBOEVaQW53Mm82blhuaFJObnJEZUp2V3J3czJFN3h4M3R5R24yZDlrNjBPSG1aVEpSeGNmcDUxOVlNdER5ZWVrSkExQytSbkZBRi9zbHJ0WVFGWlJnSnl4S2lxb1RLRkljQkRVS3I5R0F0TEpjRkNNcmh5UmZCam13Y005blh3dmxaNzN2eEZZbDlIYmZuWmV1TzY4VDhFRU1pUmdIKzFXdTF6am5uZW9IRGRvUndMZ3F3dEovRFRWL2JSQWtHNXc1TmFvY3REU05qaVlPRmdpK09zcDk2d3Y1c1dDejYyR1VOWHJkb2RuMlZDd0JmVjZ0M09jYy9iNkx2dWE1bGtpVXhBb0FFQjN1dHFSNHByTzFoSWVJdnp3VlVyUkg5Zm4zS3JoSzBOUHNQOTBNaG9zSk51MHRsVkRSQUZ0M3IvNmhheDY5Rkg2YXp6Wk5PZ202V1AreUFRZzREdlY2dmJuSTg5YjZ2anVydGpSTVNqSUtDY0FJdklQNUFqL054NTlYKzExeFkyRkJOZTBIZ3JuOXhINGtLS0luaG9LR3Bnd2VCcHhPekRHU1hoNE8zWDB4S05zRXpzTkdmeHdKVGRrQWhlY3lad1RVRCs0SGs3WGRmZGtYTmhrRDBJMEN3cVQreDQ4Y1hVUmFRV05RdklUYlEycFhmUklwb1ZOamNRRkg0TkZqdVNVUHpKbXdnZVo0SDdFdzFKOGJEVStPa3pxUXhQMVphcjlocmlVVXNEMTdvUXFGYXJ1OWdDZVpZc2tDZDBLUlRLWVRlQlBFUkVaK0k4YlBXRGh4K0c1YUZ6STFsYU5ockNldGFsT2VwWVJHaHBCOUN4MnJ4Uy9aKyt0eDE3TzFIakROQkNRUXhiNmRoTFVTWW1RTlBKdTJnWGs0NHU0QUFCblFqY1NFTkkvL1BKN2VKK1MxZFo4enFQQjJpMS9xN3Z3R0d1VTc5RVdXWVNvSDdxZE1JQ21Ra0Y3L1FoOE1pREcyakcwZHpnSEJEcXAxWUVGbzl0R3g3QUZpVld0SGF4SzBtVFNXNTFqbjMyMlpEdy9jRmlWd1dsTjVtQUxYNFJkcGF6djZQM2xrVW1OeWZxWmdvQjN4OXlqbDI0Y0lUcWc3MndUR2xVUSt2QjAyWjUxVHJ2ZTJWYVlLdmovalYvSng1YXZ4NXJQRXhyWElQclF4c3Bqam5ITDF3WW8rR0Jzc0gxUk5VTUluQndaRVM4Uk51RHBMMWVKQ3RrYkhVOHZ1bWhZS0ZqVm5raUh4QlFRUUFDb29JaTBzaUZBRnNqNzlMNTZFVVZrdm0wMlNPZjVYSHZuWGZDNnNpbEJ5SFRwQVFnSUVrSkluNnVCTTdTd2tNV2ttRVNrcUk0MlNFY3VYWVpaSzZRUUNBZzVBTXB5bmRQWWRXUmxFa0VRaUVaT1hsQ1c0c0V3bUZTajBOZHBnajQ3RVNIZ0tBL0dFSGc0dVVyZEU3NlNPQm9QM1htVE81V0NUdkgrL3Q2eGFyK2ZyRjIxU29NVlJuUnkxQ0pHZ0lRa0JvWXVEU0lBRnNsYjlPTUxkNGxOMHN4WWRFbzB5YU5xMGswZU1QR011MnhoUUFDaGhLQWdCamFzS2hXRFFFV0U5NDE5K0RvcUJnankrUlA5SjZEQ3RPYkJZTTNaTHg5Y1o4bzMwekM4YmNEMTNiNHJja2ZseUJnS0FFSWlLRU5pMnExSU1CRFhlTWtKR09uVDR0enROdnVXZTk4c0QwN3oraTZlT1d5dUhUbC84Nkl6VHZ6M3ZnZjU0aDVOSE1xMkwyMzFDTnVLblVIR3h6MkwxNkNvYWtadFBER0lnSVFFSXNhRzFVRkFSQUFBWlVFZkpxSmhRQUNJQUFDSUFBQzhRbEFRT0l6UXd3UUFBRVFBQUVpQUFGQk53QUJFQUFCRUpBaUFBR1J3b1pJSUFBQ0lBQUNyaVBFT0RDQUFBaUFBQWlBUUJ3Q1pIMk13d0tKUXd6UGdnQUlnQUFJVEJPQWdFeWp3QVVJZ0FBSWdFQWNBaENRT0xUd0xBaUFBQWlBUUVDZ0lzU0U2enZPT0hpQUFBaUFBQWlBUUJ3Q2p1OVB3QUtKUXd6UGdnQUlnQUFJVEJOd3E1WEtxZWwzdUFBQkVBQUJFQUNCQ0FTcXZuOEJGa2dFVUhnRUJFQUFCRUJnSmdIWGNieE9XZ2N5TWZNMjNvSEFiQUlxdGo2Zm5TcnU2RWFBZmc4UVFDQVNBWjhza0U3NllaaEFwNG5FeTRxSHFGUFE5dWFlK09qRXllQ1Zyem1jTzMvZWl2cmJYc241YytlS2VmU1B0NjN2cGNPd2J1b3BCZWVjOExrbkNDQlFTNEMxZ3kyUThkcWJ1TGFQQUl2R3lNbVQ0dkRJcUJnNmRKak94TGhpSHdUVXVDa0JGcFAreFl2RjRLb1ZkRVJ2bjRDWU5FVmwwd2MrYWNjcDUyUFAyK3E0N202YmFvNjZYaU13ZWVtU2VQdURYNHUzM3o4QTBVQ25pRVNBeFdUVCtuWEJDWXhmNnVtSkZBY1BHVW5BcDc4a3Z1a2M4N3hCNGJwRFJsWVJsV3BJZ0F3T0VvNERZdisvdmdQaGFFZ0lOOXNSQ0lWa2NPVUtXQ1R0WUpuNXVTK3ExYnVkMzN0ZXVkTjF4OHlzSTJwVlQrQWtIZVA2ei90ZURjNEdyLzhNNzBFZ0xnRVdrcDNmZlZUQUdvbExydkRQKzM2MXV0d1o4N3p1cTY1N3pWTmErRHFoQXEwSXZIVUFWa2NyUHZoTW5zQWpEMjRROTkrNVJqNEJ4Q3dhQVgreVd1MEpwbFljdTNDQkJhUzdhRFZBZWFNVDJQK3JkOFErK29jQUFta1JZTi9JWnZxSFlBVUJmMmxYbDl2SlZTVVZtYUJoY1FpSW9lMyswMWYyaWFIRHZ6RzBkcWlXTGdUNGo1UkxseThMdGtZUXpDWkFlbkdVYXhpc1JNZUdpdVkyTm4rcElSN210cTl1Tlh2cndBZXdkSFZybEJUS3d4c3BjcktCZ0dBL3JCUUlhNUFraHEwMGFBUUxpOEQ5am9VRXdXZ0M0MXk3Y0MrczRBM2ZRRENEd0tlMGNodytEelBhc29pMTJQM0dtMkxreElraUZoMWxqa0NBTmxJOHhZOEZBa0kra1BFSWNmQklnUWpzZk9GbkJTb3RpbW9pZ2VkZjJTOHVrazhFd1RnQ3dTcDBybFVnSVBSZk1KNWxYRFV0clJBUElZUjdXRm1LQU5YV2dBRDNRUXhsYWRBUUtSUWhORG9DQWZsOHlxT2VRajVJTW1NQ1p6RjBsVEZ4Wk5lS3dDL0pGd0lycEJXaFluNTJkV3JVS3BqRys1VlNhWnpXZ2hTekppajFEQUpzZmFnSzlGZUdLTit5U054S3U3SWkyRUdBcCtHZVBlK0pVMmZPQ0pxcW1UaE1VbnBzaFdCOVNHS1VXaVhBbXNFRkNnU0VMOWdrb1E1VDVtdUVZaEpnNjBQRmxOMzVjK2ZRcXVJN3hYMzBqNjhSN0NQQUlqSjgrTEI0bC82ZG8rc2tnYTBRWHFYT1c4VWpGSjlBdUFhRWF6SXRJTFFqMmxIaCsrWGlWOC9lR296U0dSNUp3MXJhSE8rUkJ4K0VjQ1FGV2ZENEMra2NFRjVaUHJoeXBXQ3Jkb2lFUkRhd0ZjSi8yR0NyRTFtQ2VzV2pQYkJPaFNVS2ZDRDhCbXRCUWlURmZVM3lKZWRhOHcvRzQ5L2VEUEVvYmhkUVhuSVdrc2UvdlNueEVOVEJrUkhsWlVPQytSRGcwYW93NTJrQm9SdkIwdlR3QTd3V2l3QVBYeVd4UUxDUFViSGFPK3ZTY3Y5SVlrSHdDWmR3cG1mZGFxbms1enNkSGNOaHl0TUNjZ01FSkdSU3lOZHhjbnJLQmo2MkZFNU9XWHIyeE51NllZTW9TMDZvWUlmOFFUcnhFc0VBQXBYSzlJeXJhUUdoYW8wYlVEVnJxekNTd1AreGVSMTJVTFcyNDhTb09CK0x2aTNCUm9sSi9zaUpVVXc4bWpLQnlScGpZMXBBZWt1bGlkcXhyWlRMZ09RVkU1RDljckwxc1hiVlNzV2xRWEttRXJpOXIxZndJVkl5NGF5SDljb3kzSFNLd3pPdzdpQ3RDTXMwTFNEQkRaNkpoVkJJQWhjdlg1RXE5OWY2KzZYaUlaS2RCQnd5UTFZTnlQV1pVM1FhSmtLeENkVE93T0thekJBUXYxSjVyOWpWczdmMFo3M3pVcFh2WDl3bkZRK1I3Q1V3SU5sbkxsNlIreVBIWHRKYTFueUdrVEZEUURDRXBXV0RSU3JVSlVrTFpCNFdkMFhpaTRldUUvaGlxZWY2bXhoWEVKQVlzUFI4MUNmQm1HRmt6QkNRRGlHRzlTdzNTcFVXZ1lVOWNqOEdhWlVINmVwUEFMc1Q2TjlHYVpXdzFvSE9lY3dRRURqUzA4S09kRUVBQkVDZzJBVElnVDVlNjBEbjJzd1FrS0I2Y0tRWHU1VlJlaEFBQVJCSWdRQTUwSDlibit3c0FZRWp2UjRSM29NQUNNd2d3S3NDRVd3ajRGT3pEOWRYZXBhQTBBTXp2T3oxRWZBZUJFREFiZ0xZa3NUTzlpY2ZlWHNMaExibmhZQlkxRDk0RHkwRUVJaEQ0QkttNDhiQlpjeXo5UTUwcnRnc0M0UWQ2WFFmSWxLd1pwZGRIY3dIQ0NHQVFCd0NGeTlmaXZQNDlMTUx1N3VucjNGUkxBTDFLOUREMHM4U0VQNkFuQ1V6NXZxR0QrUFZQQUxZWHNLOE5rMjdSbWNuK0cvTStHRWVEaWVMRDAyWEdFMDBvYUdBME0xaFhjcU5ja1FqSUx0TDZsaUNYWHlqbFF4UG1VWkE5b1JDbkVoWTJKN0FXN2dQTlNwOVF3SEJnc0pHcVBTK04yK2UzSEdoNDlpZlNPK0cxYXgwUHMzRmtUMTNSdmFQSE0wUVdGbWN5VXJsL1VZVmJ5Z2c4SU0wUXFYM3ZkNUZOMHNWY1B6TUp6am9SNHFjblpGNEJwYjh6cy9ZOWFDSXZhYVovNFByMGxCQStBUDRRWmhDY1VMdm9sdWtDNHVEZnFUUldSY3hTVjhwUy82Ull4MWszU3JjeFAvQnhXd3FJUFRCc0c3MVFIbWFFMGp5NVV4NmxucnpVdUVUa3dqd1NySkRveDlKVlltM2dlK1ZQTTFRS2tORVVrV2dxZitETTJncUlQQ0RxT0tmVFRyc29KUWRZOFl3VmpadFZQUmN6cDcvc3pnNEtuY3NiWG5SbHdXYzZNWHNBYzM4SDF5YnBnSVMrRUVjWjdpWVZiYXoxTEpuZS9DNDlsc0hQckFUR21vZG1ZQ3M4NXd6R09oYkhEa2ZQS2dSQWQ4ZnJ0OUFzYlowVFFXRUg2cmlnS2xhVnRwZmYyMWdRTHFNYjVPQVlJc0thWHpHUitUWlY2Kys4MjlTOWFSemhzUkt5Vk1NcFRKRUpGVUUvSXJ2djlFcXNaWUNRaDhPdDRxTXovUWl3SDRRMmNWYXNFTDBha3ZkU2pOOCtEZmlyT2RKRldzK1RURWZXQXdMUkFwZXpwRklBMW91S204cElFdExwV0Vxdjl5eTA1d3JibVAyUE1hOGR1Vks2YXJEQ3BGR1ozVEVULy84WjdIL1YrOUkxM0Yxdjd4bExKMHBJaVltUUhNbXhtOHJsVnB1YTlWU1FMZ0VOSjEzYitLU0lJSE1DQ1FaeG1JckpNa1BSV2FWUkVhWkVtRC9tS3oxd2NOWGQ2MWNubWw1a1prYUFnNzVQOXFsMUZaQXFBTzgzaTRSZks0UEFYYWt5ODdHNGxyd2o4WElpUlA2VkFnbHlaVUFXeCsvL09EWDBtVzQ2UXM5R0w2U3BwZHJSRis0YnR2Zi9yWUNNclc5TzRheGNtM0xlSm12WGJVaVhvUzZwNTkvWlQ4YzZuVk1iSHc3ZWVtUzJQbml2eVNxK3FaNzdra1VINUh6STdCMHdZSTMyK1hlVmtDbXB2TzJIQWRybHdrK3o1WUErMEZrbmVsY1VoNnV3RkJXdG0ybVcyNDg2Mm9mK1Qxa2g2NjRQZ3ZKK2xpN1N0NG5weHNUbThwVHJWWmJ6cjRLV2JRVkVINlFqcm1GSHlRa1ZvQlhkcVkvY09lZGlVcktRMWxZRzVJSVlXRWprL00wK0FNaXlkQVZWeDdXUjNHN1FJZnJ2aGFsOUpFRTVBYjRRYUt3MU9xWisrNWNrOGdLNGNyc2Z1Tk44VHY0UTdScTF5d0tNM0w4dU5ndnVlWWpMQitzajVCRU1WLy9VcTIySGI3aW1rVVNFS3hLTDE0bllDdGs4N3IxaVF2K2t6MHZTKysrbWpoekpKQTVnWk4vL0tQZ05rOGFZSDBrSlpoai9EYXJ6MnRMRmtsQU9BS0dzV3F4RmVQNi9xK3ZFYkxibTRRMTVLbTkvN2g3ci9nVVo2ZUhTSXg5NVJsWFA5bjd2OFRGaEdlZXcvb29kQmZ4YWVQTFBWRnJFRmxBcG9heE1Cc3JLbGxObnR1OFBya1Z3bzdVblMvOERDS2lTWnVtVVF5MlBIakdWUktuT1plTGQ5M2Q5ZWlqYVJRUmFXWkVJT3J3RlJjbnNvQmdObFpHcmFjNEc3WkE3aWQvU05MQVB5emZmK1k1REdjbEJhbGgvTitSejBPRmVIRFZOcTI3Unl6c0tXbFlTeFFwQ2dHZWZkVnE4OFQ2TkNJTFNCQ3hVdGxWbndEZTYwOWcwL3AxaVJZWGhqWGs0YXovOXZTem1KMFZBakhnOVJmdnZ4K0lSOUpoSzBiQlExZmMxeEFLUzhCM096cDJ4eWw5TEFIQm9zSTRhUFY1bGgzcVA5eTZKZkdzckxCR1BEdUwxd2p3ZEUrRVloTGdkUjR2VVR2dWVmTXRKUlhnRFJNeGRLVUVaVzZKOE41WFVSWVAxaFl3bG9Ed01CYjJ4cXJGVjV4ckhsWlFNU3NyckRFdk5Oenh3b3Z3aTRSQUN2VEt6dklkTC81TThPYVpLZ0w3UGI2OWJoMkdybFRBekRHTktIdGYxUmN2bG9Cd1pPeU5WWSt3T085NVZwWUtmMGhZWXo1Z2lKM3JRNGNPaDdmd3FqRUJQcEtXL1Izc3kwcHlPRlI5RmRudmNhOENQMXQ5dW5pZktRRmYrUDdMY1hNa1BZZ2ZqbDI0Y0lSaUxZc2ZFekYwSVBBVVdRNHFmMEM0VHJ4OXlrUHI3eEZmNnVuUm9Zb29ReDBCM3RlS2h4MlRyaTZ2UzFZTUxGa3NkbjBIczY3cXVSVHRQZjF0TVhaYlYxZGYzSExIdGtBNGc2ajdwTVF0REo3UGhnRDdRMjVTUEZObTZQQmhXQ1BaTkYrc1hOalhFVm9kcXNXRG5lWS8yTElsVm5ud3NKWUVmQktDblRJbGs3SkF4anl2KzZycnloMVBKbE5LeEZGTzRPeDVUenoxNG92aUhMMnFEckJHVkJPVlM0OTlIYy92ZjFXNXRjbWxZZkZncHptbTdNcTFqV2F4L0t2VmF0OVhTcVh4dU9XU0VoRE81TmhubnczUm1ObGczQXp4dkQ0RTBoUVJyaVg3VzNoc0hNTmEyYlk1RDFmeFJwaXlaNWkzS3kzRW94MmhnbjN1Kzd1WGRuZHZreW0xdklCNDNpQWRPRElra3luaTZFTWdiUkZaV0NxSlFkclNlM0RsQ2doSnlzMGVDc2N2U1R4VXJPdG9WRnlJUnlNcWhiN25rMC9pN3FuankyTlhSRnBBT0NjNDAyUHoxakpDMmlMQ2xZYVFwTmYwV1FoSDBJWVl0a3F2RVhOS1dkWjVIaFkzbVlCNDNuYXlRcDRKRThOcmNRbXdpUHg0ejE0eGR1Wk1xcFdZUDJlT1dEMHdnQmxiQ1NtemMvd3NiWEE1ZFBnM0lrMkxJeXhtNzEvZEV2Zzg1cytkRTk3Q2EvRUorQ1FBVzVkMGRiMHNXNVZFQWpMbFRCK2p6THRsQzRCNGVoSGdWZVpaSFNTMWVxQS9tUDY3cXYvMllCTSt2VWpvV1JvV0RqNnpudjBicXFkaU42b3gvMER3cVlKYk4yd1FFSTlHaEFwOXp5UG4rWElaNTNsWTYwUUN3b2w4N0huUE9xNzdSSmdnWG90UGdGZVo4NXFCckFJUGIvVXZYaHhZSlF0TFBTUW1XZVZjakh4QzBXREJ5TUxhQ0tud0NuTmVKSWo5clVJaWhyMG1jSjZISkJKL1ZYL3ZlZVZPMTJVckJNRWdBZ2RIUnNSTGIvNGlsV20rclREMUxsb1VPTnhYa1hYQ3dzSS9ZamFHWUlpS2RrRG1JYXFQeU9MSXd0cW81Y3g3Vy8xd3k4T0JzTmZleDdVeEJLU243dFlTVVBMdHhKVGVXcVRtWEdmbEYybEdqQVdFaDdsWVRQcjcrdml3Q2Q1S3g4aEF6a3c2dGUzYThOU2hrVkZ4YVBTanhHZHp5SUJpdnYyMHV2eXhUWnV3eGtNR1lGSGlLTEErdUtwS3ZvL0hNS1czS04xR3FwdzhwTVgvZ2g4NXFSU1NSMkxuZS9tV1JXSjFmMy93V25SQnFSV004ZE5ueEtHUFBoTDhtdGIwMnlndHdOYmV0ZzBQWUYrcktMQ0svVXlpcWJ1MVZWY2lJSndnckpCYXJPWmRmMHF6dEhha3RISmRobFlvS0R6a3hmNFQzcHFsZlBQTldsb3BaRmhRb0ZsVE5DVEZRMUduYUtZYnozYkxXekJxdWZNc3E4Y2Vla2owa2tnam1FMkF1dU1SMnZkcXVZcGFxaE1RV0NFcTJrUDdOSFN3UnBwQkNrV0Z6ejhwazdEd1A1NDV4TUxDOTRLUXdqQllhRTF3K256b0ZndkZxVE9maUVtNkh2L2tFM0dLTEF1ZWNwdW5kWEd0OHJQL1oxL0hBMnZXMEFRR0hBUTFtNDZSZHhKUDNhMmxva3hBT05HUEwxd1lvd1RMdFJuZzJqd0M3QnRoSWVFTkZJc1UyS2ZDbGdxTHlUejZ4Kzg1aEs5OHpmZm4xYTUxSVBQaFQ5NEVmeFFFRm90ekpCRGhLOTg4UitMQWU0cXhlT2dvRWtIQjYvN2o0YXJiKzNyRjQ1czN3OWRSeDhia3Q5UnZwWGJkYmNaRXJZQjQzbGFhMHJ1N1dXYTRieFlCUGdkazN6dnZaRDVUeXl5SzJkZUd0eU41Zk5ORG1HR1ZQZnE4YzFScWZYQmxsQW9JSndncmhDbllGU0FreFdodkhxN2lrd054K0ZNeDJrdDFLVlZiSDF3KzlRSUNLMFIxdXhjbVBRaUpuazBWK2pudXZmTk9yQ2JYczRteUtKVnk2NE1MclZ4QU9GRllJVXpCM2dBaDBhUHRJUng2dElNT3BVakQrdUI2cFNNZ3NFSjA2RE81bHlFVWtqK1JnNWs2TUVJR0JOZzUzcis0VHd5dVdCRnNXb245cXpLQXJuOFdxVmdmWE8xVUJJUVRoaFhDRkJDWUFLOTlZREVacGxsYkVKSjAra1FvSEx4M0ZhK0xRUUNCa0VCYTFnZW5uNTZBd0FvSjJ3K3ZVd1I0K3U4bzdldkVNN2RnbFNUdkZvRm8wRlRjQVJJTStEZVM4elEwaGRTc0QrYVZtb0J3NG5UZzFJZjBjZ2RmSTRCQUxRRmVpZjMyK3grSWtaTW5JQ2ExWU5wYzh4ZDJIczJtdW52RlN0b2o3SFpZRzIxNDJmNXhtdFlIczAxWFFMQTYzZmIrRzZuKzRSQVh4S1F4THJZMGdvMGxhUjh3aUVaalJyamJrRUNxMWdmbm1LcUFjQWJZSTRzcElFUWx3SmJKNlBFVDR1RG9xUGpvNUZpd1E2MXRmcFBReXVpbExWaFdrV2lzL3R1QkdhdmxvN0xFYzVZVDhQMFBsM1ozcjBpVFF2b0NBaXNremZZelBtMjJUdmdFUHZhZG1Db290WUxCRG5DZVJWVmVkQXZXYkJqZnUxT3RvSkx6UHRxVk1IVUI0UUljLyt5em45TUJPZDlzVnhoOERnTHRDTENnakowK0xjWnBzMEsyVms3UlpvVjhqa1pSckpUZ0MwZERVdVZGTjEvYjhKR3NERDUvZzNjVlJnQUJaUVFVbmZmUnJqeVpDTWpVcVlWSHFEQTRPNzFkaStEejJBUllTSGhEd3pFU2xYRzY1dGxlNTd6ejR0TGxLOU5wWlNrd29Vandwb3pzdStCZGdXK2kxK0NhdGt1SFdFdzNDeTdTSVpDSjljRkZ6MFJBT0tNL2VONU8xM1YzOERVQ0NHUkI0Q0lKeU5rcEllSHQxSG1iZFJhVnlTdVhBOEhoTXZCMFlnNHNNT2NtcnUrNkc5eXMrMjloOTlUZlAyUkJmTEhVSFh4NXZ0alRJMjZjYzIwSFh4WUlYcmgzRTkzanM5MnhpSzhPSU41bVFZQVBpOXExdEZUYWxVVm1tUW5JbU9kMVgzWGRrMVNwYTN0b1oxRTc1QUVDSUFBQ0ZoR2dQNFRHTGxhcnkrOG9sVnIvTmFTSWlhc29uYmJKOUZLRi9HcjF5YllQNGdFUUFBRVFBQUVaQWo3OW9PL01Tank0Z0psWklDRU5tdGI3TGprOTE0YnY4UW9DSUFBQ0lLQ0FRQWJUZHV0TG1aa0ZFbWJzVnlxd1FrSVllQVVCRUFBQk5RVDhxNzcvOTJxU2lwNUs1Z0p5VzZsMGxKdzh6MFl2SXA0RUFSQUFBUkJvUWNBbjk4QnpYeW1WeGxzOGs4cEhtUXNJMTZKVGlGM3M3RW1sUmtnVUJFQUFCQ3dpUUwrbDR4ZnBOeldQS3VjaUlPeFFkNnJWYlhsVUdIbUNBQWlBZ0VFRU1uZWMxN0xMUlVDNEFEUlBlVmc0emxCdFlYQU5BaUFBQWlBUW1RQnR3ZUR2V2RMVjlYTGtHSW9mekUxQXVCNVhLeFcyUXE2dDVGSmNNU1FIQWlBQUFpWVQ0S0VyY3B6L0tNODY1aW9nZ2RPbldzMFZRSjd3a1RjSWdBQUlTQklJaHE3eWNKelhsamZ6ZFNDMW1ZZlhXQnNTa3NBckNJQUFDTFFsRUF4ZDBWYnRQSUtUYThqVkFnbHJqcUdza0FSZVFRQUVRS0ExQVIyR3JzSVNhaUVnR01vS213T3ZJQUFDSU5DU2dCWkRWMkVKdFJqQ0NndURvYXlRQkY1QkFBUkFZQllCYllhdXdwSnBZWUdFaGVtc1ZMNUYxNWlWRlFMQkt3aUFBQWhNRWRCcDZDcHNGSzBFaEJjWTBqWW5MQ0lJSUFBQ0lBQUMxd2xvTlhRVkZrc3JBZUZDQlFzTXNWZFcyRDU0QlFFUUFJRmdyNnM4Rnd3MmF3S3RmQ0JoSWZud3FjOWQ5ME1xWEc5NEQ2OGdBQUlnWUNNQkdybzZlVnRYMTJJZDY2NmRCY0tRZUNpclVxM2VUWmZ3aCtqWWExQW1FQUNCckFoNDlGdjRqYXd5aTV1UGxnTENsY0RVM3JoTmllZEJBQVFNSThCRFY3dnlYbTNlaXFtMkFzS0ZKbi9Jc3pnN3BGWHo0VE1RQUFGRENRUitEem8vNlRtZDY2ZTFnREE0bkIyaWMvZEIyVUFBQk5JZ1FINlBzYnpPK0loVEgrMEZCUDZRT00ySlowRUFCQXdnRVBnOTd1QmxEWm9IN1FXRStmRVlJSTBGNGl4MXpUc1RpZ2NDSUpDWWdFK3pUN2ZyN1Blb3JXRWhCSVFMVEdPQmU4Z2ZzcXUyOExnR0FSQUFBWU1JK1B3YnArTjZqMmFNU2V5S0ZiQmZWckhhQzZVRkFSQ0lSc0R4L2RlV2RIY1hhaWVPd2xnZ1lSUHdmbG5zWUFyZjR4VUVRQUFFaWs2QWY5TSs5LzNDRGRNWHpnTGhqdko3enl0MzBrcDF1aXdWdmVPZy9DQUFBdFlUOEs1V3E4dUw0dmVvYmEzQ1dTQmMrQUQwdFUwWFNiZ1JRQUFFUUtDd0JIeGFhZjVJRWNXRGlSZFNRTGpnVTVzdUZzN2s0N0lqZ0FBSWdBQVJDSnptZjFNcXZWRlVHb1VWRUFZK3RWSWRNN09LMnZ0UWJoQ3dsMEFnSHZRYlZ1amZyMEw2UU9yNzNNY1hMdXltaW15dHY0LzNJQUFDSUtBaEFkNm1aQzh0VFhoRXc3TEZLbEtoTFpDd3BqZFVxOStqNnlQaGU3eUNBQWlBZ01ZRWp0STJKZnliVmZoZ2hBWENyY0F6c3pwYzkxMnFVRy9oV3dVVkFBRVFNSklBVDlmbG95cUs2alN2YnhSakJJUXJCaEdwYjE2OEJ3RVEwSVdBYWVMQlhJMFNFSzRRMW9nd0JRUVFBQUdkQ0pnb0hzelhDQjlJYlVkaDA1QWNWSGZUUFp4bVdBc0cxeUFBQW5rUk9FOTdYSDNMbEdHcldvakdXU0JoNVQ3MnZHWE90ZFhxeHRZeHJDdGVRUUFFdENYQU02NlcwNHlybzlxV01FSEJqTE5BUWhiY1lOUncyK2c5VnF1SFVQQUtBaUNRSlFIZm9WWG1wb29IZ3pUK3IzT3lSTGFTSmZLU0RYWE44cHVCdkVBQUJGb1NDTVJqU2FtMHQrVlRCZi9RZUFIaDlvR0lGTHlYb3ZnZ1VDd0NWb2dITjRrVkFzSVZoWWd3QlFRUUFJR1VDVmdqSHN6UkdnSGh5a0pFbUFJQ0NJQkFTZ1NzRWc5bWFKV0FjSVVoSWt3QkFRUkFRREVCNjhTRCtWa25JRnhwaUFoVFFBQUJFRkJFd0VyeFlIWldDZ2hYbkVTRTE0bThTNWM0MVpDQklJQUFDTWdRT0UvTEJiNWg4bFRkVmxDTVhRZlNxdEw4MmRRNmtidDVpNEYyeitKekVBQUJFR2hBd0dyeFlCN1dXaUJoWjhBR2pDRUp2SUlBQ0VRbFlPcmVWbEhySHo1bnZZQXdDSWhJMkIzd0NnSWcwSTRBeE9NNklXdUhzSzRqRUlJM09lTTkrdWtlRHFXcUJZTnJFQUNCV2dLa0hlS0lTZWQ1MUZaTzVob0NNa1dOUmFTVFJJUjZ5QjRaa0lnREFpQmdOSUhnR05wSmd3NkRVdEZhR01KcVFQR1k1KzBVcnJ1andVZTRCUUlnWUI4Qm43WmozN1cwVk5wbFg5VmIxeGdDMG9UUGxJZzhSUitEVVJOR3VBMENGaEJneStON05HdnpPUXZxR3J1SytIRnNnZXk0NTIzMHIrM2tpN1VpTFRqaEl4QXdsQUFmQlBYM1pIa01HMXEveE5XQ2dMUkJpQmxhYlFEaFl4QXdrQUQ1UWsrU3Mvd2JKcDRpcUxLNTRFUnZRek9jb2VVNHptdHRIc1hISUFBQ3hTZmdDOThmdWxpdHJvQjR0RzlNV0NEdEdVMC9BYi9JTkFwY2dJQ0pCT0FzajltcUVKQ1l3S1kyWW55YW9zRXZFcE1kSGdjQmpRbDRkUHpzOTB3L1FWQTFmd2lJQkZINFJTU2dJUW9JNkVuQUozL0hHUHdkY28wREg0Z0VOeDRidmFGYVhVNHpOSjZsNk5UL0VFQUFCQXBJZ0tmb1BnZC9oM3pMd1FLUlp4ZkVKTC9JZGxwMHlPdEZNS1NWa0NXaWcwQ0dCRHdTajExWTM1R01PQVFrR2I4Z05vYTBGRUJFRWlDUURRRU1XU25rakNFc0JUQjVTT3UycnE0K0RHa3BnSWtrUUNBOUFoaXlVc3dXRm9oaW9EeExpNGUwQ0d5djRxU1JIQWlBZ0R3QnJDcVhaOWMwSml5UXBtamtQcUF4MVQyODNUT05yKzZoRk9CZ2w4T0lXQ0NnaWtDd01KQjIwVjJNTFVsVUliMmVEaXlRNnl5VVg4RWFVWTRVQ1lKQUhBSndsTWVoSmZFc0JFUUNXcHdvN0dDL3dYR2U5aDFuSThVRDd6anc4Q3dJeUJGZ3EyUDRxdTl2dzNZa2NnQ2p4c0lQV2xSU0NaK0ROWklRSUtLRFFEUUNzRHFpY1ZMeUZBUkVDY1pvaVFUVGZZWFk0Ymp1Rm9vQjl0R3c0U2tRaUVMQWQzei85Yzk5LzBsWUhWRndxWGtHUDJKcU9NWktCZFpJTEZ4NEdBUmFFZUIxSGVPMGo5VTJPTWxiWVVybk04ekNTb2RyeTFSNXBoYTJRbW1KQ0IrQ1FCUUM0YnFPNVJDUEtMalVQd01MUkQzVFdDbnlzRmFuNi82Y0lpMmpmMmlQV1BUd3NLVUVBaWU1VDhOVjlNZllVVXNaYUZGdC9HQnAwUXhDWUZoTGs0WkFNWFFtd091cUp1aEhhL3VTcnE2WGRTNm9MV1dEZ0dqVTBvRTFJa1N3a3AyS2hiYlJxRzFRbE53SmVMUlYwSE9UUWp4M1I2azBrWHRwVUlDQUFINmtOT3dJbUsybFlhT2dTSGtSd095cXZNaEh5QmNDRWdGU1hvL0FQNUlYZWVTckFZSEF6MEVMQW44RUI3a0dyZEdrQ0JDUUptQjB1bDNqSHlsVHVkQm1PalVPeXFLYUFQczVqdEp3MVpNUUR0Vm8xYWVISHlQMVRGTkxFVUtTR2xva25EK0JZRDBIclN2WUNRZDUvbzBSdFFRUWtLaWtOSG9PUXFKUlk2QW9TUWxBT0pJU3pERStCQ1JIK0VtemhwQWtKWWo0T1JLQWNPUUlYMVhXRUJCVkpITk1CMEtTSTN4a0haY0FoQ011TVkyZmg0Qm8zRGh4aThaQzRqak9meFdPZzFYdGNlSGgrYlFKWUZaVjJvUnpTQjhDa2dQMHRMTTg1bm1ETkpWbEMzYjlUWnMwMG85QUFNSVJBVkpSSDRHQUZMWGxJcFM3WmtIaWcvUjROLzFEZTBmZ2hrY1NFd2kySEtGam5mZFdhT1U0dGxkUHpGUGJCUENEb20zVHFDdllsSkFNQ3RkOWlocThUQ21qM2RYaFJVclhDYkMxY1pTR1VmZjhwVnA5R1Z1T1hBZGo2aFYrU0V4dDJTYjFxaHZlNHFmUUI1cXd3dTNJQkRCTUZSbVZXUS9peDhPczlveGNHMWdsa1ZIaHdjWUVBbXVETEk0M3NNRmhZMEEyM0lXQTJOREtiZW9ZV2lVMHhIVVhkWWd5UFk1KzBZYVpwUjlQK3phb2c3eUJyVVlzN1FVMTFjWVBSUTBNWEFweDNQTTIwalRnaDMzSDJUakZBMzNFN280UmlBYjdObmhqUTdJMmpzSzNZWGVIcUswOWZoeHFhZUI2bXNBUnordWVMOFJHY29nK1RJSXlPUFVCK3NzMElhTXZwa1dqNnZ0N0w1RzFBZEV3dXIybEs0Y2ZCR2wwOWtRTXhjUjFuQTJ3VEl4dGQ0aUdzVTJiWHNVZ0lPbXhOVFpsSHVhcUN2RmdqYytFNjRxK1ZMd1duK0hUd1BCVThSb3c3eExqUzU5M0N4UThmOW8rWlZrSE9kOXBxT05CREhWcDM1Z3NHSUo4R2NQMDd6MjZlZytPOElBSS9wTWtBQUdSQklkb3N3bndVTmQvRW1LUXJKTzd5SGR5MTlTZVhQd2crdGxzWEZuY0NRWGpxRStDUVkwd1RGYkdlL0JuWklIZWpqend4YmFqblhPcFpRdEI0ZktnNzZsdGxXdGl3V25TakNrSWhscTRTSzB4QVh5SkczUEIzUlFJc0tEY0tNUXkxM1cvU2o5d2QxVnAxMkRxZ09XcHJOQVhvek9mRmd2aU9FNm4rQjBsYTIrWTlwNzZQL0JqUkllSUo1TVR3SmMyT1VPa2tJQkFLQ28wN0RYWTRUai9oWDRaeXpWRFg1eXk3WDIwbVZpY3duQlVnbzZIcUVvSTJQN2xWQUlSaWFnbEVJb0tkYzV1OXFmUTlPRmJHd2dMWjJwSy81MFdDYTVVYUZYUXhJUlQ5TUZScXVSdkx3b3hEdDhGMDBIUWlZQXBYMENkbUtJc0tSSVk4N3p5VmJKU1dGRDRING5MWDFOMlpmclhYV2U1MUpZaXIzNCtReGltQ2pSQkFqRkJCUnFuOStNc0VuUjlpb2FoSmpwSUxIcExKYjZQQUFLRklKRFhGNnNRY0ZESTRoRmc2NFZXMEplcFkzZnpQN0pndWxsbzZMcUxab1oxOFQxNnoyZWpjS2k5SnYxeHlueXpYV0FMb2ZZWlNqTjhIN3pTNXhjb0R4YUpVL3djZjk1Si95Ym9IcXdJSm9KZ0NvSC9EM1krcjcrNVEwQ3RBQUFBQUVsRlRrU3VRbUNDIi8+CjwvZGVmcz4KPC9zdmc+",u="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItNiAtNiAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxNiIgZmlsbD0iI0UxREZERCIvPjxwYXRoIGZpbGw9IiM2MDVlNWMiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",p="data:image/png;base64,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",g="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ1IDQ1Ij4KPHBhdGggZmlsbD0iI2E3MjAzNyIgc3Ryb2tlPSIjZmZmIiBkPSJNMjIuNSw0NC41YzEyLjE1LDAsMjItOS44NSwyMi0yMlMzNC42NSwuNSwyMi41LC41LC41LDEwLjM1LC41LDIyLjVzOS44NSwyMiwyMiwyMloiLz4KPHBhdGggY2xhc3M9ImNscy0zIiBkPSJNMjAuOTMsMzAuNDJsMy41Ni0xLjUxYy4xMywuODgtLjM0LDEuNzctMS4yLDIuMTQtLjg2LC4zNi0xLjgzLC4wOC0yLjM3LS42MlptNS40My0xNy44M2MyLjA5LDEuMTQsMy42NSwyLjYsNC42OCw0LjM5LDEuMDMsMS43OCwxLjUxLDMuODcsMS40Niw2LjI1LDAsLjQxLS4zNSwuNzQtLjc3LC43My0uNDEsMC0uNzQtLjM1LS43My0uNzcsLjA1LTIuMTEtLjM3LTMuOTMtMS4yNi01LjQ2LS44OS0xLjU0LTIuMjUtMi44MS00LjEtMy44Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWm0tOS4xNSw0LjQyYzIuODYtMS4yNyw2LjItLjA3LDcuNiwyLjc1bC4xLC4yMSwxLjI5LDIuODksMS43LDEuNDdjLjA5LC4wOCwuMTcsLjE3LC4yNywuMzJsLjA2LC4xMWMuMjgsLjYzLDAsMS4zNy0uNjQsMS42NWwtMTAuMzMsNC41N2MtLjE2LC4wNy0uMzMsLjExLS41MSwuMTEtLjY5LDAtMS4yNS0uNTYtMS4yNS0xLjI1di0yLjM0cy0xLjI0LTIuNzktMS4yNC0yLjc5Yy0xLjMxLTIuOTUsMC02LjM5LDIuOTUtNy43Wm0tMS41OCw3LjA5bDEuMzcsMy4wOHYyLjI4czkuNjItNC4yNiw5LjYyLTQuMjZsLTEuNjUtMS40My0xLjQyLTMuMTgtLjA4LS4xOGMtMS4wMy0yLjA4LTMuNTEtMi45Ny01LjY0LTIuMDMtMi4xOSwuOTctMy4xNywzLjUyLTIuMTksNS43MlptMTAuNS03LjkxYy45NywuNTMsMS43NCwxLjI5LDIuMzIsMi4yOSwuNTcsLjk5LC44NSwyLjA1LC44MiwzLjE1LS4wMSwuNDEtLjM1LC43NC0uNzcsLjczLS40MS0uMDEtLjc0LS4zNS0uNzMtLjc3LC4wMi0uODItLjE5LTEuNi0uNjItMi4zNi0uNDQtLjc2LTEuMDEtMS4zMy0xLjc0LTEuNzItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1oiLz4KPHBhdGggZmlsbD0iI2ZmZiIgZD0iTTIwLjkzLDMwLjQybDMuNTYtMS41MWMuMTMsLjg4LS4zNCwxLjc3LTEuMiwyLjE0LS44NiwuMzYtMS44MywuMDgtMi4zNy0uNjJabTUuNDMtMTcuODNjMi4wOSwxLjE0LDMuNjUsMi42LDQuNjgsNC4zOSwxLjAzLDEuNzgsMS41MSwzLjg3LDEuNDYsNi4yNSwwLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLDAtLjc0LS4zNS0uNzMtLjc3LC4wNS0yLjExLS4zNy0zLjkzLTEuMjYtNS40Ni0uODktMS41NC0yLjI1LTIuODEtNC4xLTMuODItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1ptLTkuMTUsNC40MmMyLjg2LTEuMjcsNi4yLS4wNyw3LjYsMi43NWwuMSwuMjEsMS4yOSwyLjg5LDEuNywxLjQ3Yy4wOSwuMDgsLjE3LC4xNywuMjcsLjMybC4wNiwuMTFjLjI4LC42MywwLDEuMzctLjY0LDEuNjVsLTEwLjMzLDQuNTdjLS4xNiwuMDctLjMzLC4xMS0uNTEsLjExLS42OSwwLTEuMjUtLjU2LTEuMjUtMS4yNXYtMi4zNHMtMS4yNC0yLjc5LTEuMjQtMi43OWMtMS4zMS0yLjk1LDAtNi4zOSwyLjk1LTcuN1ptOC45MS0uODJjLjk3LC41MywxLjc0LDEuMjksMi4zMiwyLjI5LC41NywuOTksLjg1LDIuMDUsLjgyLDMuMTUtLjAxLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLS4wMS0uNzQtLjM1LS43My0uNzcsLjAyLS44Mi0uMTktMS42LS42Mi0yLjM2LS40NC0uNzYtMS4wMS0xLjMzLTEuNzQtMS43Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWiIvPgo8L3N2Zz4=",m="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAyMCI+DQogIDxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZhZWNlYiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMi44NTM1NSAyLjE0NjQ2QzIuNjU4MjkgMS45NTEyIDIuMzQxNzEgMS45NTEyIDIuMTQ2NDUgMi4xNDY0NkMxLjk1MTE4IDIuMzQxNzIgMS45NTExOCAyLjY1ODMxIDIuMTQ2NDUgMi44NTM1N0wyLjkwOTM0IDMuNjE2NDZDMi4zNTI3MiA0LjA4NzA1IDIgNC43ODU3OSAyIDUuNTY1ODJWMTIuMjc2NEMyIDEzLjY5MzUgMy4xNjQwNiAxNC44NDIzIDQuNiAxNC44NDIzSDUuMTk5MzdMNS4yIDE3LjAxMzNDNS4yIDE3LjIyNjIgNS4yNjk4OSAxNy40MzM1IDUuMzk5MjEgMTcuNjA0MkM1LjczIDE4LjA0MDYgNi4zNTY2OCAxOC4xMjk4IDYuNzk4OTUgMTcuODAzNEwxMC44MSAxNC44NDIzSDE0LjEzNTFMMTcuMTQ2NCAxNy44NTM2QzE3LjM0MTcgMTguMDQ4OCAxNy42NTgzIDE4LjA0ODggMTcuODUzNiAxNy44NTM2QzE4LjA0ODggMTcuNjU4MyAxOC4wNDg4IDE3LjM0MTcgMTcuODUzNiAxNy4xNDY1TDE1LjU0NTQgMTQuODM4M0MxNS41NDU0IDE0LjgzODMgMTUuNTQ1NCAxNC44MzgzIDE1LjU0NTQgMTQuODM4M0wzLjgyMzUgMy4xMTYzOEMzLjgyMzUgMy4xMTYzOCAzLjgyMzUxIDMuMTE2MzggMy44MjM1IDMuMTE2MzhMMi44NTM1NSAyLjE0NjQ2Wk0xMy4xMzUxIDEzLjg0MjNIMTAuNDgwOUw2LjIwNTAyIDE2Ljk5ODhMNi4yMDM0NiAxNi45OTk3TDYuMiAxN0w2LjE5OTA4IDEzLjg0MjNINC42QzMuNzAzODMgMTMuODQyMyAzIDEzLjEyODggMyAxMi4yNzY0VjUuNTY1ODJDMyA1LjA2NzE0IDMuMjQwOTMgNC42MTU5OSAzLjYyMDM0IDQuMzI3NDZMMTMuMTM1MSAxMy44NDIzWiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMTcgMTIuMjc2NEMxNyAxMi45NjU4IDE2LjUzOTYgMTMuNTY0NCAxNS44ODk0IDEzLjc2OEwxNi42NDg4IDE0LjUyNzVDMTcuNDU0MSAxNC4wOTE1IDE4IDEzLjI0NjkgMTggMTIuMjc2NFY1LjU2NTgyQzE4IDQuMTQ4NzYgMTYuODM1OSAzIDE1LjQgM0g1LjEyMTM0TDYuMTIxMzQgNEgxNS40QzE2LjI5NjIgNCAxNyA0LjcxMzQ4IDE3IDUuNTY1ODJWMTIuMjc2NFoiLz4NCjwvc3ZnPg0K",h="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTIiIGhlaWdodD0iNTIiIHZpZXdCb3g9IjAgMCA1MiA1MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yNiA1MC45NkMzOS43ODUgNTAuOTYgNTAuOTYgMzkuNzg1IDUwLjk2IDI2QzUwLjk2IDEyLjIxNSAzOS43ODUgMS4wNCAyNiAxLjA0QzEyLjIxNSAxLjA0IDEuMDQgMTIuMjE1IDEuMDQgMjZDMS4wNCAzOS43ODUgMTIuMjE1IDUwLjk2IDI2IDUwLjk2WiIgZmlsbD0iI0ZERjZGMyIgc3Ryb2tlPSIjRjRCRkFCIiBzdHJva2Utd2lkdGg9IjEuOTIiLz4NCjxwYXRoIGQ9Ik0yMy40OTk0IDE1Ljk0NTdDMjQuNTY1NyAxNC4wMTgxIDI3LjMzNjcgMTQuMDE4MSAyOC40MDMgMTUuOTQ1NkwzOC4wNDg4IDMzLjM4MTdDMzkuMDgxOSAzNS4yNDkyIDM3LjczMTMgMzcuNTQgMzUuNTk3MSAzNy41NEgxNi4zMDZDMTQuMTcxOCAzNy41NCAxMi44MjExIDM1LjI0OTMgMTMuODU0MSAzMy4zODE4TDIzLjQ5OTQgMTUuOTQ1N1pNMjcuMTk1IDMyLjU2MDVDMjcuMTk1IDMxLjg3MzcgMjYuNjM4MiAzMS4zMTY5IDI1Ljk1MTQgMzEuMzE2OUMyNS4yNjQ2IDMxLjMxNjkgMjQuNzA3OCAzMS44NzM3IDI0LjcwNzggMzIuNTYwNUMyNC43MDc4IDMzLjI0NzMgMjUuMjY0NiAzMy44MDQxIDI1Ljk1MTQgMzMuODA0MUMyNi42MzgyIDMzLjgwNDEgMjcuMTk1IDMzLjI0NzMgMjcuMTk1IDMyLjU2MDVaTTI2Ljg3MjMgMjIuNzgwOEMyNi44MTAxIDIyLjMyNSAyNi40MTkgMjEuOTczOSAyNS45NDYyIDIxLjk3NDNDMjUuNDMwMyAyMS45NzQ3IDI1LjAxMjUgMjIuMzkzMiAyNS4wMTI5IDIyLjkwOUwyNS4wMTc0IDI4LjUxNDlMMjUuMDI2IDI4LjY0MTZDMjUuMDg4MyAyOS4wOTc0IDI1LjQ3OTMgMjkuNDQ4NSAyNS45NTIxIDI5LjQ0ODFDMjYuNDY4IDI5LjQ0NzcgMjYuODg1OCAyOS4wMjkyIDI2Ljg4NTQgMjguNTEzNEwyNi44ODA5IDIyLjkwNzVMMjYuODcyMyAyMi43ODA4WiIgZmlsbD0iI0RBM0IwMSIvPg0KPC9zdmc+",I="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiNmZmZmZmYiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGQ9Ik03IDExYTEgMSAwIDEgMCAwLTIgMSAxIDAgMCAwIDAgMlptMSAyYTEgMSAwIDEgMS0yIDAgMSAxIDAgMCAxIDIgMFptMi0yYTEgMSAwIDEgMCAwLTIgMSAxIDAgMCAwIDAgMlptMSAyYTEgMSAwIDEgMS0yIDAgMSAxIDAgMCAxIDIgMFptMi0yYTEgMSAwIDEgMCAwLTIgMSAxIDAgMCAwIDAgMlptNC01LjVBMi41IDIuNSAwIDAgMCAxNC41IDNoLTlBMi41IDIuNSAwIDAgMCAzIDUuNXY5QTIuNSAyLjUgMCAwIDAgNS41IDE3aDlhMi41IDIuNSAwIDAgMCAyLjUtMi41di05Wk00IDdoMTJ2Ny41YzAgLjgzLS42NyAxLjUtMS41IDEuNWgtOUExLjUgMS41IDAgMCAxIDQgMTQuNVY3Wm0xLjUtM2g5Yy44MyAwIDEuNS42NyAxLjUgMS41VjZINHYtLjVDNCA0LjY3IDQuNjcgNCA1LjUgNFoiIGZpbGw9IiM1YjVmYzciPjwvcGF0aD48L3N2Zz4="},925067:(e,t,n)=>{"use strict";n.d(t,{kv:()=>c,kk:()=>u,Ul:()=>p,_Z:()=>h,y9:()=>I});var i=n(480354),r=n(73466),a=n(73087),s=n(969013),o=n(379708),l=n(232062),d=n(147546);const c="beta/users/defaultProfilePictureV2?displayName={displayName}",u=3,p={profilePictureType:o.It.User,generateUrl(e,t,n,i,r=o.xi.Small,a,l,u,p,h,I,M,f){if(a)return d.GX;if((0,s.Ku)(e.id)&&!I)return d.Yt;let A="";const T=p&&!h&&e.id?e.id.split("|")[0]:e.id,N=T&&T.indexOf("#")>=0?encodeURIComponent(T):T,y=e.displayName?encodeURIComponent(e.displayName):"";return A=""===e.id||I?c.replace("{displayName}",y):h?m(y,N,l,u,n,i):g(y,N,n,i),A=`${A}&size=${r}`,M&&f&&!I&&(A=`${A}&ETag=${f}`),`${t}${A}`},getPresenceUserId:e=>e.id},g=(e,t,n,r)=>{let a="";return a=n&&r&&!(0,i.isEmpty)(r)?"beta/users/{currentUserObjectId}/profilepicturev2/{id}?displayname={displayname}".replace("{currentUserObjectId}",r).replace("{id}",t).replace("{displayname}",e):"beta/users/{id}/profilepicturev2?displayname={displayname}".replace("{id}",t).replace("{displayname}",e),a},m=(e,t,n,r,a,s)=>{let o="";return o=a&&s&&!(0,i.isEmpty)(s)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}".replace("{currentUserObjectId}",s):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}",n&&r?o=o.replace("{id}",t).replace("{displayName}",e).replace("{conversationId}",n||"").replace("{hostTenantId}",r||""):(o=a&&s&&!(0,i.isEmpty)(s)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}".replace("{currentUserObjectId}",s):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}",o=o.replace("{id}",t).replace("{displayName}",e)),o},h={profilePictureType:o.It.Group,generateUrl(e,t,n,a,s=o.xi.Small){let c="";const p=(e.length>u?e.slice(0,u):e).map((e=>({userId:e.id,displayName:e.displayName}))),g=(e=>{if(1===e.length){const t=e[0].id;if(t===r.j8)return{shouldUseProjectGroupImage:!0,shouldUseDefaultGroupImage:!1};if(t===r.i2)return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!0}}return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!1}})(e);let{shouldUseDefaultGroupImage:m}=g;const{shouldUseProjectGroupImage:h}=g;if(m=!!h||(0,l.oz)(p),m||(0,i.isEmpty)(p))return d.Mz;if(h)return d.$M;c=encodeURIComponent(JSON.stringify(p));let I="";return I=n&&a&&!(0,i.isEmpty)(a)?"beta/users/{currentUserObjectId}/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{currentUserObjectId}",a).replace("{usersArray}",c).replace("{size}",s):"beta/users/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{usersArray}",c).replace("{size}",s),`${t}${I}`},getPresenceUserId(){}},I={profilePictureType:o.It.Team,generateUrl(e,t,n,i){const{displayName:r,groupId:s,pictureETag:o}=e;return(0,a.UB)(t,r,o||"",s,n,i)},getPresenceUserId(){}}},296381:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("query msaGroupProfilePicture($msaGroupInfo:MsaGroupProfilePictureInput!,$callerInfo:String) {msaGroupProfilePicture(msaGroupInfo:$msaGroupInfo,callerInfo:$callerInfo)}");return delete this.definitions,this.definitions=e.definitions}}},853959:(e,t,n)=>{"use strict";n.d(t,{T:()=>k,g:()=>w});var i=n(823013),r=n.n(i),a=n(480354),s=n(513432),o=n(550497),l=n(755029),d=n(832669),c=n(347590),u=n(944297),p=n(912146),g=n(379708),m=n(232062),h=n(67309);const I={kind:"Document",get definitions(){const e=(0,h.G)("query ComponentsAvatarChatAvatarUrlQuery($convId:ID!) {chat(convId:$convId) {id,avatarUrl}}");return delete this.definitions,this.definitions=e.definitions}},M={kind:"Document",get definitions(){const e=(0,h.G)("query ComponentsAvatarChatTypeQuery($convId:ID!) {chat(convId:$convId) {id,picture,chatType,isOneOnOne}}");return delete this.definitions,this.definitions=e.definitions}},f={kind:"Document",get definitions(){const e=(0,h.G)("query ComponentsAvatarCommunityProfilePictureQuery($threadId:ID!,$imageUri:String) {community(threadId:$threadId) {id,profilePictureUrl(imageUri:$imageUri)}}");return delete this.definitions,this.definitions=e.definitions}},A={kind:"Document",get definitions(){const e=(0,h.G)("query ComponentsAvatarGetUsersQuery($mriOrEmailArray:[ID!]!,$isMailAddress:Boolean) {getUsers(mriOrEmailArray:$mriOrEmailArray,isMailAddress:$isMailAddress) {id,mri,avatarUrl}}");return delete this.definitions,this.definitions=e.definitions}},T={kind:"Document",get definitions(){const e=(0,h.G)("query ComponentsAvatarIsSharedChannelQuery($convId:ID!) {channelByID(conversationId:$convId) {id,isShared,substrateGroupId}}");return delete this.definitions,this.definitions=e.definitions}},N={kind:"Document",get definitions(){const e=(0,h.G)("query ComponentsAvatarUrlPreviewQuery($url:String!) {urlPreview(url:$url) {url,thumbnail}}");return delete this.definitions,this.definitions=e.definitions}},y={kind:"Document",get definitions(){const e=(0,h.G)("query connectorProfile($convId:String!,$integrationId:String!) {connectorProfile(convId:$convId,integrationId:$integrationId) {avatarUrl}}");return delete this.definitions,this.definitions=e.definitions}},C={kind:"Document",get definitions(){const e=(0,h.G)("query isTenantVerifiedDomain($domain:String!) {isTenantVerifiedDomain(domain:$domain)}");return delete this.definitions,this.definitions=e.definitions}};var S=n(296381);const b={kind:"Document",get definitions(){const e=(0,h.G)("query msaUserProfilePicture($userId:ID!,$displayName:String,$imageUri:String,$profilePictureSize:String,$callerInfo:String,$renderInitials:Boolean) {msaUserProfilePicture(userId:$userId,displayName:$displayName,imageUri:$imageUri,profilePictureSize:$profilePictureSize,callerInfo:$callerInfo,renderInitials:$renderInitials)}");return delete this.definitions,this.definitions=e.definitions}},D={kind:"Document",get definitions(){const e=(0,h.G)("query user($userId:ID!) {user(userId:$userId) {id,avatarUrl,imageUri,selfAvatarLastupdatedTime}}");return delete this.definitions,this.definitions=e.definitions}};var E=n(675190),U=n(147546);const w=(e,t="avatar-container-hook")=>{const{profilePictureType:n,defaultAvatarUrl:i}=v(e);return L(e,n,t)||i},v=e=>{const{userId:t,conversationId:n,teamId:i,enableMSAProfilePicture:r,showMergedAvatarForGroup:a,isTeamsApp:s,isUnresolvedEmail:o,sharedChannelId:d,entity:c,isEmergencyCallTarget:u}=e,{coreSettings:p}=(0,l.ur)(),g=(0,m.EO)(t,n,i,r,a||!1,s,o,d,c,p);return{profilePictureType:g,defaultAvatarUrl:(0,m.Ng)(g,u)}},L=(e,t,n)=>{const{skipGeneratingUrl:i}=e,[r,a]=s.useState(""),o=s.useRef(!1);return s.useEffect((()=>(o.current=!0,()=>{o.current=!1})),[]),s.useEffect((()=>{if(i)return;(async()=>{const i=await k(e,t,n);o.current&&i&&a(i)})()}),[e,t,n,i]),r},k=async(e,t,n)=>{const{baseImageUrl:i,isEmergencyCallTarget:s,isImageAuthCookieValid:o,enableCachedAvatarCheck:l,isAnonymousAccount:d,enableSampleAvatarFetch:c,enableAvatarUrlQuery:u,profilePictureSize:p,i18n:h}=e,I=(0,m.Ng)(t,s);let M;if(e.avatarUrl?M=(0,m.eB)(e.avatarUrl,p,t===g.It.User):u&&(M=await Y(e,t,n)),e.enableFBSTelemetryForAvatarStatus&&e.scenarioFactory&&((0,a.isEmpty)(i)||!o)){const t={callerInfo:n,skipGeneratingUrl:!!e.skipGeneratingUrl,propsAvatarUrl:e.avatarUrl,cachedUrl:void 0,generatedUrl:I,baseImageUrl:(0,a.isEmpty)(i)?"INVALID":i,isCookieValid:!!o,profilePictureType:e.generator.profilePictureType,isSelfProfileAvatar:!!e.isSelfProfileAvatar,forSharedChannel:!!e.isSharedChannel,isXtapUserUrl:!1,logger:e.logger,scenarioFactory:e.scenarioFactory};(0,m.Qc)(t)}if((0,a.isEmpty)(M)||M&&(0,m.vG)(M,h)){if((0,a.isEmpty)(i))return I;M=await x(e,t,n)}if(!M)return I;if(o||d||t===g.It.Initials)return o&&((e,t,n)=>{e&&r()(t,{method:"GET",credentials:"include",headers:{"x-ms-client-caller":n}}).catch((()=>{}))})(!!c,M,n),M;if(l){if(await(0,m.iU)(M))return M}return I},x=async(e,t,n)=>{const{userId:i,conversationId:r,entity:a,client:s,logger:o,profilePictureSize:l,isSelfProfileAvatar:d,showUpdatedGroupAvatar:c,enableConnectorsProfileInChannels:u,onBehalfOfId:p,scenarioFactory:m,isTflUser:h}=e;let I;switch(t){case g.It.VoiceApp:I=U.S2;case g.It.Communities:I=await Q(a,s,o,c);break;case g.It.Connector:const t=await _(s,r,i,o,u);I=t?.data?.connectorProfile?.avatarUrl;break;case g.It.OutgoingWebhook:I=await W(s,r,o,p,m);break;case g.It.App:case g.It.Bot:I=await G(s,i,o,n,r,e.botListWithAppDefinitionName,h);break;case g.It.MsaUser:case g.It.MsaGroup:I=await j(i,r,l||g.xi.Small,a,s,o,n,d,c);break;case g.It.User:case g.It.Group:case g.It.Team:case g.It.SharedChannelInviteeTeam:I=await F(e,s,n);break;case g.It.MergedGroup:I=await V(e);break;case g.It.Initials:I=await B(e)}return I},F=async(e,t,n)=>{const{entity:i,profilePictureSize:r,isEmergencyCallTarget:a,generator:s,baseImageUrl:o,logger:l,isSelfProfileAvatar:d,avatarEtag:c}=e;let u,p=c;const{conversationId:g}=e;if(!Array.isArray(i)){const e=i;u=e.upn,e&&!e.displayName&&l.warn(`Avatar without display name, callerInfo: ${n}`)}if(e.isSharedChannel&&g){const{data:i}=await t.query({query:T,variables:{convId:g},context:{callerInfo:"avatar-url-shared-channel"}});if(i?.channelByID?.substrateGroupId||i?.channelByID?.isShared)return O(u,e,t,n)}if(d&&!p){const e=i,r=await t.query({query:D,variables:{userId:e.id},context:{callerInfo:n}});r?.data?.user?.selfAvatarLastupdatedTime&&(p=r?.data?.user?.selfAvatarLastupdatedTime)}return s.generateUrl(i,o||"",!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,r,a,void 0,void 0,void 0,void 0,void 0,d,p)},O=async(e,t,n,i)=>{const{entity:r,profilePictureSize:a,isEmergencyCallTarget:s,generator:o,baseImageUrl:l,logger:d}=t;if(e){const i=!await P(n,e);return o.generateUrl(r,l||"",!!t.isProfilePictureWithObjectIdEnabled,t.currentUserOid,a,s,t.conversationId,t.hostTenantId,!0,i,void 0)}return d.warn(`Avatar: upn not provided for sharedChannel, callerInfo: ${i}`),o.generateUrl(r,l||"",!!t.isProfilePictureWithObjectIdEnabled,t.currentUserOid,a,s,t.conversationId,t.hostTenantId,!0,!0,void 0)},P=async(e,t)=>{const n=t.substring(t.indexOf("@")+1);try{const{data:t}=await e.query({query:C,variables:{domain:n}});return t&&t.isTenantVerifiedDomain}catch{return!1}},j=async(e,t,n,i,r,a,s,o=!1,l=!1)=>{const d=(0,c.Fz)(t);let u;if(e&&t&&Array.isArray(i)||d){const{data:e}=await r.query({query:M,variables:{convId:t},context:{callerInfo:"get-msa-avatar-url"}});if(d&&e?.chat?.picture)return e.chat.picture;u="Chat"===e?.chat?.chatType&&!e?.chat?.isOneOnOne}if(e&&!u){const t=await R(r,e,i.displayName,n,a,s,o);return t?.data?.msaUserProfilePicture}if(t){const e=[],n=i;Array.isArray(n)&&n.forEach((t=>{e.push({userId:t.id,displayName:t.displayName?t.displayName:""})}));const s=await z(r,t,e,a,l);return s?.data?.msaGroupProfilePicture}},R=async(e,t,n,i,r,a,s,o)=>{try{return await e.query({query:b,variables:{userId:t,displayName:n,callerInfo:"avatar-container",profilePictureSize:i,renderInitials:o},fetchPolicy:s?"network-only":"cache-first"})}catch(e){return void r.errorToTelemetry?.(`msaUserProfilePictureQuery failed for msa user: ${e.message}, callerInfo: ${a}`,"msa_user_profile_picture_query",void 0,!0)}},z=async(e,t,n,i,r)=>{n.forEach((e=>{e&&(0,a.isEmpty)(e.displayName)&&t&&i.warn(`Avatar without display name for conversationId: ${t}`)}));try{const i={conversationId:t,pictureReadyUsers:n};return await e.query({query:S.J,variables:{msaGroupInfo:i,callerInfo:"avatar-container"},fetchPolicy:r?"network-only":"cache-first"})}catch{return void i.error(`msaGroupProfilePictureQuery failed for conversationId:  ${t}`)}},B=async e=>{const{entity:t,profilePictureSize:n,isEmergencyCallTarget:i,generator:r,baseImageUrl:a}=e;return r.generateUrl(t,a,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,n,i,void 0,void 0,!1,!1,!0)},V=async e=>{const{entity:t,profilePictureSize:n,isEmergencyCallTarget:i,generator:r,baseImageUrl:a}=e;return r.generateUrl(t,a,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,n,i,void 0,void 0,!1,!1,!0)},_=async(e,t,n,i,r)=>{try{if(r&&t&&n){return await e.query({query:y,variables:{convId:t,integrationId:n}})}return}catch(e){return void i.error(`connectors query failed for conversationId: ${t}`)}},W=async(e,t,n,i,r)=>{if(r&&i&&t)try{const a=await(0,d.DW)(e,t);return(await(0,o.tN)(e,n,r,i,!0,"outgoing-webhook-avatar-url",{conversation:{scope:"Team",id:a||""}}))[0].definition.largeImageUrl}catch(e){n.error(`installed apps query failed for conversationId: ${t}`)}},Q=async(e,t,n,i)=>{const r=e.teamThreadId||"",a=e.pictureETag;if(a)try{const e=await t.query({query:f,variables:{threadId:r,imageUri:a},fetchPolicy:i?"network-only":"cache-first"});return e?.data?.community?.profilePictureUrl}catch(e){return void n.errorToTelemetry?.(`community profile picture query failed for this : ${r}`,"community_profile_picture_query_failed")}else n.infoToTelemetry?.(`getCommunitiesAvatarUrl function returned undefined for this threadId : ${r}, and imageUri: ${a}`,"get_communities_avatar_url_returned_undefined",void 0,!0)},Y=async(e,t,n)=>{const{client:i,profilePictureSize:r}=e;if(t===g.It.User&&e.userId){const{data:t}=await i.query({query:A,variables:{mriOrEmailArray:[e.userId]},context:{callerInfo:n}});return(0,m.eB)(t.getUsers?.[0].avatarUrl,r,!0)}if(t===g.It.Group&&e.conversationId){const{data:t}=await i.query({query:I,variables:{convId:e.conversationId},context:{callerInfo:n}});return t.chat?.avatarUrl}},G=async(e,t,n,i,r,a,s)=>{let o;if(t&&(0,m.Iz)(t)&&a?.includes(t)){const n=await(0,E.kV)(e,t,r,"GroupChat","useAvatarUrl-getBotAvatarUrl");n&&(o=n?.largeImageUrl)}else{const r=await(async(e,t,n,i)=>{try{return await e.query({query:D,variables:{userId:t},context:{callerInfo:i}})}catch(e){return void n.error(`userQuery failed: ${e.message}`)}})(e,t,n,i);o=r?.data?.user?.avatarUrl||r?.data?.user?.imageUri}if(o){if(((e,t)=>{let n;try{n=new URL(e)}catch{n=null}return!(e.startsWith("blob:")||e.startsWith("data:")||(0,u.D$)(e)||(0,p.d$)(e,"")||n?.hostname.endsWith("teams.core.microsoft")||t&&n?.hostname.includes("urlp.asm.skype.com")&&n?.pathname.includes("/v1/url/content"))})(o,s)){const t=await e.query({query:N,variables:{url:o},context:{callerInfo:i}});return t?.data.urlPreview?.thumbnail}return o}}},649728:(e,t,n)=>{"use strict";n.d(t,{A:()=>N});var i=n(67309),r=n(160606),a=n(969037),s=n(410703),o=n(983168),l=n(741357),d=n(264345),c=n(875094),u=n(930427),p=n(69886),g=n(819972),m=n(733043),h=n(366554),I=n(731687),M=n(358809),f=n(540281),A=n(2986),T=n(239082);const N={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatQueriesChatQuery($convId:ID!) {chat(convId:$convId) {id,title,shortTitle,themeId,picture,isBotBlocked,isOneOnOne,isOneOnOneBotChat,isDisabled,disabledReason {code,newlyCreatedUserId},meetingChatPolicy,chatSubType,chatType,isSfB @client,isMeeting @client,isOneOnOne,isMuted,isFederated @client,isChannel,isHidden,isRead,isRetentionHorizonSet,isModerator,replyPermission,isAdmin,isUserAnonymous,substrateGroupId,lastMessage {...lastMessageFields},me {...userFields},consumptionHorizon {...consumptionHorizonFields},consumptionHorizonBookmark {...consumptionHorizonBookmarkFields},userConsumptionHorizon {...consumptionHorizonBookmarkFields},memberIds,membersLimited {...userFields},memberDisplayNamesLimited,oneOnOneChatHeaderCallButtonValue,hasFederatedUser,hasTflConsumerUser,cfet,hasEnterpriseUser,hasUnknownConsumerUser,hasUnknownEnterpriseUser,hasUnresolvedFederatedUser,isImpersonation,hasImpersonation,isDeletedOrDead,hasTflSmsUnverifiedUser,hasTflSmsVerifiedUser,nonTeamsFederatedUserLimitedNames,nonTeamsFederatedUsersLength,isPrivateChatPolicyDefinedScenario,isChatDisabledForRecipients,guardianChatInfo,isInQuarantine,quarantineCounter,tflOffNetworkUser {...userFields},tflOffNetworkUserLength,hasBotMember,isUserMember,botMembers {id},userAdminSettings {adminDeleteEnabled,deleteMessagesEnabled},creator,meetingInformation {id,meetingType,startTime,endTime,meetingData {meetingCode,passcode,meetingUrl},iCalUid,resolvedSensitivityLabelId,isCopyRestrictionEnforced,tenantId,organizerId,meetingJoinUrl,scenario,eventType,isCancelled,...DataFragmentsCommonRecordingMessageMiFragment,messagingPolicy {textOnlyChat},templateDetails {id}},tenantId,chatDisabledContext @client {isUIDisabled,disabledReason,extendedData,lastUpdatedTime},interopConversationStatus,extendedDirectoryRedemptionRequired,hasExtendedDirectoryUsers,chatScheduleSuggestionSuppressUntil,chatHistoryHiddenTime,clearHistoryTime,userProperties {...userProperties},pinnedConversationItems {... on Message {...pinnedMessageItemFields}},addedBy,addedByTenantId,identityMaskEnabled,sensitivityLabel {id,isCopyBlocked},createdAt,lastJoinAt,isCommentStream,isCommentStreamMeetingStarted,isConversationThreadDeleted,avatarUrl,meetingChatType,...DataFragmentsCommonUseExternalTagFragment,...DataFragmentsCommonChatMtoTelemetryFragment,...DataFragmentsCommonChatWithMtoUserBannerFragment,...DataFragmentsCommonChatRecapFragment,...DataFragmentsCommonUseMtoUserBannerFragment,...DataFragmentsCommonChatPaneLayoutFragment,...DataFragmentsCommonChatAddMembersFragment,...DataFragmentsCommonChatSmartCardInfoFragment @nonreactive,awarenessLiveState {key,value},groupCopilotInfo {id,allowInstallation,allowInteraction},notes {id,isSynthesisAvailable,showConvergedUx},pendingBots,isConversationalUXEnabled,isChatPartialHistoryShared,anyMemberHasPartialHistoryAccess,meetingChatType,showRedDot,activeCall {...DataFragmentsCommonActiveCallFragment},isSkypeModeratedConversation,isSkypeConversation,pinnedMessages(pinnedMessageCallerSource:PINNED_MESSAGE_BANNER,first:1) {id,edges {cursor,node {id,...DataFragmentsCommonChatPinnedMessageFragment}}}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.L.definitions,...a.x.definitions,...s.U.definitions,...o.q.definitions,...l.x.definitions,...d.p.definitions,...c.M.definitions,...u.n.definitions,...p.Y.definitions,...g.I.definitions,...m.W.definitions,...h.P.definitions,...I.F.definitions,...M.h.definitions,...f._.definitions,...A.n.definitions,...T.Y.definitions]}}},898307:(e,t,n)=>{"use strict";n.d(t,{DW:()=>r,bE:()=>a,XF:()=>s,Yp:()=>o,u0:()=>l,gL:()=>d});var i=n(547697);const r=()=>(0,i.h)("amsV2Domain")||"",a=()=>(0,i.h)("baseImageUrl")||"",s=()=>(0,i.h)("isImageAuthCookieValid")||!1,o=()=>(0,i.h)("postCriticalPhaseReached")||!1,l=()=>(0,i.h)("completePhaseReached")||!1,d=()=>(0,i.h)("meControlAvatarSrc")||""},547697:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var i=n(513432),r=n(203774);const a=e=>{const{stateManagementServices:{userWindowStore:t}}=(0,r.C)();return s(t,e)},s=(e,t)=>{const[n,r]=(0,i.useState)(e?.get(t));return(0,i.useEffect)((()=>{const n=e?.subscribe(t,(e=>{r(e)}));return()=>n&&n()}),[e,r,t]),n}},563476:(e,t,n)=>{"use strict";n.d(t,{r$:()=>h,Os:()=>f,Dh:()=>C,wQ:()=>g,wS:()=>N,fm:()=>m,r3:()=>I,oM:()=>M});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment userProfileData on User {id,objectId,userPrincipalName,companyName,tenantName,type,userType,isFederated,xtapUser}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("query getUsersForConversation($mriArray:[ID!]!,$conversationId:String!,$isShortProfileRequested:Boolean,$callerInfo:String,$peoplePickerFilters:PeoplePickerFiltersInput,$isSharedChannel:Boolean,$hostTenantId:String) {getUsersForConversation(mriArray:$mriArray,conversationId:$conversationId,isShortProfileRequested:$isShortProfileRequested,callerInfo:$callerInfo,peoplePickerFilters:$peoplePickerFilters,isSharedChannel:$isSharedChannel,hostTenantId:$hostTenantId) {...userProfileData}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions]}};var s=n(678937),o=n(800079),l=n(189888),d=n(754255),c=n(969013);const u={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsPersonaUserTypeQuery($userId:ID!) {user(userId:$userId) {id,userType,profileType,type}}");return delete this.definitions,this.definitions=e.definitions}},p="Topic",g=e=>{const{ariaLabel:t,behavior:n,disableAccessibilityDefaults:i,externalAppSessionCorrelationId:r,hostConversationId:a,hostTenantId:s,isSharedChannel:o,tabIndex:l,userId:d,handleOnCardOpen:c,handleOnCardClose:u,personaType:g,topicId:m,contextId:h,highlightedText:I,displayName:M}=e,f=g===p?{contextId:h,highlightedText:I,hideEntityAndContextQuestion:!0}:void 0;return{cardParameters:{disableAccessibilityDefaults:!!i,personaInfo:{identifiers:{PersonaType:g||"NotResolved",HostAppPersonaId:y({userId:d,isSharedChannel:!!o,hostTenantId:s,hostConversationId:a}),TeamsMri:g!==p?d:void 0,TopicId:m},topicMetadata:f,displayName:M},behavior:{onCardOpen:c,onCardClose:u,disableHover:!1,cardPlacementMode:"AnchorSide",...n},externalAppSessionCorrelationId:r,ariaLabel:t,clientScenario:"MicrosoftTeams_MultiWindow",cardOpenTime:Date.now()},tabIndex:l}},m=(e,t,n)=>{e.LPC.openCard(t,{...g(n).cardParameters})},h=(e,t)=>{e.LPC.dismissCard((()=>{}),t)},I=e=>{e.LPC.refreshPersonInfo()},M=e=>{e.LPC.trapFocus()},f=async(e,t,n,i,r,s,l,c,u)=>{const{enableTflSms:p}=l.get(d.w.Messaging),{showPersonCardForSMSUser:g,showPersonCardForXTapUser:m}=l.get(d.w.People),{disablePstnPersonaCard:h,disablePersonaCard:I}=l.get(d.w.Calling),{enableFlyoutInlineChat:M,enableSimplifiedFeaturesInFlyoutChat:f}=l.get(d.w.Flyout);if(I||M&&f)return!1;if(e&&o.af.isTFLSmsMri(e))return!!p&&!!g;if(e&&o.af.isTFLOffNetworkUser(e))return!1;if(t&&"attendee"===n&&o.af.isAnonymousTfwUser(e))return!1;if(A(e,l))return!1;if(T(!!h,e))return!1;if(i&&!m){const t=N(e,r||"",s,u,i);if(!t)return u.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:n}=await c.query({query:a,variables:t,context:{callerInfo:"lpc-persona-container"}});if(!n||!n.getUsersForConversation)return u.warn("xTap profile Query returned null data"),!1;const l=n.getUsersForConversation,d=!!(l.length>0&&l[0]&&o.af.isFederatedUser(l[0])&&l[0].xtapUser);return!d||!!m&&d}return!0},A=(e,t)=>{const n=t.get(d.w.Metadata).environment===s.B.life,i=t.get(d.w.PhonelinkSms).enablePhonelinkSms||!1,r=t.get(d.w.HostCapabilities).phoneLinkingBlocked||!1,a=i&&!r;return e&&(0,c.Ku)(e)&&n&&a},T=(e,t)=>e&&(0,c.Ku)(t);function N(e,t,n,i,r){if(!t&&r)return void i.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:r?t:"",isShortProfileRequested:!1,peoplePickerFilters:void 0,isSharedChannel:r,hostTenantId:n}}const y=({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i})=>JSON.stringify({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i});const C=async(e,t,n)=>{const{data:i}=await n.query({query:u,variables:{userId:e},context:{callerInfo:"lpc-persona-container:on-hover"}}),{user:r}=i,{userType:a,profileType:s,type:d}=r||{},c=o.af.isMTOUser({profileType:s})?l.$o.MTOUser:o.af.isB2BMember({profileType:s,userType:a})?l.$o.B2BMember:o.af.isAcsUserMri(e)?l.$o.ACSUser:o.af.isAnonymousTfwUser(e)?l.$o.anonymousUser:a||d,p=t.createDatabag();let g;return a&&(g=o.af.getTfwExtendedDirectoryMembership({mri:e,userType:a})),p.isEDUser=!!g,p.EDUserState=g,p.userTypeSelected=c,p}},111941:(e,t,n)=>{"use strict";n.d(t,{S:()=>I});var i=n(755029),r=n(754255),a=n(937545),s=n(131647),o=n(845768),l=n(550497),d=n(418709),c=n(480354),u=n(513432),p=n(735652),g=n(883970),m=n(845097),h=n(207303);const I=()=>{const e=(0,d.m)(),{entityCommanding:t}=(0,i.ur)(),{enableAppDetailsToChatNavigation:n}=(0,p.w2)(r.w.Extensibility,["enableAppDetailsToChatNavigation"]),c=(0,h.u)();return u.useCallback((async(i,r,d)=>{const u=await(0,l.xR)(e,i,void 0,void 0,"launch-personal-app"),p=u.bots?.[0]?.id,h=f(p),{isM365BotPostInstallNavEnabled:I,navigateToM365BotChat:N}=c(i,h);if(M(u))r?I()?await N(!1):t.platform.launchPersonalPlatformApp(i,!!d):t.platform.launchPersonalApp({appId:i,botMri:h,isNewlyInstalled:!1});else if(A("Personal",u.messageExtensions)){const r=t.platform.launchAppDetailsTutorial({appName:u.name??"",isFirstInstallation:!1,hasCommandBoxCapability:T(u,"Commandbox"),hasComposeCapability:T(u,"Compose")}).subscribe({next:r=>{r.containerState&&r.containerState===a.iW.Confirmed&&(n?t.chat.default({correlation:{source:s.p.PlatformAppDetailsDialog},stateTransition:a.Ar.flush,visibilityState:a.Rp.show}).then((()=>{e.mutate({mutation:g.S,variables:{input:{appId:i,id:(0,m.v4)(),capability:o.$E.MessagingExtension}}})})):t.platform.appDetailsPostInstall({name:"navigateToLastChatState",appCapability:o.$E.MessagingExtension,appId:i,externalId:u.externalId??""}).then((()=>{e.mutate({mutation:g.S,variables:{input:{appId:i,id:(0,m.v4)(),capability:o.$E.MessagingExtension}}})})))},complete:()=>{r.unsubscribe()}})}else;}),[e,c,t.platform,n,t.chat])},M=e=>{const t=(e.meetingExtensionDefinition?.scenes?.length??0)>0,n=(e.meetingExtensionDefinition?.filters?.length??0)>0;return A("Personal",e.staticTabs)||A("Personal",e.bots)||t||n},f=e=>{if(e){const t=e?.startsWith("28:");return t?e:`28:${e}`}},A=(e,t)=>(0,c.some)(t,(t=>(0,c.includes)(t.scopes,e))),T=(e,t)=>e.messageExtensions?.some((e=>e.commands?.some((e=>e.context?e.context.some((e=>e===t)):"Commandbox"===t||"Compose"))))??!1},207303:(e,t,n)=>{"use strict";n.d(t,{u:()=>I});var i=n(513432),r=n(755029),a=n(911234),s=n(937545),o=n(131647),l=n(735652),d=n(754255),c=n(418709),u=n(155762),p=n(67309);const g={kind:"Document",get definitions(){const e=(0,p.G)("query ComponentsPlatformSharedHooksGetConversationForBotIdQuery($installedScope:AppInstallScope!,$appId:ID!,$conversationId:String) {installedApp(installedScope:$installedScope,appId:$appId,conversationId:$conversationId) {id,conversationForBot {id}}}");return delete this.definitions,this.definitions=e.definitions}},m={kind:"Document",get definitions(){const e=(0,p.G)("query ComponentsPlatformSharedHooksGetPinnedChatIdsQuery {pinnedChats {edges {node {id}}}}");return delete this.definitions,this.definitions=e.definitions}},h={kind:"Document",get definitions(){const e=(0,p.G)("mutation ComponentsPlatformSharedHooksSetChatPinnedMutation($convId:ID!,$pinned:Boolean!) {setChatPinned(convId:$convId,pinned:$pinned) {... on ConversationPinnedUpdate {convId,pinned},... on SetChatPinnedMaxLimitReachedError {maxPinnedChats}}}");return delete this.definitions,this.definitions=e.definitions}},I=()=>{const e=(0,c.m)(),{entityCommanding:t}=(0,r.ur)(),{enableM365BotPostInstallNavigation:n,m365ChatBotIds:p}=(0,l.w2)(d.w.Messaging,["enableM365BotPostInstallNavigation","m365ChatBotIds"]),[I]=(0,u.n)(h),M=(0,a.U)("useLaunchBizChatNavigation");return i.useCallback(((i,r="")=>({isM365BotPostInstallNavEnabled:()=>n&&p?.includes(r),navigateToM365BotChat:async n=>{try{const{data:r}=await e.query({query:g,variables:{appId:i,installedScope:"Personal"},fetchPolicy:"no-cache"});if(r.installedApp?.conversationForBot?.id){let a=!1;const l=r.installedApp.conversationForBot.id;try{const{data:t}=await e.query({query:m});a=!!t?.pinnedChats.edges.some((e=>e.node.id===l))}catch{M.errorToTelemetry?.("failed to get pinned chat ids for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:i,conversationId:l})}if(n&&!a)try{await I({variables:{convId:r.installedApp.conversationForBot.id,pinned:!0}})}catch{M.errorToTelemetry?.("failed to set chat pinned for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:i,conversationId:l})}await t.chat.chatById(r.installedApp.conversationForBot.id,{entityCommand:{stateTransition:s.Ar.forceFlush,visibilityState:s.Rp.show,correlation:{source:o.p.PlatformAppDetailsDialog}}})}}catch(e){throw M.errorToTelemetry?.(`failed to grab the conversation id from the installed app. appId: ${i}`,"platform_userlifecycle_details_dialog_event",{appId:i}),e}}})),[e,n,t.chat,M,p,I])}},194492:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var i=n(754255),r=n(735652),a=n(480354);const s=e=>{const{enableGetMeetingDetails:t,enableMeetingAudioAPIs:n,enableMeetingApisAccessForSideloadedApp:s,appsWithMeetingApisPermissions:o}=(0,r.w2)(i.w.Extensibility,["enableGetMeetingDetails","enableMeetingAudioAPIs","enableMeetingApisAccessForSideloadedApp","appsWithMeetingApisPermissions"]);if(e&&(t||n)){const t=e.externalId&&!e.tenantId;if(s&&t||(0,a.includes)(o,e.id))return!0}return!1}},884451:(e,t,n)=>{"use strict";n.d(t,{QA:()=>r,YT:()=>a,lb:()=>s,t2:()=>o,P3:()=>l,Lv:()=>d,dy:()=>c,TU:()=>u,u0:()=>p,Xx:()=>g});var i=n(99595);const r="com.microsoft.teamspace.tab.web",a="com.microsoft.teamspace.tab.file.staticviewer.pdf",s="com.microsoft.teams.callable-channel",o="44263ed4-f1ac-4e96-93aa-d24dd50459ea",l="b85718a3-6d15-4f59-8fad-b6809c6fc6a9",d="com.microsoft.chattabs.storyline",c="683f3525-d193-4a67-8d91-22093beab1ca",u=[i.b5.PersonalTab,i.b5.ChannelTab,i.b5.PrivateChatTab,i.b5.MeetingChatTab,i.b5.MeetingDetailsTab],p="engageCommunity",g="BackgroundLoadConfigurationTab"},121995:(e,t,n)=>{"use strict";n.d(t,{u:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsPlatformTabUtilsChannelByIdQuery($conversationId:ID!) {channelByID(conversationId:$conversationId) {id,channelType,displayName,description,defaultOneNoteSectionId,defaultFileSettings {filesRelativePath},hostTeamGroupId,hostTeamId,hostTenantId,owningTeam {id,displayName,teamSiteInformation {groupId,sharepointSiteUrl},isArchived,memberRole,teamType,tenantId},memberRole,sharepointSiteUrl,isGeneral}}");return delete this.definitions,this.definitions=e.definitions}}},419941:(e,t,n)=>{"use strict";n.d(t,{W_:()=>d,IW:()=>c,fk:()=>u,RD:()=>p,vd:()=>m,Fs:()=>I,ZB:()=>M,gn:()=>T,Ql:()=>N});var i,r=n(99425),a=n(441161),s=n(975887),o=n(99595),l=n(645095);!function(e){e.Member="member",e.Guest="guest",e.External="external",e.Anonymous="anonymous",e.Unknown="unknown"}(i||(i={}));const d=(e,t,n)=>t===l.vW.None&&e===s.CallType.Conference&&!n,c=(e,t,n)=>t===l.vW.None&&e===s.CallType.P2P&&n,u=(e,t)=>{if(p(e))return i.Anonymous;if(g(e))return i.Guest;if(e&&t){if(m(e.profile?.tenantId,t))return i.External;if(h(e.profile?.tenantId,t))return i.Member}return i.Unknown},p=e=>e?.role===r.a7.Anonymous,g=e=>e?.role===r.a7.Guest,m=(e,t,n)=>(n?.log(`isExternalUser: tenantId-${t}, currentTenantId-${e}`),!(!t||!e||e===t)),h=(e,t)=>!!t&&!!e&&e===t,I=(e,t,n,i,r)=>{const a=e?.baseInfo?.id,s=t?.appDefinition;if(r?.log(`(isValidTabForInMeetingExperience) Tab: ${a}, App: ${s?.name} ${s?.id}, isAnonymousUser: ${n}, enableMeetingSurfaces: ${i}`),!i||((e,t,n)=>{if("CustomEngineAgentTab"===e.__typename||"DeclarativeAgentTab"===e.__typename)return!0;const i=t.appDefinition?.galleryTabs?.[0];let r=!1;if("StaticExtensionTab"===e.__typename){const i=t.appDefinition?.staticTabs?.find((t=>t.entityId===e?.entityId));r=i?.context?.some((e=>e===o.b5.MeetingSidePanel)),n?.log(`(isMeetingOptimizeApp) Static tab ${e?.baseInfo?.id} isMeetingOptimized: ${r}`)}else r=i?.context?.some((e=>e===o._N.MeetingSidePanel))||i?.meetingSurfaces?.some((e=>e===o.H$.SidePanel)),n?.log(`(isMeetingOptimizeApp) Gallery Tab ${e?.baseInfo?.id} isMeetingOptimized: ${r}. `);return!!r})(e,t,r)){const e=!n||(e=>e?.appDefinition?.meetingExtensionDefinition?.isAnonymousAccessAllowed)(t);return r?.log(`(isValidTabForInMeetingExperience) is access to tab '${a}', valid: ${e}`),e}return!1},M=(e,t,n,i,o,l,c,u,p,g)=>{if(!l)return!1;const m=e?.type===r.aS.MsaLife;if(g&&m)return!0;if(T(e,l))return!1;const h=d(n,c,i);if(A(i,h,o))return!1;const I=t===a.A2.Organizer||t===a.A2.Presenter,M=u&&n===s.CallType.P2P;return I||M||p&&f(t,h)},f=(e,t)=>e===a.A2.Attendee&&t,A=(e,t,n)=>n&&(e||t),T=(e,t)=>{if(p(e))return!0;if(g(e))return!0;return!!m(e?.profile.tenantId,t)},N=(e,t)=>`${e};replyChainId=${t}`},832669:(e,t,n)=>{"use strict";n.d(t,{dx:()=>N,Y2:()=>y,ZK:()=>C,ZT:()=>S,DW:()=>b,Xc:()=>D,ZB:()=>U,re:()=>v,gf:()=>L,rP:()=>x,gL:()=>F,Ot:()=>O,V:()=>P,JU:()=>R,SN:()=>z,Hz:()=>B,Zc:()=>V,BJ:()=>_,HD:()=>W,Os:()=>Q,eT:()=>Y,V7:()=>G,iq:()=>Z,Sb:()=>H,vU:()=>J,R7:()=>X,t_:()=>q,$Y:()=>K,Zm:()=>$,JY:()=>ee,yA:()=>te,bF:()=>ne,JT:()=>ie,b5:()=>re,Fs:()=>ae,V_:()=>se,td:()=>oe,Vg:()=>le,DJ:()=>de,ef:()=>ue,RL:()=>pe,yL:()=>ge,Rx:()=>me,Q2:()=>he,BU:()=>Ie,W2:()=>Me,Cm:()=>fe,C1:()=>Ae,kH:()=>Te,Wo:()=>ye,yJ:()=>Ce,CR:()=>be,pZ:()=>De,LQ:()=>Ee,uh:()=>Ue});var i=n(989641),r=n(648260),a=n(712839),s=n(572909),o=n(76776),l=n(743288),d=n(702183),c=n(726723),u=n(347590),p=n(99595),g=n(363678),m=n(645095),h=n(199448),I=n(975887),M=n(342474),f=n(884451),A=n(121995),T=n(419941);const N=async(e,t,n,i,r)=>{const{data:a,error:s}=await e.query({query:o.$,variables:n?.isChannelMeeting&&n?.messageId?{id:t,queryType:"QueryByMessage",storageOptions:{messageStorage:{messageId:n.messageId},platformTabsQueryType:"QueryByMessage"},options:i}:{id:t,queryType:"QueryByThread",options:i},fetchPolicy:"network-only"});return s&&r?.error(`(getTabsData) Error fetching tabs: ${s.message}`),a},y=async(e,t,n,r,a,s,o)=>{const l=R(r),d=o?"Personal":l?"Team":"GroupChat",c=l?await S(e,t):void 0,{data:u,error:p}=await e.query({query:i.y,variables:{scope:d,conversationId:l?c:t,appId:n}});return p&&(s?.fail({errors:`Error getting app data for app ${n}: ${p.message}`,"App.Id":n,reason:"AppDefinitionError"}),a?.error(`(getAppData) Error getting app data for app ${n}: ${p.message}`)),u&&u.appDefinition||(s?.fail({errors:`App definition not found for app ${n}`,"App.Id":n,reason:"AppDefinitionMissing"}),a?.error(`(getAppData) App definition not found for app ${n}`)),u},C=async(e,t,n,r)=>{const{data:a}=await e.query({query:i.y,variables:{scope:r,conversationId:t,appId:n}});return a},S=async(e,t)=>b(e,t),b=async(e,t)=>{if(!t)return;const{conversationId:n}=v(t);if(!n)return;const i=await e.query({query:A.u,variables:{conversationId:n}}),r=i.data?.channelByID.owningTeam?.id;return r||void 0},D=(e,t,n)=>{if(E(t)){if(!n)return{botMri:e,appId:t.id};{const i=t.definition?.staticTabs?.some((e=>e.entityId===n));if(i)return{botMri:e,appId:t.id,tabEntityId:n}}}},E=e=>!!(e.definition?.galleryTabs?.some((e=>e?.context?.some((e=>e===p._N.MeetingSidePanel))))||e.definition?.galleryTabs?.some((e=>e?.meetingSurfaces?.some((e=>e===p.H$.SidePanel))))||e.definition?.staticTabs?.some((e=>e?.context?.some((e=>e===p.b5.MeetingSidePanel))))),U=async(e,t,n,i)=>{const{data:r,error:a}=await e.query({query:l.F,variables:{tabId:t,threadId:n}});return a&&i?.error(`(getPlatformTab) Error fetching tab: ${a.message}`),r},w=";messageid=",v=e=>{const t=e?.split(";replyChainId=")??[];let n=t[0];const i=t[1];if(n?.includes("channelId")){n=JSON.parse(n).channelId}return n?.includes(w)&&(n=n.split(w)[0]),{conversationId:n,replyChainId:i}},L=e=>{const{replyChainId:t}=v(e);return R(t)?"Team":"GroupChat"},k=e=>"ExtensionTab"===e.__typename||"CustomEngineAgentTab"===e.__typename||"DeclarativeAgentTab"===e.__typename,x=async(e,t,n,i,r,a,s,o,l,c,u)=>{const p=[],g=[];if(!e)return p;for(const o of e)if(l&&"StaticExtensionTab"===o.__typename||k(o)){const e={tabId:o.baseInfo.id,displayName:decodeURIComponent(o.baseInfo.displayName||""),entityId:o.entityId,tabType:o.__typename,tabPinnedState:o.pinnedState||"UserPinned"},l=await y(t,n,o.baseInfo.appId,a,s,c,u);if((0,T.Fs)(o,l,i,!!r,s)){const t={appId:o.baseInfo.appId,appName:l.appDefinition?.name||"",iconUrl:l.appDefinition?.smallImageUrl||""};e.displayName||(e.displayName=decodeURIComponent(t.appName));const n={tabInfo:e,appInfo:t};p.push(n)}else g.push(o.baseInfo.appId)}return g?.length>0&&(c?.mark(d.BQ.PlatformTabFetchUbarDroppedTabsDueToMeetingContext),s?.log(`convertToTabButtons(${o}) dropped apps: ${g.join(",")}`)),p},F=async(e,t,n,i,r,a,s,o,l,c,u)=>{c?.mark(d.BQ.PlatformTabFetchStart);const p=await N(e,t,r,o,a);a?.log(`getPlatformTabs(${s}): fetched ${p.platformTabs?.length} tabs`),c?.mark(d.BQ.PlatformTabFetchDataComplete);return await x(p.platformTabs,e,t,n,i,r?.messageId,a,s,l,c,u)},O=(e,t)=>{const n=[],i=[];for(const t of e.platformTabsEvent)if("StaticExtensionTab"===t?.__typename||"ExtensionTab"===t?.__typename){const e=t.baseInfo.appId??"",r=t.baseInfo.id??"";n.push(e),i.push(r)}t.log(`tabsEvent appData: ${n.join(",")}`),t.log(`tabsEvent tabData: ${i.join(",")}`)},P=(e,t,n,i,r,a,s,o,l,d)=>{const c=e&&["Scheduled","Recurring"].includes(e)&&(!a||d),u=o&&j(e,t,n),p=s&&(0,T.W_)(t,n,i),g=l&&(0,T.IW)(t,n,i);return r?.log(`isSupportedMeeting: meetingType-${e}, isChannelMeeting- ${a}, isSupportedInPrivateOrChannelMeeting-${c}, \n    callType -${t}, isSupportedInCalendarMeetNow: ${u}, isSupportedInGroupCall: ${p},\n    isSupportedInOneOnOneCall: ${g}: chatSubType - ${n}, isOneOnOne - ${i}`),!!(c||u||p||g)},j=(e,t,n)=>e&&"MeetNow"===e&&t===I.CallType.Conference&&n===m.vW.Meeting,R=e=>!!e&&"0"!==e;function z(e){return R(e)?{platformTabsQueryType:"QueryByMessage",messageStorage:{messageId:e}}:void 0}function B(e){return e?{appInstallScope:"Team"}:{appInstallScope:"GroupChat"}}const V=e=>R(e)?"QueryByMessage":"QueryByThread",_=(e,t)=>{switch(e){case r.v.Channel:case r.v.ChannelMeeting:case r.v.ChannelMeetingSchedulingForm:case r.v.SelectAppEntity:return"Team";case r.v.TabSdkAPI:return t?"Team":"GroupChat";default:return"GroupChat"}},W=(e,t)=>t?{appInstallScope:"Personal"}:e?{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeeting"}:{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeeting"},Q=e=>{switch(e){case g.hB.privateMeetingSchedulingForm:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeetingSchedulingForm"};case g.hB.chatTab:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"GroupChat"};case g.hB.channelMeetingSchedulingForm:return{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeetingSchedulingForm"};case g.hB.channelTab:return{appInstallScope:"Team",platformTabsEntryPoint:"Channel"};default:return}},Y=e=>{const t=new Error(e.message);return t.name=e.name,t},G=e=>{switch(e){case"GroupChat":return a.bY.group;case"Personal":return a.bY.personal;case"Team":return a.bY.team;default:return}},Z=e=>H({chatId:e?.chatId,teamId:e?.teamId,channelId:e?.channelId}),H=e=>{const{chatId:t,teamId:n,channelId:i}=e||{};return t?"GroupChat":n||i?"Team":"Personal"},J=e=>$(e)||ne(e)?e.baseInfo.id:"",X=e=>$(e)||ne(e)?e.baseInfo.appId:"",q=e=>ne(e)&&e.entityId||"",K=e=>($(e)||ne(e))&&e.websiteUrl?e.websiteUrl:null,$=e=>"WebsiteTab"===e?.__typename,ee=e=>"FileViewTab"===e?.__typename,te=e=>e===f.YT,ne=e=>"ExtensionTab"===e?.__typename||ie(e),ie=e=>"StaticExtensionTab"===e?.__typename,re=e=>"StaticExtensionTab"===e,ae=e=>"PlaceholderTab"===e?.__typename,se=e=>!!ie(e)&&e.baseInfo?.context?.includes(p.b5.TeamLevelApp),oe=(e,t)=>e?.linkedEntity?.type===s.ck.extensions&&!t,le=(e,t,n,i,r)=>({threadId:e,tab:{id:t,displayName:"",tabType:"StaticExtensionTab",appInstallScope:n,externalId:r},storageOptions:z(i)}),de=(e,t,n)=>{if(e)return ce(e.id,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,t,n)},ce=(e,t,n,i,r,a)=>{if(e)return t?c.bF.Meeting:n?i?c.bF.Botchat:c.bF.OneOnOneChat:r||"channelTab"===a?c.bF.Channel:c.bF.GroupChat},ue=[f.lb,f.t2,f.P3,f.YT,f.QA],pe=(e,t,n,i,r,a,s,o)=>{if(ue.includes(t))return;const l=(0,h.Mr)(t),c=(0,M.A)(),u=t=>{const o=e.findScenario(t);o&&(o.cancel({errors:"NewScenarioStarting"}),e.clearScenario(o));const d=e.newScenario(t,{clientId:`${t};${c}`});e.hoistScenarioToCore&&e.hoistScenarioToCore(d),d.appendEventData({"App.Id":l,"App.EntryPoint":s?`${n}DefaultLaunch`:n,"PlatformApp.IsMultiWindow":!!r,"PlatformApp.IsDefaultCommand":!!s,"PlatformApp.FromOpenFileInTeams":!!a}),i.log(`phase 1 scenario marker started for entryPoint ${n}`)};!o&&u(d.Cu.PlatformTabFrameLoading),u(d.Cu.PlatformTabLaunch)},ge=(e,t,n)=>{(i=>{e.findScenario(i)?.cancel();const r=(0,M.A)();e.newScenario(i,{clientId:r}).appendEventData({"App.EntryPoint":t}),n?.log(`fetch platform tabs - scenario marker started for entryPoint ${t}`)})(d.Cu.PlatformTabFetchData)},me=(e,t)=>{switch(e){case r.v.Meeting:case r.v.ChannelMeeting:return p.b5.MeetingSidePanel;case r.v.PrivateMeetingSchedulingForm:case r.v.ChannelMeetingSchedulingForm:case r.v.TabSdkAPI:return p.b5.MeetingDetailsTab;case r.v.Channel:return p.b5.ChannelTab;case r.v.Chat:return t&&Se(t)?p.b5.MeetingChatTab:p.b5.PrivateChatTab;case r.v.MeetingChat:return p.b5.MeetingChatTab;default:return p.b5.Unknown}},he=e=>{switch(e){case r.v.Chat:return g.hB.chatTab;case r.v.Channel:return g.hB.channelTab;case r.v.PrivateMeetingSchedulingForm:return g.hB.privateMeetingSchedulingForm;case r.v.ChannelMeetingSchedulingForm:return g.hB.channelMeetingSchedulingForm;default:return g.hB.platformAppView}},Ie=(e,t)=>"Desktop"===e&&!1===t,Me=e=>{switch(e){case a.bY.group:return"GroupChat";case a.bY.personal:return"Personal";case a.bY.team:return"Team";default:return}},fe=(e,t,n)=>({threadId:e.threadId,messageId:e.messageId||n?.messageId,appId:t.appId||e.appId,tabId:e.tabId||t.tabId,tabEntityId:t.tabEntityId||e.tabEntityId}),Ae=(e,t)=>t.find((t=>"StaticExtensionTab"===t.__typename&&t?.baseInfo?.appId===e)),Te=(e,t,n)=>Boolean(e&&e.length>0&&e.filter((e=>Ne(e,t)&&-1!==e.scopes?.indexOf(n))).length>0),Ne=(e,t)=>{const n=e?.context;return n&&0!==n.length?-1!==n.indexOf(t):-1!==f.TU.indexOf(t)},ye=(e,t,n)=>{let i;if(t)try{i=e.id&&JSON.parse(e.id)}catch(t){n.error(`entity id ${e.id} json parsing failed`)}else{const t=e.id&&decodeURIComponent(e.id);i=t&&JSON.parse(t)}return i},Ce=(e,t,n)=>n?.entryPoint===g.hB.botChat||!(e&&t||n?.chatId),Se=e=>!!e&&e.includes("meeting"),be=(e,t)=>(t&&e===g.E2.content)??!1,De=e=>"WebsiteTab"===e?.platformTab?.__typename&&e?.platformTab?.websiteUrl||"",Ee=(e,t,n)=>e&&(t||(0,u.Fz)(n)),Ue=e=>e===f.dy},693038:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var i=n(67309);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment baseInfo on BaseTab {id,appId,externalAppId,displayName,dateAdded,order,replyChainId,displayNameLocalizationKey,teamInfo {id,name,groupId,teamSiteDomain,teamSitePath,teamSiteUrl},channelInfo {id,name,channelRelativeUrl,channelType},installedApp {id,installationState,installedScope,definition {id,name,externalId,tenantId}},tabPermission {canUpdateConfig,canHaveTabConversation,definedDevicePermissions},isPredefinedTab}");return delete this.definitions,this.definitions=e.definitions}}},340722:(e,t,n)=>{"use strict";n.d(t,{V:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsPlatformTabsQueriesCalendarTabFragment on CalendarTab {baseInfo {...baseInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},484544:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsPlatformTabsQueriesCustomEngineAgentTabFragment on CustomEngineAgentTab {baseInfo {...baseInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},300380:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsPlatformTabsQueriesDeclarativeAgentTabFragment on DeclarativeAgentTab {baseInfo {...baseInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},209171:(e,t,n)=>{"use strict";n.d(t,{o:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsPlatformTabsQueriesPlaceholderTabFragment on PlaceholderTab {baseInfo {...baseInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},11724:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment legacyDocumentLibraryTab on LegacyDocumentLibraryTab {baseInfo {...baseInfo},siteUrl,libraryId,libraryServerRelativeUrl,selectedSiteImageUrl,selectedDocumentLibraryTitle,selectedSiteTitle}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},314864:(e,t,n)=>{"use strict";n.d(t,{r:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment extensionTab on ExtensionTab {baseInfo {...baseInfo},entityId,removeUrl,contentUrl,websiteUrl,isPlaceholderTab}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},822343:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment fileViewTab on FileViewTab {baseInfo {...baseInfo},fileType,objectId,objectUrl,serviceName,providerMetadata,baseUrl,shareUrl}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},608113:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment legacyWikiTab on LegacyWikiTab {baseInfo {...baseInfo},wikiTabId,wikiDefaultTab,hasContent,scenarioName,isMyWiki,isPrivateMeetingWiki,meetingNotes,hasMigratedToOneNote}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},446363:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment oneNoteTab on OneNoteTab {baseInfo {...baseInfo},oneNoteId,title,sectionUrl,notebookId,notebookLocation,service,subtype}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},612770:(e,t,n)=>{"use strict";n.d(t,{F:()=>N});var i=n(67309),r=n(567244),a=n(693038);const s={kind:"Document",get definitions(){const e=(0,i.G)("fragment extensionTabInfo on ExtensionTab {baseInfo {...baseInfo},entityId,websiteUrl}");return delete this.definitions,this.definitions=[...e.definitions,...a.i.definitions]}};var o=n(77728);const l={kind:"Document",get definitions(){const e=(0,i.G)("fragment basicTab on BasicTab {baseInfo {...baseInfo,displayNameLocalizationKey}}");return delete this.definitions,this.definitions=[...e.definitions,...a.i.definitions]}};var d=n(73111),c=n(822343),u=n(896806),p=n(446363),g=n(608113),m=n(11724),h=n(209171),I=n(340722),M=n(484544),f=n(300380);const A={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsPlatformTabsQueriesDocumentLibraryTabFragment on DocumentLibraryTab {baseInfo {...baseInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...a.i.definitions]}},T={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsPlatformTabsQueriesWikiTabFragment on WikiTab {baseInfo {...baseInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...a.i.definitions]}},N={kind:"Document",get definitions(){const e=(0,i.G)("fragment platformTabInfo on PlatformTab {__typename,...staticExtensionTabInfo,...extensionTabInfo,...websiteTab,...basicTab,...staticExtensionTab,...fileViewTab,...powerBiTab,...oneNoteTab,...legacyWikiTab,...legacyDocumentLibraryTab,...ComponentsPlatformTabsQueriesPlaceholderTabFragment,...ComponentsPlatformTabsQueriesCalendarTabFragment,...ComponentsPlatformTabsQueriesCustomEngineAgentTabFragment,...ComponentsPlatformTabsQueriesDeclarativeAgentTabFragment,...ComponentsPlatformTabsQueriesDocumentLibraryTabFragment,...ComponentsPlatformTabsQueriesWikiTabFragment}");return delete this.definitions,this.definitions=[...e.definitions,...r.V.definitions,...s.definitions,...o.F.definitions,...l.definitions,...d.L.definitions,...c.N.definitions,...u.i.definitions,...p.i.definitions,...g.H.definitions,...m.H.definitions,...h.o.definitions,...I.V.definitions,...M.X.definitions,...f.w.definitions,...A.definitions,...T.definitions]}}},896806:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment powerBiTab on PowerBiTab {baseInfo {...baseInfo},originatingTeam,originatingTeamId,reports,websiteUrl}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},73111:(e,t,n)=>{"use strict";n.d(t,{L:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment staticExtensionTab on StaticExtensionTab {baseInfo {...baseInfo},entityId,contentUrl,websiteUrl,pinnedState}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},567244:(e,t,n)=>{"use strict";n.d(t,{V:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment staticExtensionTabInfo on StaticExtensionTab {baseInfo {...baseInfo,context,scopes},entityId,pinnedState}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},77728:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var i=n(67309),r=n(693038);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment websiteTab on WebsiteTab {baseInfo {...baseInfo},url,websiteUrl}");return delete this.definitions,this.definitions=[...e.definitions,...r.i.definitions]}}},743288:(e,t,n)=>{"use strict";n.d(t,{F:()=>M});var i=n(67309),r=n(73111),a=n(314864),s=n(77728),o=n(567244),l=n(822343),d=n(896806),c=n(446363),u=n(608113),p=n(11724),g=n(209171),m=n(340722),h=n(484544),I=n(300380);const M={kind:"Document",get definitions(){const e=(0,i.G)("query Tab($tabId:String!,$threadId:String!,$storageOptions:PlatformTabsStorage,$appId:String,$options:TabOptionInput) {platformTab(tabId:$tabId,threadId:$threadId,storageOptions:$storageOptions,appId:$appId,options:$options) {__typename,...staticExtensionTab,...extensionTab,...websiteTab,...staticExtensionTabInfo,...fileViewTab,...powerBiTab,...oneNoteTab,...legacyWikiTab,...legacyDocumentLibraryTab,...ComponentsPlatformTabsQueriesPlaceholderTabFragment,...ComponentsPlatformTabsQueriesCalendarTabFragment,...ComponentsPlatformTabsQueriesCustomEngineAgentTabFragment,...ComponentsPlatformTabsQueriesDeclarativeAgentTabFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...r.L.definitions,...a.r.definitions,...s.F.definitions,...o.V.definitions,...l.N.definitions,...d.i.definitions,...c.i.definitions,...u.H.definitions,...p.H.definitions,...g.o.definitions,...m.V.definitions,...h.X.definitions,...I.w.definitions]}}},76776:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var i=n(67309),r=n(612770);const a={kind:"Document",get definitions(){const e=(0,i.G)("query PlatformTabsInfo($id:String!,$queryType:PlatformTabsQueryType!,$storageOptions:PlatformTabsStorage,$options:TabOptionInput) {platformTabs(id:$id,platformTabsQueryType:$queryType,storageOptions:$storageOptions,options:$options) {...platformTabInfo}}");return delete this.definitions,this.definitions=[...e.definitions,...r.F.definitions]}}},618630:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var i=n(67309),r=n(109587);const a={kind:"Document",get definitions(){const e=(0,i.G)("subscription ComponentsPresenceSubscription($userId:ID!,$source:PresenceSource!) {presenceUpdateEvent(userId:$userId,source:$source) {...userPresenceData,isBlocked,isDisabled}}");return delete this.definitions,this.definitions=[...e.definitions,...r.x.definitions]}}},990786:(e,t,n)=>{"use strict";var i,r;n.d(t,{cw:()=>i,f0:()=>r,$3:()=>a}),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_240=240]="IS_AT_LEAST_240",e[e.IS_AT_LEAST_290=290]="IS_AT_LEAST_290",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_360=360]="IS_AT_LEAST_360",e[e.IS_AT_LEAST_375=375]="IS_AT_LEAST_375",e[e.IS_AT_LEAST_414=414]="IS_AT_LEAST_414",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_640=640]="IS_AT_LEAST_640",e[e.IS_AT_LEAST_720=720]="IS_AT_LEAST_720",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_834=834]="IS_AT_LEAST_834",e[e.IS_AT_LEAST_947=947]="IS_AT_LEAST_947",e[e.IS_AT_LEAST_1000=1e3]="IS_AT_LEAST_1000",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1350=1350]="IS_AT_LEAST_1350",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2048=2048]="IS_AT_LEAST_2048",e[e.IS_AT_LEAST_2560=2560]="IS_AT_LEAST_2560",e[e.IS_AT_LEAST_3840=3840]="IS_AT_LEAST_3840"}(i||(i={})),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_568=568]="IS_AT_LEAST_568",e[e.IS_AT_LEAST_667=667]="IS_AT_LEAST_667",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1366=1366]="IS_AT_LEAST_1366",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2160=2160]="IS_AT_LEAST_2160",e[e.IS_AT_LEAST_4320=4320]="IS_AT_LEAST_4320"}(r||(r={}));const a=(e,t={})=>{const{isMinWidthBreakpointAtLeast360:n,isMinWidthBreakpointAtLeast480:i,isMinWidthBreakpointAtLeast720:r,isMinWidthBreakpointAtLeast768:a}=e,{offsetForMinWidthBreakpointIsGreaterThan0:s,offsetForMinWidthBreakpointAtLeast360:o,offsetForMinWidthBreakpointAtLeast480:l,offsetForMinWidthBreakpointAtLeast720:d,offsetForMinWidthBreakpointAtLeast768:c}=t,u=(({isMinWidthBreakpointAtLeast240:e,isMinWidthBreakpointAtLeast290:t,isMinWidthBreakpointAtLeast320:n,isMinWidthBreakpointAtLeast360:i,isMinWidthBreakpointAtLeast375:r,isMinWidthBreakpointAtLeast414:a,isMinWidthBreakpointAtLeast480:s,isMinWidthBreakpointAtLeast640:o,isMinWidthBreakpointAtLeast720:l,isMinWidthBreakpointAtLeast768:d,isMinWidthBreakpointAtLeast834:c,isMinWidthBreakpointAtLeast947:u,isMinWidthBreakpointAtLeast1000:p,isMinWidthBreakpointAtLeast1024:g,isMinWidthBreakpointAtLeast1280:m,isMinWidthBreakpointAtLeast1350:h,isMinWidthBreakpointAtLeast1440:I,isMinWidthBreakpointAtLeast1500:M,isMinWidthBreakpointAtLeast1680:f,isMinWidthBreakpointAtLeast1920:A,isMinWidthBreakpointAtLeast2048:T,isMinWidthBreakpointAtLeast2560:N,isMinWidthBreakpointAtLeast3840:y})=>y?3840:N?2560:T?2048:A?1920:f?1680:M?1500:I?1440:h?1350:m?1280:g?1024:p?1e3:u?947:c?834:d?768:l?720:o?640:s?480:a?414:r?375:i?360:n?320:t?290:e?240:239)(e);let p=s??0;a&&"number"==typeof c?p=c:r&&"number"==typeof d?p=d:i&&"number"==typeof l?p=l:n&&"number"==typeof o&&(p=o);const g=(u-p)/10+"rem";return{"--width":g,width:[g,"var(--width)"]}}},491450:(e,t,n)=>{"use strict";n.d(t,{PY:()=>s,eo:()=>o,Lg:()=>l,pM:()=>d,A7:()=>c,ok:()=>u});var i=n(990786),r=n(480354);const a=({dimension:e,MinDimensionBreakpoint:t})=>{let n=t.IS_GREATER_THAN_0;for(const i in t)if(!isNaN(Number(t[i]))){const a=Number(t[i]);if(!((0,r.round)(e)>=a))break;n=a}return n},s=({height:e,width:t,host:n})=>{const{self:{innerHeight:r,innerWidth:s}}=n;return{minHeightBreakpoint:a({dimension:e,MinDimensionBreakpoint:i.f0}),minWidthBreakpoint:a({dimension:t,MinDimensionBreakpoint:i.cw}),minHeightViewportBreakpoint:a({dimension:r,MinDimensionBreakpoint:i.f0}),minWidthViewportBreakpoint:a({dimension:s,MinDimensionBreakpoint:i.cw})}},o=({minHeightBreakpoint:e,minWidthBreakpoint:t,minHeightViewportBreakpoint:n,minWidthViewportBreakpoint:r}={minHeightBreakpoint:i.f0.IS_GREATER_THAN_0,minWidthBreakpoint:i.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:i.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:i.cw.IS_GREATER_THAN_0})=>({...p({minHeightBreakpoint:e,minHeightViewportBreakpoint:n}),...h({minWidthBreakpoint:t,minWidthViewportBreakpoint:r})}),l=({minHeightBreakpoint:e}={minHeightBreakpoint:i.f0.IS_GREATER_THAN_0})=>({...g({minHeightBreakpoint:e})}),d=({minHeightViewportBreakpoint:e}={minHeightViewportBreakpoint:i.f0.IS_GREATER_THAN_0})=>({...m({minHeightViewportBreakpoint:e})}),c=({minWidthBreakpoint:e}={minWidthBreakpoint:i.cw.IS_GREATER_THAN_0})=>({...I({minWidthBreakpoint:e})}),u=({minWidthViewportBreakpoint:e}={minWidthViewportBreakpoint:i.cw.IS_GREATER_THAN_0})=>({...M({minWidthViewportBreakpoint:e})}),p=({minHeightBreakpoint:e,minHeightViewportBreakpoint:t})=>({...g({minHeightBreakpoint:e}),...m({minHeightViewportBreakpoint:t})}),g=({minHeightBreakpoint:e})=>({isMinHeightBreakpointAtLeast320:e>=i.f0.IS_AT_LEAST_320,isMinHeightBreakpointAtLeast480:e>=i.f0.IS_AT_LEAST_480,isMinHeightBreakpointAtLeast568:e>=i.f0.IS_AT_LEAST_568,isMinHeightBreakpointAtLeast667:e>=i.f0.IS_AT_LEAST_667,isMinHeightBreakpointAtLeast768:e>=i.f0.IS_AT_LEAST_768,isMinHeightBreakpointAtLeast1024:e>=i.f0.IS_AT_LEAST_1024,isMinHeightBreakpointAtLeast1280:e>=i.f0.IS_AT_LEAST_1280,isMinHeightBreakpointAtLeast1366:e>=i.f0.IS_AT_LEAST_1366,isMinHeightBreakpointAtLeast1440:e>=i.f0.IS_AT_LEAST_1440,isMinHeightBreakpointAtLeast1500:e>=i.f0.IS_AT_LEAST_1500,isMinHeightBreakpointAtLeast1680:e>=i.f0.IS_AT_LEAST_1680,isMinHeightBreakpointAtLeast1920:e>=i.f0.IS_AT_LEAST_1920,isMinHeightBreakpointAtLeast2160:e>=i.f0.IS_AT_LEAST_2160,isMinHeightBreakpointAtLeast4320:e>=i.f0.IS_AT_LEAST_4320}),m=({minHeightViewportBreakpoint:e})=>({isMinHeightViewportBreakpointAtLeast320:e>=i.f0.IS_AT_LEAST_320,isMinHeightViewportBreakpointAtLeast480:e>=i.f0.IS_AT_LEAST_480,isMinHeightViewportBreakpointAtLeast568:e>=i.f0.IS_AT_LEAST_568,isMinHeightViewportBreakpointAtLeast667:e>=i.f0.IS_AT_LEAST_667,isMinHeightViewportBreakpointAtLeast768:e>=i.f0.IS_AT_LEAST_768,isMinHeightViewportBreakpointAtLeast1024:e>=i.f0.IS_AT_LEAST_1024,isMinHeightViewportBreakpointAtLeast1280:e>=i.f0.IS_AT_LEAST_1280,isMinHeightViewportBreakpointAtLeast1366:e>=i.f0.IS_AT_LEAST_1366,isMinHeightViewportBreakpointAtLeast1440:e>=i.f0.IS_AT_LEAST_1440,isMinHeightViewportBreakpointAtLeast1500:e>=i.f0.IS_AT_LEAST_1500,isMinHeightViewportBreakpointAtLeast1680:e>=i.f0.IS_AT_LEAST_1680,isMinHeightViewportBreakpointAtLeast1920:e>=i.f0.IS_AT_LEAST_1920,isMinHeightViewportBreakpointAtLeast2160:e>=i.f0.IS_AT_LEAST_2160,isMinHeightViewportBreakpointAtLeast4320:e>=i.f0.IS_AT_LEAST_4320}),h=({minWidthBreakpoint:e,minWidthViewportBreakpoint:t})=>({...I({minWidthBreakpoint:e}),...M({minWidthViewportBreakpoint:t})}),I=({minWidthBreakpoint:e})=>({isMinWidthBreakpointAtLeast240:e>=i.cw.IS_AT_LEAST_240,isMinWidthBreakpointAtLeast290:e>=i.cw.IS_AT_LEAST_290,isMinWidthBreakpointAtLeast320:e>=i.cw.IS_AT_LEAST_320,isMinWidthBreakpointAtLeast360:e>=i.cw.IS_AT_LEAST_360,isMinWidthBreakpointAtLeast375:e>=i.cw.IS_AT_LEAST_375,isMinWidthBreakpointAtLeast414:e>=i.cw.IS_AT_LEAST_414,isMinWidthBreakpointAtLeast480:e>=i.cw.IS_AT_LEAST_480,isMinWidthBreakpointAtLeast640:e>=i.cw.IS_AT_LEAST_640,isMinWidthBreakpointAtLeast720:e>=i.cw.IS_AT_LEAST_720,isMinWidthBreakpointAtLeast768:e>=i.cw.IS_AT_LEAST_768,isMinWidthBreakpointAtLeast834:e>=i.cw.IS_AT_LEAST_834,isMinWidthBreakpointAtLeast947:e>=i.cw.IS_AT_LEAST_947,isMinWidthBreakpointAtLeast1000:e>=i.cw.IS_AT_LEAST_1000,isMinWidthBreakpointAtLeast1024:e>=i.cw.IS_AT_LEAST_1024,isMinWidthBreakpointAtLeast1280:e>=i.cw.IS_AT_LEAST_1280,isMinWidthBreakpointAtLeast1350:e>=i.cw.IS_AT_LEAST_1350,isMinWidthBreakpointAtLeast1440:e>=i.cw.IS_AT_LEAST_1440,isMinWidthBreakpointAtLeast1500:e>=i.cw.IS_AT_LEAST_1500,isMinWidthBreakpointAtLeast1680:e>=i.cw.IS_AT_LEAST_1680,isMinWidthBreakpointAtLeast1920:e>=i.cw.IS_AT_LEAST_1920,isMinWidthBreakpointAtLeast2048:e>=i.cw.IS_AT_LEAST_2048,isMinWidthBreakpointAtLeast2560:e>=i.cw.IS_AT_LEAST_2560,isMinWidthBreakpointAtLeast3840:e>=i.cw.IS_AT_LEAST_3840}),M=({minWidthViewportBreakpoint:e})=>({isMinWidthViewportBreakpointAtLeast240:e>=i.cw.IS_AT_LEAST_240,isMinWidthViewportBreakpointAtLeast290:e>=i.cw.IS_AT_LEAST_290,isMinWidthViewportBreakpointAtLeast320:e>=i.cw.IS_AT_LEAST_320,isMinWidthViewportBreakpointAtLeast360:e>=i.cw.IS_AT_LEAST_360,isMinWidthViewportBreakpointAtLeast375:e>=i.cw.IS_AT_LEAST_375,isMinWidthViewportBreakpointAtLeast414:e>=i.cw.IS_AT_LEAST_414,isMinWidthViewportBreakpointAtLeast480:e>=i.cw.IS_AT_LEAST_480,isMinWidthViewportBreakpointAtLeast640:e>=i.cw.IS_AT_LEAST_640,isMinWidthViewportBreakpointAtLeast720:e>=i.cw.IS_AT_LEAST_720,isMinWidthViewportBreakpointAtLeast768:e>=i.cw.IS_AT_LEAST_768,isMinWidthViewportBreakpointAtLeast834:e>=i.cw.IS_AT_LEAST_834,isMinWidthViewportBreakpointAtLeast947:e>=i.cw.IS_AT_LEAST_947,isMinWidthViewportBreakpointAtLeast1000:e>=i.cw.IS_AT_LEAST_1000,isMinWidthViewportBreakpointAtLeast1024:e>=i.cw.IS_AT_LEAST_1024,isMinWidthViewportBreakpointAtLeast1280:e>=i.cw.IS_AT_LEAST_1280,isMinWidthViewportBreakpointAtLeast1350:e>=i.cw.IS_AT_LEAST_1350,isMinWidthViewportBreakpointAtLeast1440:e>=i.cw.IS_AT_LEAST_1440,isMinWidthViewportBreakpointAtLeast1500:e>=i.cw.IS_AT_LEAST_1500,isMinWidthViewportBreakpointAtLeast1680:e>=i.cw.IS_AT_LEAST_1680,isMinWidthViewportBreakpointAtLeast1920:e>=i.cw.IS_AT_LEAST_1920,isMinWidthViewportBreakpointAtLeast2048:e>=i.cw.IS_AT_LEAST_2048,isMinWidthViewportBreakpointAtLeast2560:e>=i.cw.IS_AT_LEAST_2560})},890896:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var i=n(513432),r=n(186480),a=n(291588);const s=(e={})=>{const t=(({positioning:e,defaultAutoSize:t}={})=>i.useMemo((()=>{if("string"==typeof e){const{position:n,align:i}=(0,r.P)(e);return{position:n,align:i,flipBoundary:"window",overflowBoundary:"window",autoSize:t}}return{flipBoundary:"window",overflowBoundary:"window",autoSize:t,...e}}),[e,t]))(e),{titlebarHeight:n,enablePositioningShiftToCoverTarget:s}=(0,a.k)();return i.useMemo((()=>{if(t.overflowBoundary&&"window"!==t.overflowBoundary||(t.shiftToCoverTarget??(t.shiftToCoverTarget=s)),0!==n){const{overflowBoundaryPadding:e,...i}=t??{};return"number"==typeof e?t:{...t,overflowBoundaryPadding:{top:n,...e},...i}}return t}),[s,t,n])}},291588:(e,t,n)=>{"use strict";n.d(t,{W:()=>a,k:()=>s});var i=n(513432);const r=i.createContext({titlebarHeight:0,enablePositioningShiftToCoverTarget:!1}),a=r.Provider,s=()=>i.useContext(r)},418680:(e,t,n)=>{"use strict";n.d(t,{M3:()=>o,xu:()=>l,Yf:()=>d,rq:()=>c,UP:()=>u,iw:()=>p,Me:()=>g,wR:()=>m,SK:()=>I});var i=n(795761),r=n(432143),a=n(451942);const s=[{name:"Default"},{name:"Light",code:57339},{name:"MediumLight",code:57340},{name:"Medium",code:57341},{name:"MediumDark",code:57342},{name:"Dark",code:57343}],o=(e,t,n=!1,r=!0,a=!1)=>{if("CustomEmoji"===e.__typename)return e.shortcuts[0];const o=e.description;if(!e.id||!r&&!n)return o;const{id:l,skinTone:d}=(0,i.lj)(e.id);let c=e.shortcuts?.[0]??`(${l})`;if(a&&c.match(M)){const e=r&&t?.emoticonAriaOpeningParenthesis||"left paranthesis",n=r&&t?.emoticonAriaClosingParenthesis||"right paranthesis";c=c.replace(/\(/,`${e} `).replace(/\)/,` ${n}`)}if(e.diverse){const e=(t&&t[`emoticonSkintone${s[d].name}`])??"";return n?I(t?.emoticonCombinedSkintoneTitle??"",{name:o,skinTone:e,shortName:c}):I(t?.emoticonNameWithSkintone??"",{name:o,skinTone:e})}return n?I(t?.emoticonCombinedTitle??"",{name:o,shortName:c}):o},l=e=>"TeamsEmoji"===e?.__typename||"Emoticon"===e?.__typename,d=e=>l(e)?e.description:e.shortcuts[0],c=(e,t,n,a)=>r.g_.has(e)?(0,i.ym)(u(e,t,n),"small",{enableSkypeCMSEmoticons:t,pesEmoticonCdnAssetsUrl:a},!0):void 0,u=(e,t,n=!1)=>(t?n?(0,a.$)(e):r.g_.get(e):r.$v.get(e))??e,p=(e,t,n,i,r)=>{m(n,r).forEach((n=>{const r=c(n,e,i,t);if(r){(new Image).src=r}}))},g=e=>r.dq.get(e)?.unicode||r.mL.get(e)?.unicode||void 0,m=(e,t)=>Array.isArray(t)&&e?t:Array.from(r.g_.keys()),h=/\{\{([a-zA-Z]+)\}\}/g,I=(e,t)=>e?e.replace(h,((e,n)=>t[n]||e)):"",M=/^\({1}\w+\){1}$/},451942:(e,t,n)=>{"use strict";n.d(t,{a:()=>a,$:()=>s});const i=new Map([["like","likeWithFaceMSER"],["star","starMSER"],["yes","like"]]),r=new Map([["like","yes"],["likeWithFaceMSER","like"],["starMSER","star"]]),a=e=>i.get(e)??e,s=e=>r.get(e)??e},528977:(e,t,n)=>{"use strict";n.d(t,{gz:()=>i,q4:()=>r,bH:()=>a,qz:()=>s,D8:()=>o,S2:()=>l,LH:()=>d,UV:()=>c,Cm:()=>u,yT:()=>p});const i=100,r=60,a=20,s=24,o=30,l=40,d=16,c=50,u="CustomEmoji",p="recent"},795761:(e,t,n)=>{"use strict";n.d(t,{au:()=>s,ym:()=>o,uj:()=>l,av:()=>d,DK:()=>c,zq:()=>u,NS:()=>p,lj:()=>g});var i=n(528977),r=n(432143);const a=new Map([["angry","angryV2"]]),s=(e,t=void 0)=>"legacy"===t||!e.enableSkypeCMSEmoticons&&"skype"!==t?e.emoticonCdnAssetsUrl??"https://statics.teams.cdn.office.net/evergreen-assets/skype/v2":e.pesEmoticonCdnAssetsUrl??"https://statics.teams.cdn.office.net/evergreen-assets/personal-expressions/v2/assets/emoticons",o=(e,t,n,i=!0,r="",o=!1,c=!1,u=null)=>{const m=c?d(t,u,o):l(t,o),{id:h,skinTone:I}=g(e),M=0!==I?`_s${I+1}`:"";if(!n||!n.enableSkypeCMSEmoticons&&p(h)&&0===I||c){let e=a.get(h)||h;return p(h)||(e=`${e}${M}`),`${s(n,"legacy")}/${e}/${m}${i?"a":""}.png`}{const e=i?"_anim":"",t=r&&""!==r?`?v=${r}`:"";return`${s(n,"skype")}/${h}/default/${m}${e}_f${M}.png${t}`}},l=(e,t=!1)=>{switch(e){case"extra-large":return i.gz;case"large":return t?i.gz:i.UV;case"medium":return t?i.q4:i.D8;case"medium-large":return t?i.gz:i.S2;case"extra-small":return t?i.bH:i.LH;default:return t?i.UV:i.bH}},d=(e,t=null,n=!1)=>{const i=c(e,t);return n?2*i:i},c=(e,t=null)=>{switch(e){case"meeting-giant":return t?.xxxLargeIconSize||224;case"meeting-jumbo":return t?.xxLargeIconSize||168;case"meeting-overlay":return t?.overlayIconSize||64;case"extra-large":return t?.xLargeIconSize||140;case"large":return t?.largeIconSize||112;case"medium":return t?.mediumIconSize||84;case"small":return t?.smallIconSize||56;case"extra-small":return t?.xSmallIconSize||42;default:return t?.xxSmallIconSize||32}},u=(e,t)=>{switch(e){case i.gz:return t?i.gz:i.UV;case i.q4:return i.UV;case i.UV:return i.D8;case i.D8:return t?i.qz:i.bH;default:return e}},p=e=>r.dq.has(e)||r.mL.has(e),g=e=>{const t=e.match(/(?=^.{0,40}$)(\S+)-tone(\d)/);return t&&3===t.length?{id:t[1],skinTone:Number.parseInt(t[2],10)}:{id:e,skinTone:0}}},432143:(e,t,n)=>{"use strict";n.d(t,{dq:()=>i,mL:()=>r,g_:()=>a,$v:()=>s,em:()=>o});const i=new Map([["smile",{unicode:"🙂",shortcuts:[":)",":-)",":=)","(smile)"],duration:2.2083,steps:53}],["laugh",{unicode:"😁",shortcuts:[":d",":-d",":=d","(laugh)",":>",":->","(lol)"],duration:3.2083,steps:77}],["heart",{unicode:"❤️",shortcuts:["(heart)","<3"],duration:.7083,steps:16}],["kiss",{unicode:"😘",shortcuts:["(kiss)",":*",":-*",":=*","(xo)"],duration:2.875,steps:50}],["sad",{unicode:"🙁",shortcuts:[":(",":-(",":=(","(sad)",":<",":-<"],duration:2.625,steps:63}],["tongueout",{unicode:"😋",shortcuts:[":p",":-p",":=p","(tongueout)","(yum)"],duration:2.9583,steps:71}],["wink",{unicode:"😉",shortcuts:[";)",";-)",";=)","(wink)"],duration:1.5,steps:36}],["cry",{unicode:"😭",shortcuts:[";(",";-(",";=(","(cry)",":'("],duration:2.0833,steps:50}],["inlove",{unicode:"😍",shortcuts:["(inlove)","(love)",":]",":-]"],duration:2.625,steps:63}],["hug",{unicode:"🤗",shortcuts:["(hug)","(bear)"],duration:3.1667,steps:76}],["cwl",{unicode:"😂",shortcuts:["(cwl)","(cryingwithlaughter)"],duration:2.5417,steps:61}],["lips",{unicode:"💋",shortcuts:["(lips)"],duration:3.7083,steps:89}],["blush",{unicode:"😊",shortcuts:[":$",":-$",":=$",':">',"(blush)"],duration:2.875,steps:69}],["surprised",{unicode:"😮",shortcuts:[":o",":-o",":=o","(surprised)"],duration:2.8333,steps:68}],["penguin",{unicode:"🐧",shortcuts:["(penguin)","(dancingpenguin)","(penguindance)"],duration:2.6667,steps:64}],["yes",{unicode:"👍",shortcuts:["(y)","(yes)","(thumbsup)"],duration:1.6667,steps:40}],["cool",{unicode:"😎",shortcuts:["(cool)","8-)","8=)","b-)","b=)","(sunglasses)"],duration:1.5833,steps:38}],["rofl",{unicode:"🤣",shortcuts:["(rofl)","(rotfl)"],duration:3.375,steps:81}],["cat",{unicode:"🐱",shortcuts:["(cat)","(meow)","(kitty)"],duration:5,steps:120}],["monkey",{unicode:"🐵",shortcuts:["(monkey)","(ape)"],duration:2.0833,steps:50}],["hi",{unicode:"👋",shortcuts:["(wave)","(hi)","(bye)"],duration:2.375,steps:57}],["snowangel",{unicode:"⛄",shortcuts:["(snowangel)"],duration:2.5,steps:60}],["flower",{unicode:"🌼",shortcuts:["(flower)"],duration:3.4583,steps:83}],["giggle",{unicode:"🤭",shortcuts:["(chuckle)","(giggle)"],duration:1.875,steps:45}],["devil",{unicode:"😈",shortcuts:["(devil)"],duration:2.7917,steps:67}],["party",{unicode:"🎉",shortcuts:["(party)","<o)","<:o)"],duration:2.9583,steps:71}],["worry",{unicode:"😨",shortcuts:["(worry)",":s",":-s",":=s","(worried)","(scared)"],duration:2.3333,steps:56}],["champagne",{unicode:"🍾",shortcuts:["(champagne)","(sparkling)"],duration:2.5833,steps:62}],["sun",{unicode:"🌞",shortcuts:["(sun)"],duration:1.0833,steps:26}],["star",{unicode:"⭐",shortcuts:["(star)"],duration:2.6667,steps:64}],["polarbear",{unicode:"🐻",shortcuts:["(polarbear)","(polarbearhug)"],duration:5,steps:120}],["dull",{unicode:"🙄",shortcuts:["|-(","|(","|=(","(dull)","(eyeroll)"],duration:3.2083,steps:77}],["speechless",{unicode:"😐",shortcuts:[":|",":-|",":=|","(speechless)"],duration:2.7917,steps:67}],["wonder",{unicode:"🤨",shortcuts:[":^)","(wonder)","(skeptical)"],duration:2.9167,steps:70}],["angry",{unicode:"😡",shortcuts:["(angry)",":@",":-@",":=@","x(","x-(","x=(",";@",";-@","(rage)"],duration:4.375,steps:105}],["puke",{unicode:"🤮",shortcuts:["(puke)",":&",":-&",":=&","+o("],duration:3.2917,steps:79}],["facepalm",{unicode:"🤦‍",shortcuts:["(facepalm)","(fail)"],duration:3.2083,steps:77}],["sweat",{unicode:"😓",shortcuts:["(:|","(sweat)"],duration:2.875,steps:69}],["holidayspirit",{unicode:"🎉",shortcuts:["(holidayspirit)","(crazyxmas)","(crazychristmas)"],duration:1.5,steps:36}],["sleepy",{unicode:"😴",shortcuts:["|-)","i-)","i=)","(snooze)","(sleepy)","(sleeping)"],duration:3,steps:72}],["bow",{unicode:"🙇",shortcuts:["(bow)"],duration:2.5,steps:60}],["makeup",{unicode:"💄",shortcuts:["(makeup)"],duration:4.5,steps:108}],["cash",{unicode:"💰",shortcuts:["(cash)","(money)"],duration:1.125,steps:27}],["lipssealed",{unicode:"🤐",shortcuts:[":x",":-x",":#",":-#",":=x",":=#","(lipssealed)"],duration:2.0833,steps:50}],["shivering",{unicode:"🥶",shortcuts:["(shivering)","(cold)","(freezing)"],duration:7.9167,steps:190}],["cake",{unicode:"🎂",shortcuts:["(cake)"],duration:4.125,steps:99}],["headbang",{unicode:"🤦‍♂️",shortcuts:["(headbang)","(banghead)"],duration:2.9583,steps:71}],["dance",{unicode:"🕺",shortcuts:["o/",":d/","(dance)"],duration:8.5833,steps:206}],["wasntme",{unicode:"😏",shortcuts:["(wasntme)"],duration:3.1667,steps:76}],["hungover",{unicode:"😵",shortcuts:["(hungover)"],duration:3.0417,steps:73}],["yawn",{unicode:"😩",shortcuts:["(yawn)"],duration:3.0833,steps:74}],["gift",{unicode:"🎁",shortcuts:["(gift)"],duration:.5417,steps:13}],["angel",{unicode:"👼",shortcuts:["(angel)"],duration:3.5,steps:84}],["xmastree",{unicode:"🎄",shortcuts:["(xmastree)","(christmastree)"],duration:1.125,steps:27}],["brokenheart",{unicode:"💔",shortcuts:["(brokenheart)"],duration:4.375,steps:105}],["think",{unicode:"🤔",shortcuts:["(think)",":-?",":?",":=?","*-)"],duration:2.4583,steps:59}],["clap",{unicode:"👏",shortcuts:["(clap)"],duration:1.6667,steps:40}],["punch",{unicode:"👊",shortcuts:["(punch)","*|","*-|"],duration:1.8333,steps:44}],["envy",{unicode:"😠",shortcuts:["(envy)"],duration:2.8333,steps:68}],["handshake",{unicode:"🤝",shortcuts:["(handshake)"],duration:2.5833,steps:62}],["nod",{unicode:"👍",shortcuts:["(nod)"],duration:2.125,steps:51}],["nerdy",{unicode:"🤓",shortcuts:["(nerd)","8-|","b-|","8|","b|","8=|","b=|","(nerdy)"],duration:2,steps:48}],["emo",{unicode:"😎",shortcuts:["(emo)"],duration:2.25,steps:54}],["muscle",{unicode:"💪",shortcuts:["(flex)","(muscle)"],duration:2.4583,steps:59}],["mmm",{unicode:"😏",shortcuts:["(mm)","(mmm)","(mmmm)"],duration:3.875,steps:93}],["highfive",{unicode:"✋",shortcuts:["(highfive)","(hifive)","(h5)"],duration:1.5833,steps:38}],["turkey",{unicode:"🦃",shortcuts:["(turkey)","(turkeydance)"],duration:2.0833,steps:50}],["call",{unicode:"🤙",shortcuts:["(call)"],duration:1.9167,steps:46}],["movember",{unicode:"🧐",shortcuts:["(movember)","(moustache)","(mustache)",":{"],duration:4.5833,steps:110}],["dog",{unicode:"🐶",shortcuts:["(dog)"],duration:2.25,steps:54}],["coffee",{unicode:"☕",shortcuts:["(coffee)"],duration:1.1667,steps:28}],["poke",{unicode:"👉",shortcuts:["(poke)","(nudge)"],duration:3.125,steps:75}],["swear",{unicode:"🤬",shortcuts:["(swear)"],duration:3.2083,steps:77}],["donttalktome",{unicode:"😠",shortcuts:["(donttalk)","(donttalktome)"],duration:2.5,steps:60}],["fingerscrossed",{unicode:"🤞",shortcuts:["(fingers)","(fingerscrossed)","(crossedfingers)"],duration:2.6667,steps:64}],["rainbow",{unicode:"🌈",shortcuts:["(rainbow)"],duration:.8333,steps:20}],["headphones",{unicode:"🎧",shortcuts:["(headphones)"],duration:3.5,steps:84}],["waiting",{unicode:"⏰",shortcuts:["(waiting)"],duration:2.125,steps:51}],["festiveparty",{unicode:"🎉",shortcuts:["(festiveparty)"],duration:3.0417,steps:73}],["heidy",{unicode:"🐿️",shortcuts:["(squirrel)","(heidy)"],duration:3.125,steps:75}],["beer",{unicode:"🍺",shortcuts:["(beer)"],duration:3.1667,steps:76}],["doh",{unicode:"😮",shortcuts:["(doh)"],duration:2.5,steps:60}],["bomb",{unicode:"💣",shortcuts:["(bomb)","(explosion)","(explode)"],duration:7.1667,steps:172}],["happy",{unicode:"🙂",shortcuts:["(happy)"],duration:2.9167,steps:70}],["ninja",{unicode:"🤺",shortcuts:["(ninja)"],duration:5.0833,steps:122}]]),r=new Map([["angryface",{unicode:"😡",shortcuts:[],duration:4.375,steps:105,pastName:"angry"}],["smileeyes",{unicode:"😊",shortcuts:[],duration:2.875,steps:69}]]),a=new Map([["like","yes"],["heart","heart"],["laugh","laugh"],["surprised","surprised"],["sad","sad"],["angry","angry"]]),s=a,o=new Map([["laughV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["laughV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["yesGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}],["raisehandGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["raisehandGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}]])},525387:(e,t,n)=>{"use strict";n.d(t,{l:()=>a});var i=n(480354),r=n(513432);const a=(e,t,n)=>{const a=(0,r.useRef)(e);a.current=e;const s=(0,r.useCallback)(((...e)=>a.current(...e)),[]),o=(0,r.useMemo)((()=>(0,i.debounce)(s,t,n)),[s,t,n]);return(0,r.useEffect)((()=>o.cancel),[o]),o}},45918:(e,t,n)=>{"use strict";n.d(t,{s:()=>o});var i=n(513432),r=n(288451),a=n(193406),s=n(755029);const o=(e,t,n="Url",a="",o=!1,d=!0,c)=>{const u=i.useCallback(((t,n,i,a)=>(0,r.z)(e,t,n,i,a)),[e]);return l(s.ur,u,t,n,a,o,d,c)},l=(e,t,n,r="Url",s="",o=!1,l=!0,d)=>{const c=i.useRef(!1),{host:u,amsImageCache:p,user:g}=e(),m=i.useRef(),h=i.useRef(o&&g?.id&&p?.has(n,g.id)),[I,M]=i.useState((()=>{const e=h.current&&g?.id?p?.get(n,g.id):void 0;return{result:e,loading:!e,error:void 0}})),f=i.useCallback((e=>c.current&&M(e)),[]),A=i.useCallback((()=>{(async()=>{if(""!==n&&!(0,a.nA)(n,u.location.origin)){let e=await t(n,r,s,d);if(m.current&&"Url"===r&&URL.revokeObjectURL(m.current),g?.id&&o&&p?.has(n,g.id)){const t=e.result?.blob,i=p?.get(n,g.id),r=t&&i?.blob&&t!==i.blob;e.result&&l&&r&&URL.revokeObjectURL(t),e={result:i,loading:!1},h.current=!0}else e.result&&g?.id&&!e?.error&&o&&"Url"===r&&(h.current=p?.add(n,g.id,e.result));m.current=e?.result?.blob??void 0,f(e)}})()}),[t,p,r,u.location.origin,s,o,l,f,n,g?.id,d]);return i.useEffect((()=>{c.current=!0,h.current=o&&g?.id&&p?.has(n,g.id),h.current||A()}),[A,h,p,o,n,g]),i.useEffect((()=>()=>{c.current=!1,"Url"===r&&m.current&&!h.current&&URL.revokeObjectURL(m.current)}),[A,r,h]),[I,A]}},402748:(e,t,n)=>{"use strict";n.d(t,{by:()=>sn});var i=n(957032),r=n(513432),a=n(506022),s=n(267154),o=n(14459),l=n(285343),d=n(211617),c=n(330721),u=n(324940),p=n(828078),g=n(13802),m=n(447863),h=n(613024),I=n(522013),M=n(388072),f=n(735652),A=n(754255);const T={isActionButton:!0},N=({isBotSupportCalling:e,startChat:t,startAudioCall:n,startVideoCall:a,isVideoAvailableForConversation:s,videoNotAvailableForConversationReason:o,isAudioAvailableForConversation:l,audioNotAvailableForConversationReason:d})=>{const c=(0,M.PO)(),u=r.useMemo((()=>y(c,o,s,!0)),[c,o,s]),N=r.useMemo((()=>y(c,d,l)),[c,d,l]),{enableBotsCallingSupport:C}=(0,f.w2)(A.w.Extensibility,["enableBotsCallingSupport"]),S=c.stringTranslate("extensibility","app_profile_card_toggleChat_on");return(0,i.Y)(p.s,{hAlign:"start",fill:!0,gap:"gap.small",children:[(0,i.Y)(g.$,{iconOnly:!0,text:!0,icon:(0,i.Y)(m.o,{outline:!0,size:"medium"}),onClick:t,title:S,disabled:!1,variables:T}),C&&e?(0,i.Y)(r.Fragment,{children:[(0,i.Y)(g.$,{iconOnly:!0,text:!0,icon:(0,i.Y)(h.p,{outline:!0,size:"medium"}),onClick:a,title:u,disabled:!s,variables:T}),(0,i.Y)(g.$,{iconOnly:!0,text:!0,icon:(0,i.Y)(I.q,{outline:!0,size:"medium"}),onClick:n,title:N,disabled:!l,variables:T})]}):null]})},y=(e,t,n,i)=>!n&&t?e.stringTranslate("calling",t):e.stringTranslate("messaging",i?"calling_video":"calling_call");var C=n(39485),S=n(67309);const b={kind:"Document",get definitions(){const e=(0,S.G)("subscription videoAvailableForConversationChanged($conversationId:ID!) {videoAvailableForConversationChangedEvent(conversationId:$conversationId) {conversationId,isAvailable,notAvailableReason}}");return delete this.definitions,this.definitions=e.definitions}};var D=n(283758),E=n(755029),U=n(911234),w=n(726723),v=n(702388),L=n(702183),k=n(311551),x=n(712839);const F=(e,t,n,i,r,a,s)=>({actionGesture:e,actionOutcome:t,actionScenario:n,actionScenarioType:w.DB.appMgmt,moduleName:i,panelRegion:w.rP.popover,panelType:w.HP.AppProfileCardPopover,appName:r,extensibilityData:{id:a,capabilityId:s,scenarioCapability:x.n3.bots}}),O=r.memo((({client:e,appProfile:t,botCallingCapabilities:n})=>{const{entityCommanding:a,scenarioFactory:s}=(0,E.ur)(),o=(0,U.U)(O.name),{startChat:l,startCall:d}=(0,D.wM)(a,e,o),c=(0,k.Us)(),{convId:u}=c.chatServiceSubscriptionFilter,{isBotAudioSupported:p,isBotVideoSupported:g,botAudioNotAvailableForConversationReason:m,botVideoNotAvailableForConversationReason:h}={...B(n)},{recordPanelAction:I}=(0,v.ib)(),M=p||g,f=t.botIdOrAppId,A=r.useCallback((()=>{const e=s.newScenario(L.Cu.AppProfileCardStartChat);I(F(w.Od.click,w.nd.select,w.vB.appProfileCardChat,w.Sn.appProfileCardStartChat,t.appName)),l(f,e)}),[f,t.appName,I,l,s]),T=r.useCallback((()=>{const e=s.newScenario(L.Cu.AppProfileCardStartAudioCall);j(t,!1,I),d(f,!1,e)}),[f,t,d,s,I]),y=r.useCallback((()=>{const e=s.newScenario(L.Cu.AppProfileCardStartVideoCall);j(t,!0,I),d(f,!0,e)}),[f,t,d,s,I]),{videoNotAvailableForConversationReason:C,isVideoAvailableForConversation:S}=R(e,u,g,h,o);return(0,i.Y)(N,{startChat:A,startVideoCall:y,startAudioCall:T,isBotSupportCalling:!!M,videoNotAvailableForConversationReason:C,isVideoAvailableForConversation:S&&!!g,audioNotAvailableForConversationReason:m??null,isAudioAvailableForConversation:!!p})})),P=(0,C.W)(O),j=(e,t,n)=>{n(F(w.Od.click,w.nd.nav,w.vB.appProfileCardCall,t?w.Sn.appProfileCardVideoCall:w.Sn.appProfileCardAudioCall,e.appName))},R=(e,t,n,i="bot_calling_video_not_supported",a)=>{const[s,o]=r.useState(null);r.useEffect((()=>{if(!n)return;const i=e.subscribe({query:b,variables:{conversationId:t}}).subscribe((({data:e,errors:t})=>{t&&a.error("Error on callQuery for video conversation subscription"),o(e)}));return()=>{i.unsubscribe()}}),[e,a,t,n]);const l=s?.videoAvailableForConversationChangedEvent;let d=!1,c="calling_video_disabled";return l&&(d=l.isAvailable,c=d?n?null:i:z(l.notAvailableReason,a)),{isVideoAvailableForConversation:d,videoNotAvailableForConversationReason:c}},z=(e,t)=>{switch(e){case"calling_video_disabled":case"calling_video_disabled_by_admin":case"calling_video_disabled_no_device":case"calling_video_disabled_vdi":case"bot_calling_video_not_supported":case"bot_calling_audio_not_supported":return e;default:return t.warn(`_queryVideoAvailableForConversation: wrong videoDisabledReason received: ${e}`),"calling_video_disabled"}},B=e=>{if(!e)return;const t=!!e?.supportsVideo,n=!!e?.supportsCalling;let i="bot_calling_audio_not_supported",r="bot_calling_video_not_supported";return i=n?null:i,r=t?null:r,{isBotVideoSupported:t,isBotAudioSupported:n,botAudioNotAvailableForConversationReason:i,botVideoNotAvailableForConversationReason:r}};var V=n(104656),_=n(109019),W=n(976230),Q=n(760127),Y=n(391567);const G=(0,Y.O)({isAppProfileCardTextInput:{a9b677:"fly5x3f"}}),Z=({sendMessage:e,appName:t,className:n})=>{const a=(0,M.PO)(),[s,o]=r.useState(""),l=""===s,d=r.useCallback((e=>{const t=e.target.value;o(t)}),[o]),c=r.useCallback((()=>{e(s),o("")}),[s,e]),u=a.stringTranslate("extensibility","app_profile_card_icons_send"),g=a.stringTranslate("extensibility","app_profile_card_quickMessage",{appName:t}),m=G();return(0,i.Y)(p.s,{column:!0,gap:"gap.small",className:n,children:(0,i.Y)(W.l,{onSubmit:c,children:(0,i.Y)(p.s,{className:m.isAppProfileCardTextInput,gap:"gap.smaller",children:[(0,i.Y)(V.p,{placeholder:g,onChange:d,value:s}),(0,i.Y)(_.$,{icon:(0,i.Y)(Q.q,{}),appearance:"transparent",disabled:l,title:u,type:"submit"})]})})})};var H=n(806658),J=n(84646);const X=({client:e,appProfile:t,...n})=>{const{entityCommanding:a,scenarioFactory:s}=(0,E.ur)(),o=(0,U.U)(X.name),{sendMessage:l}=(0,D.wM)(a,e,o),{recordPanelAction:d}=(0,v.ib)(),{appName:c,botIdOrAppId:u,appId:p}=t,g=(0,H.Iz)(u)?u.substring(J.gN.BotPrefix.length):void 0,m=r.useCallback((e=>{const t=s.newScenario(L.Cu.AppProfileCardSendQuickMessage);d(F(w.Od.click,w.nd.submit,w.vB.quickIM,w.Sn.appProfileCardQuickIM,c,p,g)),l(u,e,t)}),[u,c,p,g,d,l,s]);return(0,i.Y)(Z,{sendMessage:m,appName:c,...n})},q=(0,C.W)(X);var K=n(590723),$=n(677529),ee=n(301173),te=n(137172),ne=n(370118),ie=n(494825),re=n(852528);const ae=({children:e})=>(0,i.Y)(r.Fragment,{children:r.Children.map(e,(e=>r.cloneElement(e,{styles:{clipPath:"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)"}})))});var se=n(860238),oe=n(188996);const le=({title:e})=>(0,i.Y)(se.n,{state:"success",title:e,variables:{appProfileCardPresenceImage:oe.Y.Online}});var de=n(549981),ce=n(552355),ue=n(572909);const pe=(0,Y.O)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc",cr1yyl:"f1r4h3gm"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{Frg6f3:["fcgxt0o","f1ujusj6"]},isAppProfileCardLink:{Be2twd7:"f14d40fx",dvvfom:0,w71qe1:0,I8pafv:0,Bkioxbp:0,dwov6y:"ff6ntgw"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"}});var ge=n(418709),me=n(45918),he=n(912146),Ie=n(944297);const Me=({botName:e,iconUrl:t,description:n,developerName:a,privacyUrl:s,termsOfUseUrl:o,botIdOrAppId:l,isShortProfileCard:d,sceneCount:c,showActionButtons:u,isSceneApp:p,sceneName:g,showRectAppImage:m,botCallingCapabilities:h,appId:I,supportsMeetingStreaming:M,botConfiguration:T,appDef:N})=>{const y=r.useMemo((()=>({botIdOrAppId:l,appName:e,appId:I})),[I,l,e]),{host:C}=(0,E.ur)(),S=(0,de.rO)(),{entity:b}=(0,ce.At)(),D=b.type===ue.ck.channels?"Team":"GroupChat",U=(0,de.r8)(N,D),w=b.type===ue.ck.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(b):b.id,v=r.useCallback((()=>{S(w,D,N,de.uk.ReConfig)}),[N,w,S,D]),{enableFetchAPIForNonAdaptiveCardImages:L}=(0,f.w2)(A.w.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),k=(0,ge.m)(),[{result:x}]=(0,me.s)(k,L&&(0,he.d$)(t,C.location.origin)||(0,Ie.D$)(t)?t:"","Url",void 0,!0),F=x?.blob??t;return p?(0,i.Y)(Ae,{botName:e,description:n,iconUrl:F,sceneCount:c,sceneName:g,showRectAppImage:m,privacyUrl:s,termsOfUseUrl:o}):(0,i.Y)(fe,{appProfile:y,botName:e,description:n,iconUrl:F,isShortProfileCard:d,developerName:a,showRectAppImage:m,botCallingCapabilities:h,supportsMeetingStreaming:M,privacyUrl:s,termsOfUseUrl:o,showActionButtons:u,botConfiguration:U?T:null,launchBotConfig:v})},fe=({appProfile:e,botName:t,iconUrl:n,description:a,developerName:s,privacyUrl:o,termsOfUseUrl:l,isShortProfileCard:d,showActionButtons:c,showRectAppImage:u,botCallingCapabilities:g,supportsMeetingStreaming:m,botConfiguration:h,launchBotConfig:I})=>{const{enableBotConfiguration:M}=(0,f.w2)(A.w.Extensibility,["enableBotConfiguration"]),T=pe();return(0,i.Y)($.s,{className:T.isAppProfileCard,children:[(0,i.Y)(p.s,{vAlign:"start",children:(0,i.Y)(Ne,{botName:t,description:a,iconUrl:n,isShortProfileCard:d,developerName:s,showRectAppImage:u})}),(0,i.Y)(p.s,{column:!0,children:[M&&h?(0,i.Y)(_.$,{appearance:"transparent",className:T.isBotSettingsButton,onClick:I,icon:(0,i.Y)(re.Z,{outline:!0,size:"medium"})}):(0,i.Y)(r.Fragment,{}),(0,i.Y)(Le,{isShortProfileCard:d,supportsMeetingStreaming:m}),d?null:(0,i.Y)(ve,{privacyUrl:o,termsOfUseUrl:l}),c?(0,i.Y)(Se,{appProfile:e,botCallingCapabilities:g}):null]})]})},Ae=({botName:e,description:t,iconUrl:n,sceneCount:r,sceneName:a,showRectAppImage:s,privacyUrl:o,termsOfUseUrl:l})=>{const d=pe();return(0,i.Y)($.s,{className:d.isAppProfileCard,children:[(0,i.Y)(p.s,{fill:!0,vAlign:"start",children:(0,i.Y)(Te,{botName:e,description:t,iconUrl:n,sceneCount:r,sceneName:a,showRectAppImage:s})}),(0,i.Y)(p.s,{column:!0,children:(0,i.Y)(ve,{privacyUrl:o,termsOfUseUrl:l})})]})},Te=({botName:e,description:t,iconUrl:n,sceneCount:a,sceneName:s,showRectAppImage:o})=>{const l=pe();return(0,i.Y)(r.Fragment,{children:[(0,i.Y)(p.s,{fill:!0,column:!0,children:[(0,i.Y)(be,{botName:s}),(0,i.Y)(ee.D,{size:"small",children:e}),(0,i.Y)(p.s,{gap:"gap.small",vAlign:"center",className:l.sceneAppProfileCard,children:[(0,i.Y)(K.S,{size:"smaller",outline:!0}),(0,i.Y)(Ee,{sceneCount:a})]}),(0,i.Y)(Ue,{description:t})]}),(0,i.Y)(ye,{iconUrl:n,showRectAppImage:o})]})},Ne=({botName:e,description:t,developerName:n,iconUrl:a,isShortProfileCard:s,showRectAppImage:o})=>{const{presence:l}=xe(),d=pe();return(0,i.Y)(r.Fragment,{children:[(0,i.Y)(p.s,{fill:!0,column:!0,className:d.isAppProfileCardDetail,children:[(0,i.Y)(be,{botName:e}),(0,i.Y)(p.s,{column:!0,gap:"gap.small",children:[(0,i.Y)(ee.D,{className:d.isAppProfileCardPresence,children:l}),(0,i.Y)(we,{description:t}),s?(0,i.Y)(be,{botName:e,isShortProfileCard:s}):(0,i.Y)(De,{developerName:n})]})]}),(0,i.Y)(ye,{iconUrl:a,showRectAppImage:o})]})},ye=({iconUrl:e,showRectAppImage:t})=>{const{appProfileImageBorderRadius:n}=ke();return t?(0,i.Y)(Ce,{iconUrl:e,width:60,height:60,variables:n}):(0,i.Y)(Ce,{showStatus:!0,iconUrl:e,width:68,height:60,isHexagon:!0})},Ce=({iconUrl:e,showStatus:t,width:n,height:r,isHexagon:a,variables:s})=>{const{presence:o}=xe(),d=pe(),c=(0,i.Y)(l.S,{src:e,width:n,height:r,variables:s});return(0,i.Y)($.s,{className:d.isAppProfileCardImageContainer,children:[a?(0,i.Y)(ae,{children:c}):c,t&&(0,i.Y)(le,{title:o})]})},Se=({appProfile:e,botCallingCapabilities:t})=>{const n=pe();return(0,i.Y)(p.s,{column:!0,children:[(0,i.Y)(p.s,{fill:!0,className:n.isAppProfileCardActionButton,children:(0,i.Y)(P,{appProfile:e,botCallingCapabilities:t})}),(0,i.Y)(te.c,{className:n.messageAppDivider}),(0,i.Y)(q,{appProfile:e,className:n.flexItemAlign})]})},be=({botName:e,isShortProfileCard:t})=>{const n=pe();return(0,i.Y)(ee.D,{className:t?n.isAppProfileShortCardDescription:n.isAppProfileCardTitle,children:e})},De=({developerName:e})=>{const t=(0,M.PO)().translate("extensibility","app_profile_card_developer",{developerName:e}),n=pe();return(0,i.Y)(ee.D,{className:n.isAppProfileCardDeveloper,children:t})},Ee=({sceneCount:e})=>{const t=(0,M.PO)().stringTranslate("extensibility","app_profile_card_scene_count_mf",{sceneCount:e});return(0,i.Y)(ee.D,{size:"small",children:t})},Ue=({description:e})=>{const t=pe();return(0,i.Y)(ee.D,{className:(0,ne.z)(t.isContentClamped,t.isSceneProfileCardDesc),children:e})},we=({description:e})=>{const t=pe();return(0,i.Y)(ee.D,{className:(0,ne.z)(t.isContentClamped,t.isAppProfileCardDescription),children:e})},ve=({privacyUrl:e,termsOfUseUrl:t})=>{const{termsOfUse:n,privacy:r}=xe(),a=pe();return(0,i.Y)(p.s,{vAlign:"end",className:a.flexItemGrow,children:[(0,i.Y)(ie.N,{target:"_blank",href:e,className:a.isAppProfileCardLink,children:r}),(0,i.Y)(ie.N,{target:"_blank",href:t,className:(0,ne.z)(a.flexItemPush,a.isAppProfileCardLink),children:n})]})},Le=({isShortProfileCard:e,supportsMeetingStreaming:t})=>{const n=(0,M.PO)(),r=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extensibility_addAppDialogAppCardPermission1","extensibility_addAppDialogAppCardPermission2","extension_addAppDialogIdentityPermission2"];t&&!e&&r.push("extension_addAppDialog_Permission_Meeting_Streaming_Access");const a=[],s=pe();for(let t=0;t<=r.length-1;t++)a.push((0,i.Y)(p.s,{gap:"gap.smaller",children:[e?null:(0,i.Y)(ee.D,{className:s.listStyleBullet,children:"•"}),(0,i.Y)(ee.D,{children:n.translate("extensibility",r[t])})]},t));const{whatAppCanDo:o}=xe();return(0,i.Y)($.s,{className:s.isAppProfileCardBasicPermission,children:[(0,i.Y)(ee.D,{className:e?s.isAppProfileCardPermission:void 0,children:o}),(0,i.Y)(p.s,{column:!0,className:s.isAppProfileCardPermissionFlex,children:a})]})},ke=()=>{const{vars:e}=(0,a.W)();return{isAppProfileCardBasicPermission:e("extensibility",["isAppProfileCardBasicPermission"]),isAppProfileCardPermission:e("extensibility",["isAppProfileCardPermission"]),isAppProfileCardLink:e("extensibility",["isAppProfileCardLink"]),isAppProfileCardDeveloper:e("extensibility",["isAppProfileCardDeveloper"]),listStyleBullet:e("extensibility",["listStyleBullet"]),isAppProfileCardPresence:e("extensibility",["isAppProfileCardPresence"]),isAppProfileCardTitle:e("extensibility",["isAppProfileCardTitle"]),isAppProfileCardDescription:e("extensibility",["isAppProfileCardDescription"]),isAppProfileCardImageContainer:e("extensibility",["isAppProfileCardImageContainer"]),isAppProfileCard:e("extensibility",["isAppProfileCard"]),isAppProfileCardDetail:e("extensibility",["isAppProfileCardDetail"]),isAppProfileCardActionButton:e("extensibility",["isAppProfileCardActionButton"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),messageAppDivider:e("extensibility",["messageAppDivider"]),isAppProfileShortCardDescription:e("extensibility",["isAppProfileShortCardDescription"]),sceneAppProfileCard:e("extensibility",["sceneAppProfileCard"]),isSceneProfileCardDesc:e("extensibility",["isSceneProfileCardDesc"])}},xe=()=>{const e=(0,M.PO)();return{whatAppCanDo:e.translate("extensibility","app_profile_card_basicPermission_what_app_can_do"),privacy:e.translate("extensibility","app_profile_card_privacy"),termsOfUse:e.translate("extensibility","app_profile_card_terms_of_use"),presence:e.stringTranslate("extensibility","app_profile_card_presence")}};var Fe=n(550497);var Oe=n(111941),Pe=n(954665),je=n(194492),Re=n(408496);const ze=(e,t)=>!!t[e]?.length,Be=({appDef:e})=>{const t=ze("galleryTabs",e)||(0,Fe.vx)("Team",e.staticTabs),n=ze("bots",e),r=ze("messageExtensions",e),a=ze("connectors",e),s=(0,Fe.vx)("Personal",e.staticTabs);return(0,i.Y)($.s,{children:[t&&(0,i.Y)(Ve,{titleKey:"app_details_capability_tab",descriptionKey:"app_details_capability_tab_description"}),n&&(0,i.Y)(Ve,{titleKey:"app_details_capability_bot",descriptionKey:"app_details_capability_bot_description"}),r&&(0,i.Y)(Ve,{titleKey:"app_details_capability_message_extension",descriptionKey:"app_details_capability_message_extension_description"}),a&&(0,i.Y)(Ve,{titleKey:"extension_addAppDialogV3_capability_connector_title",descriptionKey:"app_details_capability_connector_description"}),s&&(0,i.Y)(Ve,{titleKey:"app_details_capability_personal_app",descriptionKey:"app_details_capability_personal_app_description"})]})},Ve=({titleKey:e,descriptionKey:t})=>{const n=(0,M.PO)(),s=r.useMemo((()=>n.translate("extensibility",e)),[n,e]),o=r.useMemo((()=>n.translate("extensibility",t)),[n,t]),{vars:l}=(0,a.W)();return(0,i.Y)($.s,{children:[(0,i.Y)(Re.Y,{as:"h4",content:s,variables:l("extensibility",["isActionableAppProfileCardAppFeatureHeader"])}),o]})};var _e=n(525387);const We=(0,Y.O)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isActionableAppProfileCardBodySection:{Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardBodySectionTitle:{Bhrd7zp:"flh3ekv"},isActionableAppProfileCardPermissionsList:{dclx09:"fuxrj8o",B6of3ja:"f1bpxv7w"},isActionableAppProfileCardConsent:{Be2twd7:"f1hn7b42",Bj7y4cg:"f11hph32"},isActionableAppProfileCardLink:{mc9l5x:"f1w7gpdv",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",ha4doy:"f1cdqgvm",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1motb3o",Bf4jedk:"f18p0k4z",Bqenvij:"f11ysow2",Be2twd7:"fjoy568",Bhrd7zp:"ff5ikls",mn2c1h:"fuuohzo",B7m74wb:"f9oa3bk",Ba85zgr:0,Bcsz1n9:0,Bidrcva:0,yit76y:0,Bbybgqa:"fczi8j1",Beapcnx:0,i089h6:0,Bvxx0d4:0,rpb332:0,zxir6n:"fbfeg0j",lj723h:"f1bq4y7d",C4gs1y:0,Bde5pd6:0,o06tbt:0,Frfyj5:0,Fnbkun:"f154bhm6",Jwef8y:"fldu4wg",Bi91k9c:"fpwtdan"},isActionableAppProfileCardBodySectionParagraph:{z8tnut:"fz04i0k"},isActionableAppProfileCardHeaderInfoBanner:{B6of3ja:"fwdhe5f",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fc882fo",De3pzq:"f18f03hv",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fffov48",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",sj55zd:"f19n0e5",sshi5w:"f4x5sky",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardDescription:{a9b677:"fly5x3f",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",ygn44y:"f1cmbuwj",Bxyxcbc:"f1it27or",Bh9c35c:"f197wrh9"},isActionableAppProfileCardAppButton:{Bf4jedk:"f13bscln",Huce71:"fz5stix",t21cq0:["fvm675v","f1kdaspl"],Bqenvij:"f1sw78cg",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fbnecyg"},isActionableAppProfileCardAppButtonLoader:{t21cq0:["fvm675v","f1kdaspl"]},isActionableAppProfileCardImageContainer:{a9b677:"ffyv3ta",Bqenvij:"fyhdfh7",qhf8xq:"f10pi13n"},isActionableAppProfileCardFooter:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f8ofw6e",Eo32re:"f1ter9b9",ekhr2s:"f1jf1ovi"},isActionableAppProfileCardTitle:{Be2twd7:"fkhj508",Bhrd7zp:"flh3ekv",Bg96gwp:"f15qi916"},isActionableAppProfileCardBody:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["fcj128b","f1ebihv0"],a9b677:"f14z66ap",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1enuhaj",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:["f4aipn0","f1kihodc"],z9904h:["f32gfn4","f9bbbef"]},isActionableAppProfileCardDivider:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1q5y2p4"},isActionableAppProfileCardHeader:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1ef08qj"},isActionableAppProfileCardHeaderDescription:{sshi5w:"f1s7fcag",Bxyxcbc:"fivuv6",Frg6f3:["f1e3ula6","f153xw4"],t21cq0:["fbjlher","f1wtvaye"]},isActionableAppProfileCard:{a9b677:"f5m2izs",Bqenvij:"fc4x5ql",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fykg1oz",F9q5ga:"f1bldkcc",Bugp6ci:"fyzbmc5",B60y50i:"f107ynw3",Bjq7wn2:"f4ws2lc"},isActionableAppProfileCardActionButtonsWrapper:{Bow7q3s:"fuvumhg"},isActionableAppProfileCardShort:{a9b677:"f5m2izs",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fykg1oz"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{B6of3ja:"fgr6219"},isAppProfileCardLink:{Be2twd7:"f14d40fx",dvvfom:0,w71qe1:0,I8pafv:0,Bkioxbp:0,dwov6y:"fctto54"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"},isActionableAppProfileCardHeaderButtons:{B6of3ja:"fwdhe5f"},isActionableAppProfileCardHeaderButtonsItem:{a9b677:"f14z66ap"}});var Qe=n(62501),Ye=n(723599),Ge=n(591594);var Ze;!function(e){e[e.Default=0]="Default",e[e.InfoBanner=1]="InfoBanner"}(Ze||(Ze={}));const He=({appDef:e,botName:t,iconUrl:n,description:a,privacyUrl:s,termsOfUseUrl:o,botIdOrAppId:l,sceneCount:d,showActionButtons:c,hideAppButton:u,isSceneApp:p,sceneName:g,showRectAppImage:m,botCallingCapabilities:h,appId:I,supportsMeetingStreaming:M,isInstalled:T,hasPersonalScope:N,botConfiguration:y})=>{const C=r.useMemo((()=>({botIdOrAppId:l,appName:t,appId:I})),[I,l,t]),{host:S}=(0,E.ur)(),b=(0,de.rO)(),{entity:D}=(0,ce.At)(),U=D.type===ue.ck.channels?"Team":"GroupChat",w=D.type===ue.ck.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(D):D.id,v=(0,de.r8)(e,U),L=r.useCallback((()=>{b(w,U,e,de.uk.ReConfig)}),[e,w,b,U]),{enableFetchAPIForNonAdaptiveCardImages:k}=(0,f.w2)(A.w.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),x=(0,ge.m)(),[{result:F}]=(0,me.s)(x,k&&((0,he.d$)(n,S.location.origin)||(0,Ie.D$)(n))?n:"","Url",void 0,!0),O=F?.blob??n;return p?(0,i.Y)(Ae,{botName:t,description:a,iconUrl:O,sceneCount:d,sceneName:g,showRectAppImage:m,privacyUrl:s,termsOfUseUrl:o}):I?(0,i.Y)(Je,{appDef:e,appProfile:C,description:a,iconUrl:O,showRectAppImage:m,botCallingCapabilities:h,supportsMeetingStreaming:M,privacyUrl:s,termsOfUseUrl:o,showActionButtons:c,hideAppButton:u,isInstalled:T,hasPersonalScope:N,botConfiguration:v?y:null,launchBotConfig:L}):(0,i.Y)(Xe,{appName:t,iconUrl:O,showRectAppImage:m})},Je=({appDef:e,appProfile:t,iconUrl:n,description:a,privacyUrl:s,termsOfUseUrl:o,showActionButtons:l,hideAppButton:d,showRectAppImage:c,botCallingCapabilities:u,supportsMeetingStreaming:g,isInstalled:m,hasPersonalScope:h,botConfiguration:I,launchBotConfig:M})=>{const{enableBotConfiguration:T}=(0,f.w2)(A.w.Extensibility,["enableBotConfiguration"]),N=We(),y=r.useRef(null),C=r.useRef(null),{recordPanelAction:S}=(0,v.ib)(),b=(0,Ge.X)(),D=r.useCallback((()=>{if(C.current&&y.current){const{appId:e,appName:n}=t;C.current.scrollTo({top:y.current.offsetTop-C.current.offsetTop,behavior:"smooth"}),S({actionGesture:w.Od.click,actionOutcome:w.nd.scroll,moduleName:w.Sn.appProfileCard,panelRegion:w.rP.popover,panelType:w.HP.AppProfileCardPopover,extensibilityData:{id:e,name:n}})}}),[t,y,C,S]);return(0,i.Y)(p.s,{column:!0,className:N.isActionableAppProfileCard,"data-tid":"actionable-app-profile-card-content",children:[(0,i.Y)(qe,{appProfile:t,botCallingCapabilities:u,description:a,iconUrl:n,showActionButtons:l,hideAppButton:d,showRectAppImage:c,isInstalled:m,hasPersonalScope:h}),T&&I?(0,i.Y)(_.$,{"data-tid":"bot-settings-button",appearance:"transparent",className:N.isBotSettingsButton,onClick:M,...b,icon:(0,i.Y)(re.Z,{outline:!0,size:"medium"})}):(0,i.Y)(r.Fragment,{}),(0,i.Y)(te.c,{className:N.isActionableAppProfileCardDivider}),(0,i.Y)(Ke,{appDef:e,appProfile:t,bodyRef:C,permissionsRef:y,supportsMeetingStreaming:!!g}),(0,i.Y)(te.c,{className:N.isActionableAppProfileCardDivider}),(0,i.Y)($e,{appProfile:t,showActionButtons:l,onPermissionsClick:D,privacyUrl:s,termsOfUseUrl:o})]})},Xe=({appName:e,iconUrl:t,showRectAppImage:n})=>{const r=We();return(0,i.Y)(p.s,{column:!0,className:r.isActionableAppProfileCardShort,children:[(0,i.Y)(p.s,{className:r.isActionableAppProfileCardHeader,children:[(0,i.Y)(et,{iconUrl:t,showRectAppImage:n}),(0,i.Y)(p.s,{column:!0,className:r.isActionableAppProfileCardHeaderDescription,children:(0,i.Y)(it,{name:e})})]}),(0,i.Y)(te.c,{className:r.isActionableAppProfileCardDivider}),(0,i.Y)(lt,{isShortCard:!0})]})},qe=({appProfile:e,botCallingCapabilities:t,description:n,iconUrl:r,showActionButtons:a,hideAppButton:s,showRectAppImage:o,isInstalled:l,hasPersonalScope:d})=>{const{actionableAppProfileCardType:c}=(0,f.w2)(A.w.Extensibility,["actionableAppProfileCardType"]),u=c===Ze.InfoBanner,g=We();return(0,i.Y)(p.s,{column:!0,className:g.isActionableAppProfileCardHeader,children:[(0,i.Y)(p.s,{children:[(0,i.Y)(et,{iconUrl:r,showRectAppImage:o}),(0,i.Y)(p.s,{column:!0,className:g.isActionableAppProfileCardHeaderDescription,children:[(0,i.Y)(it,{name:e.appName}),(0,i.Y)(rt,{description:n})]})]}),(0,i.Y)(p.s,{fill:!0,className:g.isActionableAppProfileCardHeaderButtons,children:[d&&!s?(0,i.Y)(nt,{appId:e.appId,appName:e.appName,isInstalled:l,isInfoBannerType:u}):null,a?(0,i.Y)(p.s,{className:g.isActionableAppProfileCardActionButtonsWrapper,children:(0,i.Y)(P,{appProfile:e,botCallingCapabilities:t})}):null]}),!u||l||s?null:(0,i.Y)(at,{})]})},Ke=({appDef:e,appProfile:{appId:t,appName:n},bodyRef:r,permissionsRef:a,supportsMeetingStreaming:s})=>{const{recordPanelAction:o}=(0,v.ib)(),l=(0,_e.l)((()=>o({actionGesture:w.Od.scroll,actionOutcome:w.nd.read,moduleName:w.Sn.appProfileCard,panelRegion:w.rP.popover,panelType:w.HP.AppProfileCardPopover,extensibilityData:{id:t,name:n}})),1e3),d=We();return(0,i.Y)(p.s,{column:!0,ref:r,className:d.isActionableAppProfileCardBody,onScroll:l,children:[(0,i.Y)(dt,{appDef:e}),(0,i.Y)(te.c,{className:d.isActionableAppProfileCardDivider}),(0,i.Y)(lt,{permissionsRef:a,supportsMeetingStreaming:s,appDef:e})]})},$e=({appProfile:e,onPermissionsClick:t,privacyUrl:n,showActionButtons:r,termsOfUseUrl:a})=>{const s=We();return(0,i.Y)(p.s,{column:!0,className:s.isActionableAppProfileCardFooter,children:[r?(0,i.Y)(q,{appProfile:e}):null,(0,i.Y)(ot,{appName:e.appName,onPermissionsClick:t,privacyUrl:n,termsOfUseUrl:a})]})},et=({iconUrl:e,showRectAppImage:t})=>{const{appProfileImageBorderRadius:n}=ut();return t?(0,i.Y)(tt,{iconUrl:e,width:80,height:72,variables:n}):(0,i.Y)(tt,{iconUrl:e,width:80,height:72,isHexagon:!0})},tt=({iconUrl:e,width:t,height:n,isHexagon:r,variables:a})=>{const s=We(),o=(0,i.Y)(l.S,{src:e,width:t,height:n,variables:a}),d={src:e};return(0,i.Y)($.s,{className:s.isActionableAppProfileCardImageContainer,children:r?(0,i.Y)(u.A,{commonImgAttributes:d,size:72}):o})},nt=({appId:e,appName:t,isInstalled:n,isInfoBannerType:a})=>{const{addAppButton:s,addToYourAppsButton:o,openAppButton:l}=pt(),[d,c]=r.useState(!1),[u,p]=r.useState(!1),g=(()=>{const e=(0,ge.m)(),{scenarioFactory:t}=(0,E.ur)(),n=(0,U.U)("useInstallPersonalApp"),{enableAppsQueryOptimization:i}=(0,f.w2)(A.w.Extensibility,["enableAppsQueryOptimization"]);return r.useCallback((r=>(0,Fe.Pe)(e,t,L.Cu.AppProfileCardInstallApp,r,"Personal",n,i)),[e,n,t,i])})(),m=(0,Oe.S)(),{recordPanelAction:h}=(0,v.ib)(),I=(0,Pe.H)();r.useEffect((()=>(p(!0),()=>p(!1))),[]);const{enablePersonalAppNavigationV2:M}=(0,f.w2)(A.w.Extensibility,["enablePersonalAppNavigationV2"]),T=r.useCallback((()=>{d||void 0===e||(I(e),c(!0),g(e).then((()=>m(e,!!M,!0))).catch((()=>{u&&c(!1)})),h(ct({isAppInstallAction:!0,appId:e,appName:t})))}),[e,t,d,u,M,g,m,I,h]),N=r.useCallback((()=>{void 0!==e&&(I(e),m(e,!!M,!0)),h(ct({appId:e,appName:t}))}),[e,t,M,m,h,I]),y=n?l:a?s:o,C=We();return(0,i.Y)(_.$,{disabled:void 0===e,onClick:n?N:T,className:C.isActionableAppProfileCardAppButton,title:y,"data-tid":`app-profile-card-${n?"open":"add"}-app-button`,children:[d&&(0,i.Y)(Qe.y,{size:"extra-small",className:C.isActionableAppProfileCardAppButtonLoader}),y]})},it=({name:e})=>{const t=We();return(0,i.Y)(ee.D,{className:t.isActionableAppProfileCardTitle,children:e})},rt=({description:e})=>{const t=We();return(0,i.Y)(ee.D,{className:t.isActionableAppProfileCardDescription,children:e})},at=()=>{const{addAppInfoBanner:e}=pt(),t=We();return(0,i.Y)(p.s,{gap:"gap.smaller",className:t.isActionableAppProfileCardHeaderInfoBanner,children:[(0,i.Y)(d.m,{}),(0,i.Y)(ee.D,{children:e})]})},st=({developerName:e,developerUrl:t})=>{const n=(0,M.PO)(),a=r.useMemo((()=>n.getTransForNs("extensibility")),[n]),s=We();return(0,i.Y)(ee.D,{className:s.isActionableAppProfileCardBodySectionParagraph,children:(0,i.Y)(a,{i18nKey:"ext_actionable_app_profile_card_app_features_created_by",children:(0,i.Y)(ie.N,{target:"_blank",href:t||"",children:{developerName:e}})})})},ot=({appName:e,onPermissionsClick:t,privacyUrl:n,termsOfUseUrl:a})=>{const s=(0,M.PO)(),o=r.useMemo((()=>s.getTransForNs("extensibility")),[s]),l=r.useCallback((e=>{"Enter"===e.key&&t()}),[t]),{termsOfUse:d,privacyPolicy:c,permissions:u}=pt(),g=We();return(0,i.Y)(p.s,{vAlign:"end",gap:"gap.medium",children:(0,i.Y)(ee.D,{className:g.isActionableAppProfileCardConsent,children:(0,i.Y)(o,{i18nKey:"ext_actionable_app_profile_card_consent",children:[(0,i.Y)(ee.D,{children:{appName:e}}),(0,i.Y)(ie.N,{target:"_blank",href:n,children:{privacyPolicy:c}}),(0,i.Y)(ie.N,{target:"_blank",href:a,children:{termsOfUse:d}}),(0,i.Y)(_.$,{appearance:"transparent",onClick:t,onKeyPress:l,className:g.isActionableAppProfileCardLink,children:{permissions:u}})]})})})},lt=({isShortCard:e,permissionsRef:t,appDef:n})=>{const a=(0,M.PO)(),{isActionableAppProfileCardPermission:s,isActionableAppProfileCardPermissionsList:o}=ut(),l=(0,je.z)(n),d=r.useMemo((()=>e?["app_profile_card_imsend","app_profile_card_imreceive"]:n?(0,Ye.H)(n,l,a):[]),[n,a,e,l]),u=r.useMemo((()=>d.map((e=>({key:e,content:a.translate("extensibility",e),variables:s})))),[d,a,s]),{permissionsTitle:g}=pt(),m=We();return(0,i.Y)(p.s,{column:!0,ref:t,className:m.isActionableAppProfileCardBodySection,children:[(0,i.Y)(ee.D,{className:m.isActionableAppProfileCardBodySectionTitle,children:g}),(0,i.Y)(c.B,{variables:o,items:u})]})},dt=({appDef:e})=>{const{appFeaturesTitle:t}=pt(),{developerName:n,developerUrl:r}=e,a=We();return(0,i.Y)(p.s,{column:!0,className:a.isActionableAppProfileCardBodySection,children:[(0,i.Y)(ee.D,{className:a.isActionableAppProfileCardBodySectionTitle,children:t}),(0,i.Y)(Be,{appDef:e}),(0,i.Y)(st,{developerName:n||"",developerUrl:r||""})]})},ct=({isAppInstallAction:e,appId:t,appName:n})=>({actionGesture:w.Od.click,actionOutcome:w.nd.nav,actionScenario:e?w.vB.appCardAdd:w.vB.appCardOpen,actionScenarioType:w.DB.appCardActions,moduleName:w.Sn.appProfileCard,panelRegion:w.rP.popover,panelType:w.HP.AppProfileCardPopover,extensibilityData:{id:t,name:n}}),ut=()=>{const{vars:e}=(0,a.W)();return r.useMemo((()=>({isActionableAppProfileCardActionButtonsWrapper:e("extensibility",["isActionableAppProfileCardActionButtonsWrapper"]),isActionableAppProfileCardAppButton:e("extensibility",["isActionableAppProfileCardAppButton"]),isActionableAppProfileCardPermission:e("extensibility",["isActionableAppProfileCardPermission"]),isActionableAppProfileCardPermissionsList:e("extensibility",["isActionableAppProfileCardPermissionsList"]),isActionableAppProfileCardConsent:e("extensibility",["isActionableAppProfileCardConsent"]),isActionableAppProfileCardDeveloper:e("extensibility",["isActionableAppProfileCardDeveloper"]),isActionableAppProfileCardLink:e("extensibility",["isActionableAppProfileCardLink"]),isActionableAppProfileCardPresence:e("extensibility",["isActionableAppProfileCardPresence"]),isActionableAppProfileCardTitle:e("extensibility",["isActionableAppProfileCardTitle"]),isActionableAppProfileCardDescription:e("extensibility",["isActionableAppProfileCardDescription"]),isActionableAppProfileCardImageContainer:e("extensibility",["isActionableAppProfileCardImageContainer"]),isActionableAppProfileCard:e("extensibility",["isActionableAppProfileCard"]),isActionableAppProfileCardShort:e("extensibility",["isActionableAppProfileCardShort"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),isActionableAppProfileCardHeader:e("extensibility",["isActionableAppProfileCardHeader"]),isActionableAppProfileCardHeaderDescription:e("extensibility",["isActionableAppProfileCardHeaderDescription"]),isActionableAppProfileCardHeaderButtons:e("extensibility",["isActionableAppProfileCardHeaderButtons"]),isActionableAppProfileCardHeaderInfoBanner:e("extensibility",["isActionableAppProfileCardHeaderInfoBanner"]),isActionableAppProfileCardDivider:e("extensibility",["isActionableAppProfileCardDivider"]),isActionableAppProfileCardBody:e("extensibility",["isActionableAppProfileCardBody","customScrollbar"]),isActionableAppProfileCardBodySection:e("extensibility",["isActionableAppProfileCardBodySection"]),isActionableAppProfileCardBodySectionParagrahp:e("extensibility",["isActionableAppProfileCardBodySectionParagrahp"]),isActionableAppProfileCardBodySectionTitle:e("extensibility",["isActionableAppProfileCardBodySectionTitle"]),isActionableAppProfileCardFooter:e("extensibility",["isActionableAppProfileCardFooter"])})),[e])},pt=()=>{const e=(0,M.PO)();return r.useMemo((()=>({addAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_button_text"),addAppInfoBanner:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_info_banner_text"),addToYourAppsButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_to_your_apps_button_text"),appFeaturesTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_app_features_title"),openAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_open_app_button_text"),permissions:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_link_text"),permissionsTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_title"),privacyPolicy:e.stringTranslate("extensibility","ext_actionable_app_profile_card_privacy_policy_link_text"),termsOfUse:e.stringTranslate("extensibility","ext_actionable_app_profile_card_terms_of_use_link_text")})),[e])};var gt=n(645095),mt=n(649728),ht=n(480354);const It={kind:"Document",get definitions(){const e=(0,S.G)("query user($mri:ID!) {user(userId:$mri) {id,displayName,imageUri}}");return delete this.definitions,this.definitions=e.definitions}};var Mt=n(832669),ft=n(878336);const At={kind:"Document",get definitions(){const e=(0,S.G)("fragment ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope on BotConfigurationScope {fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}}");return delete this.definitions,this.definitions=e.definitions}},Tt={kind:"Document",get definitions(){const e=(0,S.G)("fragment ComponentsAppProfileCardAppDefinitionFragment on AppDefinition {id,name,bots {id,scopes,capabilities {isNotificationOnly,supportsFiles,supportsCalling,supportsVideo},configuration {team {...ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope},groupChat {...ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope}}},developerName,developerUrl,longDescription,shortDescription,connectors {connectorId,scopes,configurationUrl},privacyUrl,largeImageUrl,termsOfUseUrl,meetingExtensionDefinition {supportsStreaming,scenes {id,name,file,preview,maxAudience,seatsReservedForOrganizersOrPresenters},filters {id,name,thumbnail}},galleryTabs {configurationUrl,canUpdateConfiguration,canHaveTabConversation,scopes,meetingSurfaces,context},staticTabs {entityId,name,scopes},messageExtensions {botId,scopes,commands {id,title,context,description}},isFullScreenApp,isFullTrustApp,validDomains,tenantId,isMicrosoftOwned,externalId,webApplicationInfo {id,applicationPermissions},authorization {permissions {resourceSpecific {name,type}}},devicePermissions}");return delete this.definitions,this.definitions=[...e.definitions,...At.definitions]}},Nt={kind:"Document",get definitions(){const e=(0,S.G)("query ComponentsAppProfileCardGetInstalledAppsQuery($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsV2(installedContext:$installedContext,options:$options) {id,definition {...ComponentsAppProfileCardAppDefinitionFragment}}}");return delete this.definitions,this.definitions=[...e.definitions,...Tt.definitions]}},yt={kind:"Document",get definitions(){const e=(0,S.G)("query ComponentsAppProfileCardUseAppDefinitionsQuery($scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinitions(scope:$scope,conversationId:$conversationId,options:$options) {id,...ComponentsAppProfileCardAppDefinitionFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...Tt.definitions]}},Ct={kind:"Document",get definitions(){const e=(0,S.G)("query ComponentsAppProfileCardUseAppDefinitionQuery($appId:ID!,$scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinition(appId:$appId,scope:$scope,conversationId:$conversationId,options:$options) {id,...ComponentsAppProfileCardAppDefinitionFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...Tt.definitions]}};var St=n(675190);const bt=[],Dt=(e,t,n,i,r,a)=>{const s=bt.find((s=>s.botOrAppId===e&&s.isWebhook===t&&(0,ht.isEqual)(s.conversationId,i)&&(0,ht.isEqual)(s.connectorSenderGuid,r)&&(0,ht.isEqual)(s.displayName,a)&&(0,ht.isEqual)(s.togetherModeParams,n)));if(s)return s;const o={botOrAppId:e,togetherModeParams:n,conversationId:i,connectorSenderGuid:r,displayName:a,isWebhook:t,isGetAppDefinitionCallInProgress:!1,listeners:[]};return bt.push(o),o},Et=(e,t)=>{e&&(e.listeners.forEach((e=>{e(t)})),e.isGetAppDefinitionCallInProgress=!1)},Ut=(e,t,n,i,a,s,o=!1,l=!1,d=!1)=>{const[c,u]=(0,r.useState)(),{loggerFactory:{newLogger:p},scenarioFactory:g,host:{location:{origin:m}},discover:h}=(0,E.ur)(),I=(0,r.useMemo)((()=>p("AppProfileCardContentContainer","app-profile-card-data")),[p]),M=(0,k.Us)(),{convId:T}=M.chatServiceSubscriptionFilter,{appDefinition:N,isSceneApp:y}=n||{},{entity:C}=(0,ce.At)(),S=T||i||"",b=(0,r.useRef)(!1),{enableBotAvatarWithAppDefinition:D}=(0,f.w2)(A.w.Extensibility,["enableBotAvatarWithAppDefinition"]),{copilotAppIdForNewChat:U}=(0,f.w2)(A.w.Messaging,["copilotAppIdForNewChat"]);return(0,r.useEffect)((()=>{if(d)return;const e=Dt(t,o,n,i,a,s);return e.listeners.push(u),()=>{e.listeners=e.listeners.filter((e=>e!==u)),0===e.listeners.length&&(e=>{const t=bt.findIndex((t=>t.botOrAppId===e.botOrAppId&&t.isWebhook===e.isWebhook&&(0,ht.isEqual)(t.conversationId,e.conversationId)&&(0,ht.isEqual)(t.connectorSenderGuid,e.connectorSenderGuid)&&(0,ht.isEqual)(t.displayName,e.displayName)&&(0,ht.isEqual)(t.togetherModeParams,e.togetherModeParams)));t>=0&&bt.splice(t,1)})(e)}}),[t,n,i,a,s,o,d]),(0,r.useEffect)((()=>{if(d)return;let r;b.current=!0;const l=Dt(t,o,n,i,a,s);if(!l.isGetAppDefinitionCallInProgress){l.isGetAppDefinitionCallInProgress=!0,r=g.newScenario(L.Cu.AppProfileCardGetAppDefinition);const n=(0,H.Iz)(t)?"Bot.Id":"App.Id";r.appendEventData({[n]:t}),N?b.current&&(Et(l,N),r.stop()):Lt(e,t,S,C,y,a,s,o,m,h,D,U).then((e=>{b.current&&(Et(l,e),r.stop())})).catch((e=>{const n=`Unable to fetch appDefinition for BotOrAppId: ${t}, Failed with error: ${e}`;!S&&n.toLowerCase().includes("conversationId is undefined".toLowerCase())?b.current&&r&&r.stop():(I.error(n,{botOrAppId:t}),b.current&&r&&r.fail({message:n})),l.isGetAppDefinitionCallInProgress=!1}))}return()=>{b.current=!1,r&&r.cancel()}}),[e,t,m,h,y,I,u,g,N,S,a,C,s,o,i,n,l,D,U,d]),c},wt=async(e,t,n,i,r)=>{if((0,H.GX)(t)&&n){return{name:n,largeImageUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg=="}}const{data:a}=await e.query({query:It,variables:{mri:t},context:{callerInfo:"app-profile-card-data"}}),s=a?.user;if(s){const e={name:s.displayName||"",largeImageUrl:s.imageUri??""};return e.largeImageUrl&&r&&i&&!vt(e.largeImageUrl,i)&&(e.largeImageUrl=await(async(e,t)=>{let n="";try{n=new URL(await e.regionGtm("urlp")).hostname}catch{n="urlp.asm.skype.com"}return`https://${n}/v1/url/content?url=${encodeURIComponent(t)}`})(r,e.largeImageUrl)),e}return null},vt=(e,t)=>(0,he.d$)(e,t)||(0,Ie.D$)(e),Lt=async(e,t,n,i,r,a,s,o=!1,l,d,c,u)=>{let p,g;const m=i.type===ue.ck.channels;if(m)p="Team";else{const i=n?await Rt(e,n):null;if(i){g=i?.chatSubType===gt.vW.Channel;const e=zt(t,i);p=g?"Team":e||r?"Personal":"GroupChat"}}return(m||g)&&(n=await(0,Mt.DW)(e,n)??""),kt(e,t,n,a,p,s,o,l,d,c,u)},kt=async(e,t,n,i,r,a,s=!1,o,l,d,c)=>{const u=(0,H.Iz)(t),p=(0,H.GX)(t)&&!!i,g=s?await(async(e,t,n,i)=>{const{data:r}=await e.query({query:Ct,variables:{conversationId:t,scope:i||"Team",appId:n},context:{callerInfo:"app-profile-card-data-getAppDefinitionForOutgoingWebhook"}});return r?.appDefinition?r.appDefinition:null})(e,n,t,r):p?await(async(e,t,n,i)=>{if(!n)return null;const{data:r}=await e.query({query:yt,variables:{conversationId:t,scope:i,options:{capabilityFilter:["Connector"],connectorId:n}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForConnector"}});return r?.appDefinitions?.length&&r.appDefinitions[0]?r.appDefinitions[0]:null})(e,n,i,r):u?xt(t,c)?await Ft(e,t,n,r):await(d?(0,St.fP)(e,t,n,r,"app-profile-card-data"):(async(e,t,n,i)=>{const{data:r}=await e.query({query:yt,variables:{conversationId:n,scope:i,options:{botId:(0,ft.Uf)(t)}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForBot"}});return r?.appDefinitions?.length&&r.appDefinitions[0]?r.appDefinitions[0]:null})(e,t,n,r)):await(async(e,t,n,i)=>{const{data:r}=await e.query({query:Ct,variables:{conversationId:n,scope:i,appId:t},context:{callerInfo:"app-profile-card-data-getAppDefinitionForApp"}});return r?.appDefinition?r.appDefinition:null})(e,t,n,r);if(g)return g;return u?await wt(e,t,a,o,l):null},xt=(e,t)=>!!t&&(0,H.Iz)(e)&&(0,ft.Uf)(e)===t,Ft=async(e,t,n,i)=>{const r=(0,ft.Uf)(t),a={scope:i||"Personal",conversationId:n},{data:s}=await e.query({query:Nt,variables:{installedContext:a,options:{botId:r,includeUnlicensedApps:!0}},context:{callerInfo:"app-profile-card-data-gcp"}}),o=s?.installedAppsV2?.filter((e=>e?.definition?.bots?.some((e=>e.id===r))));return o?.[0]?.definition?o?.[0]?.definition:null},Ot=e=>e?.bots&&e.bots.length>0&&(0,ht.includes)(e.bots[0].scopes,"Personal")||!1,Pt=(e,t,n)=>{const[i,a]=(0,r.useState)(!1),[s,o]=(0,r.useState)(!1),[l,d]=(0,r.useState)(!0),c=(0,k.Us)(),{scenarioFactory:u}=(0,E.ur)(),p=(0,U.U)("AppProfileCardContentContainer");return(0,r.useEffect)((()=>{const i=Vt(t);if(!i)return;const{convId:r}=c.chatServiceSubscriptionFilter;let s,l=!1;const g=r||n;return g&&(l=!0,s=u.newScenario(L.Cu.UseOneOnOneAndDisabledByTenantChecker),Rt(e,g).then((e=>{l&&(a(!e||zt(i,e)),o(!e||Bt(i,e)),d(!e||zt(i,e)),s.stop())})).catch((()=>{const e=`Failed to get conversation with conversationId:${r} for bot/app:${i}`;p.error(e,{botMri:i}),l&&s&&s.fail({message:e})}))),()=>{l=!1,s&&s.cancel()}}),[c.chatServiceSubscriptionFilter,t,e,p,u,n]),{isDisabledByTenant:s,isOneOnOne:i,isOneOnOneBotChat:l}},jt=(e,t)=>{const[n,i]=(0,r.useState)(!1),{scenarioFactory:a}=(0,E.ur)(),s=(0,U.U)("AppProfileCardContentContainer");return(0,r.useEffect)((()=>{const n=Vt(t);if(!n)return;let r=!0;const o=a.newScenario(L.Cu.UseDisabledByUserChecker);return(0,D.QL)(e,n).then((e=>{r&&(i(!e||Bt(n,e)),o.stop())})).catch((()=>{const e=`Failed to get conversation for bot/app:${n}`;s.error(e,{botMri:n}),r&&o&&o.fail({message:e})})),()=>{r=!1,o&&o.cancel()}}),[t,e,s,a]),n},Rt=async(e,t)=>{const n=await e.query({query:mt.A,variables:{convId:t},context:{callerInfo:"app-profile-card-data"}});return n.data?.chat},zt=(e,t)=>!!t&&!!t.isOneOnOne&&!!t.memberIds&&-1!==t.memberIds.indexOf(e),Bt=(e,t)=>!!t&&!!t.isDisabled&&!!t.memberIds&&-1!==t.memberIds.indexOf(e),Vt=e=>{let t=e&&e.bots&&e.bots.length>0&&e.bots[0].id;if(t){const e=t?.startsWith(J.gN.BotPrefix);t=e?t:`${J.gN.BotPrefix}${t}`}return t||null},_t=e=>e&&e.meetingExtensionDefinition&&e.meetingExtensionDefinition.scenes&&e.meetingExtensionDefinition.scenes.length>0?e.meetingExtensionDefinition.scenes.length:0,Wt=e=>{const t={supportsCalling:!1,supportsVideo:!1},n=e?.bots&&e?.bots[0]?.capabilities;return t.supportsCalling=n?.supportsCalling??!1,t.supportsVideo=n?.supportsVideo??!1,t},Qt=e=>(e?.bots&&e?.bots[0]?.configuration)??null,Yt="ext_actionable_app_profile_card_use_is_app_installed_get_installed_apps",Gt=({client:e,botIdOrAppId:t,hideActionButtons:n,hideAppButton:a,appDef:s,togetherModeParams:o,convId:l})=>{const{isOneOnOne:d,isDisabledByTenant:c,isOneOnOneBotChat:u}=Pt(e,s,l),p=jt(e,s),g=s&&Vt(s),m=s&&_t(s),h=s&&Wt(s),I=s&&Qt(s),{id:M,name:T,privacyUrl:N,termsOfUseUrl:y,largeImageUrl:C,shortDescription:S,meetingExtensionDefinition:b}=s,D=Ot(s),w=!D&&!!n,v=((e,t)=>{const[n,i]=r.useState(null),{scenarioFactory:a}=(0,E.ur)(),s=(0,U.U)("useIsAppInstalled"),{enableAppsQueryOptimization:o,enableInstalledAppQueryOptimization:l}=(0,f.w2)(A.w.Extensibility,["enableAppsQueryOptimization","enableInstalledAppQueryOptimization"]);return r.useEffect((()=>{(0,Fe.tN)(e,s,a,t,o,"use-is-app-installed",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:l}).then((e=>{const t=`Loaded installed apps. Length: ${e.length}`;s.infoToTelemetry?s.infoToTelemetry(t,Yt):s.log(`${Yt}: ${t}`),i(e.length>0)})).catch((()=>{const e=`Failed to get installed apps by ID for app id: ${t}`;s.errorToTelemetry?s.errorToTelemetry(e,Yt):s.error(`${Yt}: ${e}`)}))}),[e,s,a,t,o,l]),n})(e,M),L=(e=>{const t="Personal",n=(0,Fe.vx)(t,e.bots)||(0,Fe.vx)(t,e.galleryTabs)||(0,Fe.vx)(t,e.staticTabs),i=(0,Fe.vx)(t,e.messageExtensions)&&!!e.messageExtensions?.some((e=>(e.commands?.length??0)>0)),r=(e.meetingExtensionDefinition?.scenes?.length??0)>0,a=(e.meetingExtensionDefinition?.filters?.length??0)>0;return n||r||a||i})(s);return(0,i.Y)(He,{appDef:s,botName:Zt(T),privacyUrl:Zt(N),termsOfUseUrl:Zt(y),iconUrl:Zt(C),description:Zt(S),botIdOrAppId:g||t,showRectAppImage:!!o?.isSceneApp||w,sceneCount:m||0,isSceneApp:!!o?.isSceneApp,showActionButtons:D&&!d&&!c&&!p&&!n,hideAppButton:a,sceneName:Zt(o?.sceneName),botCallingCapabilities:h,appId:M,supportsMeetingStreaming:b?.supportsStreaming,hasPersonalScope:L,isInstalled:!!v,botConfiguration:u?null:I})},Zt=e=>e||"",Ht=({client:e,botIdOrAppId:t,hideActionButtons:n,appDef:r,togetherModeParams:a,convId:s})=>{const{isOneOnOne:o,isDisabledByTenant:l,isOneOnOneBotChat:d}=Pt(e,r,s),c=jt(e,r),u=r&&Vt(r),p=r&&_t(r),g=r&&Wt(r),m=r&&Qt(r),{id:h,name:I,privacyUrl:M,termsOfUseUrl:f,developerName:A,largeImageUrl:T,longDescription:N,shortDescription:y,meetingExtensionDefinition:C}=r,S=Ot(r),b=!S&&n||!1,D=!r?.id&&!n;return(0,i.Y)(Me,{botName:Jt(I),privacyUrl:Jt(M),termsOfUseUrl:Jt(f),developerName:Xt(a)?"":Jt(A),iconUrl:Jt(T),description:Xt(a)?Jt(y):Jt(N),botIdOrAppId:u||t,showRectAppImage:Xt(a)||b,isShortProfileCard:D,sceneCount:p||0,isSceneApp:!!Xt(a),showActionButtons:S&&!o&&!l&&!c&&!n&&!D,sceneName:Jt(a&&a.sceneName),botCallingCapabilities:g,appId:h,supportsMeetingStreaming:C?.supportsStreaming,botConfiguration:d?null:m,appDef:r})},Jt=e=>e||"",Xt=e=>e&&e.isSceneApp;var qt=n(115100),Kt=n(619761);const $t=({className:e})=>(0,i.Y)($.s,{className:e,children:(0,i.Y)(p.s,{fill:!0,vAlign:"center",hAlign:"center",children:(0,i.Y)(Qe.y,{})})});var en=n(140336);const tn=(0,Y.O)({isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"}});var nn=n(172084);const rn=r.memo((({children:e,client:t,botIdOrAppId:n,hideActionButtons:l,hideAppButton:d,position:c,align:u,offset:p,togetherModeParams:g,autoFocus:m,connectorSenderGuid:h,conversationId:I,onBehalfOfId:M,renderTriggerAsLink:T=!0,displayName:N,tabbableTrigger:y,nonFocusableTrigger:C})=>{const S=r.useContext(Kt.I18nContext),{recordPanelAction:b,createDatabag:D}=(0,v.ib)(),E=r.useRef(!1),{enableAppProfileCard:U,enableActionableAppProfileCard:L,enableInstalledAppQueryOptimization:k,enableLegacyAppProfileCardHoverEventRecording:x}=(0,f.w2)(A.w.Extensibility,["enableAppProfileCard","enableActionableAppProfileCard","enableInstalledAppQueryOptimization","enableLegacyAppProfileCardHoverEventRecording"]),O=tn(),{vars:P}=(0,a.W)(),[j,R]=r.useState(!1),z=(0,nn.ab)(qt.Jj.POST_CRITICAL),B=(0,H.BG)(n),V=Ut(t,B&&M?M:n,g,I,h,N,B,!!k,!z),_=(0,ht.debounce)((()=>{R(!0)}),1e3),W=r.useCallback(((e,t)=>{const n=t?.open;if(_.cancel(),!0===n?_():R(!1),x&&n&&!E.current){const e=F(w.Od.hover,w.nd.inspect,w.vB.appProfileCardAppear,w.Sn.appProfileCard,V?.name??void 0,V?.id,V?.bots?.[0]?.id);L&&(e.dataBag=D(),e.dataBag.actionableAppProfileCard=!0),b(e)}void 0!==n&&n!==E.current&&(E.current=n)}),[D,b,V,L,E,_,x]),Q=r.useMemo((()=>an(!!L)),[L]);if(!U)return(0,i.Y)(r.Fragment,{children:e});if(null===V)return null;const Y=((e,t,n,i)=>{if(n){const{name:r,developerName:a,longDescription:s,shortDescription:o}=n,l=i?.sceneName,d=_t(n),c=(t?o:s)||"";return e.stringTranslate("extensibility","app_profile_card_app_information_dialog_aria_label",{sceneName:l||"",name:r||"",developerName:a||"",sceneCount:d||0,longDescription:c})}return""})(S,!!L,V,g),G=e??V?.name;return(0,i.Y)(s.z,{on:"hover",position:c||"before",align:u||"center",offset:p,open:j,onOpenChange:W,autoFocus:m,trapFocus:!m,autoSize:!0,content:{"aria-label":Y,autoFocus:!0,className:en.n,content:V?(0,i.Y)(Q,{botIdOrAppId:n,client:t,appDef:V,hideActionButtons:l,hideAppButton:d,togetherModeParams:g,convId:I}):(0,i.Y)($t,{className:O.isAppProfileCard}),variables:{removePopupContentPadding:!0,hasNoBorder:!0}},tabbableTrigger:y,trigger:(0,i.Y)(o.E,{"data-tid":"app-profile-card-trigger",link:!!T,content:G,variables:P("extensibility",["isFocusableOutlineBorder"]),...C&&{tabIndex:"-1"}}),overflowBoundary:"window",flipBoundary:"window"})})),an=(e=!1)=>e?Gt:Ht,sn=(0,C.W)(rn)},463836:(e,t,n)=>{"use strict";n.d(t,{R4:()=>p,IZ:()=>u,A_:()=>g});var i=n(957032),r=n(513432),a=n(959022),s=n(755029);const o={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",width:"1px",position:"absolute"},l=r.forwardRef((({assertive:e,targetDocument:t},n)=>{const[l,d]=r.useState(""),c=r.useRef(),u=(0,s.ur)(),p=u?u.host:window,g=/Mac|iPod|iPhone|iPad/.test(p.navigator.platform),m=r.useCallback((e=>{d(e),null!==c.current&&p.clearTimeout(c.current),c.current=p.setTimeout((()=>{d(""),null!==c.current&&p.clearTimeout(c.current),c.current=null}),2e3)}),[c,p,d]);r.useImperativeHandle(n,(()=>({announce:m}))),r.useEffect((()=>()=>{null!==c.current&&p.clearTimeout(c.current)}),[c,p]);const h=t?t.body:p.document.body;let I=null;if(g){const e=t?t.activeElement:p.document.activeElement;I=e?.closest("*[aria-modal='true']")}const M=I||h;return a.createPortal((0,i.Y)("div",{"aria-live":e?"assertive":"polite","aria-atomic":"true",style:o,children:l}),M)}));var d=n(35871),c=n(106255);const u=({children:e,targetDocument:t})=>{const n=r.useRef(),a=r.useRef(),s=r.useCallback(((e,t)=>{const i=t?a.current:n.current;i&&i.announce(e)}),[a,n]),o=r.useMemo((()=>({announce:s})),[s]),u=r.useMemo((()=>({announce:(e,t)=>{const n=!!t&&!t.polite;s(e,n)}})),[s]);return(0,i.Y)(r.Fragment,{children:[(0,i.Y)(l,{assertive:!1,ref:n,targetDocument:t}),(0,i.Y)(l,{assertive:!0,ref:a,targetDocument:t}),(0,i.Y)(d.AnnounceProvider,{value:u,children:(0,i.Y)(c.AriaLiveContext.Provider,{value:o,children:e})})]})},p=c.AriaLiveContext.Consumer,g=()=>r.useContext(c.AriaLiveContext)},322636:(e,t,n)=>{"use strict";n.d(t,{j:()=>de});var i=n(957032),r=n(480354),a=n(513432),s=n(845097),o=n(402748),l=n(911234),d=n(755029),c=n(898307),u=n(99425),p=n(388072),g=n(755347),m=n(735652),h=n(754255),I=n(261580),M=n(506022),f=n(666699),A=n(418709),T=n(806658),N=n(379708),y=n(232062),C=n(172084),S=n(115100),b=n(937545),D=n(131647),E=n(117179),U=n(143922),w=n(324940),v=n(709812),L=n(370118),k=n(422598),x=n(794171);var F=n(391567);const O=(0,F.O)({avatarObjectFit:{st4lth:"f1ps3kmd"},groupChatAvatarObjectFit:{st4lth:"f1plgu50"}}),P=(0,F.O)({mercuryHexagonalAvatarBorder:{Bw0xxkn:"f13sgyd8"}}),j=(0,F.O)({teamAvatarBorder:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},teamHighContrastAvatarBorder:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f12wbrtg"}});var R=n(925067);const z=a.memo((({simpleAvatarType:e,...t})=>{const{enableFluentV9Avatar:n}=(0,m.w2)(h.w.People,["enableFluentV9Avatar"]);return e?(0,i.Y)(ne,{enableFluentV9Avatar:!!n,simpleAvatarType:e,...t}):(0,i.Y)(B,{...t})})),B=({accessibilityLabel:e,alt:t,presenceUserId:n,profilePictureType:i,presenceSource:r,isPresencePrefetched:s,isEmergencyCallTarget:o,shouldAllowContextMenu:u,isFocusable:p,hexagonal:g,square:I,userId:M,personaType:f,hostConversationId:A,isDoubleClickDisabled:T,narrateProfilePicture:y,callerInfo:C,statusSize:S,isSharedChannel:b,isXtapUserUrl:D,draggable:w,isTeamHeaderEmblemExpanded:v,hidePersonaCard:k,v9ClassName:F,role:R,avatarUrl:z,cacheKey:B,isGroupChatAvatarPresetOrEmojiPicture:_=!1,displayName:W,onError:Q,allowDoubleClickEventPropagation:te,...ne})=>{const ie=(0,l.U)("AvatarRenderer"),re=a.useRef(null),ae=(()=>{const{host:e}=(0,d.ur)(),{avatarDoubleClickDelayInMs:t}=(0,m.w2)(h.w.People,["avatarDoubleClickDelayInMs"]),n=a.useRef(null),i=t||0,r=e=>{s(),null!==e&&null!==e.current&&e.current.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},s=()=>{n.current&&e.clearTimeout(n.current),n.current=null};return a.useEffect((()=>()=>{n.current&&(e.clearTimeout(n.current),n.current=null)}),[e,n]),(t,a,o,l)=>{i>0&&!o?(t.preventDefault(),t.stopPropagation(),n.current?s():n.current=e.setTimeout((()=>{r(a),l&&l(t)}),i)):l&&l(t)}})(),se=j(),oe=P(),le=O(),{isOnline:de}=(0,d.WB)(),{themeType:ce}=(0,E.z2)(),ue=(0,c.bE)(),[pe,ge]=a.useState(!1),[me,he]=a.useState(z),[Ie,Me]=a.useState(!1),{entityCommanding:fe,user:Ae,avatarImageCache:Te}=(0,d.ur)(),{enableShowPresenceInCriticalPhase:Ne}=(0,m.w2)(h.w.Presence,["enableShowPresenceInCriticalPhase"]),{msgEnableSelfChat:ye,allowUserChat:Ce,enableChatActionFromAvatar:Se,enableFluentV9Avatar:be,enableFailedAvatarReloadOnNetworkReconnect:De,enableInitialsAvatarOnError:Ee,enableMercuryDesign:Ue}=V(),{onClick:we,onKeyDown:ve,onMouseEnter:Le,onMouseLeave:ke}=(0,U.q0)({userId:M,personaType:f,hostConversationId:A}),xe=H(y,e),Fe=a.useCallback((e=>{ge(e.isError),he(e.currentUrl),Me(e.shouldReload)}),[]),Oe=(0,L.z)((i===N.It.Team||I)&&se.teamAvatarBorder,ce===x.SV.Contrast&&se.teamHighContrastAvatarBorder,F,!!Ue&&!!g&&oe.mercuryHexagonalAvatarBorder),Pe=ee(!!De,pe,de,Ie,z,i,o,!!Ee,ue,W||""),je=q(i,p,I),Re={...ne.variables,...je},ze={profilePictureType:i,imageUrl:Pe,isEmergencyCallTarget:o,logger:ie,avatarState:{currentUrl:me,isError:pe,shouldReload:Ie},isOnline:de,setAvatarState:Fe},Be=be?void 0:Z(n,r,s,S),Ve=!!g,_e={...Y(!!p,Pe,t,w,e,_?le.groupChatAvatarObjectFit:le.avatarObjectFit),onError:e=>{$(ze,Q)},onLoad:e=>{(e=>{try{const t=new URL(e);if("https:"!==t.protocol)return!1;const n=t.searchParams.get("size");if(null!==n&&n!==N.xi.Small)return!1}catch(e){return!1}return!0})(Pe)&&Te?.add(B||Pe,Pe),K(ze)},onContextMenu:e=>J(e,u),onDoubleClick:e=>{X(T,Ce,Se,M,i,Ae,fe,ye),!te&&e.stopPropagation()},onClickCapture:e=>ae(e,re,T,we),...!k&&!Ve&&{onKeyDown:ve,onMouseEnter:Le,onMouseLeave:ke}},We={root:{isTeamHeaderEmblemExpanded:v},image:{...xe,..._e,variables:Re},status:Be?{...Be,variables:Re}:Be,...ne},Qe=We["data-tid"],Ye=xe["aria-label"];return G(n,r,We,_e,re,Oe,je,g,!!be,Qe,R,!!p,Ye,!!Ne,y)},V=()=>{const{msgEnableSelfChat:e}=(0,m.w2)(h.w.Host,["msgEnableSelfChat"]),{allowUserChat:t,enableChatActionFromAvatar:n}=(0,m.w2)(h.w.Messaging,["allowUserChat","enableChatActionFromAvatar"]),{enableFluentV9Avatar:i,enableFailedAvatarReloadOnNetworkReconnect:r,enableInitialsAvatarOnError:a}=(0,m.w2)(h.w.People,["enableFluentV9Avatar","enableFailedAvatarReloadOnNetworkReconnect","enableInitialsAvatarOnError"]),{enableMercuryDesign:s}=(0,m.w2)(h.w.MercuryDesign,["enableMercuryDesign"]);return{msgEnableSelfChat:e,allowUserChat:t,enableChatActionFromAvatar:n,enableFluentV9Avatar:i,enableFailedAvatarReloadOnNetworkReconnect:r,enableInitialsAvatarOnError:a,enableMercuryDesign:s}},_=e=>{if(!(0,C.ab)(S.Jj.POST_CRITICAL)||!e.presenceUserId)return(0,i.Y)(W,{...e,isFocusable:!1});const{hexagonal:t,presenceUserId:n,presenceSource:r,avatarRef:a,commonImgAttributes:s,role:o,isFocusable:l,v9AllStyles:d,dataTid:c,ariaLabel:u,size:p,narrateProfilePicture:g}=e;return(0,i.Y)(Q,{hexagonal:!!t,presenceUserId:n,presenceSource:r||"ups",avatarRef:a,commonImgAttributes:{...s,role:o||(l?"img":"presentation")},v9AllStyles:d,dataTid:c,ariaLabel:u,size:p,narrateProfilePicture:g})},W=({hexagonal:e,dataTid:t,v9AllStyles:n,commonImgAttributes:r,size:a,isFocusable:s,role:o,avatarRef:l})=>e?(0,i.Y)(w.A,{commonImgAttributes:r,className:n,size:(0,y.BY)(a),avatarRef:l}):(0,i.Y)(k.e,{"data-tid":t,image:{...r},ref:l,className:n,size:(0,y.BY)(a),role:o||(s?"img":"presentation")}),Q=({hexagonal:e,presenceUserId:t,presenceSource:n,avatarRef:r,commonImgAttributes:a,v9AllStyles:s,dataTid:o,size:l,ariaLabel:d,narrateProfilePicture:c,role:u})=>{const p=(0,v.qI)(t,n);let g=!0;return c&&(g=!1),e?(0,i.Y)(w.A,{"aria-label":d,badgeProps:p,commonImgAttributes:a,className:s,size:(0,y.BY)(l),"aria-hidden":g,avatarRef:r}):(0,i.Y)(k.e,{"aria-hidden":g,"aria-label":d,badge:p,"data-tid":o,image:{...a},ref:r,className:s,size:(0,y.BY)(l),role:u})},Y=(e,t,n,i,r,a)=>({alt:n,src:t,draggable:i,...e&&{"data-is-focusable":!0,"aria-haspopup":!0,"aria-hidden":!1,"aria-label":r,tabIndex:0},className:a}),G=(e,t,n,r,a,s,o,l,d,c,u,p,g,m,h)=>{const I=l?w.A:f.e;return d?e&&m?(0,i.Y)(Q,{hexagonal:!!l,presenceUserId:e,presenceSource:t||"ups",avatarRef:a,commonImgAttributes:{...r,role:u||(p?"img":"presentation")},v9AllStyles:s,dataTid:c,ariaLabel:g,size:n?.size,narrateProfilePicture:h}):(0,i.Y)(_,{hexagonal:!!l,presenceUserId:e,presenceSource:t||"ups",commonImgAttributes:r,v9AllStyles:s,size:n?.size,avatarRef:a,role:u??"presentation",isFocusable:p,dataTid:c}):(0,i.Y)(I,{...n,size:(0,y.fr)(n.size),variables:{...n?.variables,...o},ref:a})},Z=(e,t,n,r)=>e?{children:(a,s)=>{const o=r?{size:r}:{};return(0,i.Y)(v.Fd,{userId:e,ProvidedStatus:a,presenceSource:t,isPresencePrefetched:n,...s,...o})}}:void 0,H=(e,t)=>{const n={};return"boolean"==typeof e&&(n["aria-hidden"]=!e),t&&(n["aria-label"]=t),n},J=(e,t)=>{t||(e.preventDefault(),e.stopPropagation())},X=async(e,t,n,i,r,a,s,o)=>{!e&&t&&n&&i&&!(0,T.FL)(i)&&r===N.It.User&&(o||a?.id!==i)&&await s.chat.chatWithUsers({userIds:[i],entityCommand:{stateTransition:b.Ar.new,visibilityState:b.Rp.show,correlation:{source:D.p.Avatar}}})},q=(e,t,n)=>({...(e===N.It.Team||n)&&{isTeamProfilePicture:!0},...t&&{hasCursorPointer:!0}}),K=e=>{e.avatarState.isError?e.isOnline&&e.avatarState.shouldReload?e.setAvatarState({...e.avatarState,isError:!1,shouldReload:!1}):e.logger.debug("Avatar onLoad. Returning without triggering state change."):e.setAvatarState({...e.avatarState,isError:!1})},$=(e,t)=>e.avatarState.isError?(e.avatarState.shouldReload?e.setAvatarState({currentUrl:(0,y.Ng)(e.profilePictureType,e.isEmergencyCallTarget),isError:!0,shouldReload:!1}):e.logger.debug("Avatar onError. Returning without triggering state change"),!1):(e.logger.warn("Avatar load failed. Handling onError by setting currentUrl in state to default image."),e.setAvatarState({currentUrl:"",isError:!0,shouldReload:!e.isOnline}),t&&t(),!1),ee=(e,t,n,i,a,s,o,l,d,c)=>{let u=a;if(t&&(!e||!n||!i)&&(u=(0,y.Ng)(s,o),l&&s===N.It.User)){(0,r.isEmpty)(c)&&(c=te(a));u=`${d}${R.kv.replace("{displayName}",encodeURIComponent(c))}`}return u},te=e=>{const t=new URLSearchParams(e.slice(e.indexOf("?")));return t.get("displayName")||t.get("displayname")||""},ne=({simpleAvatarType:e,enableFluentV9Avatar:t,onError:n,...r})=>{const s=r["data-tid"];if(t)return(0,i.Y)(k.e,{className:r.v9ClassName,size:(0,y.BY)(r.size),"data-tid":s,...r.label&&{initials:{children:(0,i.Y)(a.Fragment,{children:r.label})}},...r.v9Icon&&{icon:r.v9Icon},...r.name&&{name:r.name},...r.avatarUrl&&{image:{src:r.avatarUrl,...n?{onError:n}:{}}}});{const{variables:e}=r,t=(0,y.fr)(r.size);return(0,i.Y)(f.e,{variables:e,size:t,"data-tid":s,...r.label&&{label:{children:(0,i.Y)(a.Fragment,{children:r.label})}},...r.icon&&{icon:r.icon},...r.name&&{name:r.name},...r.avatarUrl&&{image:{src:r.avatarUrl,...n?{onError:n}:{},...r.variables?{variables:r.variables}:{}}}})}};var ie=n(853959);const re=[N.It.User,N.It.Group,N.It.Team],ae=(e,t,n,i,r=N.xi.Small)=>{const{user:a,avatarImageCache:s,coreSettings:o}=(0,d.ur)(),{enableAvatarUrlCacheLookup:l}=(0,m.w2)(h.w.ImageCache,["enableAvatarUrlCacheLookup"]),{enableMSAProfilePicture:c}=(0,m.w2)(h.w.People,["enableMSAProfilePicture"]),u=(0,y.L9)(e,t),{entity:p}=(0,y.WF)(e,t);if(!l||!s||a?.id===u)return null;const g=(0,y.EO)(u,n,e?.groupId||e?.teamThreadId,c,i||!1,void 0,void 0,void 0,p,o);if(!re.includes(g))return null;const I=[r];if(p&&(e=>"id"in e&&!!e.id)(p))I.push("user"),I.push(p.id),I.push(p.displayName),I.push(p.imageUri);else if(p&&(e=>Array.isArray(e))(p)&&p.length>1)I.push("group"),I.push(p.map((e=>`${e.id}-${e.displayName}`)).slice(0,R.kk).join("-"));else{if(!p||!(e=>"groupId"in e&&!!e.groupId)(p))return null;I.push("team"),I.push(p.groupId),I.push(p.displayName),I.push(p.pictureETag)}const M=I.filter(Boolean).join("-"),f=s?.getUrl(M);return{cacheKey:M,cachedUrl:f}};var se=n(18732),oe=n(67309);const le={kind:"Document",get definitions(){const e=(0,oe.G)("subscription msaProfileAvatarChangedEvent($isSelfProfileAvatar:Boolean!) {msaProfileAvatarChangedEvent(isSelfProfileAvatar:$isSelfProfileAvatar) {id,updateType,updatedTime}}");return delete this.definitions,this.definitions=e.definitions}},de=({simpleAvatarType:e,avatarUrl:t,isMeetingChat:n,...a})=>{const{vars:s}=(0,M.W)();if(e)return(0,i.Y)(z,{simpleAvatarType:e,avatarUrl:t||"",profilePictureType:N.It.Simple,...a});if(n){const e=Array.isArray(a.variables)?a.variables:[];return(0,i.Y)(f.e,{icon:(0,i.Y)(I.zJo,{}),variables:s("search",(0,r.merge)(["meetingChatAvatar"],e))})}return(0,i.Y)(ce,{avatarUrl:t,...a})},ce=({users:e,team:t,profilePictureSize:n,isEmergencyCallTarget:i,requesterObjectId:r,baseImageUrl:a,skipAvatarQuery:s,avatarUrl:o,onError:c,...u})=>{const p=(0,l.U)("AvatarContainer"),{user:g,scenarioFactory:m}=(0,d.ur)(),h=(0,y.L9)(t,e),I=g?.id===h,{baseUrlFromHook:M,isCookieValid:f,client:A}=me(),N=he(),C=Ie(),S=r||C.currentUserObjectId,{entity:b,generator:D}=(0,y.WF)(t,e),E=a||M,U=h&&(0,T.Iz)(h)&&N.botListWithAppDefinitionName.includes(h),w=(e=>{const t=(0,l.U)("MsaProfileAvatarSubscription"),{data:n,loading:i,error:r}=(0,se.R)(le,{skip:!e,variables:{isSelfProfileAvatar:e}});return(r||!i&&!n&&e)&&t.error("msa profile avatar subscription failed"),n?.msaProfileAvatarChangedEvent})(I&&N.enableMsaSelfProfileAvatarUpdateSubscription);o=Me(!!h,o,S,n,t,e);const v=ge(i||U?null:o||e?.[0]?.avatarUrl,n,!!h&&(0,T.AF)(h),!t&&!h&&!!u.conversationId,N.enableCacheCheckOnAvatarUrlFromCaller,f),{cacheKey:L,cachedUrl:k}=ae(t,e,u.conversationId,u.showMergedAvatarForGroup,n)||{},x=s||!!v||!!k;x&&p.debug(`Skipping generating avatar URL. skipAvatarQuery: ${s}, propsAvatarUrl: ${v}, cachedUrl: ${k}, callerInfo: ${u.callerInfo}`);const F=ue(u),O=(0,ie.g)({avatarEtag:(0,y.Dm)(w,g,h),baseImageUrl:E,client:A,currentUserOid:S,entity:b,generator:D,isEmergencyCallTarget:i,isImageAuthCookieValid:f,logger:p,profilePictureSize:n,scenarioFactory:m,teamId:t?.groupId||t?.teamThreadId,userId:h,skipGeneratingUrl:x,isSelfProfileAvatar:I,...C,...N,...F},u.callerInfo),P=v||k||O,j=(0,y.X3)(P),{onError:R}=pe({callerInfo:u.callerInfo,skipGeneratingUrl:x,propsAvatarUrl:v,cachedUrl:k,generatedUrl:O,baseImageUrl:E,isCookieValid:f,generator:D,isSelfProfileAvatar:I,forSharedChannel:!!F.isSharedChannel,isXtapUserUrl:j,logger:p,scenarioFactory:m,onErrorFromProps:c});return fe({generator:D,entity:b,userId:h,conversationId:F.conversationId,hostTenantId:F.hostTenantId,avatarUrl:P,draggable:!1,isBotAvatar:(0,y.Ch)(h?e?.[0]:void 0),cacheKey:L,isXtapUserUrl:j,isEmergencyCallTarget:i,onError:R,...u})},ue=e=>{const{conversationId:t,showMergedAvatarForGroup:n,showUpdatedGroupAvatar:i,onBehalfOfId:r,hostTenantId:a,isSharedChannel:s}=e;return{conversationId:t,showMergedAvatarForGroup:n,showUpdatedGroupAvatar:i,onBehalfOfId:r,hostTenantId:a,isSharedChannel:s}},pe=({callerInfo:e,skipGeneratingUrl:t,propsAvatarUrl:n,cachedUrl:i,generatedUrl:r,baseImageUrl:s,isCookieValid:o,generator:l,isSelfProfileAvatar:d,forSharedChannel:c,isXtapUserUrl:u,logger:p,scenarioFactory:g,onErrorFromProps:m})=>{const h=he(),I=a.useMemo((()=>({callerInfo:e,skipGeneratingUrl:t,propsAvatarUrl:n,cachedUrl:i,generatedUrl:r,baseImageUrl:s,isCookieValid:o,profilePictureType:l.profilePictureType,isSelfProfileAvatar:d,forSharedChannel:c,isXtapUserUrl:u,logger:p,scenarioFactory:g})),[s,i,r,l.profilePictureType,o,d,u,p,c,n,e,g,t]),M=a.useMemo((()=>((e,t,n)=>t||(e?()=>{(0,y.Qc)(n)}:void 0))(h.enableFBSTelemetryForAvatarStatus,m,I)),[h.enableFBSTelemetryForAvatarStatus,I,m]);return{onErrorArgs:I,onError:M}},ge=(e,t,n,i,r,s)=>{const o=(0,y.eB)(e,t,n),l=r&&!s&&!!o,d=l?(0,y.UI)(o,n,i):o,[c,u]=a.useState(d),p=a.useRef(!1);return a.useEffect((()=>(p.current=!0,l&&d!==o?(0,y.iU)(o).then((e=>{const t=e?o:d;p.current&&u(t)})):u(o),()=>{p.current=!1})),[l,d,o]),l?c:o},me=()=>({baseUrlFromHook:(0,c.bE)(),isCookieValid:(0,c.XF)(),client:(0,A.m)()}),he=()=>{const{enableMSAProfilePicture:e,enableMsaSelfProfileAvatarUpdateSubscription:t,enableCachedAvatarCheck:n,enableProfilePicturesWithObjectId:i,enableSampleAvatarFetch:r,enableAvatarUrlQuery:a,enableFBSTelemetryForAvatarStatus:s,enableCacheCheckOnAvatarUrlFromCaller:o}=(0,m.w2)(h.w.People,["enableMSAProfilePicture","enableMsaSelfProfileAvatarUpdateSubscription","enableCachedAvatarCheck","enableProfilePicturesWithObjectId","enableSampleAvatarFetch","enableAvatarUrlQuery","enableFBSTelemetryForAvatarStatus","enableCacheCheckOnAvatarUrlFromCaller"]),{enableConnectorsProfileInChannels:l}=(0,m.w2)(h.w.Extensibility,["enableConnectorsProfileInChannels"]),{customViewBots:d}=(0,m.w2)(h.w.Calling,["customViewBots"]),{enableEntityMoreInfo:c}=(0,m.w2)(h.w.Core,["enableEntityMoreInfo"]),{botListWithAppDefinitionName:u}=(0,m.w2)(h.w.Extensibility,["botListWithAppDefinitionName"]),p=!!(d&&d.length>0);return{enableCachedAvatarCheck:!!n,enableConnectorsProfileInChannels:!!l,enableMSAProfilePicture:!!e,enableFBSTelemetryForAvatarStatus:!!s,isProfilePictureWithObjectIdEnabled:!!i,enableSampleAvatarFetch:!!r,enableAvatarUrlQuery:!!a,customViewBots:d||[],enableMsaSelfProfileAvatarUpdateSubscription:!!t,enableCacheCheckOnAvatarUrlFromCaller:!!o,enableEntityMoreInfo:!!c,isCustomViewBots:p,customViewBotIds:p?d[0]:{},botListWithAppDefinitionName:u||[]}},Ie=()=>{const{authenticationUser:e}=(0,d.ur)(),t=e?.type===u.aS.Anonymous,n=e?.type===u.aS.Msa||e?.type===u.aS.MsaLife,i=e?.id;return{isAnonymousAccount:t,isTflUser:n,currentUserObjectId:i}},Me=(e,t,n,i,r,a)=>{const s=(0,p.PO)(),o=(0,c.bE)(),{user:l}=(0,d.ur)(),{displayName:u,entity:g,generator:m}=(0,y.WF)(r,a),h=(0,y.xG)(!!e,s,t,u),I=g?.id===l?.id,M=he();return h?m.generateUrl(g,o,M.isProfilePictureWithObjectIdEnabled,n,i,!1,void 0,void 0,void 0,void 0,void 0,I):t},fe=({avatarUrl:e,generator:t,hidePersonaCard:n,isEmergencyCallTarget:r,isFocusable:l,role:d,shouldAllowContextMenu:c,userId:u,isDoubleClickDisabled:p,statusSize:m,isSharedChannel:h,conversationId:I,hostTenantId:M,draggable:f,connectorSenderGuid:A,onBehalfOfId:T,isBotAvatar:N,square:C,cacheKey:S,showPresence:b,entity:D,isXtapUserUrl:E,...U})=>{const w=u&&D,v=w&&w.displayName||void 0,L=a.useMemo((()=>(0,s.v4)()),[]),k=he(),{isTflUser:x}=Ie(),F=(0,y.C0)(u,b,t,D),O=(0,i.Y)(z,{accessibilityLabel:U.accessibilityLabel,presenceUserId:F,profilePictureType:t.profilePictureType,role:d||(l?"button":"presentation"),shouldAllowContextMenu:c,isEmergencyCallTarget:r,isFocusable:l,hexagonal:!C&&N&&!(0,y.uC)(u,k.customViewBotIds),square:C,userId:u,isDoubleClickDisabled:N&&x||p,statusSize:m,avatarUrl:e,draggable:f,isSharedChannel:h,isXtapUserUrl:E,hidePersonaCard:n,cacheKey:S,displayName:v,...U}),P=n||k.enableEntityMoreInfo||!u?O:(0,i.Y)(g.FN,{userId:u,isSharedChannel:h,hostConversationId:I,hostTenantId:M,disableAccessibilityDefaults:!0,externalAppSessionCorrelationId:L,displayName:v,callerInfo:U.callerInfo,"data-tid":"avatar",children:O},u);return n||!u||!(0,y.oG)(u)&&N?!n&&u&&N?(0,i.Y)(o.by,{botIdOrAppId:u,connectorSenderGuid:A,conversationId:I,onBehalfOfId:T,displayName:v,renderTriggerAsLink:!1,nonFocusableTrigger:!0,children:O},u):O:P}},549981:(e,t,n)=>{"use strict";n.d(t,{uk:()=>i,r8:()=>A,rO:()=>y});var i,r=n(513432),a=n(735652),s=n(754255),o=n(693284),l=n(755029),d=n(911234),c=n(619761),u=n(43372),p=n(226107),g=n(84646),m=n(480354),h=n(99595),I=n(845097),M=n(236184),f=n(702183);!function(e){e.InitialConfig="config",e.ReConfig="reconfig"}(i||(i={}));const A=(e,t)=>{if(e.bots?.[0]?.configuration){if(t===h.jr.Team)return T(e)?e.bots[0].configuration.team:null;if(t===h.jr.GroupChat)return N(e)?e.bots[0].configuration.groupChat:null}return null},T=e=>null!==e.bots?.[0]?.configuration?.team?.fetchTask,N=e=>null!==e.bots?.[0]?.configuration?.groupChat?.fetchTask,y=()=>{const{enableBotConfiguration:e}=(0,a.w2)(s.w.Extensibility,["enableBotConfiguration"]),{scenarioFactory:t}=(0,l.ur)(),n=(0,d.U)("BotConfigLauncher"),i=r.useContext(c.I18nContext),{entityCommanding:o}=(0,l.ur)(),u=(0,M.U)();return r.useCallback(((r,a,s,l)=>{const d=t.newScenario(f.Cu.ExtBotConfig),c=A(s,a);c&&e&&(d.appendEventData({configEntryPoint:l}),C(s,c,r,i,n,o,a,u,d))}),[e,n,o,u,i,t])},C=async(e,t,n,i,r,a,s,o,l)=>{const d=S(e,n,i,t);if(t&&d)try{const t=(0,I.v4)();a.platform.launchTaskModule(t,{taskModuleOptions:{input:d,launchContext:s===h.jr.GroupChat?{type:u.Y.chat,parentMessageId:o.replyChainId,...o,chatId:n,launchId:t}:{type:u.Y.channel,channelId:o.channelId,parentMessageId:o.replyChainId,teamId:n,launchId:t}}}).subscribe({complete:()=>{r.log(`task module complete for entrypoint ${d.entryPoint}`),l.stop({"App.Id":e.id,"Bot.Id":e.bots?.[0].id})},error:t=>{const n=`error launching task module for entry point ${d.entryPoint}. errorCode: ${t.ErrorCode}, errorName: ${t.name}, innerErrorCode: ${t.innerError?.code}`;r.error(`${n} Error:`,t),l.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:n})}})}catch(t){r.log("error","Error while launching task module",t),l.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:"Error in launching task module with bot config entry point"})}},S=(e,t,n,i)=>({appName:e.name||"",appIcon:e.largeImageUrl||"",appId:e.id,isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,validDomains:e.validDomains||[],tenantId:e.tenantId||"",entryPoint:p.t7.BotConfig,botInvokeParams:{threadId:t,botMri:(0,m.first)(e.bots)?.id?`${g.gN.BotPrefix}${(0,m.first)(e.bots)?.id}`:""},fetchTask:i.fetchTask||!1,taskInfo:(0,o.Jm)(n,i.taskInfo)??{},isMicrosoftOwned:e.isMicrosoftOwned||!1,externalId:e.externalId||""})},172084:(e,t,n)=>{"use strict";n.d(t,{ab:()=>m,SX:()=>h,IN:()=>I,eh:()=>M,Qz:()=>f,Ur:()=>A});var i=n(957032),r=n(513432),a=n(911293),s=n(888591),o=n(297292),l=n(507907);const{useCallback:d,useEffect:c,useMemo:u,useRef:p,useState:g}=r,m=e=>{const{layoutPhaseStateMachineRef:t}=(0,l.yf)(),n=t.current,i=p(n),[r,d]=g(n.currentPhase>=e),m=u((()=>i.current.currentPhaseObservable.pipe((0,a.T)((t=>t>=e)),(0,s.F)())),[e,i]),h=(0,o.J)(m,{next:r?()=>r:d},!0);return c((()=>()=>h()),[h]),r&&h(),i.current===n||r?r||i.current.currentPhase>=e||n.currentPhase>=e:(d(!0),!0)},h=e=>{const{layoutPhaseStateMachineRef:t}=(0,l.yf)();return d((()=>t.current.currentPhase>=e),[t,e])},I=()=>{const{reportFirstPaintCallbackRef:e}=(0,l.yf)();e.current()},M=({component:e,fallback:t,minimumAppPhase:n})=>r=>m(n)?(0,i.Y)(e,{...r}):t?(0,i.Y)(t,{}):null,f=()=>{const{useAppPhasePostCriticalOnEveryPhaseCycle:e}=(0,l.yf)();return e()},A=()=>{const{useAppPhaseCompleteOnEveryPhaseCycle:e}=(0,l.yf)();return e()}},203774:(e,t,n)=>{"use strict";n.d(t,{u:()=>l,C:()=>d});var i=n(957032),r=n(480354),a=n(513432),s=n(591561);const o=a.createContext(void 0),l=e=>{const{children:t,...n}=e,a={...n,activeWindowService:n.activeWindowsService.getWindowLayoutService(n.windowId),context:{hostCommunicationService:n.hostCommunicationService}};return(0,i.Y)(o.Provider,{value:(0,s.F)(a,r.isEqual),children:t})},d=()=>a.useContext(o)},10269:(e,t,n)=>{"use strict";n.d(t,{wT:()=>c,g6:()=>u});var i=n(957032),r=n(513432),a=n(591561);const{createContext:s,memo:o,useContext:l}=r,d=s({UNSAFE_overflowAndFlipBoundaryRef:null});d.displayName="UNSAFE_OverflowAndFlipBoundaryContext";const c=o((e=>{const{children:t,...n}=e;return(0,i.Y)(d.Provider,{value:(0,a.F)(n),children:t})}));c.displayName="UNSAFE_OverflowAndFlipBoundaryContextProvider";const u=()=>l(d)},507907:(e,t,n)=>{"use strict";n.d(t,{Sz:()=>c,yf:()=>u});var i=n(957032),r=n(513432),a=n(591561);const{createContext:s,memo:o,useContext:l}=r,d=s(void 0),c=o((({children:e,...t})=>(0,i.Y)(d.Provider,{value:(0,a.F)(t),children:e}))),u=()=>l(d)},108001:(e,t,n)=>{"use strict";n.d(t,{wF:()=>o,LE:()=>l,F6:()=>c});var i=n(693973),r=n(572909),a=n(513432),s=n(349545);const o=a.createContext(null),l=()=>a.useContext(o),d=(e,t,n)=>null===e[n]&&null!==t[n]?1:null!==e[n]&&null===t[n]?-1:0;class c{constructor(e,t){this.activeWindowsService=e,this.windowId=t,this.handleEntitiesUpdate=(e,t)=>{if(!this.getDimensions)return;const n=this.activeWindowsService.getSlotLayoutConfigProperty(this.windowId,i.sk.NAV,i.EJ.DISPLAY_MODE)===i.UU.OVERLAY,a=this.activeWindowsService.getSlotLayoutConfigProperty(this.windowId,i.sk.END,i.EJ.DISPLAY_MODE)===i.UU.OVERLAY,s=this.activeWindowsService.getSlotLayoutConfigProperty(this.windowId,i.sk.END,i.EJ.DISPLAY_MODE)===i.UU.OVERLAY;if(n||a||s)return;const o=d(e,t,r.Ko.subNavEntity),l=d(e,t,r.Ko.midNavEntity),c=d(e,t,r.Ko.endEntity),u=this.getDimensions(i.sk.END).width,p=this.getDimensions(i.sk.SUBNAV).width,g=this.getDimensions(i.sk.MID_NAV).width,m=this.getDimensions(i.sk.MAIN).height??0,h=this.getDimensions(i.sk.HEADER).height??0,I=this.getDimensions(i.sk.CONTEXTUAL_NOTIFICATIONS).height??0;let M=this.getDimensions(i.sk.MAIN).width,f=this.getDimensions(i.sk.HEADER).width,A=this.getDimensions(i.sk.CONTEXTUAL_NOTIFICATIONS).width;M-=u*c+p*o+g*l,f-=p*o+g*l,A-=p*o+g*l,this.responsiveOptimisticStateObservables.get(i.sk.MAIN)?.next({width:M,height:m}),this.responsiveOptimisticStateObservables.get(i.sk.HEADER)?.next({width:f,height:h}),this.responsiveOptimisticStateObservables.get(i.sk.CONTEXTUAL_NOTIFICATIONS)?.next({width:A,height:I})},this.getDimensions=null,this.responsiveOptimisticStateObservables=new Map([[i.sk.END,new s.B],[i.sk.SUBNAV,new s.B],[i.sk.MID_NAV,new s.B],[i.sk.MAIN,new s.B],[i.sk.HEADER,new s.B],[i.sk.CONTEXTUAL_NOTIFICATIONS,new s.B]])}}},117179:(e,t,n)=>{"use strict";n.d(t,{X4:()=>s,z2:()=>o});var i=n(957032),r=n(513432);const a=r.createContext({}),s=r.memo((({children:e,setCoreThemeType:t,themeType:n,themeOptions:s})=>{const o=r.useMemo((()=>({setCoreThemeType:t,themeType:n,themeOptions:s})),[t,n,s]);return(0,i.Y)(a.Provider,{value:o,children:e})})),o=()=>r.useContext(a)},845214:(e,t,n)=>{"use strict";n.d(t,{YE:()=>d,jK:()=>h,ns:()=>I,KB:()=>p,zc:()=>T,nb:()=>A,hC:()=>m,XQ:()=>g});var i=n(845097),r=n(726390),a=n(754255),s=n(437542),o=n(67309);const l={kind:"Document",get definitions(){const e=(0,o.G)("query ComponentsCortexTopicsSdkAuthenticationAcquireTokenQuery($resource:String!,$acquireTokenOptions:AcquireTokenOptions) {authenticationToken(resource:$resource,acquireTokenOptions:$acquireTokenOptions) {token}}");return delete this.definitions,this.definitions=e.definitions}},d="https://substrate.office.com",c=new Map,u=6e4;function p(e){return(0,r.KB)(e)}async function g(e,t,n,i,r){const a=p(n);return a?(await I(t,n,i,a),e(a)):r?r():void 0}function m(e,t,n,i,r){const a=p(n);return a?(I(t,n,i,a),e(a)):r?r():void 0}function h(e,t){const n=(0,i.v4)();return async(i,r)=>{const a=f(e,t);if(c.has(a)){const e=c.get(a);e?.token&&i(e.token,n)}else r("No token in Reference",n)}}async function I(e,t,n,i){const{enableSilentLokiAuthTokenRetrieval:r,lokiTokenResourceUrl:o}=n.get(a.w.People),{enableCallKMApiDirectly:l}=n.get(a.w.Messaging),c=M(e,t,o||s.rs,r,i),u=l?M(e,t,d,r,i):Promise.resolve();return Promise.all([c,u]).then((()=>{}))}async function M(e,t,n,i,r){let a;const s={resourceUrl:n};r||(r=p(t));const o=c.get(f(n,t));if(o){if(Date.now()-o.lastRefreshTime<u)return}r&&(a=r.createQosEvent("Cortex.TopicAnnotations.RenewToken.Execute"));try{let r;if(e){const{data:o}=await e.query({query:l,variables:{resource:n,acquireTokenOptions:{silent:i}},fetchPolicy:"network-only"});r={token:o?.authenticationToken?.token,lastRefreshTime:Date.now()},r.token?(c.set(f(n,t),{token:r.token,lastRefreshTime:r.lastRefreshTime}),a?.logSuccess(s)):a?.logUnexpectedFailure("NoTokenReceived",void 0,s)}else a?.logUnexpectedFailure("NoApolloClient",void 0,s)}catch(e){a?.logUnexpectedFailure("ErrorThrowRetrievingToken",e,s)}}function f(e,t){return`${e}_${t.userAadObjectId??""}_${t.tenantAadObjectId??""}`}function A(e,t,n,i){const{enableCortexTopicsAuthRefactor:r}=n.get(a.w.Messaging),s=p(t);return r&&i?m(e,i,t,n):s?e(s):void 0}async function T(e,t,n,i){const{enableCortexTopicsAuthRefactor:r}=n.get(a.w.Messaging),s=p(t);return r&&i?g(e,i,t,n):s?e(s):void 0}},143922:(e,t,n)=>{"use strict";n.d(t,{q0:()=>u,KZ:()=>p,Kb:()=>g});var i=n(513432),r=n(735652),a=n(754255),s=n(697673),o=n(763588),l=n(525387);const{useCallback:d,useMemo:c}=i,u=({userId:e,displayName:t,personaType:n,hostConversationId:i,ariaLabel:u,tabIndex:p})=>{const{enableEntityMoreInfo:g}=(0,r.w2)(a.w.Core,["enableEntityMoreInfo"]),m=(0,o.useNovaEventing)(),h=d(((e,{userId:t,ariaLabel:n,tabIndex:i,displayName:r,personaType:a,hostConversationId:o})=>{if(t){const{left:l,top:d,width:c,height:u}=e.target.getBoundingClientRect();m.bubble({event:s.AZ.requestPersonMoreInfo({eventType:e.type,height:u,left:l,top:d,width:c,userId:t,displayName:r,personaType:a,hostConversationId:o,ariaLabel:n,tabIndex:i}),reactEvent:e})}}),[m]),I=d((r=>{g&&h(r,{userId:e,ariaLabel:u,tabIndex:p,displayName:t,personaType:n,hostConversationId:i})}),[g,h,e,u,p,t,n,i]),M=(0,l.l)(I,500),f=d((r=>{M.cancel(),g&&h(r,{userId:e,ariaLabel:u,tabIndex:p,displayName:t,personaType:n,hostConversationId:i})}),[g,M,h,e,u,p,t,n,i]),A=d((n=>{!g||"Enter"!==n.key&&" "!==n.key||h(n,{userId:e,ariaLabel:u,tabIndex:p,displayName:t})}),[g,h,e,u,p,t]),T=d((e=>{M.cancel()}),[M]);return c((()=>({onClick:f,onKeyDown:A,onMouseEnter:M,onMouseLeave:T})),[f,A,M,T])},p=({userId:e,displayName:t,ariaLabel:n,tabIndex:i})=>{const{enableEntityMoreInfo:l}=(0,r.w2)(a.w.Core,["enableEntityMoreInfo"]),u=(0,o.useNovaEventing)(),p=d(((e,{userId:t,ariaLabel:n,tabIndex:i,displayName:r})=>{if(t){const{left:a,top:o,width:l,height:d}=e.target.getBoundingClientRect();u.bubble({event:s.AZ.requestPersonMoreOrgInfo({eventType:e.type,height:d,left:a,top:o,width:l,userId:t,displayName:r,ariaLabel:n,tabIndex:i}),reactEvent:e})}}),[u]),g=d((r=>{l&&p(r,{userId:e,ariaLabel:n,tabIndex:i,displayName:t})}),[l,p,e,n,i,t]),m=d((r=>{!l||"Enter"!==r.key&&" "!==r.key||p(r,{userId:e,ariaLabel:n,tabIndex:i,displayName:t})}),[l,p,e,n,i,t]);return c((()=>({onClick:g,onKeyDown:m})),[g,m])},g=({userId:e,ariaLabel:t,tabIndex:n,topicId:i})=>{const{enableEntityMoreInfo:l}=(0,r.w2)(a.w.Core,["enableEntityMoreInfo"]),u=(0,o.useNovaEventing)(),p=d(((e,{userId:t,ariaLabel:n,tabIndex:i,topicId:r})=>{if(t){const{left:a,top:o,width:l,height:d}=e.target.getBoundingClientRect();u.bubble({event:s.AZ.requestTopicMoreInfo({eventType:e.type,height:d,left:a,top:o,width:l,userId:t,ariaLabel:n,tabIndex:i,topicId:r}),reactEvent:e})}}),[u]),g=d((r=>l?p(r,{userId:e,ariaLabel:t,tabIndex:n,topicId:i}):void 0),[l,p,e,t,n,i]),m=d((r=>{!l||"Enter"!==r.key&&" "!==r.key||p(r,{userId:e,ariaLabel:t,tabIndex:n,topicId:i})}),[l,p,e,t,n,i]),h=d((r=>l?p(r,{userId:e,ariaLabel:t,tabIndex:n,topicId:i}):void 0),[l,p,e,t,n,i]);return c((()=>({onClick:g,onKeyDown:m,onMouseEnter:h})),[g,m,h])}},568572:(e,t,n)=>{"use strict";n.d(t,{t:()=>l});var i=n(957032),r=n(513432),a=n(755029),s=n(199448);class o extends r.PureComponent{constructor(e){super(e),this.render=()=>{const{children:e,fallbackUI:t=null}=this.props,{error:n}=this.state;return n?"function"==typeof t?t(n,this.resetError.bind(this)):t:e},this.handleError=(e,t)=>{if((0,s.XC)(e))throw e;const{errorHandler:n,onErrorCallback:i,scenarios:r,rethrowError:a,loggerName:o}=this.props;if(i&&i(e),n){if(n(e,t),a)throw e;return}let l="";try{l=JSON.stringify(e)}catch(t){l=`Failed to stringify error: ${e}`}if(r?.forEach((e=>{e.fail({reason:`Error in ${o}: ${l}`})})),this.logger.error(`error: \n    ${l}\n    componentStack: \n    ${t.componentStack}`),a)throw e};const{loggerName:t,newLogger:n}=this.props;this.state={error:null},this.logger=n(t,"components-error-boundary")}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){this.logger.error(`Error message: ${e?.message}.`),this.handleError(e,t)}resetError(){this.setState({error:null})}}const l=e=>(0,i.Y)(o,{...e,newLogger:(0,a.ur)().loggerFactory.newLogger})},324940:(e,t,n)=>{"use strict";n.d(t,{A:()=>D});var i=n(957032),r=n(755029),a=n(735652),s=n(754255),o=n(666699);const l=e=>{const{hexagonal:t,...n}=e;if(t){const e=(e,t)=>{const{"aria-label":r,src:a,...s}=t;return(0,i.Y)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%",children:[(0,i.Y)("title",{children:n.name||s.alt||""}),(0,i.Y)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,i.Y)(e,{as:"image",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:a,"aria-label":r||n.name||s.alt||"",...s})]})};return(0,i.Y)(o.e,{...n,image:{..."object"==typeof n.image&&n.image,children:e}})}return(0,i.Y)(o.e,{...n})};var d=n(513432),c=n(911234),u=n(702183),p=n(288451),g=n(418709),m=n(944297),h=n(912146),I=n(422598),M=n(370118);const f=(0,n(391567).O)({transparent:{sj55zd:"f44pa96",De3pzq:"f3rmtva",Bic5iru:"f1pspie5"},foregroundColorStroke:{ojy3ng:"f1r2wt8h"}}),A=({alt:e,badge:t,name:n,size:r,src:a,className:s,onError:o,onLoad:l,avatarRef:c,commonImgAttributes:u})=>{const p=f();return(0,i.Y)(d.Fragment,{children:(0,i.Y)(I.e,{badge:t,className:(0,M.z)(p.transparent,s),icon:{children:()=>(0,i.Y)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%","aria-label":e,children:[(0,i.Y)("title",{children:""}),(0,i.Y)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,i.Y)("image",{clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:a,...u}),(0,i.Y)("use",{className:p.foregroundColorStroke,href:"#bot-hexagon-path",strokeOpacity:.2,strokeWidth:"1px",strokeLinejoin:"round",fill:"none",clipPath:"url(#bot-hexagon-clip-path)"})]})},initials:null,name:n,size:r,onError:o,onLoad:l,ref:c})})},T=e=>{const{name:t,src:n,setShouldFallbackToDefault:a,setBlobUrl:s,enableFetchApiForBotAvatar:o,setError:l,error:I}=e,M=(0,g.m)(),f=(0,c.U)("custom-avatar-v9"),{host:T}=(0,r.ur)(),{scenarioFactory:N}=(0,r.ur)();let y=N.findScenario(u.Cu.ExtBotAvatar);y||(y=N.newScenario(u.Cu.ExtBotAvatar),y.appendEventData({"App.Name":t}));const C=(e,t)=>{y?.mark(u.BQ.ExtBotAvatarFetchApi,{errors:t??""},e),"failure"===e&&(f.errorToTelemetry?.("CustomAvatarV9:: bot avatar did not load properly, rendering fallback","platform_bot_avatar_error"),a&&a(!0),l&&l(!0))};return(0,i.Y)(d.Fragment,{children:(0,i.Y)(A,{onError:async()=>{try{if(o)if(n&&((0,m.D$)(n)||(0,h.d$)(n,T.location.origin))){const e=await(0,p.z)(M,n,"Url");if(e.result?.blob)s&&s(e.result.blob),C("success");else{C("failure",`CustomAvatarV9:: amsDownload did not return a blob for app: ${t}`)}}else{C("failure",`CustomAvatarV9:: non-AMS image did not load properly for app: ${t}`)}else a&&a(!0)}catch(e){C("failure",`CustomAvatarv9:: Failed to load bot avatar for app: ${t}`)}},onLoad:()=>{I?y?.fail():y?.stop()},...e})})};var N=n(959022);const y=(0,i.Y)("svg",{xmlns:"http://w3.org/2000/svg",style:{width:0,height:0,position:"absolute"},children:(0,i.Y)("defs",{role:"presentation",children:(0,i.Y)("clipPath",{id:"bot-hexagon-clip-path",children:(0,i.Y)("path",{id:"bot-hexagon-path",d:"M23.93,2H10.07C9,2,8.01,2.57,7.47,3.5l-6.92,12c-0.54,0.93-0.54,2.07,0,3l6.93,12c0.54,0.93,1.53,1.5,2.6,1.5h13.85c1.07,0,2.06-0.57,2.6-1.5l6.93-12c0.54-0.93,0.54-2.07,0-3l-6.93-12C25.99,2.57,25,2,23.93,2z"})})})}),C=e=>{const{enableFluentV9Avatar:t,enableFetchApiForBotAvatar:n,host:r,CustomAvatarV9Slot:a,CustomAvatarSlot:s}=e,[o,l]=d.useState(!1),[c,u]=d.useState(""),[p,g]=d.useState(!1),m=(e=>{const t="bot-hexagon-clip-path-container";let n=e.document.body.querySelector(`[id='${t}']`);return n||(n=e.document.createElement("div"),n.id=t,e.document.body.insertBefore(n,e.document.body.childNodes[0])),n})(r);return d.useEffect((()=>{m.hasChildNodes()||N.render(y,m)}),[m]),t?(0,i.Y)(a,{src:c&&n?c:o?"data:image/png;base64,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":e.commonImgAttributes?.src,alt:e.commonImgAttributes?.alt,badge:e.badgeProps,size:"number"==typeof e.size?e.size:void 0,setShouldFallbackToDefault:l,setBlobUrl:u,enableFetchApiForBotAvatar:!!n,error:p,setError:g,...e}):(0,i.Y)(s,{hexagonal:!0,...e})};var S=n(417798);const b=e=>{const{enableFluentV9Avatar:t}=(0,a.w2)(s.w.People,["enableFluentV9Avatar"]),{enableFetchApiForBotAvatar:n}=(0,a.w2)(s.w.Extensibility,["enableFetchApiForBotAvatar"]),{host:o}=(0,r.ur)();return(0,i.Y)(C,{enableFluentV9Avatar:t,enableFetchApiForBotAvatar:n,host:o,CustomAvatarV9Slot:(0,S.OE)(T),CustomAvatarSlot:(0,S.OE)(l),...e})},D=b},907294:(e,t,n)=>{"use strict";n.d(t,{e:()=>s});var i=n(513432),r=n(275943);class a extends i.Component{constructor(e){super(e),this.mounted=!1;const{i18n:t,namespace:n,namespaces:i}=e,r=(i||[]).filter((e=>!t.isNamespaceLoaded(e)));!n||t.isNamespaceLoaded(n)||r.includes(n)||r.push(n),this.state={namespacesToLoad:r}}componentDidMount(){const{i18n:e}=this.props;this.mounted=!0;const t=()=>{this.mounted&&this.setState((t=>({namespacesToLoad:t.namespacesToLoad.filter((t=>!e.isNamespaceLoaded(t)))})))};this.state.namespacesToLoad.length&&Promise.all(this.state.namespacesToLoad.map((t=>e.waitForNamespace(t)))).then(t).catch(t)}componentWillUnmount(){this.mounted=!1}render(){const{loaderRenderer:e,children:t}=this.props;return this.state.namespacesToLoad.length?e?e():null:t||null}}const s=(0,r.z)(a)},275943:(e,t,n)=>{"use strict";n.d(t,{z:()=>a,D:()=>s});var i=n(957032),r=n(619761);const a=e=>t=>(0,i.Y)(r.I18nContext.Consumer,{children:n=>(0,i.Y)(e,{...{...t,i18n:n}})}),s=a},437542:(e,t,n)=>{"use strict";n.d(t,{rs:()=>l,Y:()=>o,Py:()=>d});var i=n(845097),r=n(678937),a=n(67309);const s={kind:"Document",get definitions(){const e=(0,a.G)("query authenticationToken($resource:String!,$acquireTokenOptions:AcquireTokenOptions) {authenticationToken(resource:$resource,acquireTokenOptions:$acquireTokenOptions) {token}}");return delete this.definitions,this.definitions=e.definitions}},o=(e,t)=>{if("df"===t)return"Df";if("msit"===t)return"Msit";switch(e){case r.B.prod:case r.B.life:return"Prod";case r.B.gcc:return"GccModerate";case r.B.gcchigh:return"GccHigh";case r.B.dod:return"DoD";case r.B.ag08:return"AG08";case r.B.ag09:return"AG09";case r.B.gallatin:return"Gallatin";default:return"Unknown"}},l="https://unknownregion.loki.delve.office.com",d=(e,t,n)=>{const r=(0,i.v4)();return async(i,a)=>{try{let o;e.current?o=(await e.current.query({query:s,variables:{resource:t,acquireTokenOptions:{silent:n}},fetchPolicy:"network-only"})).data?.authenticationToken?.token:a("Error no apollo client to retrieve token",r),o?i(o,r):a("No auth token found",r)}catch{a("Error retrieving auth token",r)}}}},425801:(e,t,n)=>{"use strict";n.d(t,{CA:()=>g,uw:()=>m});var i=n(957032),r=n(513432),a=n(315854),s=n(39485),o=n(67309);const l={kind:"Document",get definitions(){const e=(0,o.G)("query lpcState {lpcState @client {isLivePersonaCardInitialized,lastLoggedInUserMri}}");return delete this.definitions,this.definitions=e.definitions}};var d=n(591561),c=n(480354);const u=r.createContext({IsLivePersonaCardInitialized:!1,LastLoggedInUserMri:null}),p=e=>{const t={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized,LastLoggedInUserMri:e.LastLoggedInUserMri};return(0,i.Y)(u.Provider,{value:(0,d.F)(t,c.isEqual),children:e.children})},g=(0,s.W)((e=>(0,i.Y)(a.X,{query:l,children:({data:t,loading:n,error:r})=>{const a=!n&&!r&&!!t&&!!t.lpcState&&t.lpcState.isLivePersonaCardInitialized;return(0,i.Y)(p,{children:e.children,IsLivePersonaCardInitialized:a,LastLoggedInUserMri:t?.lpcState?.lastLoggedInUserMri??null})}}))),m=()=>r.useContext(u)},755347:(e,t,n)=>{"use strict";n.d(t,{FN:()=>N});var i=n(957032),r=n(513432),a=n(480354),s=n(26648),o=n(172084),l=n(755029),d=n(911234),c=n(726723),u=n(115100),p=n(754255),g=n(845214),m=n(404615),h=n(568572),I=n(425801),M=n(418709);const f=(0,n(391567).O)({defaultPersona:{mc9l5x:"fau6ura",Bqenvij:"f3052tw"}});var A=n(563476);const T=e=>{const t=(0,o.ab)(u.Jj.POST_CRITICAL),n=(0,I.uw)(),T=(0,M.m)(),{host:{LivePersonaCardHoverTargetV2:N},coreSettings:y}=(0,l.ur)(),C=((e,t,n,i)=>{const[a,o]=r.useState(!0),l=r.useRef(!1),{userId:d,hostConversationId:c,hostTenantId:u,isSharedChannel:p}=e,{data:g}=(0,s.G)(["meetingDetails","meetingRole"]),m=!!g?.call?.meetingDetails?.meetingCapability?.maskIdentitiesForRole,h=g?.call?.meetingRole??"";return r.useEffect((()=>(l.current=!0,(async()=>{const e=await(0,A.Os)(d,m,h,!!p,c,u,t,n,i);l.current&&o(e)})(),()=>{l.current=!1})),[n,t,i,d,m,h,c,u,p]),a})(e,y,T,(0,d.U)("PersonaInner")),S=(e=>{const{host:t,userBiService:n,authenticationUser:i}=(0,l.ur)(),a=(0,d.U)("PersonaRenderer"),s=(0,M.m)(),{topicId:o,personaType:u}=e,p=r.useCallback((()=>{t.document.dispatchEvent(new MouseEvent("mousemove"))}),[t]),{ariaLabel:h,behavior:I,disableAccessibilityDefaults:f,externalAppSessionCorrelationId:T,hostConversationId:N,hostTenantId:y,isSharedChannel:C,tabIndex:S,userId:b,displayName:D,module:E,source:U,highlightedText:w}=e,v=r.useCallback((async()=>{if(t.document.addEventListener("mouseleave",p),"Topic"===u&&o){const e=(0,g.KB)({userAadObjectId:i?.profile.objectId,tenantAadObjectId:i?.profile.tenantId});e?.logEvent(m.P.TopicCardOpen,{topicId:o,module:E??"",source:U??""})}const e=await(0,A.Dh)(b,n,s),r={panelRegion:c.rP.popover,panelType:c.HP.LivePersonaCard,dataBag:e};n.recordPanelView(r,a)}),[i,t,p,a,n,s,o,u,E,U,b]),L=r.useCallback((()=>{t.document.removeEventListener("mouseleave",p);const e={actionGesture:c.Od.mouseleave,actionOutcome:c.nd.closePanel,actionScenarioType:c.DB.people,actionScenario:c.vB.closePanel,moduleName:c.Sn.lpcClose,panelRegion:c.rP.popover,panelType:c.HP.LivePersonaCard};n.recordPanelAction(e,a)}),[t,n,a,p]),k=r.useMemo((()=>(0,A.wQ)({ariaLabel:h,behavior:I,disableAccessibilityDefaults:f,externalAppSessionCorrelationId:T,hostConversationId:N,hostTenantId:y,isSharedChannel:C,tabIndex:S,userId:b,handleOnCardOpen:v,handleOnCardClose:L,personaType:u,topicId:o,displayName:D,module:E,source:U,highlightedText:w})),[h,I,f,T,N,y,C,S,b,v,L,o,u,D,E,U,w]);return r.useEffect((()=>()=>{t.document.removeEventListener("mouseleave",p)}),[t,p]),k})(e),{enableEntityMoreInfo:b}=y.get(p.w.Core),{enableFluentV9Avatar:D}=y.get(p.w.People),E=((e,t)=>{const n={"data-tid":t.callerInfo},r=f();return e?(0,i.Y)("div",{className:t.classNames||r.defaultPersona,...n,children:t.children}):t.children})(D,e);return!b&&t&&!(0,a.isEmpty)(e.userId)&&C&&n?.IsLivePersonaCardInitialized&&N?(0,i.Y)(h.t,{fallbackUI:(0,i.Y)(r.Fragment,{children:e.children}),loggerName:"PersonaInner",children:(0,i.Y)(N,{...S,children:E})}):C?(0,i.Y)(r.Fragment,{children:e.children}):(0,i.Y)(r.Fragment,{children:E})},N=r.memo((e=>T(e)))},236184:(e,t,n)=>{"use strict";n.d(t,{U:()=>o,Q:()=>l});var i=n(552355),r=n(572909),a=n(363678),s=n(878336);const o=()=>{const{entity:e,getEntityOptions:t}=(0,i.At)();return l(e,t)},l=(e,t)=>{let n={};const i=e&&e.type;switch(i){case r.ck.extensions:n=d(e,t),n={...n,...t(r.ck.extensions,u(e.action))};break;case r.ck.communities:case r.ck.channels:case r.ck.channelthread:case r.ck.channelextensibilityapppickersidepanel:case r.ck.connectorinstanceconfiguration:n=e.id?{channelId:(0,s.a9)(e)}:{channelId:void 0};break;case r.ck.extensibilityapppickersidepanel:case r.ck.callingchats:case r.ck.chats:const a=e.id?.split(";replyChainId=")??[],o=a[0],l=a[1];n={chatId:o,channelId:l?o:void 0,replyChainId:l,channelMeetingMessageId:l};break;case r.ck.platformapp:if(e.action===r.SY.config){const e=t(r.ck.platformapp,r.SY.config),i=e?.messageId&&"0"!==e.messageId,a={chatId:e?.convId,channelId:i?e?.convId:void 0,parentMessageId:i?e.messageId:void 0,channelMeetingMessageId:i?e.messageId:void 0,eventId:e?.eventId};n={...n,...a}}else n={...t(r.ck.platformapp,r.SY.create)};break;case r.ck.platformStage:case r.ck.platformstagewithoutchat:case r.ck.platformstagemodal:n=c(i,t);break;case r.ck.yammerqna:const p=t(r.ck.yammerqna,r.SY.view);n={chatId:p?.conversationId,channelMeetingMessageId:"0"!==p?.messageId?p?.messageId:void 0,...p}}return n},d=(e,t)=>{if(e.linkedEntity?.id)switch(e.linkedEntity.type){case r.ck.chats:return{chatId:e.linkedEntity.id};case r.ck.communities:case r.ck.channels:case r.ck.extensions:case r.ck.schoolteams:return JSON.parse(e.linkedEntity.id);case r.ck.calls:return function(e){const{options:t}=e;if(!t)return{};const{convId:n,messageId:i}=JSON.parse(t);return function(e){return!!e&&"0"!==e}(i)?{channelId:n,chatId:n,parentMessageId:i,channelMeetingMessageId:i}:{chatId:n}}(e);case r.ck.schedulingform:return function(e,t){if(!e.linkedEntity?.id)return{};const{threadId:n,messageId:i}=e.id&&JSON.parse(e.id)||{},{channelId:a}=e.linkedEntity.id&&JSON.parse(e.linkedEntity.id)||{},{isChannelMeeting:s,messageId:o}=function(e,t){let{isChannelMeeting:n,messageId:i}=t(r.ck.extensions,u(e.action));if(void 0===n){const{options:t}=e;if(t){const{isChannelMeeting:e,backFilledOptions:{messageId:r}}=JSON.parse(t);n=e,i=r}}return{isChannelMeeting:n,messageId:i}}(e,t);return s?{channelId:a,chatId:n,parentMessageId:i??o,channelMeetingMessageId:i??o}:{chatId:n}}(e,t);case r.ck.simplecollab:case r.ck.simplecollabchannels:case r.ck.simplecollabchats:const n=(0,s.a9)(e),i=e.linkedEntity.id;if(n)try{return JSON.parse(e.linkedEntity.id)}catch(e){return{chatId:i}}}return{}},c=(e,t)=>{const n=((e,t)=>e===r.ck.platformStage?t(r.ck.platformStage,r.SY.create):e===r.ck.platformstagewithoutchat?t(r.ck.platformstagewithoutchat,r.SY.view):t(r.ck.platformstagemodal,r.SY.view))(e,t);switch(n.entryPoint){case a.hB.adaptiveCardCollabStage:case a.hB.adaptiveCardStageModal:case a.hB.fileChiclet:return n.replyChainId?{channelId:n.channelId??n.convId,replyChainId:n.replyChainId,entityId:n?.entityId,chatId:void 0,subEntityId:n?.subEntityId}:{chatId:n.convId,entityId:n?.entityId,subEntityId:n?.subEntityId}}return n.replyChainId||n.channelId?{channelId:n.channelId??n.convId,replyChainId:n.replyChainId,entityId:n.entityId,parentMessageId:n.messageId,channelMeetingMessageId:n.messageId,chatId:n.messageId?n.channelId??n.convId:void 0}:{chatId:n.convId,entityId:n.entityId}};function u(e){return e===r.SY.loading?r.SY.loading:r.SY.view}},954665:(e,t,n)=>{"use strict";n.d(t,{H:()=>g});var i=n(67309),r=n(16214);const a={kind:"Document",get definitions(){const e=(0,i.G)("mutation recordAppUsage($appId:String!) {recordAppUsage(appId:$appId) {...appsUsageFields}}");return delete this.definitions,this.definitions=[...e.definitions,...r.j.definitions]}};var s=n(755029),o=n(911234),l=n(155762),d=n(513432),c=n(702183),u=n(735652),p=n(754255);const g=()=>{const{enableAppUsageRecording:e}=(0,u.w2)(p.w.Extensibility,["enableAppUsageRecording"]),{scenarioFactory:t}=(0,s.ur)(),n=(0,o.U)("useRecordAppUsage"),[i]=(0,l.n)(a);return d.useCallback((async(r,a)=>{if(!e)return;const s=t.newScenario(c.Cu.ExtRecordAppUsage);try{await i({variables:{appId:r}}),s.appendEventData({"App.Id":r,"App.EntryPoint":a}),s.stop()}catch(e){s.fail({"App.Id":r,"App.EntryPoint":a,errors:JSON.stringify(e),message:"Failed to record app usage."}),n.error("Failed to record app usage.")}}),[e,n,i,t])}},709812:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>R,CD:()=>k,kR:()=>P,xQ:()=>F,qI:()=>O});var i=n(957032),r=n(513432),a=n(418709),s=n(18732),o=n(827619),l=n(858773),d=n(388072),c=n(188996);const u="Disabled",p={InAConferenceCall:{backgroundImage:c.Y.OnThePhone,title:"status_inACall"},InACall:{backgroundImage:c.Y.OnThePhone,title:"status_inACall"},Presenting:{backgroundImage:c.Y.DoNotDisturb,title:"status_presenting"},OffWork:{backgroundImage:c.Y.Offline,title:"status_offline"},InAMeeting:{backgroundImage:c.Y.Busy,title:"status_inAMeeting"},Available:{backgroundImage:c.Y.Online,title:"status_online"},Inactive:{backgroundImage:c.Y.Away,title:"status_away"},Busy:{backgroundImage:c.Y.Busy,title:"status_busy"},DoNotDisturb:{backgroundImage:c.Y.DoNotDisturb,title:"status_doNotDisturb"},BeRightBack:{backgroundImage:c.Y.BeRightBack,title:"status_beRightBack"},Away:{backgroundImage:c.Y.Away,title:"status_away"},OutOfOffice:{backgroundImage:c.Y.Away,title:"status_away"},Offline:{backgroundImage:c.Y.Offline,title:"status_offline"},UrgentInterruptionsOnly:{backgroundImage:c.Y.DoNotDisturb,title:"status_doNotDisturb"},PresenceUnknown:{backgroundImage:c.Y.Unknown,title:"status_unknown"},AvailableIdle:{backgroundImage:c.Y.Idle,title:"status_away"},BusyIdle:{backgroundImage:c.Y.Idle,title:"status_away"},OnShift:{backgroundImage:c.Y.OnShift,title:"status_onShift"},OffShift:{backgroundImage:c.Y.OffShift,title:"status_offShift"},[u]:{backgroundImage:c.Y.Disabled,title:"status_disabled"}},g={status_inACall:"inACall",status_presenting:"presenting",status_offline:"offline",status_inAMeeting:"inAMeeting",status_online:"online",status_away:"away",status_Busy:"busy",status_doNotDisturb:"doNotDisturb",status_beRightBack:"beRightBack",status_unknown:"unknown",status_onShift:"onShift",status_offShift:"offShift",status_disabled:"disabled",status_blocked:"blocked"},m={InAConferenceCall:{backgroundImage:c.Y.OnThePhoneOof,title:p.InAConferenceCall.title},InACall:{backgroundImage:c.Y.OnThePhoneOof,title:p.InACall.title},Presenting:{backgroundImage:c.Y.DoNotDisturbOof,title:p.Presenting.title},InAMeeting:{backgroundImage:c.Y.BusyOof,title:p.InAMeeting.title},Busy:{backgroundImage:c.Y.BusyOof,title:p.Busy.title},DoNotDisturb:{backgroundImage:c.Y.DoNotDisturbOof,title:p.DoNotDisturb.title},Available:{backgroundImage:c.Y.OnlineOof,title:p.Available.title}},h=e=>{const{title:t,backgroundImage:n}=e,i={status:"unknown",outOfOffice:!1};switch(t){case"status_online":i.status="available";break;case"status_busy":case"status_inAMeeting":case"status_inACall":i.status="busy";break;case"status_presenting":case"status_doNotDisturb":case"status_focusing":i.status="do-not-disturb";break;case"status_away":case"status_beRightBack":i.status="away";break;case"status_offline":i.status="offline";break;case"out_of_office_title":i.status="out-of-office";break;case"status_blocked":case"status_disabled":i.status="blocked";break;default:i.status="unknown"}switch(n){case c.Y.OutOfOffice:case c.Y.OnThePhoneOof:case c.Y.DoNotDisturbOof:case c.Y.BusyOof:case c.Y.OnlineOof:i.outOfOffice=!0}return i},I=(e,t)=>{switch(e){case"Available":return t.stringTranslate("nova","me_control_presence_activity_available");case"Away":case"Inactive":return t.stringTranslate("nova","me_control_presence_activity_away");case"BeRightBack":return t.stringTranslate("nova","me_control_presence_activity_be_right_back");case"Busy":return t.stringTranslate("nova","me_control_presence_activity_busy");case"DoNotDisturb":case"UrgentInterruptionsOnly":return t.stringTranslate("nova","me_control_presence_activity_do_not_disturb");case"InACall":case"InAConferenceCall":return t.stringTranslate("nova","me_control_presence_activity_in_a_call");case"InAMeeting":return t.stringTranslate("nova","me_control_presence_activity_in_a_meeting");case"Offline":case"OffWork":return t.stringTranslate("nova","me_control_presence_activity_offline");case"PresenceUnknown":default:return t.stringTranslate("nova","me_control_presence_activity_unknown");case"Presenting":return t.stringTranslate("nova","me_control_presence_activity_presenting")}},M=e=>!!e&&["Available","Busy","InAMeeting","InACall","InAConferenceCall","DoNotDisturb","Presenting","UrgentInterruptionsOnly"].includes(e);const f=(0,n(391567).O)({presenceIcon:{t21cq0:["f8zmjen","fjf1xye"],Bz10aip:"fxr4zw7"}}),A=e=>{const t=f(),n=(0,d.PO)(),{status:{backgroundImage:r,title:a,subTitle:s},ProvidedStatus:c,size:u,styles:p,userId:m,variables:I}=e,M=n.stringTranslate("messaging",a),A=s?`${M}, ${n.stringTranslate("messaging",s)}`:M,{status:T,outOfOffice:N}=h(e.status),y={id:`presence-pill-${m}`,title:A,style:{backgroundImage:`url('${r}')`,backgroundColor:o.L.colorNeutralBackground1},styles:p,size:u,variables:I},C=g[a]||"presence";return c?(0,i.Y)(c,{...y,"data-tid":"presence","data-pstatus":C}):(0,i.Y)(l.n,{id:`presence-pill-${m}`,className:t.presenceIcon,outOfOffice:N,status:T,size:"extra-small",title:A,"data-tid":"presence","data-pstatus":C})};var T=n(755029),N=n(115100),y=n(618630),C=n(735652),S=n(754255),b=n(172084),D=n(67309);const E={kind:"Document",get definitions(){const e=(0,D.G)("fragment ComponentsPresenceFragment on Presence {id,availability,activity,isOutOfOffice,statusNote {message,publishTime,expiry},flwPresence,flwShifts {previousShift {teamId,teamName,startTime,endTime,scheduleGroupDisplayName,teamOlsonCode},currentShift {teamId,teamName,startTime,endTime,scheduleGroupDisplayName,teamOlsonCode},nextShift {teamId,teamName,startTime,endTime,scheduleGroupDisplayName,teamOlsonCode}},isFocus,workLocation {location,locationSource,approximateDetails {id,name,idType}},isBlocked,isDisabled}");return delete this.definitions,this.definitions=e.definitions}};var U=n(841135),w=n(253070);const v={backgroundImage:c.Y.Unknown,title:"status_unknown"},L={backgroundImage:c.Y.Blocked,title:"status_blocked"},k=(e,t)=>{const n=x(e);if(!t)return n;const i=((e,t,n,i,r)=>i&&!M(e)?r.stringTranslate("nova","me_control_presence_out_of_office"):i&&M(e)?r.stringTranslate("nova","me_control_presence_activity_with_out_of_office",{activity:I(e,r)}):n&&"DoNotDisturb"===t&&"Presenting"!==e?r.stringTranslate("nova","me_control_presence_activity_focusing"):I(e,r))(e?.activity??null,e?.availability??null,e?.isFocus??null,e?.isOutOfOffice??null,t);return{...n,ariaLabel:i}},x=e=>{if(!e)return v;const{isOutOfOffice:t,flwPresence:n,isFocus:i}=e,{isBlocked:r,isDisabled:a}=e;if(a)return p[u];if(r)return L;const s=e.activity,o=e.availability;if(!n||"None"===n)return i&&("DoNotDisturb"===s||!s&&"DoNotDisturb"===o)?(e=>{const t="status_focusing";return e?{backgroundImage:c.Y.FocusingOof,title:t,subTitle:"out_of_office_title"}:{backgroundImage:c.Y.Focusing,title:t}})(t):t?((e,t)=>{const n=e?m[e]:m[t],i="out_of_office_title";return n?{...n,subTitle:i}:{backgroundImage:c.Y.OutOfOffice,title:i}})(s,o):s?p[s]:p[o];if("OffShift"===n)return p.OffShift;if(!s)return"Busy"===o?p[o]:p.OnShift;switch(s){case"InAConferenceCall":case"InACall":case"InAMeeting":case"Presenting":case"Busy":return p[s];default:return p.OnShift}},F=(e,t)=>{const n=(0,a.m)(),i=(0,d.PO)(),[o,l]=r.useState(!0);r.useEffect((()=>{(0,w.unstable_scheduleCallback)(w.unstable_LowPriority,(()=>{l(!1)}))}),[]);const{data:c}=(0,s.R)(y.C,{variables:{userId:e,source:t},skip:o}),{setUserPresence:u}=(0,U.$)(),p=c?.presenceUpdateEvent??((e,t)=>{try{return e.readFragment({id:`Presence:${t}`,fragment:E})??void 0}catch(e){return}})(n,e);return r.useEffect((()=>{u(p)}),[p,u]),k(p,i)},O=(e,t)=>{const n=F(e,t),i=h(n);return i.id=`presence-pill-${e}`,i["aria-label"]=n.ariaLabel,i.title=n.ariaLabel,i["data-tid"]="presence-badge",i},P=(e,t,n,i)=>!(!e||n&&n===i||"status_unknown"!==t.title&&"status_offline"!==t.title),j=e=>{const{userId:t,presenceSource:n}=e,{enableHideOfflinePresenceInTFL:r}=(0,C.w2)(S.w.Presence,["enableHideOfflinePresenceInTFL"]),{user:a}=(0,T.ur)(),s=F(t||"",n||"ups"),{ProvidedStatus:o,...l}=e;return P(!!r,s,t,a?.id)?null:(0,i.Y)(A,{status:{backgroundImage:s.backgroundImage,title:s.title,subTitle:s.subTitle},ProvidedStatus:o,userId:t||"",...l})},R=e=>(0,b.ab)(N.Jj.POST_CRITICAL)?(0,i.Y)(j,{...e}):null},188996:(e,t,n)=>{"use strict";n.d(t,{Y:()=>E});var i=n(118356),r=n.n(i),a=n(567322),s=n.n(a),o=n(870586),l=n.n(o),d=n(78727),c=n.n(d),u=n(791542),p=n.n(u),g=n(152248),m=n.n(g),h=n(444257),I=n.n(h),M=n(952388),f=n.n(M),A=n(834818),T=n.n(A),N=n(604322),y=n.n(N),C=n(603313),S=n.n(C),b=n(960935),D=n.n(b);const E={Online:r(),OnShift:r(),DoNotDisturb:s(),Focusing:s(),Busy:l(),OnThePhone:l(),Away:c(),Idle:c(),BeRightBack:c(),Offline:p(),OffShift:p(),OutOfOffice:m(),Unknown:I(),OnlineOof:f(),BusyOof:T(),OnThePhoneOof:T(),DoNotDisturbOof:y(),FocusingOof:y(),Disabled:S(),Blocked:D()}},841135:(e,t,n)=>{"use strict";n.d(t,{G:()=>s,$:()=>o});var i=n(957032),r=n(513432);const a=r.createContext({userPresence:void 0,setUserPresence:()=>{}}),s=({children:e})=>{const[t,n]=r.useState();return(0,i.Y)(a.Provider,{value:{userPresence:t,setUserPresence:n},children:e})},o=()=>r.useContext(a)},145263:(e,t,n)=>{"use strict";n.d(t,{v9:()=>E,wN:()=>U,Ft:()=>v,My:()=>k,RF:()=>O,Xt:()=>B,m9:()=>V,J9:()=>_,Ff:()=>W,mU:()=>Q,gO:()=>Y,P3:()=>G,bg:()=>Z});var i=n(957032),r=n(513432),a=n(959022),s=n(844462),o=n(931328),l=n(787313),d=n(911293),c=n(854507),u=n(755029),p=n(297292),g=n(108001),m=n(990786),h=n(491450),I=n(480354);const{createContext:M,memo:f,useContext:A,useMemo:T,useState:N,useRef:y,useCallback:C}=r,S={minHeightBreakpoint:m.f0.IS_GREATER_THAN_0,minWidthBreakpoint:m.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:m.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:m.cw.IS_GREATER_THAN_0},b={responsiveBreakpoints:{...S},responsiveBreakpointsVariables:(0,h.eo)(S)},D=M(b),E=(e,t)=>t?new o.c((n=>{const i=new e.ResizeObserver((([e])=>n.next(e)));return i.observe(t),()=>i.disconnect()})):s.w,U=()=>e=>e.pipe((0,l.p)((e=>e.contentRect.width>0))),w=(e,t,n)=>E(e,t).pipe((0,c.c)(250,void 0,{leading:!0,trailing:!0}),((e,t)=>n=>n.pipe(U(),(0,d.T)((n=>(t?.(n.contentRect.width,n.contentRect.height),(0,h.PY)({height:n.contentRect.height,width:n.contentRect.width,host:e}))))))(e,n)),v=e=>{const{host:t}=(0,u.ur)();return(0,i.Y)(L,{...e,host:t})},L=f((({children:e,containerRef:t,initialSize:n,setDimensionsCallback:s,host:o,area:l})=>{const[d,c]=N((()=>{const e={minHeightBreakpoint:n?.minHeightBreakpoint??m.f0.IS_GREATER_THAN_0,minWidthBreakpoint:n?.minWidthBreakpoint??m.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:o.self.innerHeight??m.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:o.self.innerWidth??m.cw.IS_GREATER_THAN_0};return{responsiveBreakpoints:e,responsiveBreakpointsVariables:(0,h.eo)(e)}})),u=T((()=>new Set),[]),M=(0,g.LE)(),f=y(),A=C((e=>{if((0,I.isEqual)(e,f.current))return;f.current=e;const t={responsiveBreakpoints:e,responsiveBreakpointsVariables:(0,h.eo)(e)};(0,a.unstable_batchedUpdates)((()=>{c(t),u.forEach((e=>e.next(t)))}))}),[c,u]);r.useEffect((()=>{if(!l)return;const e=M?.responsiveOptimisticStateObservables.get(l),t=e?.subscribe((e=>{const t=(0,h.PY)({height:e.height,width:e.width,host:o});A(t)}));return()=>t?.unsubscribe()}),[M,o,l,A]);const S=t.current,b=T((()=>w(o,S,s)),[o,S,s]);(0,p.J)(b,{next:A},!0);const E=y(d);E.current=d;const U=y((e=>{const t={next:(I.noop,n=>{const i=x(e,n);(0,I.isEqual)(i,t.value)||(t.value=i,t.onNext?.(i))}),value:x(e,E.current),unsubscribe:(I.noop,()=>u.delete(t))};return u.add(t),t}));return(0,i.Y)(D.Provider,{value:d,children:(0,i.Y)(F.Provider,{value:U.current,children:e})})})),k=()=>A(D).responsiveBreakpoints,x=(e,t)=>{const n={};for(const i of e)n[i]=i in t.responsiveBreakpoints?t.responsiveBreakpoints[i]:t.responsiveBreakpointsVariables[i];return n},F=M((e=>({next:I.noop,value:x(e,b),unsubscribe:I.noop}))),O=e=>{const t=function(e){const t=r.useRef(e);t.current===e||(0,I.isEqual)(t.current,e)||(t.current=e);return t.current}(e),n=r.useContext(F),i=r.useMemo((()=>n(t)),[n,t]),[a,s]=r.useState(i.value);return i.onNext=s,r.useEffect((()=>()=>i.unsubscribe()),[i]),i.value};const P=["minHeightBreakpoint"],j=["minWidthBreakpoint"],R=["minHeightViewportBreakpoint"],z=["minWidthViewportBreakpoint"],B=()=>O(P),V=()=>O(j),_=({children:e})=>(0,i.Y)(D.Consumer,{children:t=>e(t)}),W=()=>A(D).responsiveBreakpointsVariables,Q=e=>{let t=B();return t=e||t,T((()=>(0,h.Lg)(t)),[t])},Y=e=>{let t=O(R);return t=e||t,T((()=>(0,h.pM)(t)),[t])},G=e=>{let t=V();return t=e||t,T((()=>(0,h.A7)(t)),[t])},Z=e=>{let t=O(z);return t=e||t,T((()=>(0,h.ok)(t)),[t])}},417798:(e,t,n)=>{"use strict";n.d(t,{OE:()=>a,K7:()=>s,_E:()=>o});var i=n(957032),r=n(513432);function a(e){return e}function s(e){const t=r.useRef(e);t.current=e;return r.useRef(((...e)=>t.current(...e))).current}function o(e,t){const n=r.useRef(new Set),a=r.useRef({sub:e=>(n.current.add(e),()=>n.current.delete(e)),triggerSlotsUpdate:()=>{for(const e of n.current.values())e(s.current)}}),s=r.useRef(t);s.current=t,r.useEffect((()=>{a.current.triggerSlotsUpdate()}));const o=r.useMemo((()=>function(e,t,n){const a=r.memo(e),s=e=>{const[s,o]=r.useState(t.current),l=r.useRef(null);return l.current=l.current||n.current.sub((e=>{o(e)})),r.useEffect((()=>()=>{l.current?.()}),[]),(0,i.Y)(a,{...e,...s})};return s.displayName=e.displayName?`${e.displayName}_SlotWrapper`:"SlotWrapper",s}(e,s,a)),[e]);return o}},213507:(e,t,n)=>{"use strict";n.d(t,{B:()=>r});var i=n(957032);const r=(0,n(757146).A)((e=>(0,i.Y)("svg",{width:"1em",height:"1em",viewBox:"2 2 20 20",xmlns:"http://www.w3.org/2000/svg",role:"presentation",...e,children:(0,i.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 9V10H21.061C21.579 10 22 10.386 22 10.861V15.75C22 17.335 20.598 18.62 18.869 18.62C18.508 18.62 18.039 18.553 17.644 18.327C16.97 19.899 15.409 21 13.59 21H13.41C11.467 21 9.818 19.744 9.23 18H3C2.45 18 2 17.55 2 17V7C2 6.45 2.45 6 3 6H11C11 4.343 12.343 3 14 3C15.657 3 17 4.343 17 6C17 7.657 15.657 9 14 9ZM16 6C16 7.103 15.103 8 14 8V7C14 6.45 13.55 6 13 6H12C12 4.897 12.897 4 14 4C15.103 4 16 4.897 16 6ZM8.468 15.875V10.055H10.632V8.125H4.368V10.055H6.545V15.875H8.468ZM17 16.59V16.631C16.998 16.657 16.997 16.685 16.998 16.713C16.933 18.536 15.429 20 13.59 20H13.41C12.032 20 10.843 19.179 10.305 18H13C13.55 18 14 17.55 14 17V11H17V16.59ZM21 15.75C21 16.781 20.044 17.62 18.869 17.62C18.761 17.62 18.285 17.606 18.034 17.381C18.0368 17.2312 18.0252 17.0874 18.0147 16.9579L18.012 16.924L18.008 16.8821C18.0032 16.8321 17.9986 16.7839 17.997 16.74C17.999 16.69 18 16.64 18 16.59V11H21V15.75ZM21.2 7C21.2 7.662 20.662 8.2 20 8.2C19.338 8.2 18.8 7.662 18.8 7C18.8 6.338 19.338 5.8 20 5.8C20.662 5.8 21.2 6.338 21.2 7ZM20 5C21.105 5 22 5.896 22 7C22 8.104 21.105 9 20 9C18.896 9 18 8.104 18 7C18 5.896 18.896 5 20 5Z"})})),"TeamsMonochrome2Icon")},494825:(e,t,n)=>{"use strict";n.d(t,{N:()=>d});var i=n(513432),r=n(737461),a=n(937008),s=n(370118),o=n(585011);const l=(0,n(391567).O)({root:{oivjwe:"f1h8hb77",dvvfom:"f1x7u7e9",w71qe1:"f13mvf36",Bkioxbp:"f1cmlufx",C4gs1y:"f10aw75t",Beapcnx:"fsle3fq",Jkg3mj:"f17ae5zn"},subtle:{C4gs1y:"f18y0hww",Beapcnx:"f8r86f8"},inline:{dvvfom:"f1lqvz6u"},inlineSubtle:{dvvfom:"f1842k2q"},disabled:{dvvfom:"f1x7u7e9",C4gs1y:"f1y8dcps",Beapcnx:"f16x84av"}}),d=i.forwardRef(((e,t)=>{const n=(0,r.f)(e,t);n.root.dir="string"==typeof e.children?"auto":void 0,(0,a.r)(n);const{appearance:i,disabled:d,inline:c}=n,u=l();return n.root.className=(0,s.z)(n.root.className,u.root,"subtle"===i&&u.subtle,c&&u.inline,"subtle"===i&&c&&u.inlineSubtle,d&&u.disabled,e.className),(0,o.q)(n)}))},301173:(e,t,n)=>{"use strict";n.d(t,{D:()=>m,k:()=>p});var i=n(957032),r=n(513432),a=n(987702),s=n(370118),o=n(391567);const l=(0,o.O)({base100:{Be2twd7:"f13mqy1h",Bg96gwp:"fcpl73t"},base200:{Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm"},base300:{Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},base400:{Be2twd7:"fod5ikn",Bg96gwp:"faaz57k"},base500:{Be2twd7:"f1pp30po",Bg96gwp:"f106mvju"},base600:{Be2twd7:"f1x0m3f5",Bg96gwp:"fb86gi6"},hero700:{Be2twd7:"fojgt09",Bg96gwp:"fcen8rp"}}),d=(0,o.O)({light:{Bhrd7zp:"f3wt7jm"},semilight:{Bhrd7zp:"f13vlhzf"},regular:{Bhrd7zp:"f71fsbu"},medium:{Bhrd7zp:"f1hd9hm2"},semibold:{Bhrd7zp:"fhuq1gn"},bold:{Bhrd7zp:"f1leeax8"}}),c=(0,o.O)({mention:{sj55zd:"fyind8e"},mentionMe:{sj55zd:"f1l8vj45",Bhrd7zp:"f1leeax8"},mentionMeContrast:{sj55zd:"fyind8e"},disabled:{sj55zd:"f1s2aq7o"},error:{sj55zd:"f1whyuy6"},important:{sj55zd:"f1l8vj45",Bhrd7zp:"f1leeax8"},success:{sj55zd:"f1m7fhi8"},temporary:{B80ckks:"f1j4dglz"},timestamp:{sj55zd:"f11d4kpn"},nowrap:{Huce71:"fz5stix",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp"},truncate:{ygn44y:"f1cmbuwj"},alignCenter:{fsow6f:"f17mccla"},alignEnd:{fsow6f:"f12ymhq5"},alignJustify:{fsow6f:"f1j59e10"}});var u=n(457398);const p="fui-StyledText",g={100:"base100",200:"base200",300:"base300",400:"base400",500:"base500",600:"base600",700:"hero700",smaller:"base100",small:"base200",medium:"base300",large:"base400",large500:"base500",larger:"base600",largest:"hero700"},m=r.forwardRef(((e,t)=>{const{align:n,as:r="span",atMention:o,disabled:m,error:h,important:I,success:M,temporary:f,timestamp:A,truncate:T,weight:N,wrap:y=!0}=e,C="string"==typeof e.children?"auto":void 0,S=(0,a._)(r,{ref:t,...e}),b=l(),D=d(),E=c(),U=(0,u.v)(),w=e.size?g[e.size]:e.size,v=(0,s.z)(p,w&&b[w],N&&D[N],!1===y&&E.nowrap,T&&E.truncate,"center"===n&&E.alignCenter,"end"===n&&E.alignEnd,"justify"===n&&E.alignJustify,o&&E.mention,"me"===o&&E.mentionMe,"me"===o&&"contrast"===U&&E.mentionMeContrast,m&&E.disabled,h&&E.error,I&&E.important,M&&E.success,f&&E.temporary,A&&E.timestamp,e.className);return(0,i.Y)(r,{dir:C,...S,className:v})}))},302983:(e,t,n)=>{"use strict";n.d(t,{m:()=>p});var i=n(513432),r=n(945706),a=n(837556),s=n(166881),o=n(370118),l=n(611184),d=n(13014),c=n(35871),u=n(890896);const p=e=>{const t=(0,u.N)({positioning:e.positioning,defaultAutoSize:!1}),n=(0,a.w)({...e,positioning:t}),p=(0,s.a)(n.content?.ref,function(e){const t=i.useRef(null),n=(0,r.Bi)();return i.useEffect((()=>{if(e){const e=t.current,i=e?.parentElement;i&&i.dataset.portalNode&&(i.style.viewTransitionName=n)}}),[e,n]),t}(n.visible));return n.content&&(n.content.ref=p,n.content.className=(0,o.z)(n.content.className,"vdi-occlusion")),(0,l.k)(n),(0,c.useCustomStyleHook_unstable)("useTooltipStyles_unstable")(n),(0,d.x)(n)};p.isFluentTriggerComponent=!0},457398:(e,t,n)=>{"use strict";n.d(t,{o:()=>a,v:()=>s});var i=n(513432),r=n(794171);const a=i.createContext(r.SV.Light),s=()=>i.useContext(a)},267154:(e,t,n)=>{"use strict";n.d(t,{z:()=>c});var i=n(957032),r=n(513432),a=n(898788),s=n(735652),o=n(754255),l=n(10269);const d=({children:e})=>{const{disallowAppRegionOverrides:t}=(0,s.w2)(o.w.Core,["disallowAppRegionOverrides"]);return(0,i.Y)(r.Fragment,{children:e({disallowAppRegionOverrides:!!t})})},c=e=>{const{UNSAFE_overflowAndFlipBoundaryRef:t}=(0,l.g6)(),{disableOverflowAndFlipBoundaryContext:n,...r}=e,o=n?{}:{flipBoundary:t?.current||"window",overflowBoundary:t?.current||"window"};s.w2._isMockFunction;return(0,i.Y)(d,{children:({disallowAppRegionOverrides:e})=>(e&&(r.content={...r.content,variables:{...r.content?.variables,disallowAppRegionOverrides:e}}),(0,i.Y)(a.z,{...r,...o}))})}},285343:(e,t,n)=>{"use strict";n.d(t,{S:()=>I});var i=n(957032),r=n(513432),a=n(145263),s=n(554208),o=n(375746),l=n(571204),d=n(480354),c=n(755029),u=n(973893);const p="333ms";var g;!function(e){e[e.Fail=0]="Fail",e[e.Loading=1]="Loading",e[e.Succeed=2]="Succeed"}(g||(g={}));class m extends r.PureComponent{constructor(){super(...arguments),this._loaderImage=null,this.state={...this._getInitialState(this.props)},this._getImageComponent=e=>{const{fixedAspectRatio:t,variables:n,isInlineImageWrapper:r,isImageInlineOrAttached:a,dataImageMode:l}=this.props,{maxHeight:d,maxWidth:c}=this.state,u=this._shouldShowImage(),g=this._shouldAddPlaceholder();return(0,i.Y)(s.s,{as:"span",itemType:l,style:{...!a&&{maxHeight:t?`${d}rem`:void 0,maxWidth:`${c}rem`}},variables:{...n,hasFixedAspectRatio:t,isRelativePositioned:g,isInlineImageWrapper:r},children:[(0,i.Y)(o.X,{visible:u,name:"fadeInInPlace",duration:p,iterationCount:"1",fillMode:"forwards",children:e}),this._getImagePlaceholder()]})},this._getHeightsAndWidths=()=>{const{width:e,height:t}=this.props;let n,i=20;if(e&&t){const r=this._getMaxHeightAndMaxWidth(t,e);i=r.maxHeight,n=r.maxWidth}return{height:t,maxHeight:i,maxWidth:n,width:e}},this._getImagePlaceholder=()=>{const{placeholder:e,preLoadState:t}=this.props,{loadState:n}=this.state;if(e&&this._shouldAddPlaceholder())return n===g.Fail||t===g.Fail?e.failureCbElem:e.loadingCbElem},this._loadImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(g.Succeed),this.setState({src:this.props.src,loadState:g.Succeed})},this._errorImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(g.Fail),this.setState({src:this.props.src,loadState:g.Fail})},this._lazyLoadImage=()=>{const{host:{Image:e}}=this.props;this._loaderImage=new e,this._loaderImage.addEventListener("load",this._loadImageEventListener,{once:!0}),this._loaderImage.addEventListener("error",this._errorImageEventListener,{once:!0}),this._loaderImage.src=this.props.src},this._shouldShowImage=()=>{const{preLoadState:e}=this.props,{loadState:t}=this.state;return e===g.Succeed||t===g.Succeed},this._shouldAddPlaceholder=()=>{const{placeholder:e}=this.props;return!this._shouldShowImage()&&!!e}}componentDidMount(){(0,d.isEmpty)(this.props.src)||this._lazyLoadImage()}componentWillUnmount(){this._loaderImage?.removeEventListener("load",this._loadImageEventListener),this._loaderImage?.removeEventListener("error",this._errorImageEventListener)}componentDidUpdate(e,t){const{src:n,preLoadState:i,scenarioHandler:r}=this.props,{loadState:a}=this.state;i===g.Succeed&&this.setState({src:n});const s=i===g.Fail||a===g.Fail;if(e.src===n||s)s&&r&&r(g.Fail);else{const{height:e,maxHeight:t,maxWidth:n,width:i}=this._getHeightsAndWidths();this._lazyLoadImage(),this.setState({height:e,loadState:g.Loading,maxHeight:t,maxWidth:n,width:i})}}render(){const{alt:e,as:t,fixedAspectRatio:n,height:r,id:a,itemType:d,placeholder:c,preLoadState:g,scenarioHandler:m,src:h,styles:I,variables:M,width:f,host:A,isInlineImageWrapper:T,isImageInlineOrAttached:N,isMosaicIcon:y,dataImageMode:C,...S}=this.props,{height:b,maxHeight:D,maxWidth:E,src:U,width:w,loadState:v}=this.state,L=`lazy-image-${v}`,k="lazy-image",x=this._shouldShowImage();let F;const O=this._shouldAddPlaceholder();if(w&&b){let r=u.Y5.NONE;return N&&(r=(0,u.AJ)(w,b)),F=(0,i.Y)(l._,{as:t,"data-tid":L,"data-inp":k,alt:e,className:"ui-known-width-and-height",id:a,itemType:d,"data-image-type":r,"data-image-mode":C,src:n?"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7":U,style:{...!N&&{maxHeight:`${D}rem`,maxWidth:`${E}rem`},...n&&{backgroundImage:`url("${U}")`}},styles:{...n?{backgroundPosition:"center",backgroundSize:"cover",height:"100%",width:"100%"}:I,...y&&{padding:0}},variables:{...M,hasKnownWidthAndHeight:!0,isImageInlineOrAttached:N},...S}),this._getImageComponent(F)}return n?(F=(0,i.Y)(l._,{as:t,"data-tid":L,"data-inp":k,alt:e,id:a,itemType:d,src:U,className:"ui-unknown-width-or-height","data-image-type":N?u.Y5.STANDARD:null,"data-image-mode":C,style:{...n&&{backgroundImage:`url("${U}")`}},variables:{...M,responsiveImageUnknownHeightAndWidth:!0},...S}),this._getImageComponent(F)):(0,i.Y)(s.s,{as:"span",variables:{...M,isRelativePositioned:O},children:[(0,i.Y)(o.X,{visible:x,name:"fadeInInPlace",duration:p,iterationCount:"1",fillMode:"forwards",children:(0,i.Y)(l._,{as:t,"data-tid":L,"data-inp":k,"aria-label":e,className:"ui-unknown-width-or-height","data-image-type":N?u.Y5.STANDARD:null,"data-image-mode":C,id:a,itemType:d,role:"img",style:{backgroundImage:`url("${U}")`,...!N&&{paddingTop:`${D}rem`}},styles:{...I,...N&&{backgroundSize:"cover"}},variables:{...M,hasUnknownWidthOrHeight:!0},...S})}),this._getImagePlaceholder()]})}_getInitialState(e){const{width:t,height:n,isVideoThumbnail:i,preLoadState:r}=e,a=r===g.Succeed;let s,o,l=20;if(t&&n){const e=this._getMaxHeightAndMaxWidth(n,t,i);l=e.maxHeight,s=e.maxWidth,o=`0 0 ${t} ${n}`}else o=`0 0 1 ${l}`;return{height:n,maxHeight:l,maxWidth:s,src:a?e.src:`data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="${o}"%3E%3C/svg%3E`,width:t,loadState:a?g.Succeed:g.Loading}}_getMaxHeightAndMaxWidth(e,t,n){const i=t/e;let r=e/10,a=t/10>62?62:t/10;return(r>48||i<.5)&&(n||(r=48),a=i*r),{maxHeight:r,maxWidth:a}}}const h=e=>{const{host:t}=(0,c.ur)();return(0,i.Y)(m,{...e,host:t})},I=e=>{const t=(0,a.Ff)(),{variables:n}=e,s=r.useMemo((()=>({...n,...t})),[t,n]);return(0,i.Y)(h,{...e,variables:s})}},14459:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});var i=n(957032),r=n(753984);const a=({variables:e,link:t,disabled:n})=>"function"==typeof e?i=>({...e(i),isNotDisabledLink:t&&!n}):t&&!n?{...e,isNotDisabledLink:t&&!n}:e||{},s=e=>{const{as:t,elementRef:n,href:s,link:o,...l}=e;return(0,i.Y)(r.E,{...l,variables:a(e),as:e.link&&!e.disabled?"a":e.as,href:e.disabled?null:e.href,htmlFor:e.htmlFor,ref:n})}},506022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,W:()=>a});var i=n(513432);const r=i.createContext({}),a=()=>i.useContext(r)},566620:()=>{},20115:()=>{}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/314054-0c23301c9d2f7945.js.map